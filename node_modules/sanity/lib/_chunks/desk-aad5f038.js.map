{"version":3,"file":"desk-aad5f038.js","sources":["../../src/desk/components/Delay.tsx","../../src/desk/components/DocTitle.tsx","../../src/desk/components/TimeAgo.tsx","../../src/desk/components/confirmDeleteDialog/useReferringDocuments.ts","../../src/desk/components/PublishedStatus.tsx","../../src/desk/components/DraftStatus.tsx","../../src/desk/components/paneItem/PaneItemPreview.tsx","../../src/desk/components/paneRouter/PaneRouterContext.tsx","../../src/desk/components/paneRouter/BackLink.tsx","../../src/desk/components/pane/PaneLayoutContext.ts","../../src/desk/components/pane/usePaneLayout.ts","../../src/desk/components/paneRouter/ChildLink.tsx","../../src/desk/components/paneRouter/ReferenceChildLink.tsx","../../src/desk/components/paneRouter/ParameterizedLink.tsx","../../src/desk/components/paneRouter/usePaneRouter.ts","../../src/desk/components/confirmDeleteDialog/ReferencePreviewLink.tsx","../../src/desk/components/confirmDeleteDialog/ConfirmDeleteDialogBody.styles.tsx","../../src/desk/components/confirmDeleteDialog/ConfirmDeleteDialogBody.tsx","../../src/desk/components/confirmDeleteDialog/ConfirmDeleteDialog.tsx","../../src/desk/components/confirmDeleteDialog/index.tsx","../../src/desk/components/pane/PaneMenuButtonItem.tsx","../../src/desk/components/pane/PaneContextMenuButton.tsx","../../src/desk/components/pane/constants.ts","../../src/desk/components/pane/PaneContext.ts","../../src/desk/components/pane/PaneDivider.tsx","../../src/desk/components/pane/Pane.tsx","../../src/desk/components/pane/usePane.ts","../../src/desk/components/pane/PaneContent.styles.tsx","../../src/desk/components/pane/PaneContent.tsx","../../src/desk/components/pane/PaneFooter.styles.tsx","../../src/desk/components/pane/PaneFooter.tsx","../../src/desk/components/pane/PaneHeader.styles.tsx","../../src/desk/components/pane/PaneHeader.tsx","../../src/desk/components/pane/PaneHeaderActionButton.tsx","../../src/desk/components/pane/PaneLayout.styles.tsx","../../src/desk/menuNodes.ts","../../src/desk/components/IntentButton.tsx","../../src/desk/components/paneHeaderActions/InsufficientPermissionsMessageTooltip.tsx","../../src/desk/components/paneHeaderActions/PaneHeaderCreateButton.tsx","../../src/desk/components/paneHeaderActions/PaneHeaderActions.tsx","../../src/desk/panes/document/DocumentPaneContext.ts","../../src/desk/panes/document/useDocumentPane.tsx","../../src/desk/documentActions/DeleteAction.tsx","../../src/desk/documentActions/DiscardChangesAction.tsx","../../src/desk/documentActions/DuplicateAction.tsx","../../src/desk/documentActions/HistoryRestoreAction.tsx","../../src/desk/documentActions/PublishAction.tsx","../../src/desk/documentActions/UnpublishAction.tsx","../../src/desk/documentBadges/LiveEditBadge.ts","../../src/desk/constants.ts","../../src/desk/getIntentState.ts","../../src/desk/router.ts","../../src/desk/panes/document/constants.ts","../../src/desk/panes/document/documentInspector/DocumentInspectorHeader.tsx","../../src/desk/DeskToolContext.ts","../../src/desk/useDeskTool.ts","../../src/desk/panes/document/documentInspector/Resizer.tsx","../../src/desk/panes/document/documentInspector/Resizable.tsx","../../src/desk/panes/document/inspectors/validation/getPathTypes.ts","../../src/desk/panes/document/inspectors/validation/ValidationInspector.tsx","../../src/desk/panes/document/inspectors/validation/index.ts","../../src/desk/panes/document/timeline/constants.ts","../../src/desk/panes/document/timeline/helpers.ts","../../src/desk/panes/document/timeline/userAvatarStack.tsx","../../src/desk/panes/document/timeline/timelineItem.styled.tsx","../../src/desk/panes/document/timeline/timelineItem.tsx","../../src/desk/panes/document/timeline/timeline.styled.tsx","../../src/desk/panes/document/timeline/timeline.tsx","../../src/desk/panes/document/timeline/TimelineError.tsx","../../src/desk/panes/document/timeline/timelineMenu.tsx","../../src/desk/panes/document/inspectors/changes/LoadingContent.tsx","../../src/desk/panes/document/inspectors/changes/helpers.ts","../../src/desk/panes/document/inspectors/changes/ChangesInspector.tsx","../../src/desk/panes/document/inspectors/changes/index.ts","../../src/desk/deskTool.ts","../../src/desk/panes/document/menuItems.ts","../../src/desk/panes/document/usePreviewUrl.ts","../../src/desk/panes/document/getInitialValueTemplateOpts.ts","../../src/desk/panes/document/DocumentInspectorMenuItemsResolver.tsx","../../src/desk/panes/document/DocumentPaneProvider.tsx","../../src/desk/structureBuilder/SerializeError.ts","../../src/desk/structureBuilder/util/getExtendedProjection.ts","../../src/desk/structureBuilder/Sort.ts","../../src/desk/structureBuilder/MenuItem.ts","../../src/desk/structureBuilder/MenuItemGroup.ts","../../src/desk/structureBuilder/util/validateId.ts","../../src/desk/structureBuilder/util/getStructureNodeId.ts","../../src/desk/structureBuilder/Component.ts","../../src/desk/structureBuilder/util/resolveTypeForDocument.ts","../../src/desk/structureBuilder/views/View.ts","../../src/desk/structureBuilder/views/ComponentView.ts","../../src/desk/structureBuilder/views/FormView.ts","../../src/desk/structureBuilder/views/index.ts","../../src/desk/structureBuilder/Document.ts","../../src/desk/structureBuilder/Layout.ts","../../src/desk/structureBuilder/Intent.ts","../../src/desk/structureBuilder/InitialValueTemplateItem.ts","../../src/desk/structureBuilder/GenericList.ts","../../src/desk/structureBuilder/DocumentList.ts","../../src/desk/structureBuilder/List.ts","../../src/desk/structureBuilder/ListItem.ts","../../src/desk/structureBuilder/DocumentListItem.ts","../../src/desk/structureBuilder/DocumentTypeList.ts","../../src/desk/structureBuilder/documentTypeListItems.ts","../../src/desk/structureBuilder/createStructureBuilder.ts","../../src/desk/DeskToolProvider.tsx"],"sourcesContent":["import React, {useEffect, useState} from 'react'\n\nexport function Delay({\n  children,\n  ms = 0,\n}: {\n  children?: React.ReactElement | (() => React.ReactElement)\n  ms?: number\n}): React.ReactElement {\n  const [ready, setReady] = useState(ms <= 0)\n\n  useEffect(() => {\n    if (ms <= 0) {\n      return undefined\n    }\n\n    const timeoutId = setTimeout(() => setReady(true), ms)\n\n    return () => {\n      clearTimeout(timeoutId)\n    }\n  }, [ms])\n\n  if (!ready || !children) {\n    return <></>\n  }\n\n  return typeof children === 'function' ? children() : children\n}\n","import {SanityDocumentLike} from '@sanity/types'\nimport React from 'react'\nimport {useSchema, unstable_useValuePreview as useValuePreview} from 'sanity'\n\nexport interface DocTitleProps {\n  document: SanityDocumentLike\n}\n\nexport function DocTitle(props: DocTitleProps) {\n  const {document: documentValue} = props\n  const schema = useSchema()\n  const schemaType = schema.get(documentValue._type)\n\n  const {error, value} = useValuePreview({\n    schemaType: schemaType!,\n    value: documentValue,\n  })\n\n  if (!schemaType) {\n    return <code>Unknown schema type: {documentValue._type}</code>\n  }\n\n  if (error) {\n    return <>Error: {error.message}</>\n  }\n\n  return <>{value?.title || <span style={{color: 'var(--card-muted-fg-color)'}}>Untitled</span>}</>\n}\n","import React from 'react'\nimport {useTimeAgo} from 'sanity'\n\nexport interface TimeAgoProps {\n  time: string | Date\n}\n\nexport function TimeAgo({time}: TimeAgoProps) {\n  const timeAgo = useTimeAgo(time)\n\n  return <span title={timeAgo}>{timeAgo} ago</span>\n}\n","import {useMemo} from 'react'\nimport {ClientError, SanityClient} from '@sanity/client'\nimport {Observable, timer, fromEvent, EMPTY, of} from 'rxjs'\nimport {\n  map,\n  startWith,\n  distinctUntilChanged,\n  switchMap,\n  shareReplay,\n  catchError,\n} from 'rxjs/operators'\nimport {\n  AvailabilityResponse,\n  DEFAULT_STUDIO_CLIENT_OPTIONS,\n  DocumentStore,\n  useDocumentStore,\n  createHookFromObservableFactory,\n  getDraftId,\n  getPublishedId,\n  useClient,\n} from 'sanity'\n\n// this is used in place of `instanceof` so the matching can be more robust and\n// won't have any issues with dual packages etc\n// https://nodejs.org/api/packages.html#dual-package-hazard\nfunction isClientError(e: unknown): e is ClientError {\n  if (typeof e !== 'object') return false\n  if (!e) return false\n  return 'statusCode' in e && 'response' in e\n}\n\nconst POLL_INTERVAL = 5000\n\n// only fetches when the document is visible\nlet visiblePoll$: Observable<number>\nconst getVisiblePoll$ = () => {\n  if (!visiblePoll$) {\n    visiblePoll$ = fromEvent(document, 'visibilitychange').pipe(\n      // add empty emission to have this fire on creation\n      startWith(null),\n      map(() => document.visibilityState === 'visible'),\n      distinctUntilChanged(),\n      switchMap((visible) =>\n        visible\n          ? // using timer instead of interval since timer will emit on creation\n            timer(0, POLL_INTERVAL)\n          : EMPTY,\n      ),\n      shareReplay({refCount: true, bufferSize: 1}),\n    )\n  }\n  return visiblePoll$\n}\n\nexport type ReferringDocuments = {\n  isLoading: boolean\n  totalCount: number\n  projectIds: string[]\n  datasetNames: string[]\n  hasUnknownDatasetNames: boolean\n  internalReferences?: {\n    totalCount: number\n    references: Array<{_id: string; _type: string}>\n  }\n  crossDatasetReferences?: {\n    totalCount: number\n    references: Array<{\n      /**\n       * The project ID of the document that is currently referencing the subject\n       * document. Unlike `documentId` and `datasetName`, this should always be\n       * defined.\n       */\n      projectId: string\n      /**\n       * The ID of the document that is currently referencing the subject\n       * document. This will be omitted if there is no access to the current\n       * project and dataset pair (e.g. if no `sanity-project-token` were\n       * configured)\n       */\n      documentId?: string\n      /**\n       * The dataset name that is currently referencing the subject document.\n       * This will be omitted if there is no access to the current project and\n       * dataset pair (e.g. if no `sanity-project-token` were configured)\n       */\n      datasetName?: string\n    }>\n  }\n}\n\nfunction getDocumentExistence(\n  documentId: string,\n  {versionedClient}: {versionedClient: SanityClient},\n): Observable<string | undefined> {\n  const draftId = getDraftId(documentId)\n  const publishedId = getPublishedId(documentId)\n  const requestOptions = {\n    uri: versionedClient.getDataUrl('doc', `${draftId},${publishedId}`),\n    json: true,\n    query: {excludeContent: 'true'},\n    tag: 'use-referring-documents.document-existence',\n  }\n  return versionedClient.observable.request<AvailabilityResponse>(requestOptions).pipe(\n    map(({omitted}) => {\n      const nonExistant = omitted.filter((doc) => doc.reason === 'existence')\n      if (nonExistant.length === 2) {\n        // None of the documents exist\n        return undefined\n      }\n\n      if (nonExistant.length === 0) {\n        // Both exist, so use the published one\n        return publishedId\n      }\n\n      // If the draft does not exist, use the published ID, and vice versa\n      return nonExistant.some((doc) => doc.id === draftId) ? publishedId : draftId\n    }),\n  )\n}\n\n/**\n * fetches the cross-dataset references using the client observable.request\n * method (for that requests can be automatically cancelled)\n */\nfunction fetchCrossDatasetReferences(\n  documentId: string,\n  context: {versionedClient: SanityClient},\n): Observable<ReferringDocuments['crossDatasetReferences']> {\n  const {versionedClient} = context\n\n  return getVisiblePoll$().pipe(\n    switchMap(() => getDocumentExistence(documentId, context)),\n    switchMap((checkDocumentId) => {\n      if (!checkDocumentId) {\n        return of({totalCount: 0, references: []})\n      }\n\n      const currentDataset = versionedClient.config().dataset\n\n      return versionedClient.observable\n        .request({\n          url: `/data/references/${currentDataset}/documents/${checkDocumentId}/to?excludeInternalReferences=true&excludePaths=true`,\n          tag: 'use-referring-documents.external',\n        })\n        .pipe(\n          catchError((e) => {\n            // it's possible that referencing document doesn't exist yet so the\n            // API will return a 404. In those cases, we want to catch and return\n            // a response with no references\n            if (isClientError(e) && e.statusCode === 404) {\n              return of({totalCount: 0, references: []})\n            }\n\n            throw e\n          }),\n        )\n    }),\n  )\n}\n\nconst useInternalReferences = createHookFromObservableFactory(\n  ([documentId, documentStore]: [string, DocumentStore]) => {\n    const referencesClause = '*[references($documentId)][0...100]{_id,_type}'\n    const totalClause = 'count(*[references($documentId)])'\n    const fetchQuery = `{\"references\":${referencesClause},\"totalCount\":${totalClause}}`\n    const listenQuery = '*[references($documentId)]'\n\n    return documentStore.listenQuery(\n      {fetch: fetchQuery, listen: listenQuery},\n      {documentId},\n      {tag: 'use-referring-documents', transitions: ['appear', 'disappear'], throttleTime: 5000},\n    ) as Observable<ReferringDocuments['internalReferences']>\n  },\n)\n\nconst useCrossDatasetReferences = createHookFromObservableFactory(\n  ([documentId, versionedClient]: [string, SanityClient]) => {\n    // (documentId: string, versionedClient: SanityClient) => {\n    return getVisiblePoll$().pipe(\n      switchMap(() =>\n        fetchCrossDatasetReferences(documentId, {\n          versionedClient,\n        }),\n      ),\n    )\n  },\n)\n\nexport function useReferringDocuments(documentId: string): ReferringDocuments {\n  const versionedClient = useClient(DEFAULT_STUDIO_CLIENT_OPTIONS)\n\n  const documentStore = useDocumentStore()\n  const publishedId = getPublishedId(documentId)\n\n  const [internalReferences, isInternalReferencesLoading] = useInternalReferences(\n    useMemo(() => [publishedId, documentStore], [documentStore, publishedId]),\n  )\n\n  const [crossDatasetReferences, isCrossDatasetReferencesLoading] = useCrossDatasetReferences(\n    useMemo(() => [publishedId, versionedClient], [publishedId, versionedClient]),\n  )\n\n  const projectIds = useMemo(() => {\n    return Array.from(\n      new Set(\n        crossDatasetReferences?.references\n          .map((crossDatasetReference) => crossDatasetReference.projectId)\n          .filter(Boolean),\n      ),\n    ).sort()\n  }, [crossDatasetReferences?.references])\n\n  const datasetNames = useMemo(() => {\n    return Array.from(\n      new Set<string>(\n        crossDatasetReferences?.references\n          // .filter((name) => typeof name === 'string')\n          .map((crossDatasetReference) => crossDatasetReference?.datasetName || '')\n          .filter((datasetName) => Boolean(datasetName) && datasetName !== ''),\n      ),\n    ).sort()\n  }, [crossDatasetReferences?.references])\n\n  const hasUnknownDatasetNames = useMemo(() => {\n    return Boolean(\n      crossDatasetReferences?.references.some(\n        (crossDatasetReference) => typeof crossDatasetReference.datasetName !== 'string',\n      ),\n    )\n  }, [crossDatasetReferences?.references])\n\n  return {\n    totalCount: (internalReferences?.totalCount || 0) + (crossDatasetReferences?.totalCount || 0),\n    projectIds,\n    datasetNames,\n    hasUnknownDatasetNames,\n    internalReferences,\n    crossDatasetReferences,\n    isLoading: isInternalReferencesLoading || isCrossDatasetReferencesLoading,\n  }\n}\n","import React from 'react'\nimport {PublishIcon} from '@sanity/icons'\nimport {PreviewValue, SanityDocument} from '@sanity/types'\nimport {Box, Text, Tooltip} from '@sanity/ui'\nimport {TimeAgo} from './TimeAgo'\nimport {TextWithTone} from 'sanity'\n\nexport function PublishedStatus(props: {document?: PreviewValue | Partial<SanityDocument> | null}) {\n  const {document} = props\n  const updatedAt = document && '_updatedAt' in document && document._updatedAt\n  const statusLabel = document ? 'Published' : 'Not published'\n\n  return (\n    <Tooltip\n      portal\n      content={\n        <Box padding={2}>\n          <Text size={1}>\n            {document ? (\n              <>Published {updatedAt && <TimeAgo time={updatedAt} />}</>\n            ) : (\n              <>Not published</>\n            )}\n          </Text>\n        </Box>\n      }\n    >\n      <TextWithTone tone=\"positive\" dimmed={!document} muted={!document} size={1}>\n        <PublishIcon aria-label={statusLabel} />\n      </TextWithTone>\n    </Tooltip>\n  )\n}\n","import React from 'react'\nimport {EditIcon} from '@sanity/icons'\nimport {PreviewValue, SanityDocument} from '@sanity/types'\nimport {Box, Text, Tooltip} from '@sanity/ui'\nimport {TimeAgo} from './TimeAgo'\nimport {TextWithTone} from 'sanity'\n\nexport function DraftStatus(props: {document?: PreviewValue | Partial<SanityDocument> | null}) {\n  const {document} = props\n  const updatedAt = document && '_updatedAt' in document && document._updatedAt\n\n  return (\n    <Tooltip\n      portal\n      content={\n        <Box padding={2}>\n          <Text size={1}>\n            {document ? (\n              <>Edited {updatedAt && <TimeAgo time={updatedAt} />}</>\n            ) : (\n              <>No unpublished edits</>\n            )}\n          </Text>\n        </Box>\n      }\n    >\n      <TextWithTone tone=\"caution\" dimmed={!document} muted={!document} size={1}>\n        <EditIcon />\n      </TextWithTone>\n    </Tooltip>\n  )\n}\n","import type {SanityDocument, SchemaType} from '@sanity/types'\nimport React, {isValidElement} from 'react'\nimport {isNumber, isString} from 'lodash'\nimport {Inline} from '@sanity/ui'\nimport {useMemoObservable} from 'react-rx'\nimport {PublishedStatus} from '../PublishedStatus'\nimport {DraftStatus} from '../DraftStatus'\nimport type {PaneItemPreviewState} from './types'\nimport {\n  DocumentPresence,\n  DocumentPreviewPresence,\n  DocumentPreviewStore,\n  GeneralPreviewLayoutKey,\n  getPreviewStateObservable,\n  getPreviewValueWithFallback,\n  SanityDefaultPreview,\n  isRecord,\n} from 'sanity'\n\nexport interface PaneItemPreviewProps {\n  documentPreviewStore: DocumentPreviewStore\n  icon: React.ComponentType | false\n  layout: GeneralPreviewLayoutKey\n  presence?: DocumentPresence[]\n  schemaType: SchemaType\n  value: SanityDocument\n}\n\nexport function PaneItemPreview(props: PaneItemPreviewProps) {\n  const {icon, layout, presence, schemaType, value} = props\n  const title =\n    (isRecord(value.title) && isValidElement(value.title)) ||\n    isString(value.title) ||\n    isNumber(value.title)\n      ? value.title\n      : null\n\n  // NOTE: this emits sync so can never be null\n  // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n  const {draft, published, isLoading} = useMemoObservable<PaneItemPreviewState>(\n    () => getPreviewStateObservable(props.documentPreviewStore, schemaType, value._id, title),\n    [props.documentPreviewStore, schemaType, value._id, title],\n  )!\n\n  const status = isLoading ? null : (\n    <Inline space={4}>\n      {presence && presence.length > 0 && <DocumentPreviewPresence presence={presence} />}\n      <PublishedStatus document={published} />\n      <DraftStatus document={draft} />\n    </Inline>\n  )\n\n  return (\n    <SanityDefaultPreview\n      {...getPreviewValueWithFallback({value, draft, published})}\n      isPlaceholder={isLoading}\n      icon={icon}\n      layout={layout}\n      status={status}\n    />\n  )\n}\n","import {createContext} from 'react'\nimport {PaneRouterContextValue} from './types'\n\nfunction missingContext<T = unknown>(): T {\n  throw new Error('Pane is missing router context')\n}\n\n/**\n *\n * @hidden\n * @beta\n */\nexport const PaneRouterContext = createContext<PaneRouterContextValue>({\n  index: 0,\n  groupIndex: 0,\n  siblingIndex: 0,\n  payload: undefined,\n  params: {},\n  hasGroupSiblings: false,\n  groupLength: 0,\n  routerPanesState: [],\n  BackLink: () => missingContext(),\n  ChildLink: () => missingContext(),\n  ReferenceChildLink: () => missingContext(),\n  handleEditReference: () => missingContext(),\n  ParameterizedLink: () => missingContext(),\n  replaceCurrent: () => missingContext(),\n  closeCurrentAndAfter: () => missingContext(),\n  closeCurrent: () => missingContext(),\n  duplicateCurrent: () => missingContext(),\n  setView: () => missingContext(),\n  setParams: () => missingContext(),\n  setPayload: () => missingContext(),\n  navigateIntent: () => missingContext(),\n})\n","import React, {forwardRef, useContext, useMemo} from 'react'\nimport {PaneRouterContext} from './PaneRouterContext'\nimport {BackLinkProps} from './types'\nimport {StateLink} from 'sanity/router'\n\n/**\n * @internal\n */\nexport const BackLink = forwardRef(function BackLink(\n  props: BackLinkProps,\n  ref: React.ForwardedRef<HTMLAnchorElement>,\n) {\n  const {routerPanesState, groupIndex} = useContext(PaneRouterContext)\n  const panes = useMemo(() => routerPanesState.slice(0, groupIndex), [groupIndex, routerPanesState])\n  const state = useMemo(() => ({panes}), [panes])\n\n  return <StateLink {...props} ref={ref} state={state} />\n}) as React.ComponentType<BackLinkProps>\n","import {createContext} from 'react'\nimport {PaneLayoutContextValue} from './types'\n\n/**\n * @internal\n */\nexport const PaneLayoutContext = createContext<PaneLayoutContextValue | null>(null)\n","import {useContext} from 'react'\nimport {PaneLayoutContext} from './PaneLayoutContext'\nimport {PaneLayoutContextValue} from './types'\n\n/**\n *\n * @hidden\n * @beta This API will change. DO NOT USE IN PRODUCTION.\n */\nexport function usePaneLayout(): PaneLayoutContextValue {\n  const pane = useContext(PaneLayoutContext)\n\n  if (!pane) {\n    throw new Error('PaneLayout: missing context value')\n  }\n\n  return pane\n}\n","import React, {forwardRef, useContext} from 'react'\nimport {PaneRouterContext} from './PaneRouterContext'\nimport {ChildLinkProps} from './types'\nimport {StateLink} from 'sanity/router'\n\n/**\n * @internal\n */\nexport const ChildLink = forwardRef(function ChildLink(\n  props: ChildLinkProps,\n  ref: React.ForwardedRef<HTMLAnchorElement>,\n) {\n  const {childId, childPayload, childParameters, ...rest} = props\n  const {routerPanesState, groupIndex} = useContext(PaneRouterContext)\n\n  return (\n    <StateLink\n      {...rest}\n      ref={ref}\n      state={{\n        panes: [\n          ...routerPanesState.slice(0, groupIndex + 1),\n          [{id: childId, params: childParameters, payload: childPayload}],\n        ],\n      }}\n    />\n  )\n})\n","import React, {forwardRef} from 'react'\nimport {toString as pathToString} from '@sanity/util/paths'\nimport {ChildLink} from './ChildLink'\nimport {ReferenceChildLinkProps} from './types'\n\nexport const ReferenceChildLink = forwardRef(function ReferenceChildLink(\n  {documentId, documentType, parentRefPath, children, template, ...rest}: ReferenceChildLinkProps,\n  ref: React.ForwardedRef<HTMLAnchorElement>,\n) {\n  return (\n    <ChildLink\n      {...rest}\n      ref={ref}\n      childId={documentId}\n      childPayload={template?.params}\n      childParameters={{\n        type: documentType,\n        parentRefPath: pathToString(parentRefPath),\n        ...(template && {template: template?.id}),\n      }}\n    >\n      {children}\n    </ChildLink>\n  )\n})\n","import React, {forwardRef, useContext, useMemo} from 'react'\nimport {PaneRouterContext} from './PaneRouterContext'\nimport {useUnique} from 'sanity'\nimport {StateLink} from 'sanity/router'\n\ninterface ParameterizedLinkProps {\n  params?: Record<string, string>\n  payload?: unknown\n  children?: React.ReactNode\n}\n\n/**\n * @internal\n */\nexport const ParameterizedLink = forwardRef(function ParameterizedLink(\n  props: ParameterizedLinkProps,\n  ref: React.ForwardedRef<HTMLAnchorElement>,\n) {\n  const {routerPanesState: currentPanes, groupIndex, siblingIndex} = useContext(PaneRouterContext)\n  const {params, payload, ...rest} = props\n  const nextParams = useUnique(params)\n  const nextPayload = useUnique(payload)\n\n  const nextState = useMemo(() => {\n    const currentGroup = currentPanes[groupIndex]\n    const currentSibling = currentGroup[siblingIndex]\n\n    const nextSibling = {\n      ...currentSibling,\n      params: nextParams ?? currentSibling.params,\n      payload: nextPayload ?? currentSibling.payload,\n    }\n\n    const nextGroup = [\n      ...currentGroup.slice(0, siblingIndex),\n      nextSibling,\n      ...currentGroup.slice(siblingIndex + 1),\n    ]\n\n    const nextPanes = [\n      ...currentPanes.slice(0, groupIndex),\n      nextGroup,\n      ...currentPanes.slice(groupIndex + 1),\n    ]\n\n    return {panes: nextPanes}\n  }, [currentPanes, groupIndex, nextParams, nextPayload, siblingIndex])\n\n  return <StateLink ref={ref} {...rest} state={nextState} />\n})\n","import {useContext} from 'react'\nimport {PaneRouterContext} from './PaneRouterContext'\nimport {PaneRouterContextValue} from './types'\n\n/**\n *\n * @hidden\n * @beta\n */\nexport function usePaneRouter(): PaneRouterContextValue {\n  return useContext(PaneRouterContext)\n}\n","import React, {useCallback} from 'react'\nimport type {SanityDocument, SchemaType} from '@sanity/types'\nimport {PaneItemPreview} from '../paneItem/PaneItemPreview'\nimport {usePaneRouter} from '../paneRouter'\nimport {\n  FIXME,\n  PreviewCard,\n  getPublishedId,\n  useDocumentPresence,\n  useDocumentPreviewStore,\n} from 'sanity'\n\nconst EMPTY_ARRAY: [] = []\n\ninterface ReferencePreviewLinkProps {\n  onClick?: () => void\n  type: SchemaType & {icon?: any}\n  value: SanityDocument\n}\n\nexport function ReferencePreviewLink(props: ReferencePreviewLinkProps) {\n  const {onClick, type, value} = props\n  const publishedId = getPublishedId(value?._id)\n  const documentPresence = useDocumentPresence(publishedId)\n  const documentPreviewStore = useDocumentPreviewStore()\n  const {ReferenceChildLink} = usePaneRouter()\n\n  const Link = useCallback(\n    function LinkComponent(linkProps: {children: React.ReactNode}) {\n      return (\n        <ReferenceChildLink\n          documentId={value?._id}\n          documentType={type?.name}\n          parentRefPath={EMPTY_ARRAY}\n          {...linkProps}\n        />\n      )\n    },\n    [ReferenceChildLink, type?.name, value?._id],\n  )\n\n  return (\n    <PreviewCard\n      __unstable_focusRing\n      as={Link as FIXME}\n      data-as=\"a\"\n      onClick={onClick}\n      padding={2}\n      radius={2}\n    >\n      <PaneItemPreview\n        documentPreviewStore={documentPreviewStore}\n        icon={type?.icon}\n        layout=\"default\"\n        presence={documentPresence?.length > 0 ? documentPresence : EMPTY_ARRAY}\n        schemaType={type}\n        value={value}\n      />\n    </PreviewCard>\n  )\n}\n","import React from 'react'\nimport styled from 'styled-components'\nimport {rem, Flex, Text, Box, Tooltip, Container, Inline} from '@sanity/ui'\nimport {InfoOutlineIcon} from '@sanity/icons'\n\nexport const ChevronWrapper = styled(Box)`\n  margin-left: auto;\n`\n\nexport const CrossDatasetReferencesDetails = styled.details`\n  flex: none;\n\n  &[open] ${ChevronWrapper} {\n    transform: rotate(180deg);\n  }\n`\n\nexport const CrossDatasetReferencesSummary = styled.summary`\n  list-style: none;\n\n  &::-webkit-details-marker {\n    display: none;\n  }\n`\n\nexport const Table = styled.table`\n  width: 100%;\n  text-align: left;\n  padding: 0 ${({theme}) => rem(theme.sanity.space[2])};\n  border-collapse: collapse;\n\n  th {\n    padding: ${({theme}) => rem(theme.sanity.space[1])};\n  }\n\n  td {\n    padding: 0 ${({theme}) => rem(theme.sanity.space[1])};\n  }\n\n  tr > *:last-child {\n    text-align: right;\n  }\n`\n\nexport const DocumentIdFlex = styled(Flex)`\n  min-height: 35px;\n`\n\nexport const OtherReferenceCount = (props: {totalCount: number; references: unknown[]}) => {\n  const difference = props.totalCount - props.references.length\n\n  if (!difference) return null\n\n  return (\n    <Inline space={2}>\n      <Text size={1} muted>\n        {difference} other reference{difference === 1 ? '' : 's'} not shown{' '}\n      </Text>\n\n      <Tooltip\n        portal\n        placement=\"top\"\n        content={\n          <Container width={0}>\n            <Box padding={2}>\n              <Text size={1}>\n                We can't show metadata about these references because no token with access to the\n                datasets they are in was found.\n              </Text>\n            </Box>\n          </Container>\n        }\n      >\n        <Text size={1} muted>\n          <InfoOutlineIcon />\n        </Text>\n      </Tooltip>\n    </Inline>\n  )\n}\n","import React, {useCallback} from 'react'\nimport {\n  WarningOutlineIcon,\n  DocumentsIcon,\n  CopyIcon,\n  UnknownIcon,\n  ChevronDownIcon,\n} from '@sanity/icons'\nimport {useToast, Text, Box, Button, Flex, Label, Card, Stack} from '@sanity/ui'\nimport CopyToClipboard from 'react-copy-to-clipboard'\nimport {ReferencePreviewLink} from './ReferencePreviewLink'\nimport {ReferringDocuments} from './useReferringDocuments'\nimport {\n  OtherReferenceCount,\n  CrossDatasetReferencesDetails,\n  CrossDatasetReferencesSummary,\n  Table,\n  ChevronWrapper,\n  DocumentIdFlex,\n} from './ConfirmDeleteDialogBody.styles'\nimport {SanityDefaultPreview, useSchema} from 'sanity'\n\ntype DeletionConfirmationDialogBodyProps = Required<ReferringDocuments> & {\n  documentTitle: React.ReactNode\n  action: string\n  onReferenceLinkClick?: () => void\n}\n\n/**\n * The inner part of the `ConfirmDeleteDialog`. This is ran when both the\n * `crossDatasetReferences` and `internalReferences` are loaded.\n */\nexport function ConfirmDeleteDialogBody({\n  crossDatasetReferences,\n  internalReferences,\n  documentTitle,\n  totalCount,\n  action,\n  datasetNames,\n  hasUnknownDatasetNames,\n  onReferenceLinkClick,\n}: DeletionConfirmationDialogBodyProps) {\n  const schema = useSchema()\n  const toast = useToast()\n\n  const renderPreviewItem = useCallback(\n    (item: any) => {\n      const type = schema.get(item._type)\n      if (type) {\n        return <ReferencePreviewLink type={type} value={item} onClick={onReferenceLinkClick} />\n      }\n\n      return (\n        // Padding added to match the ReferencePreviewLink styling\n        <Box padding={2}>\n          <SanityDefaultPreview\n            icon={UnknownIcon}\n            title=\"Preview Unavailable\"\n            subtitle={`ID: ${item._id}`}\n            layout=\"default\"\n          />\n        </Box>\n      )\n    },\n    [schema, onReferenceLinkClick],\n  )\n\n  if (internalReferences?.totalCount === 0 && crossDatasetReferences?.totalCount === 0) {\n    return (\n      <Text as=\"p\">\n        Are you sure you want to {action} <strong>“{documentTitle}”</strong>?\n      </Text>\n    )\n  }\n\n  const documentCount =\n    crossDatasetReferences.totalCount === 1\n      ? '1 document'\n      : `${crossDatasetReferences.totalCount.toLocaleString()} documents`\n\n  // We do some extra checks to handle cases where you have unavailable dataset\n  // name(s) due to permissions, both alone and in combination with known datasets\n\n  // This normalizes one or more undefined dataset names to the catch-all `unavailable`\n  const normalizedDatasetNames = [\n    ...datasetNames,\n    ...(hasUnknownDatasetNames ? ['unavailable'] : []),\n  ]\n  const datasetsCount =\n    normalizedDatasetNames.length === 1\n      ? 'another dataset'\n      : `${normalizedDatasetNames.length} datasets`\n\n  let datasetNameList = `Dataset${\n    normalizedDatasetNames.length === 1 ? '' : 's'\n  }: ${normalizedDatasetNames.join(', ')}`\n\n  // We only have one dataset, and it is unavailable due to permissions\n  if (hasUnknownDatasetNames && normalizedDatasetNames.length === 1) {\n    datasetNameList = 'Unavailable dataset'\n  }\n\n  return (\n    <Card>\n      <Card padding={3} radius={2} tone=\"caution\" marginBottom={4} flex=\"none\">\n        <Flex>\n          <Text aria-hidden=\"true\" size={1}>\n            <WarningOutlineIcon />\n          </Text>\n          <Box flex={1} marginLeft={3}>\n            <Text size={1}>\n              {totalCount === 1 ? (\n                <>1 document refers to “{documentTitle}”</>\n              ) : (\n                <>\n                  {totalCount.toLocaleString()} documents refer to “{documentTitle}”\n                </>\n              )}\n            </Text>\n          </Box>\n        </Flex>\n      </Card>\n\n      <Box flex=\"none\" marginBottom={4}>\n        <Text>\n          You may not be able to {action} “{documentTitle}” because the following documents refer to\n          it:\n        </Text>\n      </Box>\n\n      <Card radius={2} shadow={1} marginBottom={4} flex=\"auto\">\n        <Flex direction=\"column\">\n          {internalReferences.totalCount > 0 && (\n            <Stack as=\"ul\" padding={2} space={3} data-testid=\"internal-references\">\n              {internalReferences?.references.map((item) => (\n                <Box as=\"li\" key={item._id}>\n                  {renderPreviewItem(item)}\n                </Box>\n              ))}\n\n              {internalReferences.totalCount > internalReferences.references.length && (\n                <Box as=\"li\" padding={3}>\n                  <OtherReferenceCount {...internalReferences} />\n                </Box>\n              )}\n            </Stack>\n          )}\n\n          {crossDatasetReferences.totalCount > 0 && (\n            <CrossDatasetReferencesDetails\n              data-testid=\"cross-dataset-references\"\n              style={{\n                // only add the border if needed\n                borderTop:\n                  internalReferences.totalCount > 0\n                    ? '1px solid var(--card-shadow-outline-color)'\n                    : undefined,\n              }}\n            >\n              <CrossDatasetReferencesSummary>\n                <Card as=\"a\" margin={2} radius={2} shadow={1} paddingY={1}>\n                  <Flex align=\"center\" margin={2}>\n                    <Box marginLeft={3} marginRight={4}>\n                      <Text size={3}>\n                        <DocumentsIcon />\n                      </Text>\n                    </Box>\n                    <Flex marginRight={4} direction=\"column\">\n                      <Box marginBottom={2}>\n                        <Text>\n                          {documentCount} in {datasetsCount}\n                        </Text>\n                      </Box>\n                      <Box>\n                        <Text title={datasetNameList} textOverflow=\"ellipsis\" size={1} muted>\n                          {datasetNameList}\n                        </Text>\n                      </Box>\n                    </Flex>\n                    <ChevronWrapper>\n                      <Text muted>\n                        <ChevronDownIcon />\n                      </Text>\n                    </ChevronWrapper>\n                  </Flex>\n                </Card>\n              </CrossDatasetReferencesSummary>\n\n              <Box overflow=\"auto\" paddingBottom={2} paddingX={2}>\n                <Table>\n                  <thead>\n                    <tr>\n                      <th>\n                        <Label muted size={0} style={{minWidth: '5rem'}}>\n                          Project ID\n                        </Label>\n                      </th>\n                      <th>\n                        <Label muted size={0}>\n                          Dataset\n                        </Label>\n                      </th>\n                      <th>\n                        <Label muted size={0}>\n                          Document ID\n                        </Label>\n                      </th>\n                    </tr>\n                  </thead>\n                  <tbody>\n                    {crossDatasetReferences.references\n                      .filter((reference): reference is Required<typeof reference> => {\n                        return 'projectId' in reference\n                      })\n                      .map(({projectId, datasetName, documentId}, index) => (\n                        // eslint-disable-next-line react/no-array-index-key\n                        <tr key={`${documentId}-${index}`}>\n                          <td>\n                            <Text size={1}>{projectId}</Text>\n                          </td>\n                          <td>\n                            <Text size={1}>{datasetName || 'unavailable'}</Text>\n                          </td>\n                          <td>\n                            <DocumentIdFlex align=\"center\" gap={2} justify=\"flex-end\">\n                              <Text textOverflow=\"ellipsis\" size={1}>\n                                {documentId || 'unavailable'}\n                              </Text>\n                              {documentId && (\n                                <CopyToClipboard\n                                  text={documentId}\n                                  // eslint-disable-next-line react/jsx-no-bind\n                                  onCopy={() => {\n                                    // TODO: this isn't visible with the dialog open\n                                    toast.push({\n                                      title: 'Copied document ID to clipboard!',\n                                      status: 'success',\n                                    })\n                                  }}\n                                >\n                                  <Button\n                                    title=\"Copy ID to clipboard\"\n                                    mode=\"bleed\"\n                                    icon={CopyIcon}\n                                    fontSize={0}\n                                  />\n                                </CopyToClipboard>\n                              )}\n                            </DocumentIdFlex>\n                          </td>\n                        </tr>\n                      ))}\n                  </tbody>\n                </Table>\n\n                <Box padding={2}>\n                  <OtherReferenceCount {...crossDatasetReferences} />\n                </Box>\n              </Box>\n            </CrossDatasetReferencesDetails>\n          )}\n        </Flex>\n      </Card>\n\n      <Box flex=\"none\">\n        <Text>\n          If you {action} this document, documents that refer to it will no longer be able to access\n          it.\n        </Text>\n      </Box>\n    </Card>\n  )\n}\n","import React, {useMemo, useId} from 'react'\nimport styled from 'styled-components'\nimport {Box, Dialog, Button, Text, Spinner, Grid, Flex} from '@sanity/ui'\nimport {DocTitle} from '../DocTitle'\nimport {useReferringDocuments} from './useReferringDocuments'\nimport {ConfirmDeleteDialogBody} from './ConfirmDeleteDialogBody'\n\n/** @internal */\nexport const DialogBody = styled(Box).attrs({\n  padding: 4,\n})`\n  box-sizing: border-box;\n`\n\n/** @internal */\nexport const LoadingContainer = styled(Flex).attrs({\n  align: 'center',\n  direction: 'column',\n  justify: 'center',\n})`\n  height: 300px;\n`\n\n/** @internal */\nexport interface ConfirmDeleteDialogProps {\n  /**\n   * Incoming document ID used to find other referencing documents. This\n   * field respects draft IDs (e.g. if you pass in a published ID when one\n   * doesn't exist the document title may not show up).\n   */\n  id: string\n  /**\n   * The schema typename of the incoming document\n   */\n  type: string\n  /**\n   * The name of the action being done. (e.g. the `'unpublish'` action requires\n   * the same document deletion confirmation).\n   */\n  action?: string\n  onCancel: () => void\n  onConfirm: () => void\n}\n\n/**\n * A confirmation dialog used to prevent unwanted document deletes. Loads all\n * the referencing internal and cross-data references prior to showing the\n * delete button.\n *\n * @internal\n */\nexport function ConfirmDeleteDialog({\n  id,\n  type,\n  action = 'delete',\n  onCancel,\n  onConfirm,\n}: ConfirmDeleteDialogProps) {\n  const dialogId = `deletion-confirmation-${useId()}`\n  const {\n    internalReferences,\n    crossDatasetReferences,\n    isLoading,\n    totalCount,\n    projectIds,\n    datasetNames,\n    hasUnknownDatasetNames,\n  } = useReferringDocuments(id)\n  const capitalizedAction = `${action.substring(0, 1).toUpperCase()}${action.substring(1)}`\n\n  const documentTitle = <DocTitle document={useMemo(() => ({_id: id, _type: type}), [id, type])} />\n  const showConfirmButton = !isLoading\n\n  return (\n    <Dialog\n      width={1}\n      id={dialogId}\n      header={`${capitalizedAction} document?`}\n      footer={\n        <Grid columns={showConfirmButton ? 2 : 1} gap={2} paddingX={4} paddingY={3}>\n          <Button mode=\"ghost\" onClick={onCancel} text=\"Cancel\" />\n\n          {showConfirmButton && (\n            <Button\n              data-testid=\"confirm-delete-button\"\n              text={totalCount > 0 ? `${capitalizedAction} anyway` : `${capitalizedAction} now`}\n              tone=\"critical\"\n              onClick={onConfirm}\n            />\n          )}\n        </Grid>\n      }\n      onClose={onCancel}\n      onClickOutside={onCancel}\n    >\n      <DialogBody>\n        {crossDatasetReferences && internalReferences && !isLoading ? (\n          <ConfirmDeleteDialogBody\n            crossDatasetReferences={crossDatasetReferences}\n            internalReferences={internalReferences}\n            documentTitle={documentTitle}\n            isLoading={isLoading}\n            totalCount={totalCount}\n            action={action}\n            projectIds={projectIds}\n            datasetNames={datasetNames}\n            hasUnknownDatasetNames={hasUnknownDatasetNames}\n            onReferenceLinkClick={onCancel}\n          />\n        ) : (\n          <LoadingContainer data-testid=\"loading-container\">\n            <Spinner muted />\n            <Box marginTop={3}>\n              <Text align=\"center\" muted size={1}>\n                Looking for referring documents…\n              </Text>\n            </Box>\n          </LoadingContainer>\n        )}\n      </DialogBody>\n    </Dialog>\n  )\n}\n","import React, {useCallback, useState, useId} from 'react'\nimport {Box, Flex, Button, Dialog, Text, ErrorBoundary} from '@sanity/ui'\nimport {ConfirmDeleteDialog, ConfirmDeleteDialogProps} from './ConfirmDeleteDialog'\n\nexport type {ConfirmDeleteDialogProps}\n\ntype ArgType<T> = T extends (arg: infer U) => unknown ? U : never\ntype ErrorInfo = ArgType<React.ComponentProps<typeof ErrorBoundary>['onCatch']>\n\n/** @internal */\nfunction ConfirmDeleteDialogContainer(props: ConfirmDeleteDialogProps) {\n  const id = useId()\n  const [error, setError] = useState<ErrorInfo | null>(null)\n  const handleRetry = useCallback(() => setError(null), [])\n\n  return error ? (\n    <Dialog\n      id={`dialog-error-${id}`}\n      data-testid=\"confirm-delete-error-dialog\"\n      header=\"Error\"\n      footer={\n        <Flex paddingX={4} paddingY={3} direction=\"column\">\n          <Button mode=\"ghost\" text=\"Retry\" onClick={handleRetry} />\n        </Flex>\n      }\n      onClose={props.onCancel}\n    >\n      <Box padding={4}>\n        <Text>An error occurred while loading referencing documents.</Text>\n      </Box>\n    </Dialog>\n  ) : (\n    <ErrorBoundary onCatch={setError}>\n      <ConfirmDeleteDialog {...props} />\n    </ErrorBoundary>\n  )\n}\n\nexport {ConfirmDeleteDialogContainer as ConfirmDeleteDialog}\n","import {CheckmarkIcon} from '@sanity/icons'\nimport {Box, Label, MenuDivider, MenuGroup, MenuItem, PopoverProps, Text} from '@sanity/ui'\nimport React, {useCallback, MouseEvent} from 'react'\nimport {Intent} from '../../structureBuilder'\nimport {_PaneMenuItem, _PaneMenuNode} from './types'\nimport {TooltipOfDisabled} from 'sanity'\nimport {useIntentLink} from 'sanity/router'\n\nconst MENU_GROUP_POPOVER_PROPS: PopoverProps = {\n  constrainSize: true,\n  placement: 'left-start',\n  portal: true,\n}\n\nexport function PaneMenuButtonItem(props: {\n  disabled?: boolean\n  isAfterGroup: boolean\n  node: _PaneMenuNode\n}) {\n  const {disabled, isAfterGroup, node} = props\n\n  if (node.type === 'divider') {\n    return <MenuDivider />\n  }\n\n  if (node.type === 'group') {\n    if (node.children.length === 0) {\n      return null\n    }\n\n    if (node.expanded) {\n      return (\n        <>\n          {isAfterGroup && <MenuDivider />}\n          {node.title && (\n            <Box padding={2} paddingBottom={1}>\n              <Label muted size={0}>\n                {node.title}\n              </Label>\n            </Box>\n          )}\n          {node.children.map((child, childIndex) => (\n            <PaneMenuButtonItem\n              disabled={disabled || Boolean(node.disabled)}\n              isAfterGroup={node.children[childIndex - 1]?.type === 'group'}\n              key={child.key}\n              node={child}\n            />\n          ))}\n        </>\n      )\n    }\n\n    return (\n      <>\n        {isAfterGroup && <MenuDivider />}\n        <MenuGroup\n          disabled={disabled}\n          icon={node.icon}\n          popover={MENU_GROUP_POPOVER_PROPS}\n          text={node.title}\n        >\n          {node.children.map((child, childIndex) => (\n            <PaneMenuButtonItem\n              disabled={disabled || Boolean(node.disabled)}\n              isAfterGroup={node.children[childIndex - 1]?.type === 'group'}\n              key={child.key}\n              node={child}\n            />\n          ))}\n        </MenuGroup>\n      </>\n    )\n  }\n\n  return (\n    <>\n      {isAfterGroup && <MenuDivider />}\n      <PaneContextMenuItemResolver disabled={disabled} node={node} />\n    </>\n  )\n}\n\nfunction PaneContextMenuItemResolver(props: {disabled?: boolean; node: _PaneMenuItem}) {\n  const {node} = props\n\n  if (node.intent) {\n    return <PaneContextIntentMenuItem {...props} intent={node.intent} />\n  }\n\n  return <PaneContextMenuItem {...props} />\n}\n\nfunction PaneContextMenuItem(props: {disabled?: boolean; node: _PaneMenuItem}) {\n  const {disabled, node} = props\n  const tooltipContent = typeof node.disabled === 'object' && (\n    <Text size={1}>{node.disabled.reason}</Text>\n  )\n\n  return (\n    <TooltipOfDisabled content={tooltipContent} placement=\"left\">\n      <MenuItem\n        disabled={disabled || Boolean(node.disabled)}\n        hotkeys={node.hotkey?.split('+')}\n        icon={node.icon}\n        iconRight={node.iconRight || (node.selected && CheckmarkIcon)}\n        // eslint-disable-next-line react/jsx-handler-names\n        onClick={node.onAction}\n        pressed={node.selected}\n        text={node.title}\n        tone={node.tone}\n      />\n    </TooltipOfDisabled>\n  )\n}\n\nfunction PaneContextIntentMenuItem(props: {\n  disabled?: boolean\n  intent: Intent\n  node: _PaneMenuItem\n}) {\n  const {disabled, intent, node} = props\n  const tooltipContent = typeof node.disabled === 'object' && (\n    <Text size={1}>{node.disabled.reason}</Text>\n  )\n  const intentLink = useIntentLink({intent: intent.type, params: intent.params})\n\n  const handleClick = useCallback(\n    (event: MouseEvent<HTMLDivElement>) => {\n      intentLink.onClick(event)\n      node.onAction()\n    },\n    [intentLink, node],\n  )\n\n  return (\n    <TooltipOfDisabled content={tooltipContent} placement=\"left\">\n      <MenuItem\n        as=\"a\"\n        disabled={disabled || Boolean(node.disabled)}\n        hotkeys={node.hotkey?.split('+')}\n        href={intentLink.href}\n        icon={node.icon}\n        iconRight={node.selected ? CheckmarkIcon : undefined}\n        onClick={handleClick}\n        pressed={node.selected}\n        text={node.title}\n        tone={node.tone}\n      />\n    </TooltipOfDisabled>\n  )\n}\n","import {EllipsisVerticalIcon} from '@sanity/icons'\nimport {Menu, MenuButton, PopoverProps} from '@sanity/ui'\nimport React, {useId} from 'react'\nimport {_PaneMenuItem, _PaneMenuNode} from './types'\nimport {PaneMenuButtonItem} from './PaneMenuButtonItem'\nimport {StatusButton} from 'sanity'\n\ninterface PaneContextMenuButtonProps {\n  nodes: _PaneMenuNode[]\n}\n\nconst CONTEXT_MENU_POPOVER_PROPS: PopoverProps = {\n  constrainSize: true,\n  placement: 'bottom',\n  portal: true,\n}\n\nfunction nodesHasTone(nodes: _PaneMenuNode[], tone: NonNullable<_PaneMenuItem['tone']>): boolean {\n  return nodes.some((node) => {\n    return (\n      (node.type === 'item' && node.tone === tone) ||\n      (node.type === 'group' && nodesHasTone(node.children, tone))\n    )\n  })\n}\n\n/**\n *\n * @hidden\n * @beta This API will change. DO NOT USE IN PRODUCTION.\n */\nexport function PaneContextMenuButton(props: PaneContextMenuButtonProps) {\n  const {nodes} = props\n  const id = useId()\n\n  const hasCritical = nodesHasTone(nodes, 'critical')\n  const hasCaution = nodesHasTone(nodes, 'caution')\n\n  return (\n    <MenuButton\n      button={\n        <StatusButton\n          icon={EllipsisVerticalIcon}\n          mode=\"bleed\"\n          title=\"Show menu\"\n          // eslint-disable-next-line no-nested-ternary\n          tone={hasCritical ? 'critical' : hasCaution ? 'caution' : undefined}\n        />\n      }\n      id={id}\n      menu={\n        <Menu>\n          {nodes.map((node, nodeIndex) => {\n            const isAfterGroup = nodes[nodeIndex - 1]?.type === 'group'\n\n            return <PaneMenuButtonItem isAfterGroup={isAfterGroup} key={node.key} node={node} />\n          })}\n        </Menu>\n      }\n      popover={CONTEXT_MENU_POPOVER_PROPS}\n    />\n  )\n}\n","/**\n * @internal\n */\nexport const PANE_DEBUG = false\n\n/**\n * @internal\n */\nexport const PANE_COLLAPSED_WIDTH = 51\n\n/**\n * @internal\n */\nexport const PANE_DEFAULT_MIN_WIDTH = PANE_COLLAPSED_WIDTH * 4\n","import {createContext} from 'react'\nimport {PaneContextValue} from './types'\n\n/**\n * @internal\n */\nexport const PaneContext = createContext<PaneContextValue | null>(null)\n","import {Layer} from '@sanity/ui'\nimport React, {useCallback, useState} from 'react'\nimport styled from 'styled-components'\nimport {usePaneLayout} from './usePaneLayout'\n\nconst Root = styled(Layer)`\n  position: relative;\n  width: 1px;\n  min-width: 1px;\n\n  &:before {\n    content: '';\n    display: block;\n    position: absolute;\n    top: 0;\n    left: 0;\n    bottom: 0;\n    width: 1px;\n    background-color: var(--card-border-color);\n  }\n\n  &:not([data-disabled]) {\n    cursor: ew-resize;\n    width: 9px;\n    min-width: 9px;\n    margin: 0 -4px;\n\n    &:before {\n      left: 4px;\n    }\n\n    &:after {\n      content: '';\n      display: block;\n      position: absolute;\n      top: 0;\n      left: 0;\n      width: 9px;\n      bottom: 0;\n      background-color: var(--card-border-color);\n      opacity: 0;\n      transition: opacity 150ms;\n    }\n\n    &[data-dragging]:after,\n    &:hover:after {\n      opacity: 0.2;\n    }\n  }\n`\n\n/**\n *\n * @hidden\n * @beta This API will change. DO NOT USE IN PRODUCTION.\n */\nexport function PaneDivider({\n  disabled,\n  element,\n}: {\n  disabled?: boolean\n  element: HTMLElement | null\n}) {\n  const {resize} = usePaneLayout()\n  const [dragging, setDragging] = useState(false)\n\n  const handleMouseDown = useCallback(\n    (event: any) => {\n      if (!element) return\n\n      setDragging(true)\n\n      event.preventDefault()\n\n      const startX = event.pageX\n\n      resize('start', element, 0)\n\n      const handleMouseMove = (e: MouseEvent) => {\n        e.preventDefault()\n\n        const deltaX = e.pageX - startX\n\n        resize('move', element, deltaX)\n      }\n\n      const handleMouseUp = (e: MouseEvent) => {\n        e.preventDefault()\n\n        setDragging(false)\n\n        window.removeEventListener('mousemove', handleMouseMove)\n        window.removeEventListener('mouseup', handleMouseUp)\n\n        resize('end', element, 0)\n      }\n\n      window.addEventListener('mousemove', handleMouseMove)\n      window.addEventListener('mouseup', handleMouseUp)\n    },\n    [element, resize],\n  )\n\n  return (\n    <Root\n      data-disabled={disabled ? '' : undefined}\n      data-dragging={dragging ? '' : undefined}\n      onMouseDown={handleMouseDown}\n    />\n  )\n}\n","import {BoundaryElementProvider, Card, CardProps, Code, Flex, useForwardedRef} from '@sanity/ui'\nimport React, {forwardRef, useMemo, useState, useCallback, useEffect} from 'react'\nimport styled from 'styled-components'\nimport {PANE_COLLAPSED_WIDTH, PANE_DEBUG, PANE_DEFAULT_MIN_WIDTH} from './constants'\nimport {PaneContext} from './PaneContext'\nimport {PaneDivider} from './PaneDivider'\nimport {usePaneLayout} from './usePaneLayout'\nimport {LegacyLayerProvider} from 'sanity'\n\ninterface PaneProps {\n  children?: React.ReactNode\n  currentMinWidth?: number\n  currentMaxWidth?: number\n  flex?: number\n  id: string\n  minWidth?: number\n  maxWidth?: number\n  selected?: boolean\n}\n\nconst Root = styled(Card)`\n  outline: none;\n\n  // NOTE: This will render a border to the right side of each pane\n  // without taking up physical space.\n  box-shadow: 1px 0 0 var(--card-border-color);\n`\n\n/**\n *\n * @hidden\n * @beta This API will change. DO NOT USE IN PRODUCTION.\n */\n// eslint-disable-next-line complexity\nexport const Pane = forwardRef(function Pane(\n  props: PaneProps &\n    Omit<CardProps, 'as' | 'overflow'> &\n    Omit<React.HTMLProps<HTMLDivElement>, 'as' | 'height' | 'hidden' | 'id' | 'style'>,\n  ref: React.ForwardedRef<HTMLDivElement>,\n) {\n  const {\n    children,\n    currentMinWidth: currentMinWidthProp,\n    currentMaxWidth: currentMaxWidthProp,\n    flex: flexProp = 1,\n    id,\n    minWidth: minWidthProp,\n    maxWidth: maxWidthProp,\n    selected = false,\n    ...restProps\n  } = props\n  const [rootElement, setRootElement] = useState<HTMLDivElement | null>(null)\n  const {\n    collapse,\n    collapsed: layoutCollapsed,\n    expand,\n    expandedElement,\n    mount,\n    panes,\n  } = usePaneLayout()\n  const pane = panes.find((p) => p.element === rootElement)\n  const paneIndex = pane && panes.indexOf(pane)\n  const nextPane = typeof paneIndex === 'number' ? panes[paneIndex + 1] : undefined\n  const isLast = paneIndex === panes.length - 1\n  const expanded = expandedElement === rootElement\n  const collapsed = layoutCollapsed ? false : pane?.collapsed || false\n  const nextCollapsed = nextPane?.collapsed || false\n  const forwardedRef = useForwardedRef(ref)\n  const flex = pane?.flex ?? flexProp\n  const currentMinWidth = pane?.currentMinWidth ?? currentMinWidthProp\n  const currentMaxWidth = pane?.currentMaxWidth ?? currentMaxWidthProp\n\n  const setRef = useCallback(\n    (refValue: HTMLDivElement | null) => {\n      setRootElement(refValue)\n      forwardedRef.current = refValue\n    },\n    [forwardedRef],\n  )\n\n  useEffect(() => {\n    if (!rootElement) return undefined\n    return mount(rootElement, {\n      currentMinWidth: currentMinWidthProp,\n      currentMaxWidth: currentMaxWidthProp,\n      flex: flexProp,\n      id,\n      minWidth: minWidthProp,\n      maxWidth: maxWidthProp,\n    })\n  }, [\n    currentMinWidthProp,\n    currentMaxWidthProp,\n    flexProp,\n    id,\n    minWidthProp,\n    maxWidthProp,\n    mount,\n    rootElement,\n  ])\n\n  const handleCollapse = useCallback(() => {\n    if (!rootElement) return\n    collapse(rootElement)\n  }, [collapse, rootElement])\n\n  const handleExpand = useCallback(() => {\n    if (!rootElement) return\n    expand(rootElement)\n  }, [expand, rootElement])\n\n  const contextValue = useMemo(\n    () => ({\n      collapse: handleCollapse,\n      collapsed: layoutCollapsed ? false : collapsed,\n      expand: handleExpand,\n      index: paneIndex,\n      isLast,\n      rootElement,\n    }),\n    [collapsed, handleCollapse, handleExpand, isLast, layoutCollapsed, paneIndex, rootElement],\n  )\n\n  const minWidth = useMemo(() => {\n    if (layoutCollapsed) {\n      return undefined\n    }\n\n    if (collapsed) return PANE_COLLAPSED_WIDTH\n\n    if (currentMinWidth === 0) {\n      return minWidthProp || PANE_DEFAULT_MIN_WIDTH\n    }\n\n    if (isLast) {\n      return minWidthProp || PANE_DEFAULT_MIN_WIDTH\n    }\n\n    return currentMinWidth || minWidthProp || PANE_DEFAULT_MIN_WIDTH\n  }, [collapsed, currentMinWidth, isLast, layoutCollapsed, minWidthProp])\n\n  const maxWidth = useMemo(() => {\n    if (collapsed) return PANE_COLLAPSED_WIDTH\n\n    if (layoutCollapsed && isLast) {\n      return undefined\n    }\n\n    if (isLast) {\n      if (maxWidthProp) {\n        return currentMaxWidth ?? maxWidthProp\n      }\n\n      return undefined\n    }\n\n    return currentMaxWidth ?? maxWidthProp\n  }, [collapsed, currentMaxWidth, isLast, layoutCollapsed, maxWidthProp])\n\n  const hidden = layoutCollapsed && !isLast\n\n  const divider = useMemo(\n    () =>\n      !isLast &&\n      !layoutCollapsed && (\n        <LegacyLayerProvider zOffset=\"paneResizer\">\n          <PaneDivider disabled={collapsed || nextCollapsed} element={rootElement} />\n        </LegacyLayerProvider>\n      ),\n    [collapsed, isLast, layoutCollapsed, nextCollapsed, rootElement],\n  )\n\n  const style = useMemo(\n    () => ({\n      flex,\n      minWidth,\n      maxWidth: maxWidth === Infinity ? undefined : maxWidth,\n    }),\n    [flex, minWidth, maxWidth],\n  )\n\n  return (\n    <>\n      <LegacyLayerProvider zOffset=\"pane\">\n        <PaneContext.Provider value={contextValue}>\n          <Root\n            data-testid=\"pane\"\n            data-ui=\"Pane\"\n            tone=\"inherit\"\n            hidden={hidden}\n            id={id}\n            overflow={layoutCollapsed ? undefined : 'hidden'}\n            {...restProps}\n            data-pane-collapsed={collapsed ? '' : undefined}\n            data-pane-index={paneIndex}\n            data-pane-selected={selected ? '' : undefined}\n            ref={setRef}\n            style={style}\n          >\n            {PANE_DEBUG && (\n              <Card padding={4} tone={expanded ? 'primary' : 'caution'}>\n                <Code size={1}>\n                  {[\n                    `#${paneIndex}`,\n                    `collapsed=${collapsed}`,\n                    `currentMinWidth=${currentMinWidth}`,\n                    `currentMaxWidth=${currentMaxWidth}`,\n                    `flex=${flex}`,\n                    `minWidth=${minWidth}`,\n                    `maxWidth=${maxWidth}`,\n                  ].join('\\n')}\n                </Code>\n              </Card>\n            )}\n\n            <BoundaryElementProvider element={rootElement}>\n              {!hidden && (\n                <Flex direction=\"column\" height=\"fill\">\n                  {children}\n                </Flex>\n              )}\n            </BoundaryElementProvider>\n          </Root>\n        </PaneContext.Provider>\n      </LegacyLayerProvider>\n\n      {divider}\n    </>\n  )\n})\n","import {useContext} from 'react'\nimport {PaneContext} from './PaneContext'\nimport {PaneContextValue} from './types'\n\n/**\n *\n * @hidden\n * @beta This API will change. DO NOT USE IN PRODUCTION.\n */\nexport function usePane(): PaneContextValue {\n  const pane = useContext(PaneContext)\n\n  if (!pane) {\n    throw new Error('Pane: missing context value')\n  }\n\n  return pane\n}\n","import {Card} from '@sanity/ui'\nimport styled from 'styled-components'\n\nexport const Root = styled(Card)`\n  position: relative;\n  outline: none;\n`\n\nRoot.displayName = 'PaneContent__root'\n","import {BoxOverflow} from '@sanity/ui'\nimport React, {forwardRef} from 'react'\nimport {usePane} from './usePane'\nimport {usePaneLayout} from './usePaneLayout'\nimport {Root} from './PaneContent.styles'\n\ninterface PaneContentProps {\n  as?: React.ElementType | keyof JSX.IntrinsicElements\n  overflow?: BoxOverflow\n  padding?: number | number[]\n}\n\n/**\n *\n * @hidden\n * @beta This API will change. DO NOT USE IN PRODUCTION.\n */\nexport const PaneContent = forwardRef(function PaneContent(\n  props: PaneContentProps & Omit<React.HTMLProps<HTMLDivElement>, 'as' | 'height' | 'ref'>,\n  ref: React.ForwardedRef<HTMLDivElement>,\n) {\n  const {as, children, overflow, padding, ...restProps} = props\n  const {collapsed} = usePane()\n  const {collapsed: layoutCollapsed} = usePaneLayout()\n\n  return (\n    <Root\n      data-testid=\"pane-content\"\n      forwardedAs={as}\n      {...restProps}\n      flex={1}\n      hidden={collapsed}\n      overflow={layoutCollapsed ? undefined : overflow}\n      padding={padding}\n      ref={ref}\n      tone=\"inherit\"\n    >\n      {children}\n    </Root>\n  )\n})\n","import {Card, Layer} from '@sanity/ui'\nimport styled from 'styled-components'\n\nexport const Root = styled(Layer)`\n  position: sticky;\n  bottom: 0;\n\n  &:before {\n    content: '';\n    display: block;\n    position: absolute;\n    left: 0;\n    right: 0;\n    top: -1px;\n    border-bottom: 1px solid var(--card-shadow-outline-color);\n  }\n`\n\nexport const RootCard = styled(Card)`\n  padding-bottom: env(safe-area-inset-bottom);\n`\n","import {Box} from '@sanity/ui'\nimport React, {forwardRef} from 'react'\nimport {usePane} from './usePane'\nimport {Root, RootCard} from './PaneFooter.styles'\nimport {LegacyLayerProvider} from 'sanity'\n\ninterface PaneFooterProps {\n  children?: React.ReactNode\n  padding?: number | number[]\n}\n\n/**\n *\n * @hidden\n * @beta This API will change. DO NOT USE IN PRODUCTION.\n */\nexport const PaneFooter = forwardRef(function PaneFooter(\n  props: PaneFooterProps,\n  ref: React.ForwardedRef<HTMLDivElement>,\n) {\n  const {children, padding} = props\n  const {collapsed} = usePane()\n\n  return (\n    <LegacyLayerProvider zOffset=\"paneFooter\">\n      <Root data-testid=\"pane-footer\" hidden={collapsed} ref={ref}>\n        <RootCard tone=\"inherit\">\n          <Box padding={padding}>{children}</Box>\n        </RootCard>\n      </Root>\n    </LegacyLayerProvider>\n  )\n})\n","import {Box, Flex, Layer, rgba, TextSkeleton, Text, Theme, Card} from '@sanity/ui'\nimport styled, {css} from 'styled-components'\n\nexport const Root = styled(Layer)`\n  line-height: 0;\n  position: sticky;\n  top: 0;\n\n  &:not([data-collapsed]):after {\n    content: '';\n    display: block;\n    position: absolute;\n    left: 0;\n    right: 0;\n    bottom: -1px;\n    border-bottom: 1px solid var(--card-shadow-outline-color);\n  }\n`\n\nexport const Layout = styled(Flex)`\n  transform-origin: calc(51px / 2);\n\n  [data-collapsed] > div > & {\n    transform: rotate(90deg);\n  }\n`\n\nexport const TitleCard = styled(Card)(({theme}: {theme: Theme}) => {\n  const {fg, bg} = theme.sanity.color.card.enabled\n\n  // Disable color updates on hover\n  return css`\n    background-color: ${bg};\n\n    [data-ui='Text'] {\n      color: ${fg};\n    }\n  `\n})\n\nexport const TitleTextSkeleton = styled(TextSkeleton)`\n  width: 66%;\n  max-width: 175px;\n`\n\nexport const TitleText = styled(Text)`\n  cursor: default;\n  outline: none;\n`\n\nexport const TabsBox = styled(Box)(({theme}: {theme: Theme}) => {\n  const {color, space} = theme.sanity\n\n  return css`\n    overflow: hidden;\n    overflow: clip;\n    position: relative;\n\n    & > div {\n      white-space: nowrap;\n      overflow: auto;\n      /* Hide scrollbars */\n      scrollbar-width: none;\n      &::-webkit-scrollbar {\n        width: 0;\n        height: 0;\n      }\n    }\n\n    /* right padding */\n    & > div:after {\n      content: '';\n      display: inline-block;\n      top: 0;\n      right: 0;\n      bottom: 0;\n      width: ${space[3]}px;\n      height: 1px;\n    }\n\n    /* Gradient that makes it look like tabs disappear into nothing (looks nicer) */\n    &:after {\n      content: '';\n      display: block;\n      position: absolute;\n      top: 0;\n      right: 0;\n      bottom: 0;\n      background: linear-gradient(to right, ${rgba(color.base.bg, 0)}, var(--card-bg-color));\n      width: ${space[3]}px;\n      pointer-events: none;\n    }\n  `\n})\n","import {useElementRect, Box, Card, Flex, LayerProvider} from '@sanity/ui'\nimport React, {useMemo, useCallback, forwardRef} from 'react'\nimport {usePane} from './usePane'\nimport {Layout, Root, TabsBox, TitleCard, TitleTextSkeleton, TitleText} from './PaneHeader.styles'\nimport {LegacyLayerProvider} from 'sanity'\n\n/**\n * @beta This API will change. DO NOT USE IN PRODUCTION.\n */\nexport interface PaneHeaderProps {\n  actions?: React.ReactNode\n  backButton?: React.ReactNode\n  contentAfter?: React.ReactNode\n  loading?: boolean\n  subActions?: React.ReactNode\n  tabIndex?: number\n  tabs?: React.ReactNode\n  title: React.ReactNode\n}\n\n/**\n *\n * @hidden\n * @beta This API will change. DO NOT USE IN PRODUCTION.\n */\nexport const PaneHeader = forwardRef(function PaneHeader(\n  props: PaneHeaderProps,\n  ref: React.ForwardedRef<HTMLDivElement>,\n) {\n  const {actions, backButton, contentAfter, loading, subActions, tabs, tabIndex, title} = props\n  const {collapse, collapsed, expand, rootElement: paneElement} = usePane()\n  const paneRect = useElementRect(paneElement || null)\n\n  const layoutStyle = useMemo(\n    () => ({\n      width: collapsed ? paneRect?.height || window.innerHeight : undefined,\n    }),\n    [collapsed, paneRect],\n  )\n\n  const handleTitleClick = useCallback(() => {\n    if (collapsed) return\n    collapse()\n  }, [collapse, collapsed])\n\n  const handleLayoutClick = useCallback(() => {\n    if (!collapsed) return\n    expand()\n  }, [collapsed, expand])\n\n  const showTabsOrSubActions = Boolean(!collapsed && (tabs || subActions))\n\n  return (\n    <LayerProvider zOffset={100}>\n      <Root data-collapsed={collapsed ? '' : undefined} data-testid=\"pane-header\" ref={ref}>\n        <LegacyLayerProvider zOffset=\"paneHeader\">\n          <Card data-collapsed={collapsed ? '' : undefined} tone=\"inherit\">\n            <Layout onClick={handleLayoutClick} padding={2} sizing=\"border\" style={layoutStyle}>\n              {backButton && (\n                <Box flex=\"none\" padding={1}>\n                  {backButton}\n                </Box>\n              )}\n\n              <TitleCard\n                __unstable_focusRing\n                flex={1}\n                forwardedAs=\"button\"\n                marginRight={actions ? 1 : 0}\n                onClick={handleTitleClick}\n                paddingLeft={backButton ? 1 : 3}\n                paddingY={3}\n                tabIndex={tabIndex}\n              >\n                {loading && <TitleTextSkeleton animated radius={1} />}\n                {!loading && (\n                  <TitleText textOverflow=\"ellipsis\" weight=\"semibold\">\n                    {title}\n                  </TitleText>\n                )}\n              </TitleCard>\n\n              {actions && (\n                <Flex align=\"center\" hidden={collapsed}>\n                  <LegacyLayerProvider zOffset=\"paneHeader\">{actions}</LegacyLayerProvider>\n                </Flex>\n              )}\n            </Layout>\n\n            {showTabsOrSubActions && (\n              <Flex\n                align=\"center\"\n                hidden={collapsed}\n                overflow=\"auto\"\n                paddingBottom={3}\n                paddingX={3}\n                paddingTop={1}\n              >\n                <TabsBox flex={1} marginRight={subActions ? 3 : 0}>\n                  {tabs}\n                </TabsBox>\n\n                {subActions && subActions}\n              </Flex>\n            )}\n\n            {!collapsed && contentAfter && contentAfter}\n          </Card>\n        </LegacyLayerProvider>\n      </Root>\n    </LayerProvider>\n  )\n})\n","import React, {MouseEvent, useCallback, useId} from 'react'\nimport {ButtonProps, Menu, MenuButton, Text} from '@sanity/ui'\nimport {UnknownIcon} from '@sanity/icons'\nimport {Intent} from '../../structureBuilder'\nimport {_PaneMenuGroup, _PaneMenuItem} from './types'\nimport {PaneMenuButtonItem} from './PaneMenuButtonItem'\nimport {TooltipOfDisabled, StatusButton} from 'sanity'\nimport {useIntentLink} from 'sanity/router'\n\nexport interface PaneHeaderActionButtonProps {\n  node: _PaneMenuItem | _PaneMenuGroup\n  padding?: ButtonProps['padding']\n}\n\nexport function PaneHeaderActionButton(props: PaneHeaderActionButtonProps) {\n  const {node, padding} = props\n\n  if (node.type === 'item') {\n    return <PaneHeaderMenuItemActionButton node={node} padding={padding} />\n  }\n\n  if (node.type === 'group') {\n    return <PaneHeaderMenuGroupActionButton node={node} padding={padding} />\n  }\n\n  console.warn('unknown menu node (expected `type: \"item\" | \"group\"`):', node)\n\n  return null\n}\n\nexport interface PaneHeaderMenuItemActionButtonProps {\n  node: _PaneMenuItem\n  padding?: ButtonProps['padding']\n}\n\nexport function PaneHeaderMenuItemActionButton(props: PaneHeaderMenuItemActionButtonProps) {\n  const {node, padding} = props\n\n  if (node.intent) {\n    return <PaneHeaderActionIntentButton {...props} intent={node.intent} />\n  }\n\n  const disabledTooltipContent = typeof node.disabled === 'object' && (\n    <Text size={1}>{node.disabled.reason}</Text>\n  )\n\n  return (\n    <TooltipOfDisabled content={disabledTooltipContent} placement=\"bottom\">\n      <StatusButton\n        disabled={Boolean(node.disabled)}\n        hotkey={node.hotkey?.split('+')}\n        icon={node.icon}\n        label={disabledTooltipContent ? undefined : node.title}\n        // eslint-disable-next-line react/jsx-handler-names\n        onClick={node.onAction}\n        padding={padding}\n        selected={node.selected}\n        tone={node.tone}\n      />\n    </TooltipOfDisabled>\n  )\n}\n\nfunction PaneHeaderActionIntentButton(props: {\n  intent: Intent\n  node: _PaneMenuItem\n  padding?: ButtonProps['padding']\n}) {\n  const {intent, node, padding} = props\n  const disabledTooltipContent = typeof node.disabled === 'object' && (\n    <Text size={1}>{node.disabled.reason}</Text>\n  )\n  const intentLink = useIntentLink({intent: intent.type, params: intent.params})\n\n  const handleClick = useCallback(\n    (event: MouseEvent<HTMLButtonElement>) => {\n      intentLink.onClick(event)\n      node.onAction()\n    },\n    [intentLink, node],\n  )\n\n  return (\n    <TooltipOfDisabled content={disabledTooltipContent} placement=\"bottom\">\n      <StatusButton\n        as=\"a\"\n        disabled={Boolean(node.disabled)}\n        hotkey={node.hotkey?.split('+')}\n        href={intentLink.href}\n        icon={node.icon}\n        label={disabledTooltipContent ? undefined : node.title}\n        onClick={handleClick}\n        padding={padding}\n        selected={node.selected}\n        tone={node.tone}\n      />\n    </TooltipOfDisabled>\n  )\n}\n\nexport interface PaneHeaderMenuGroupActionButtonProps {\n  node: _PaneMenuGroup\n  padding?: ButtonProps['padding']\n}\n\nfunction PaneHeaderMenuGroupActionButton(props: PaneHeaderMenuGroupActionButtonProps) {\n  const {node, padding} = props\n\n  return (\n    <MenuButton\n      button={\n        <StatusButton\n          disabled={node.disabled}\n          icon={node.icon ?? UnknownIcon}\n          label={node.title}\n          padding={padding}\n        />\n      }\n      id={useId()}\n      menu={\n        <Menu>\n          {node.children.map((child, idx) => {\n            return (\n              <PaneMenuButtonItem\n                disabled={Boolean(node.disabled)}\n                isAfterGroup={node.children[idx - 1]?.type === 'group'}\n                key={child.key}\n                node={child}\n              />\n            )\n          })}\n        </Menu>\n      }\n    />\n  )\n}\n","import {Card} from '@sanity/ui'\nimport styled from 'styled-components'\n\nexport const Root = styled(Card)`\n  transition: opacity 200ms;\n  position: relative;\n  z-index: 1;\n  padding-left: env(safe-area-inset-left);\n  padding-right: env(safe-area-inset-right);\n  opacity: 0;\n\n  &:not([hidden]) {\n    display: flex;\n  }\n\n  &:not([data-collapsed]) {\n    overflow: auto;\n  }\n\n  &[data-mounted] {\n    opacity: 1;\n  }\n\n  &[data-resizing] {\n    pointer-events: none;\n  }\n`\n","/* eslint-disable camelcase */\n\nimport {negate} from 'lodash'\nimport {_PaneMenuGroup, _PaneMenuItem, _PaneMenuNode} from './components/pane/types'\nimport {PaneMenuItem, PaneMenuItemGroup, DocumentFieldMenuActionNode} from './types'\n\nexport function isMenuNodeButton(node: _PaneMenuNode): node is _PaneMenuItem | _PaneMenuGroup {\n  return (node.type === 'item' || node.type === 'group') && node.renderAsButton\n}\n\nexport const isNotMenuNodeButton = negate(isMenuNodeButton)\n\nexport function resolveMenuNodes(params: {\n  actionHandler: (item: PaneMenuItem) => void\n  fieldActions?: DocumentFieldMenuActionNode[]\n  menuItems: PaneMenuItem[]\n  menuItemGroups: PaneMenuItemGroup[]\n}): _PaneMenuNode[] {\n  const {fieldActions = [], menuItems, menuItemGroups} = params\n\n  const nodes: _PaneMenuNode[] = []\n\n  let keyOffset = 0\n\n  for (let i = 0; i < fieldActions.length; i += 1) {\n    const a = fieldActions[i]\n\n    nodes.push(mapFieldActionToPaneMenuNode(a, `${i}-${a.type}`))\n  }\n\n  keyOffset += nodes.length\n\n  const groups: _PaneMenuGroup[] = []\n\n  for (const itemGroup of menuItemGroups) {\n    const group = groups.find((g) => g.key === itemGroup.id)\n\n    if (!group) {\n      groups.push({\n        type: 'group',\n        key: itemGroup.id,\n\n        children: [],\n        expanded: true,\n        renderAsButton: false,\n        title: itemGroup.title,\n      })\n    }\n  }\n\n  const ungroupedItems: _PaneMenuItem[] = []\n\n  for (let i = 0; i < menuItems.length; i += 1) {\n    const item = menuItems[i]\n\n    let group = item.group && groups.find((g) => g.key === item.group)\n\n    if (item.group && !group) {\n      group = {\n        type: 'group',\n        key: item.group,\n\n        expanded: true,\n        icon: item.icon,\n        title: item.group,\n        children: [],\n        renderAsButton: false,\n      }\n      groups.push(group)\n    }\n\n    if (group) {\n      group.children.push({\n        type: 'item',\n        key: `${keyOffset + i}-item`,\n\n        hotkey: item.shortcut,\n        icon: item.icon,\n        onAction: () => params.actionHandler(item),\n        renderAsButton: item.showAsAction ?? false,\n        selected: item.selected,\n        title: item.title,\n        tone: item.tone,\n      })\n    } else {\n      ungroupedItems.push({\n        type: 'item',\n        key: `${keyOffset + i}-item`,\n\n        hotkey: item.shortcut,\n        icon: item.icon,\n        onAction: () => params.actionHandler(item),\n        renderAsButton: item.showAsAction ?? false,\n        selected: item.selected,\n        title: item.title,\n        tone: item.tone,\n      })\n    }\n  }\n\n  return [...ungroupedItems, ...groups, ...nodes]\n}\n\nfunction mapFieldActionToPaneMenuNode(a: DocumentFieldMenuActionNode, key: string): _PaneMenuNode {\n  if (a.type === 'divider') {\n    return {\n      type: 'divider',\n      key,\n    }\n  }\n\n  if (a.type === 'group') {\n    return {\n      type: 'group',\n      key,\n\n      children: a.children.map((child, childIdx) =>\n        mapFieldActionToPaneMenuNode(child, `${key}-${childIdx}-${child.type}`),\n      ),\n      disabled: a.disabled,\n      expanded: a.expanded ?? true,\n      icon: a.icon,\n      title: a.title,\n      renderAsButton: a.renderAsButton ?? false,\n    }\n  }\n\n  return {\n    type: 'item',\n    key,\n    intent: a.intent,\n    disabled: a.disabled,\n    icon: a.icon,\n    iconRight: a.iconRight,\n    onAction: a.onAction,\n    renderAsButton: a.renderAsButton ?? false,\n    selected: a.selected,\n    title: a.title,\n    tone: a.tone,\n  }\n}\n","import {Button} from '@sanity/ui'\nimport React, {forwardRef, useMemo} from 'react'\nimport {PaneMenuItem} from '../types'\nimport {IntentLink} from 'sanity/router'\n\ntype RouterIntent = NonNullable<PaneMenuItem['intent']>\n\nexport const IntentButton = forwardRef(function IntentButton(\n  props: {intent: RouterIntent} & Omit<React.ComponentProps<typeof Button>, 'as' | 'href' | 'type'>,\n  ref: React.ForwardedRef<HTMLAnchorElement>,\n) {\n  const {intent, ...restProps} = props\n\n  const Link = useMemo(\n    () =>\n      // eslint-disable-next-line @typescript-eslint/no-shadow\n      forwardRef(function Link(\n        linkProps: {children: React.ReactNode},\n        linkRef: React.ForwardedRef<HTMLAnchorElement>,\n      ) {\n        return (\n          <IntentLink {...linkProps} intent={intent.type} params={intent.params} ref={linkRef} />\n        )\n      }),\n    [intent],\n  )\n\n  return props.disabled ? (\n    <Button {...props} as=\"a\" role=\"link\" aria-disabled=\"true\" />\n  ) : (\n    <Button\n      {...restProps}\n      as={Link}\n      data-as=\"a\"\n      ref={ref as React.ForwardedRef<HTMLButtonElement>}\n    />\n  )\n})\n","import {Tooltip, Text, Box} from '@sanity/ui'\nimport React from 'react'\nimport {useCurrentUser, InsufficientPermissionsMessage} from 'sanity'\n\ninterface InsufficientPermissionsMessageTooltipProps {\n  reveal: boolean\n  loading: boolean\n  children: React.ReactNode\n}\n\nexport function InsufficientPermissionsMessageTooltip({\n  reveal,\n  loading,\n  children,\n}: InsufficientPermissionsMessageTooltipProps) {\n  const currentUser = useCurrentUser()\n\n  if (!reveal) {\n    return <>{children}</>\n  }\n\n  return (\n    <Tooltip\n      content={\n        loading ? (\n          <Box padding={2}>\n            <Text>Loading…</Text>\n          </Box>\n        ) : (\n          <InsufficientPermissionsMessage currentUser={currentUser} />\n        )\n      }\n      portal\n    >\n      {/* this wrapping div is to allow mouse events */}\n      {/* while the child element is disabled */}\n      <div>{children}</div>\n    </Tooltip>\n  )\n}\n","import {ComposeIcon} from '@sanity/icons'\nimport React, {useMemo, forwardRef} from 'react'\nimport {Box, Button, Label, Menu, MenuButton, MenuItem, PopoverProps} from '@sanity/ui'\nimport {Schema} from '@sanity/types'\nimport {IntentButton} from '../IntentButton'\nimport {InsufficientPermissionsMessageTooltip} from './InsufficientPermissionsMessageTooltip'\nimport {IntentLink} from 'sanity/router'\nimport {\n  useTemplatePermissions,\n  TemplatePermissionsResult,\n  Template,\n  InitialValueTemplateItem,\n  useSchema,\n  useTemplates,\n} from 'sanity'\n\nexport type PaneHeaderIntentProps = React.ComponentProps<typeof IntentButton>['intent']\n\nconst POPOVER_PROPS: PopoverProps = {\n  constrainSize: true,\n  placement: 'bottom',\n  portal: true,\n}\n\nconst getIntent = (\n  schema: Schema,\n  templates: Template[],\n  item: InitialValueTemplateItem,\n): PaneHeaderIntentProps | null => {\n  const typeName = templates.find((t) => t.id === item.templateId)?.schemaType\n  if (!typeName) return null\n\n  const baseParams = {\n    template: item.templateId,\n    type: typeName,\n    id: item.initialDocumentId,\n  }\n\n  return {\n    type: 'create',\n    params: item.parameters ? [baseParams, item.parameters] : baseParams,\n  }\n}\n\ninterface PaneHeaderCreateButtonProps {\n  templateItems: InitialValueTemplateItem[]\n}\n\nexport function PaneHeaderCreateButton({templateItems}: PaneHeaderCreateButtonProps) {\n  const schema = useSchema()\n  const templates = useTemplates()\n\n  const [templatePermissions, isTemplatePermissionsLoading] = useTemplatePermissions({\n    templateItems,\n  })\n\n  const nothingGranted = useMemo(() => {\n    return (\n      !isTemplatePermissionsLoading &&\n      templatePermissions?.every((permission) => !permission.granted)\n    )\n  }, [isTemplatePermissionsLoading, templatePermissions])\n\n  const permissionsById = useMemo(() => {\n    if (!templatePermissions) return {}\n    return templatePermissions.reduce<Record<string, TemplatePermissionsResult | undefined>>(\n      (acc, permission) => {\n        acc[permission.id] = permission\n        return acc\n      },\n      {},\n    )\n  }, [templatePermissions])\n\n  if (nothingGranted) {\n    return (\n      <InsufficientPermissionsMessageTooltip reveal loading={isTemplatePermissionsLoading}>\n        <Button\n          aria-label=\"Insufficient permissions\"\n          icon={ComposeIcon}\n          mode=\"bleed\"\n          disabled\n          data-testid=\"action-intent-button\"\n        />\n      </InsufficientPermissionsMessageTooltip>\n    )\n  }\n\n  if (templateItems.length === 1) {\n    const firstItem = templateItems[0]\n    const permissions = permissionsById[firstItem.id]\n    const disabled = !permissions?.granted\n    const intent = getIntent(schema, templates, firstItem)\n    if (!intent) return null\n\n    return (\n      <InsufficientPermissionsMessageTooltip\n        reveal={disabled}\n        loading={isTemplatePermissionsLoading}\n      >\n        <IntentButton\n          aria-label={firstItem.title}\n          icon={firstItem.icon || ComposeIcon}\n          intent={intent}\n          mode=\"bleed\"\n          disabled={disabled}\n          data-testid=\"action-intent-button\"\n        />\n      </InsufficientPermissionsMessageTooltip>\n    )\n  }\n\n  return (\n    <MenuButton\n      button={<Button icon={ComposeIcon} mode=\"bleed\" data-testid=\"multi-action-intent-button\" />}\n      id=\"create-menu\"\n      menu={\n        <Menu>\n          <Box paddingX={3} paddingTop={3} paddingBottom={2}>\n            <Label muted>Create</Label>\n          </Box>\n\n          {templateItems.map((item, itemIndex) => {\n            const permissions = permissionsById[item.id]\n            const disabled = !permissions?.granted\n            const intent = getIntent(schema, templates, item)\n            const template = templates.find((t) => t.id === item.templateId)\n            if (!template || !intent) return null\n\n            const Link = forwardRef((linkProps, linkRef: React.ForwardedRef<never>) =>\n              disabled ? (\n                <button type=\"button\" disabled {...linkProps} ref={linkRef} />\n              ) : (\n                <IntentLink\n                  {...linkProps}\n                  intent={intent.type}\n                  params={intent.params}\n                  ref={linkRef}\n                />\n              ),\n            )\n\n            Link.displayName = 'Link'\n\n            return (\n              <InsufficientPermissionsMessageTooltip\n                key={item.id}\n                reveal={disabled}\n                loading={isTemplatePermissionsLoading}\n              >\n                <MenuItem\n                  as={Link}\n                  data-as={disabled ? 'button' : 'a'}\n                  text={item.title || template.title}\n                  aria-label={disabled ? 'Insufficient permissions' : item.title || template.title}\n                  disabled={disabled}\n                  data-testid={`action-intent-button-${itemIndex}`}\n                />\n              </InsufficientPermissionsMessageTooltip>\n            )\n          })}\n        </Menu>\n      }\n      popover={POPOVER_PROPS}\n    />\n  )\n}\n","import {Flex} from '@sanity/ui'\nimport {uniqBy} from 'lodash'\nimport React, {memo, useCallback, useMemo} from 'react'\nimport {isMenuNodeButton, isNotMenuNodeButton, resolveMenuNodes} from '../../menuNodes'\nimport {DeskToolPaneActionHandler, PaneMenuItem, PaneMenuItemGroup} from '../../types'\nimport {PaneContextMenuButton} from '../pane/PaneContextMenuButton'\nimport {PaneHeaderActionButton} from '../pane/PaneHeaderActionButton'\nimport {PaneHeaderCreateButton} from './PaneHeaderCreateButton'\nimport {useTemplates, InitialValueTemplateItem, EMPTY_ARRAY, EMPTY_OBJECT} from 'sanity'\n\nfunction isNonNullable<T>(value: T): value is NonNullable<T> {\n  return value !== null && value !== undefined\n}\n\n/**\n * hashes an object to a string where the order of the keys don't matter\n */\nconst hashObject = (value: unknown) => {\n  const sortObject = (v: unknown): unknown => {\n    if (typeof v !== 'object' || !v) return v\n    if (Array.isArray(v)) return v.map(sortObject)\n    return Object.entries(v).sort(([keyA], [keyB]) => keyA.localeCompare(keyB, 'en'))\n  }\n\n  const normalize = (v: unknown) => JSON.parse(JSON.stringify(v))\n\n  return JSON.stringify(sortObject(normalize(value)))\n}\n\ninterface PaneHeaderActionsProps {\n  initialValueTemplateItems?: InitialValueTemplateItem[]\n  menuItems?: PaneMenuItem[]\n  menuItemGroups?: PaneMenuItemGroup[]\n  actionHandlers?: Record<string, DeskToolPaneActionHandler>\n}\n\nexport const PaneHeaderActions = memo(function PaneHeaderActions(props: PaneHeaderActionsProps) {\n  const {\n    initialValueTemplateItems: initialValueTemplateItemsFromStructure = EMPTY_ARRAY,\n    menuItems = EMPTY_ARRAY,\n    menuItemGroups = EMPTY_ARRAY,\n    actionHandlers = EMPTY_OBJECT as Record<string, DeskToolPaneActionHandler>,\n  } = props\n\n  const templates = useTemplates()\n\n  const handleAction = useCallback(\n    (item: PaneMenuItem) => {\n      if (typeof item.action === 'string' && !(item.action in actionHandlers)) {\n        console.warn('No handler for action:', item.action)\n        return false\n      }\n\n      const handler =\n        // eslint-disable-next-line no-nested-ternary\n        typeof item.action === 'function'\n          ? item.action\n          : typeof item.action === 'string'\n          ? actionHandlers[item.action]\n          : null\n\n      if (handler) {\n        handler(item.params as Record<string, string>)\n        return true\n      }\n\n      return false\n    },\n    [actionHandlers],\n  )\n\n  const menuNodes = useMemo(\n    () =>\n      resolveMenuNodes({\n        actionHandler: handleAction,\n        menuItemGroups,\n        menuItems: menuItems\n          // remove items with `create` intents because those will get combined\n          // into one action button (see `initialValueTemplateItemFromMenuItems`)\n          .filter((item) => item.intent?.type !== 'create'),\n      }),\n    [handleAction, menuItemGroups, menuItems],\n  )\n\n  const actionNodes = useMemo(() => menuNodes.filter(isMenuNodeButton), [menuNodes])\n  const contextMenuNodes = useMemo(() => menuNodes.filter(isNotMenuNodeButton), [menuNodes])\n\n  const initialValueTemplateItemFromMenuItems = useMemo(() => {\n    return menuItems\n      .map((item, menuItemIndex) => {\n        if (item.intent?.type !== 'create') return null\n\n        const {params} = item.intent\n        if (!params) return null\n\n        const intentParams = Array.isArray(params) ? params[0] : params\n        const templateParams = Array.isArray(params) ? params[1] : undefined\n\n        // fallback to the schema type name as the template ID.\n        // by default, the initial template values are populated from every\n        // document type in the schema\n        const templateId = intentParams.template || intentParams.type\n        if (!templateId) return null\n\n        // eslint-disable-next-line max-nested-callbacks\n        const template = templates.find((t) => t.id === templateId)\n        // the template doesn't exist then the action might be disabled\n        if (!template) return null\n\n        const initialDocumentId = intentParams.id\n\n        return {\n          item,\n          template,\n          templateParams,\n          menuItemIndex,\n          initialDocumentId,\n        }\n      })\n      .filter(isNonNullable)\n      .map(({initialDocumentId, item, template, menuItemIndex, templateParams}) => {\n        const initialValueTemplateItem: InitialValueTemplateItem = {\n          id: `menuItem${menuItemIndex}`,\n          initialDocumentId,\n          templateId: template.id,\n          type: 'initialValueTemplateItem',\n          title: item.title || template.title,\n          icon: item.icon as InitialValueTemplateItem['icon'],\n          description: template.description,\n          parameters: templateParams,\n          schemaType: template.schemaType,\n        }\n\n        return initialValueTemplateItem\n      })\n  }, [menuItems, templates])\n\n  const combinedInitialValueTemplates = useMemo(() => {\n    // this de-dupes create actions\n    return uniqBy(\n      [...initialValueTemplateItemFromMenuItems, ...initialValueTemplateItemsFromStructure],\n      (item) => hashObject([item.initialDocumentId, item.templateId, item.parameters]),\n    )\n  }, [initialValueTemplateItemFromMenuItems, initialValueTemplateItemsFromStructure])\n\n  return (\n    <Flex gap={1}>\n      {combinedInitialValueTemplates.length > 0 && (\n        <PaneHeaderCreateButton templateItems={combinedInitialValueTemplates} />\n      )}\n\n      {actionNodes.map((node) => (\n        <PaneHeaderActionButton key={node.key} node={node} />\n      ))}\n\n      {contextMenuNodes.length > 0 && <PaneContextMenuButton nodes={contextMenuNodes} />}\n    </Flex>\n  )\n})\n","import {\n  ValidationMarker,\n  Path,\n  SanityDocument,\n  ObjectSchemaType,\n  SanityDocumentLike,\n} from '@sanity/types'\nimport {createContext} from 'react'\nimport {View} from '../../structureBuilder'\nimport {PaneMenuItem, PaneMenuItemGroup} from '../../types'\nimport {TimelineMode} from './types'\nimport {\n  DocumentActionComponent,\n  DocumentBadgeComponent,\n  DocumentFieldAction,\n  DocumentFormNode,\n  DocumentInspector,\n  DocumentLanguageFilterComponent,\n  DocumentPermission,\n  EditStateFor,\n  PatchEvent,\n  PermissionCheckResult,\n  StateTree,\n  TimelineStore,\n} from 'sanity'\n\n/** @internal */\nexport interface DocumentPaneContextValue {\n  actions: DocumentActionComponent[] | null\n  activeViewId: string | null\n  badges: DocumentBadgeComponent[] | null\n  changesOpen: boolean\n  closeInspector: (inspectorName?: string) => void\n  collapsedFieldSets: StateTree<boolean> | undefined\n  collapsedPaths: StateTree<boolean> | undefined\n  compareValue: Partial<SanityDocument> | null\n  connectionState: 'connecting' | 'reconnecting' | 'connected'\n  displayed: Partial<SanityDocument> | null\n  documentId: string\n  documentIdRaw: string\n  documentType: string\n  editState: EditStateFor | null\n  fieldActions: DocumentFieldAction[]\n  focusPath: Path\n  index: number\n  inspectOpen: boolean\n  inspector: DocumentInspector | null\n  inspectors: DocumentInspector[]\n  menuItemGroups: PaneMenuItemGroup[]\n  menuItems: PaneMenuItem[]\n  onBlur: (blurredPath: Path) => void\n  onChange: (event: PatchEvent) => void\n  onFocus: (pathOrEvent: Path) => void\n  onHistoryClose: () => void\n  onHistoryOpen: () => void\n  onInspectClose: () => void\n  onKeyUp: (event: React.KeyboardEvent<HTMLDivElement>) => void\n  onMenuAction: (item: PaneMenuItem) => void\n  onPaneClose: () => void\n  onPaneSplit?: () => void\n  onPathOpen: (path: Path) => void\n  onSetActiveFieldGroup: (path: Path, groupName: string) => void\n  onSetCollapsedPath: (path: Path, expanded: boolean) => void\n  onSetCollapsedFieldSet: (path: Path, expanded: boolean) => void\n  openInspector: (inspectorName: string, paneParams?: Record<string, string>) => void\n  paneKey: string\n  previewUrl?: string | null\n  ready: boolean\n  schemaType: ObjectSchemaType\n  setTimelineMode: (mode: TimelineMode) => void\n  setTimelineRange(since: string | null, rev: string | null): void\n  setIsDeleting: (state: boolean) => void\n  source?: string\n  timelineError: Error | null\n  timelineMode: TimelineMode\n  timelineStore: TimelineStore\n  title: string | null\n  validation: ValidationMarker[]\n  value: SanityDocumentLike\n  views: View[]\n  formState: DocumentFormNode | null\n  permissions?: PermissionCheckResult | null\n  isDeleting: boolean\n  isDeleted: boolean\n  isPermissionsLoading: boolean\n  unstable_languageFilter: DocumentLanguageFilterComponent[]\n}\n\n/** @internal */\nexport const DocumentPaneContext = createContext<DocumentPaneContextValue | null>(null)\n","import {useContext} from 'react'\nimport {DocumentPaneContext, DocumentPaneContextValue} from './DocumentPaneContext'\n\n/** @internal */\nexport function useDocumentPane(): DocumentPaneContextValue {\n  const documentPane = useContext(DocumentPaneContext)\n\n  if (!documentPane) {\n    throw new Error('DocumentPane: missing context value')\n  }\n\n  return documentPane\n}\n","/* eslint-disable import/no-extraneous-dependencies */\n\nimport {TrashIcon} from '@sanity/icons'\nimport React, {useCallback, useState} from 'react'\nimport {ConfirmDeleteDialog} from '../components'\nimport {\n  DocumentActionComponent,\n  InsufficientPermissionsMessage,\n  useCurrentUser,\n  useDocumentOperation,\n  useDocumentPairPermissions,\n} from 'sanity'\nimport {useDocumentPane} from '../panes/document/useDocumentPane'\n\nconst DISABLED_REASON_TITLE = {\n  NOTHING_TO_DELETE: 'This document doesn’t yet exist or is already deleted',\n}\n\n/** @internal */\nexport const DeleteAction: DocumentActionComponent = ({id, type, draft, onComplete}) => {\n  const {setIsDeleting: paneSetIsDeleting} = useDocumentPane()\n  const {delete: deleteOp} = useDocumentOperation(id, type)\n  const [isDeleting, setIsDeleting] = useState(false)\n  const [isConfirmDialogOpen, setConfirmDialogOpen] = useState(false)\n\n  const handleCancel = useCallback(() => {\n    setConfirmDialogOpen(false)\n    onComplete()\n  }, [onComplete])\n\n  const handleConfirm = useCallback(() => {\n    setIsDeleting(true)\n    setConfirmDialogOpen(false)\n    paneSetIsDeleting(true)\n    deleteOp.execute()\n    onComplete()\n  }, [deleteOp, onComplete, paneSetIsDeleting])\n\n  const handle = useCallback(() => {\n    setConfirmDialogOpen(true)\n  }, [])\n\n  const [permissions, isPermissionsLoading] = useDocumentPairPermissions({\n    id,\n    type,\n    permission: 'delete',\n  })\n\n  const currentUser = useCurrentUser()\n\n  if (!isPermissionsLoading && !permissions?.granted) {\n    return {\n      tone: 'critical',\n      icon: TrashIcon,\n      disabled: true,\n      label: 'Delete',\n      title: (\n        <InsufficientPermissionsMessage\n          operationLabel=\"delete this document\"\n          currentUser={currentUser}\n        />\n      ),\n    }\n  }\n\n  return {\n    tone: 'critical',\n    icon: TrashIcon,\n    disabled: isDeleting || Boolean(deleteOp.disabled) || isPermissionsLoading,\n    title:\n      (deleteOp.disabled &&\n        DISABLED_REASON_TITLE[deleteOp.disabled as keyof typeof DISABLED_REASON_TITLE]) ||\n      '',\n    label: isDeleting ? 'Deleting…' : 'Delete',\n    shortcut: 'Ctrl+Alt+D',\n    onHandle: handle,\n    dialog: isConfirmDialogOpen && {\n      type: 'custom',\n      component: (\n        <ConfirmDeleteDialog\n          action=\"delete\"\n          id={draft?._id || id}\n          type={type}\n          onCancel={handleCancel}\n          onConfirm={handleConfirm}\n        />\n      ),\n    },\n  }\n}\n\nDeleteAction.action = 'delete'\n","/* eslint-disable import/no-extraneous-dependencies */\n\nimport {ResetIcon} from '@sanity/icons'\nimport React, {useCallback, useMemo, useState} from 'react'\nimport {\n  DocumentActionComponent,\n  DocumentActionDialogProps,\n  InsufficientPermissionsMessage,\n  useCurrentUser,\n  useDocumentOperation,\n  useDocumentPairPermissions,\n} from 'sanity'\n\nconst DISABLED_REASON_TITLE = {\n  NO_CHANGES: 'This document has no unpublished changes',\n  NOT_PUBLISHED: 'This document is not published',\n}\n\n/** @internal */\nexport const DiscardChangesAction: DocumentActionComponent = ({\n  id,\n  type,\n  published,\n  liveEdit,\n  onComplete,\n}) => {\n  const {discardChanges} = useDocumentOperation(id, type)\n  const [isConfirmDialogOpen, setConfirmDialogOpen] = useState(false)\n  const [permissions, isPermissionsLoading] = useDocumentPairPermissions({\n    id,\n    type,\n    permission: 'discardDraft',\n  })\n  const currentUser = useCurrentUser()\n\n  const handleConfirm = useCallback(() => {\n    discardChanges.execute()\n    onComplete()\n  }, [discardChanges, onComplete])\n\n  const handle = useCallback(() => {\n    setConfirmDialogOpen(true)\n  }, [])\n\n  const dialog: DocumentActionDialogProps | false = useMemo(\n    () =>\n      isConfirmDialogOpen && {\n        type: 'confirm',\n        tone: 'critical',\n        onCancel: onComplete,\n        onConfirm: handleConfirm,\n        message: <>Are you sure you want to discard all changes since last published?</>,\n      },\n    [handleConfirm, isConfirmDialogOpen, onComplete],\n  )\n\n  if (!published || liveEdit) {\n    return null\n  }\n\n  if (!isPermissionsLoading && !permissions?.granted) {\n    return {\n      tone: 'critical',\n      icon: ResetIcon,\n      disabled: true,\n      label: 'Discard changes',\n      title: (\n        <InsufficientPermissionsMessage\n          operationLabel=\"discard changes in this document\"\n          currentUser={currentUser}\n        />\n      ),\n    }\n  }\n\n  return {\n    tone: 'critical',\n    icon: ResetIcon,\n    disabled: Boolean(discardChanges.disabled) || isPermissionsLoading,\n    title:\n      (discardChanges.disabled &&\n        DISABLED_REASON_TITLE[discardChanges.disabled as keyof typeof DISABLED_REASON_TITLE]) ||\n      '',\n    label: 'Discard changes',\n    onHandle: handle,\n    dialog,\n  }\n}\n\nDiscardChangesAction.action = 'discardChanges'\n","import {CopyIcon} from '@sanity/icons'\nimport {uuid} from '@sanity/uuid'\nimport React, {useCallback, useState} from 'react'\nimport {useRouter} from 'sanity/router'\nimport {\n  DocumentActionComponent,\n  InsufficientPermissionsMessage,\n  useDocumentPairPermissions,\n  useDocumentOperation,\n  useCurrentUser,\n} from 'sanity'\n\nconst DISABLED_REASON_TITLE = {\n  NOTHING_TO_DUPLICATE: 'This document doesn’t yet exist so there‘s nothing to duplicate',\n}\n\n/** @internal */\nexport const DuplicateAction: DocumentActionComponent = ({id, type, onComplete}) => {\n  const {duplicate} = useDocumentOperation(id, type)\n  const {navigateIntent} = useRouter()\n  const [isDuplicating, setDuplicating] = useState(false)\n  const [permissions, isPermissionsLoading] = useDocumentPairPermissions({\n    id,\n    type,\n    permission: 'duplicate',\n  })\n\n  const currentUser = useCurrentUser()\n\n  const handle = useCallback(() => {\n    const dupeId = uuid()\n\n    setDuplicating(true)\n    duplicate.execute(dupeId)\n    navigateIntent('edit', {id: dupeId, type})\n    onComplete()\n  }, [duplicate, navigateIntent, onComplete, type])\n\n  if (!isPermissionsLoading && !permissions?.granted) {\n    return {\n      icon: CopyIcon,\n      disabled: true,\n      label: 'Duplicate',\n      title: (\n        <InsufficientPermissionsMessage\n          operationLabel=\"duplicate this document\"\n          currentUser={currentUser}\n        />\n      ),\n    }\n  }\n\n  return {\n    icon: CopyIcon,\n    disabled: isDuplicating || Boolean(duplicate.disabled) || isPermissionsLoading,\n    label: isDuplicating ? 'Duplicating…' : 'Duplicate',\n    title:\n      (duplicate.disabled &&\n        DISABLED_REASON_TITLE[duplicate.disabled as keyof typeof DISABLED_REASON_TITLE]) ||\n      '',\n    onHandle: handle,\n  }\n}\n\nDuplicateAction.action = 'duplicate'\n","import {RestoreIcon} from '@sanity/icons'\nimport React, {useCallback, useEffect, useMemo, useRef, useState} from 'react'\nimport {\n  DocumentActionComponent,\n  DocumentActionDialogProps,\n  useDocumentOperation,\n  useDocumentOperationEvent,\n} from 'sanity'\nimport {useRouter} from 'sanity/router'\n\n/** @internal */\nexport const HistoryRestoreAction: DocumentActionComponent = ({id, type, revision, onComplete}) => {\n  const {restore} = useDocumentOperation(id, type)\n  const event = useDocumentOperationEvent(id, type)\n  const {navigateIntent} = useRouter()\n  const prevEvent = useRef(event)\n  const [isConfirmDialogOpen, setConfirmDialogOpen] = useState(false)\n\n  const handleConfirm = useCallback(() => {\n    restore.execute(revision!)\n    onComplete()\n  }, [restore, revision, onComplete])\n\n  /**\n   * If the restore operation is successful, navigate to the document edit view\n   */\n  useEffect(() => {\n    if (!event || event === prevEvent.current) return\n\n    if (event.type === 'success' && event.op === 'restore') {\n      navigateIntent('edit', {id, type})\n    }\n\n    prevEvent.current = event\n  }, [event, id, navigateIntent, type])\n\n  const handle = useCallback(() => {\n    setConfirmDialogOpen(true)\n  }, [])\n\n  const dialog: DocumentActionDialogProps | null = useMemo(() => {\n    if (isConfirmDialogOpen) {\n      return {\n        type: 'confirm',\n        tone: 'critical',\n        onCancel: onComplete,\n        onConfirm: handleConfirm,\n        message: <>Are you sure you want to restore this document?</>,\n      }\n    }\n\n    return null\n  }, [handleConfirm, isConfirmDialogOpen, onComplete])\n\n  const isRevisionInitialVersion = revision === '@initial'\n  const isRevisionLatestVersion = revision === undefined // undefined means latest version\n\n  if (isRevisionLatestVersion) {\n    return null\n  }\n\n  return {\n    label: 'Restore',\n    color: 'primary',\n    onHandle: handle,\n    title: isRevisionInitialVersion\n      ? \"You can't restore to the initial version\"\n      : 'Restore to this version',\n    icon: RestoreIcon,\n    dialog,\n    disabled: isRevisionInitialVersion,\n  }\n}\n\nHistoryRestoreAction.action = 'restore'\n","import {CheckmarkIcon, PublishIcon} from '@sanity/icons'\nimport {isValidationErrorMarker} from '@sanity/types'\nimport React, {useCallback, useEffect, useState} from 'react'\nimport {TimeAgo} from '../components'\nimport {useDocumentPane} from '../panes/document/useDocumentPane'\nimport {\n  DocumentActionComponent,\n  InsufficientPermissionsMessage,\n  useCurrentUser,\n  useDocumentOperation,\n  useDocumentPairPermissions,\n  useEditState,\n  useSyncState,\n  useValidationStatus,\n} from 'sanity'\n\nconst DISABLED_REASON_TITLE = {\n  LIVE_EDIT_ENABLED: 'Cannot publish since liveEdit is enabled for this document type',\n  ALREADY_PUBLISHED: 'Already published',\n  NO_CHANGES: 'No unpublished changes',\n  NOT_READY: 'Operation not ready',\n}\n\nfunction getDisabledReason(\n  reason: keyof typeof DISABLED_REASON_TITLE,\n  publishedAt: string | undefined,\n) {\n  if (reason === 'ALREADY_PUBLISHED' && publishedAt) {\n    return (\n      <>\n        <span>\n          Published <TimeAgo time={publishedAt} />\n        </span>\n      </>\n    )\n  }\n  return DISABLED_REASON_TITLE[reason]\n}\n\n/** @internal */\n// eslint-disable-next-line complexity\nexport const PublishAction: DocumentActionComponent = (props) => {\n  const {id, type, liveEdit, draft, published} = props\n  const [publishState, setPublishState] = useState<'publishing' | 'published' | null>(null)\n  const {publish} = useDocumentOperation(id, type)\n  const validationStatus = useValidationStatus(id, type)\n  const syncState = useSyncState(id, type)\n  const {changesOpen, onHistoryOpen, documentId, documentType} = useDocumentPane()\n  const editState = useEditState(documentId, documentType)\n\n  const revision = (editState?.draft || editState?.published || {})._rev\n\n  const hasValidationErrors = validationStatus.validation.some(isValidationErrorMarker)\n  // we use this to \"schedule\" publish after pending tasks (e.g. validation and sync) has completed\n  const [publishScheduled, setPublishScheduled] = useState<boolean>(false)\n  const isSyncing = syncState.isSyncing\n  const isValidating = validationStatus.isValidating\n  const [permissions, isPermissionsLoading] = useDocumentPairPermissions({\n    id,\n    type,\n    permission: 'publish',\n  })\n\n  const currentUser = useCurrentUser()\n\n  // eslint-disable-next-line no-nested-ternary\n  const title = publish.disabled\n    ? getDisabledReason(publish.disabled, (published || {})._updatedAt) || ''\n    : hasValidationErrors\n    ? 'There are validation errors that need to be fixed before this document can be published'\n    : ''\n\n  const hasDraft = Boolean(draft)\n\n  const doPublish = useCallback(() => {\n    publish.execute()\n    setPublishState('publishing')\n  }, [publish])\n\n  useEffect(() => {\n    // make sure the validation status is about the current revision and not an earlier one\n    const validationComplete =\n      validationStatus.isValidating === false && validationStatus.revision !== revision\n\n    if (!publishScheduled || isSyncing || !validationComplete) {\n      return\n    }\n\n    if (!hasValidationErrors) {\n      doPublish()\n    }\n    setPublishScheduled(false)\n  }, [\n    isSyncing,\n    doPublish,\n    hasValidationErrors,\n    publishScheduled,\n    validationStatus.revision,\n    revision,\n    isValidating,\n    validationStatus.isValidating,\n  ])\n\n  useEffect(() => {\n    const didPublish = publishState === 'publishing' && !hasDraft\n    if (didPublish) {\n      if (changesOpen) {\n        // Re-open the panel\n        onHistoryOpen()\n      }\n    }\n    const nextState = didPublish ? 'published' : null\n    const delay = didPublish ? 200 : 4000\n    const timer = setTimeout(() => {\n      setPublishState(nextState)\n    }, delay)\n    return () => clearTimeout(timer)\n  }, [changesOpen, publishState, hasDraft, onHistoryOpen])\n\n  const handle = useCallback(() => {\n    if (\n      syncState.isSyncing ||\n      validationStatus.isValidating ||\n      validationStatus.revision !== revision\n    ) {\n      setPublishScheduled(true)\n    } else {\n      doPublish()\n    }\n  }, [\n    syncState.isSyncing,\n    validationStatus.isValidating,\n    validationStatus.revision,\n    revision,\n    doPublish,\n  ])\n\n  if (liveEdit) {\n    return {\n      tone: 'positive',\n      label: 'Publish',\n      title:\n        'Live Edit is enabled for this content type and publishing happens automatically as you make changes',\n      disabled: true,\n    }\n  }\n\n  if (!isPermissionsLoading && !permissions?.granted) {\n    return {\n      tone: 'positive',\n      label: 'Publish',\n      title: (\n        <InsufficientPermissionsMessage\n          operationLabel=\"publish this document\"\n          currentUser={currentUser}\n        />\n      ),\n      disabled: true,\n    }\n  }\n\n  const disabled = Boolean(\n    publishScheduled ||\n      editState?.transactionSyncLock?.enabled ||\n      publishState === 'publishing' ||\n      publishState === 'published' ||\n      hasValidationErrors ||\n      publish.disabled,\n  )\n\n  return {\n    disabled: disabled || isPermissionsLoading,\n    tone: 'positive',\n    label:\n      // eslint-disable-next-line no-nested-ternary\n      publishState === 'published'\n        ? 'Published'\n        : publishScheduled || publishState === 'publishing'\n        ? 'Publishing…'\n        : 'Publish',\n    // @todo: Implement loading state, to show a `<Button loading />` state\n    // loading: publishScheduled || publishState === 'publishing',\n    icon: publishState === 'published' ? CheckmarkIcon : PublishIcon,\n    // eslint-disable-next-line no-nested-ternary\n    title: publishScheduled\n      ? 'Waiting for tasks to finish before publishing'\n      : publishState === 'published' || publishState === 'publishing'\n      ? null\n      : title,\n    shortcut: disabled || publishScheduled ? null : 'Ctrl+Alt+P',\n    onHandle: handle,\n  }\n}\n\nPublishAction.action = 'publish'\n","import {UnpublishIcon} from '@sanity/icons'\nimport React, {useCallback, useMemo, useState} from 'react'\nimport {ConfirmDeleteDialog} from '../components'\nimport {\n  DocumentActionComponent,\n  InsufficientPermissionsMessage,\n  useDocumentPairPermissions,\n  useCurrentUser,\n  useDocumentOperation,\n  DocumentActionModalDialogProps,\n} from 'sanity'\n\nconst DISABLED_REASON_TITLE = {\n  NOT_PUBLISHED: 'This document is not published',\n}\n\n/** @internal */\nexport const UnpublishAction: DocumentActionComponent = ({\n  id,\n  type,\n  draft,\n  onComplete,\n  liveEdit,\n}) => {\n  const {unpublish} = useDocumentOperation(id, type)\n  const [isConfirmDialogOpen, setConfirmDialogOpen] = useState(false)\n  const [permissions, isPermissionsLoading] = useDocumentPairPermissions({\n    id,\n    type,\n    permission: 'unpublish',\n  })\n  const currentUser = useCurrentUser()\n\n  const handleCancel = useCallback(() => {\n    setConfirmDialogOpen(false)\n    onComplete()\n  }, [onComplete])\n\n  const handleConfirm = useCallback(() => {\n    setConfirmDialogOpen(false)\n    unpublish.execute()\n    onComplete()\n  }, [onComplete, unpublish])\n\n  const dialog: DocumentActionModalDialogProps | null = useMemo(() => {\n    if (isConfirmDialogOpen) {\n      return {\n        type: 'dialog',\n        onClose: onComplete,\n        content: (\n          <ConfirmDeleteDialog\n            id={draft?._id || id}\n            type={type}\n            action=\"unpublish\"\n            onCancel={handleCancel}\n            onConfirm={handleConfirm}\n          />\n        ),\n      }\n    }\n\n    return null\n  }, [draft, id, handleCancel, handleConfirm, isConfirmDialogOpen, onComplete, type])\n\n  if (liveEdit) {\n    return null\n  }\n\n  if (!isPermissionsLoading && !permissions?.granted) {\n    return {\n      tone: 'critical',\n      icon: UnpublishIcon,\n      label: 'Unpublish',\n      title: (\n        <InsufficientPermissionsMessage\n          operationLabel=\"unpublish this document\"\n          currentUser={currentUser}\n        />\n      ),\n      disabled: true,\n    }\n  }\n\n  return {\n    tone: 'critical',\n    icon: UnpublishIcon,\n    disabled: Boolean(unpublish.disabled) || isPermissionsLoading,\n    label: 'Unpublish',\n    title: unpublish.disabled\n      ? DISABLED_REASON_TITLE[unpublish.disabled as keyof typeof DISABLED_REASON_TITLE]\n      : '',\n    onHandle: () => setConfirmDialogOpen(true),\n    dialog,\n  }\n}\n\nUnpublishAction.action = 'unpublish'\n","import {DocumentBadgeComponent} from 'sanity'\n\n/** @internal */\nexport const LiveEditBadge: DocumentBadgeComponent = (props) => {\n  const {liveEdit} = props\n\n  if (liveEdit) {\n    return {\n      label: 'Live',\n      color: 'danger',\n    }\n  }\n\n  return null\n}\n","/**\n * @internal\n */\nexport const _DEBUG = false\n\nexport const EMPTY_PARAMS = {}\nexport const LOADING_PANE = Symbol('LOADING_PANE')\n\nexport const DOCUMENT_PANEL_PORTAL_ELEMENT = 'documentPanelPortalElement'\n","import {uuid} from '@sanity/uuid'\nimport {PaneNode, RouterPanes} from './types'\nimport {EMPTY_PARAMS, LOADING_PANE} from './constants'\n\nconst state: {\n  activePanes: Array<PaneNode | typeof LOADING_PANE>\n} = {activePanes: []}\n\nexport function setActivePanes(panes: Array<PaneNode | typeof LOADING_PANE>): void {\n  state.activePanes = panes\n}\n\n/**\n * This function looks at the _active panes_ to resolve an intent. this type of\n * intent resolution is faster and does not cause the panes to reset\n *\n * @internal\n */\nexport function getIntentState(\n  intent: string,\n  params: Record<string, string>,\n  routerState: {panes?: RouterPanes} | undefined,\n  payload: unknown,\n): {panes: RouterPanes} | {intent: string; params: Record<string, string>; payload: unknown} {\n  const panes = routerState?.panes || []\n  const activePanes = state.activePanes || []\n  const editDocumentId = params.id || uuid()\n  const isTemplate = intent === 'create' && params.template\n\n  // Loop through open panes and see if any of them can handle the intent\n  for (let i = activePanes.length - 1; i >= 0; i--) {\n    const pane = activePanes[i]\n\n    if (typeof pane !== 'object') continue\n\n    // NOTE: if you update this logic, please also update the similar handler in\n    // `resolveIntent.ts`\n    if (\n      pane.canHandleIntent?.(intent, params, {\n        pane,\n        index: i,\n      }) ||\n      // see `resolveIntent.ts` for more info\n      (pane.type === 'documentList' &&\n        pane.schemaTypeName === params.type &&\n        pane.options.filter === '_type == $type')\n    ) {\n      const paneParams = isTemplate ? {template: params.template} : EMPTY_PARAMS\n\n      return {\n        panes: panes\n          .slice(0, i)\n          .concat([[{id: editDocumentId, params: paneParams, payload}]]) as RouterPanes,\n      }\n    }\n  }\n\n  return {intent: intent, params, payload}\n}\n","import {omit} from 'lodash'\nimport {RouterPanes, RouterPaneGroup, RouterPaneSibling} from './types'\nimport {route} from 'sanity/router'\n\nconst EMPTY_PARAMS = {}\n\n/**\n * @internal\n */\nexport function legacyEditParamsToState(params: string): Record<string, unknown> {\n  try {\n    return JSON.parse(decodeURIComponent(params))\n  } catch (err) {\n    // eslint-disable-next-line no-console\n    console.warn('Failed to parse JSON parameters')\n    return {}\n  }\n}\n\nexport function encodePanesSegment(panes: RouterPanes): string {\n  return (panes || [])\n    .map((group) => group.map(encodeChunks).join('|'))\n    .map(encodeURIComponent)\n    .join(';')\n}\n\n/**\n * @internal\n */\nexport function legacyEditParamsToPath(params: Record<string, unknown>): string {\n  return JSON.stringify(params)\n}\n\n// http://localhost:3333/intent/create/template=book-by-author;type=book/eyJhdXRob3JJZCI6Imdycm0ifQ==\n\n/**\n * @internal\n */\nexport function toState(pathSegment: string): RouterPaneGroup[] {\n  return parsePanesSegment(decodeURIComponent(pathSegment))\n}\n\n/**\n * @internal\n */\nexport function toPath(panes: RouterPaneGroup[]): string {\n  return encodePanesSegment(panes)\n}\n\nexport const router = route.create('/', [\n  // \"Asynchronous intent resolving\" route\n  route.intents('/intent'),\n\n  // Legacy fallback route, will be redirected to new format\n  route.create('/edit/:type/:editDocumentId', [\n    route.create({\n      path: '/:params',\n      transform: {params: {toState: legacyEditParamsToState, toPath: legacyEditParamsToPath}},\n    }),\n  ]),\n\n  // The regular path - when the intent can be resolved to a specific pane\n  route.create({\n    path: '/:panes',\n    // Legacy URLs, used to handle redirects\n    children: [route.create('/:action', route.create('/:legacyEditDocumentId'))],\n    transform: {\n      panes: {toState, toPath},\n    },\n  }),\n])\n\n// old: authors;knut,{\"template\":\"diaryEntry\"}\n// new: authors;knut,view=diff,eyJyZXYxIjoiYWJjMTIzIiwicmV2MiI6ImRlZjQ1NiJ9|latest-posts\n\nconst panePattern = /^([.a-z0-9_-]+),?({.*?})?(?:(;|$))/i\nconst isParam = (str: string) => /^[a-z0-9]+=[^=]+/i.test(str)\nconst isPayload = (str: string) =>\n  /^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(str)\nconst exclusiveParams = ['view', 'since', 'rev', 'inspect']\n\ntype Truthy<T> = T extends false\n  ? never\n  : T extends ''\n  ? never\n  : T extends 0\n  ? never\n  : T extends 0n\n  ? never\n  : T extends null | undefined\n  ? NonNullable<T>\n  : T\nconst isTruthy = Boolean as (t: unknown) => boolean as <T>(t: T) => t is Truthy<T>\n\nfunction parseChunks(chunks: string[], initial: RouterPaneSibling): RouterPaneSibling {\n  return chunks.reduce(\n    (pane, chunk) => {\n      if (isParam(chunk)) {\n        const key = chunk.slice(0, chunk.indexOf('='))\n        const value = chunk.slice(key.length + 1)\n        pane.params = {...pane.params, [decodeURIComponent(key)]: decodeURIComponent(value)}\n      } else if (isPayload(chunk)) {\n        pane.payload = tryParseBase64Payload(chunk)\n      } else {\n        // eslint-disable-next-line no-console\n        console.warn('Unknown pane segment: %s - skipping', chunk)\n      }\n\n      return pane\n    },\n    {...initial, params: EMPTY_PARAMS, payload: undefined},\n  )\n}\n\nfunction encodeChunks(pane: RouterPaneSibling, index: number, group: RouterPaneGroup): string {\n  const {payload, params = {}, id} = pane\n  const [firstSibling] = group\n  const paneIsFirstSibling = pane === firstSibling\n  const sameAsFirst = index !== 0 && id === firstSibling.id\n  const encodedPayload = typeof payload === 'undefined' ? undefined : btoa(JSON.stringify(payload))\n\n  const encodedParams = Object.entries(params)\n    .filter((entry): entry is [string, string] => {\n      const [key, value] = entry\n      if (!value) return false\n      if (paneIsFirstSibling) return true\n\n      // omit the value if it's the same as the value from the first sibling\n      const valueFromFirstSibling = firstSibling.params?.[key]\n      if (value === valueFromFirstSibling && !exclusiveParams.includes(key)) return false\n      return true\n    })\n    .map(([key, value]) => `${encodeURIComponent(key)}=${encodeURIComponent(value)}`)\n\n  return (\n    [sameAsFirst ? '' : id]\n      .concat([encodedParams.length > 0 && encodedParams, encodedPayload].filter(isTruthy).flat())\n      .join(',') || ','\n  )\n}\n\nexport function parsePanesSegment(str: string): RouterPanes {\n  if (str.indexOf(',{') !== -1) {\n    return parseOldPanesSegment(str)\n  }\n\n  return str\n    .split(';')\n    .map((group) => {\n      const [firstSibling, ...restOfSiblings] = group.split('|').map((segment) => {\n        const [id, ...chunks] = segment.split(',')\n        return parseChunks(chunks, {id})\n      })\n\n      return [\n        firstSibling,\n        ...restOfSiblings.map((sibling) => ({\n          ...firstSibling,\n          ...sibling,\n          id: sibling.id || firstSibling.id,\n          params: {...omit(firstSibling.params, exclusiveParams), ...sibling.params},\n          payload: sibling.payload || firstSibling.payload,\n        })),\n      ]\n    })\n    .filter((group) => group.length > 0)\n}\n\nfunction parseOldPanesSegment(str: string): RouterPanes {\n  const chunks: RouterPaneGroup = []\n\n  let buffer = str\n  while (buffer.length) {\n    const [match, id, payloadChunk] = buffer.match(panePattern) || []\n    if (!match) {\n      buffer = buffer.slice(1)\n      continue\n    }\n\n    const payload = payloadChunk && tryParsePayload(payloadChunk)\n    chunks.push({id, payload})\n\n    buffer = buffer.slice(match.length)\n  }\n\n  return [chunks]\n}\n\nfunction tryParsePayload(json: string) {\n  try {\n    return JSON.parse(json)\n  } catch (err) {\n    // eslint-disable-next-line no-console\n    console.warn(`Failed to parse parameters: ${err.message}`)\n    return undefined\n  }\n}\n\nfunction tryParseBase64Payload(data: string) {\n  return data ? tryParsePayload(atob(data)) : undefined\n}\n","import {PaneRouterContextValue} from '../../components'\nimport {PaneMenuItemGroup} from '../../types'\n\nexport const DOCUMENT_PANEL_MIN_WIDTH = 320\nexport const DOCUMENT_PANEL_INITIAL_MIN_WIDTH = 600\n\nexport const DOCUMENT_INSPECTOR_MIN_WIDTH = 320\nexport const DOCUMENT_INSPECTOR_MAX_WIDTH = 540\n\nexport const EMPTY_PARAMS: NonNullable<PaneRouterContextValue['params']> = {}\n\nexport const INSPECT_ACTION_PREFIX = 'inspect:'\n\nexport const DEFAULT_MENU_ITEM_GROUPS: PaneMenuItemGroup[] = [{id: 'inspectors'}, {id: 'links'}]\n\n// inspectors\nexport const HISTORY_INSPECTOR_NAME = 'sanity/desk/history'\nexport const VALIDATION_INSPECTOR_NAME = 'sanity/desk/validation'\n","import {CloseIcon} from '@sanity/icons'\nimport {Box, Button, Card, CardProps, Flex, Text} from '@sanity/ui'\nimport React, {HTMLProps, ReactNode} from 'react'\nimport styled from 'styled-components'\n\nexport interface DocumentInspectorHeaderProps {\n  as?: CardProps['as']\n  closeButtonLabel: string\n  flex?: CardProps['flex']\n  onClose: () => void\n  title: ReactNode\n}\n\nconst Root = styled(Card)({\n  position: 'relative',\n  zIndex: 1,\n  lineHeight: 0,\n\n  '&:after': {\n    content: '\"\"',\n    display: 'block',\n    position: 'absolute',\n    left: 0,\n    bottom: -1,\n    right: 0,\n    borderBottom: '1px solid var(--card-border-color)',\n    opacity: 0.5,\n  },\n})\n\n/** @internal */\nexport function DocumentInspectorHeader(\n  props: DocumentInspectorHeaderProps & Omit<HTMLProps<HTMLDivElement>, 'as' | 'height' | 'ref'>,\n) {\n  const {as: forwardedAs, children, closeButtonLabel, onClose, title, ...restProps} = props\n\n  return (\n    <Root {...restProps} as={forwardedAs}>\n      <Flex padding={2}>\n        <Box flex={1} padding={3}>\n          <Text as=\"h1\" size={1} weight=\"semibold\">\n            {title}\n          </Text>\n        </Box>\n        <Box flex=\"none\" padding={1}>\n          <Button\n            aria-label={closeButtonLabel}\n            fontSize={1}\n            icon={CloseIcon}\n            mode=\"bleed\"\n            onClick={onClose}\n            padding={2}\n          />\n        </Box>\n      </Flex>\n      {children}\n    </Root>\n  )\n}\n","import {createContext} from 'react'\nimport {DeskToolContextValue} from './types'\n\nexport const DeskToolContext = createContext<DeskToolContextValue | null>(null)\n","import {useContext} from 'react'\nimport {DeskToolContext} from './DeskToolContext'\nimport {DeskToolContextValue} from './types'\n\n/** @internal */\nexport function useDeskTool(): DeskToolContextValue {\n  const deskTool = useContext(DeskToolContext)\n\n  if (!deskTool) throw new Error(`DeskTool: missing context value`)\n\n  return deskTool\n}\n","import React, {useCallback, useRef} from 'react'\nimport styled from 'styled-components'\n\nconst Root = styled.div`\n  position: absolute;\n  top: 0;\n  left: -4px;\n  bottom: 0;\n  width: 9px;\n  z-index: 201;\n  cursor: ew-resize;\n\n  /* Border */\n  & > span:nth-child(1) {\n    display: block;\n    border-left: 1px solid var(--card-border-color);\n    position: absolute;\n    top: 0;\n    left: 4px;\n    bottom: 0;\n    transition: opacity 200ms;\n    opacity: 0.5;\n  }\n\n  /* Hover effect */\n  & > span:nth-child(2) {\n    display: block;\n    position: absolute;\n    top: 0;\n    left: 0;\n    width: 9px;\n    bottom: 0;\n    background-color: var(--card-border-color);\n    opacity: 0;\n    transition: opacity 150ms;\n  }\n\n  @media (hover: hover) {\n    &:hover > span:nth-child(2) {\n      opacity: 0.2;\n    }\n  }\n`\n\nexport function Resizer(props: {onResize: (delta: number) => void; onResizeStart: () => void}) {\n  const {onResize, onResizeStart} = props\n\n  const mouseXRef = useRef(0)\n\n  const handleMouseDown = useCallback(\n    (event: React.MouseEvent) => {\n      event.preventDefault()\n\n      mouseXRef.current = event.pageX\n\n      onResizeStart()\n\n      const handleMouseMove = (e: MouseEvent) => {\n        e.preventDefault()\n        onResize(e.pageX - mouseXRef.current)\n      }\n\n      const handleMouseUp = () => {\n        window.removeEventListener('mousemove', handleMouseMove)\n        window.removeEventListener('mouseup', handleMouseUp)\n      }\n\n      window.addEventListener('mousemove', handleMouseMove)\n      window.addEventListener('mouseup', handleMouseUp)\n    },\n    [onResize, onResizeStart],\n  )\n\n  return (\n    <Root onMouseDown={handleMouseDown}>\n      {/* Hover effect */}\n      <span />\n\n      {/* Border */}\n      <span />\n    </Root>\n  )\n}\n","import React, {HTMLProps, useCallback, useMemo, useRef, useState} from 'react'\nimport styled from 'styled-components'\nimport {Box, BoxProps} from '@sanity/ui'\nimport {Resizer} from './Resizer'\n\nexport interface ResizableProps {\n  minWidth: number\n  maxWidth: number\n}\n\nconst Root = styled(Box)`\n  position: relative;\n  flex: 1;\n  padding-left: 1px;\n`\n\nexport function Resizable(\n  props: ResizableProps & BoxProps & Omit<HTMLProps<HTMLDivElement>, 'as'>,\n) {\n  const {as: forwardedAs, children, minWidth, maxWidth, ...restProps} = props\n  const [element, setElement] = useState<HTMLDivElement | null>(null)\n  const elementWidthRef = useRef<number>()\n  const [targetWidth, setTargetWidth] = useState<number>()\n\n  const handleResizeStart = useCallback(() => {\n    elementWidthRef.current = element?.offsetWidth\n  }, [element])\n\n  const handleResize = useCallback(\n    (deltaX: number) => {\n      const w = elementWidthRef.current\n\n      if (!w) return\n\n      setTargetWidth(Math.min(Math.max(w - deltaX, minWidth), maxWidth))\n    },\n    [minWidth, maxWidth],\n  )\n\n  const style = useMemo(\n    () => (targetWidth ? {flex: 'none', width: targetWidth} : {minWidth, maxWidth}),\n    [minWidth, maxWidth, targetWidth],\n  )\n\n  return (\n    <Root as={forwardedAs} {...restProps} ref={setElement} style={style}>\n      {children}\n      <Resizer onResize={handleResize} onResizeStart={handleResizeStart} />\n    </Root>\n  )\n}\n","/* eslint-disable no-loop-func */\n\nimport {Path, SanityDocument, SchemaType} from '@sanity/types'\nimport {isArray, isRecord} from 'sanity'\n\nexport function getPathTypes(options: {\n  path: Path\n  schemaType: SchemaType\n  value: Partial<SanityDocument> | null\n}): SchemaType[] {\n  const {path, schemaType, value} = options\n  const result: SchemaType[] = []\n\n  let s = schemaType\n  let v: unknown = value\n\n  for (const segment of path) {\n    // field name\n    if (typeof segment === 'string') {\n      if (!isRecord(v) && v !== undefined) {\n        throw new Error(`Parent value is not an object, cannot get path segment: .${segment}`)\n      }\n\n      if (s.jsonType !== 'object') {\n        throw new Error(\n          `Parent type is not an object schema type, cannot get path segment: .${segment}`,\n        )\n      }\n\n      v = v?.[segment]\n\n      const field = s.fields.find((f) => f.name === segment)\n\n      if (!field) {\n        throw new Error(`Field type not found: .${segment}`)\n      }\n\n      s = field.type\n\n      result.push(s)\n\n      continue\n    }\n\n    // array item index\n    if (typeof segment === 'number') {\n      if (!isArray(v) && v !== undefined) {\n        throw new Error(`Parent value is not an array, cannot get path segment: [${segment}]`)\n      }\n\n      if (s.jsonType !== 'array') {\n        throw new Error(\n          `Parent type is not an array schema type, cannot get path segment: [${segment}]`,\n        )\n      }\n\n      v = v?.[segment]\n\n      const itemType = s.of.find((ofType) => {\n        if (typeof v === 'string') {\n          return ofType.jsonType === 'string'\n        }\n\n        if (typeof v === 'number') {\n          return ofType.jsonType === 'number'\n        }\n\n        if (typeof v === 'boolean') {\n          return ofType.jsonType === 'boolean'\n        }\n\n        if (isRecord(v)) {\n          return ofType.name === v?._type\n        }\n\n        return false\n      })\n\n      if (!itemType) {\n        throw new Error(`Item type not found: [${segment}]`)\n      }\n\n      s = itemType\n\n      result.push(s)\n\n      continue\n    }\n\n    // array item key\n    if (isRecord(segment) && segment._key) {\n      if (!isArray(v)) {\n        throw new Error(\n          `Parent value is not an array, cannot get path segment: [_key == ${segment}]`,\n        )\n      }\n\n      if (s.jsonType !== 'array') {\n        throw new Error(\n          `Parent type is not an array schema type, cannot get path segment: .${segment}`,\n        )\n      }\n\n      const values = v ?? []\n\n      v = values.find((i) => isRecord(i) && i._key === segment._key)\n\n      if (!isRecord(v)) {\n        throw new Error(`Array item not found: [_key == ${segment._key}]`)\n      }\n\n      const ofType = s.of.find((i) => isRecord(v) && i.name === v?._type)\n\n      if (!ofType) {\n        throw new Error(`Array item type not found: .${v?._type}`)\n      }\n\n      s = ofType\n\n      result.push(s)\n\n      continue\n    }\n\n    throw new Error(`Invalid path segment: ${JSON.stringify(segment)}`)\n  }\n\n  return result\n}\n","import {ErrorOutlineIcon, IconComponent, InfoOutlineIcon, WarningOutlineIcon} from '@sanity/icons'\nimport {Box, Card, CardTone, ErrorBoundary, Flex, Stack, Text} from '@sanity/ui'\nimport {ObjectSchemaType, Path, SanityDocument, SchemaType, ValidationMarker} from '@sanity/types'\nimport React, {ErrorInfo, Fragment, createElement, useCallback, useMemo, useState} from 'react'\nimport {useDocumentPane} from '../../useDocumentPane'\nimport {DocumentInspectorHeader} from '../../documentInspector'\nimport {getPathTypes} from './getPathTypes'\nimport {DocumentInspectorProps, pathToString} from 'sanity'\n\nconst MARKER_ICON: Record<'error' | 'warning' | 'info', IconComponent> = {\n  error: ErrorOutlineIcon,\n  warning: WarningOutlineIcon,\n  info: InfoOutlineIcon,\n}\n\nconst MARKER_TONE: Record<'error' | 'warning' | 'info', CardTone> = {\n  error: 'critical',\n  warning: 'caution',\n  info: 'primary',\n}\n\nexport function ValidationInspector(props: DocumentInspectorProps) {\n  const {onClose} = props\n  const {onFocus, onPathOpen, schemaType, validation, value} = useDocumentPane()\n\n  const handleOpen = useCallback(\n    (path: Path) => {\n      onPathOpen(path)\n      onFocus(path)\n    },\n    [onFocus, onPathOpen],\n  )\n\n  return (\n    <Flex direction=\"column\" height=\"fill\" overflow=\"hidden\">\n      <DocumentInspectorHeader\n        as=\"header\"\n        closeButtonLabel=\"Close validation\"\n        flex=\"none\"\n        onClose={onClose}\n        title=\"Validation\"\n      />\n\n      <Card flex={1} overflow=\"auto\" padding={3}>\n        {validation.length === 0 && (\n          <Box padding={2}>\n            <Text muted size={1}>\n              No validation errors\n            </Text>\n          </Box>\n        )}\n\n        {validation.length > 0 && (\n          <Stack space={2}>\n            {validation.map((marker, i) => (\n              <ValidationCard\n                key={i}\n                marker={marker}\n                onOpen={handleOpen}\n                schemaType={schemaType}\n                value={value}\n              />\n            ))}\n          </Stack>\n        )}\n      </Card>\n    </Flex>\n  )\n}\n\nfunction ValidationCard(props: {\n  marker: ValidationMarker\n  onOpen: (path: Path) => void\n  schemaType: ObjectSchemaType\n  value: Partial<SanityDocument> | null\n}) {\n  const {marker, onOpen, schemaType, value} = props\n  const handleOpen = useCallback(() => onOpen(marker.path), [marker, onOpen])\n  const [errorInfo, setErrorInfo] = useState<{error: Error; info: ErrorInfo} | null>(null)\n\n  return (\n    <ErrorBoundary onCatch={setErrorInfo}>\n      {errorInfo && (\n        <Card padding={3} radius={2} tone=\"critical\">\n          <Text size={1}>ERROR: {errorInfo.error.message}</Text>\n        </Card>\n      )}\n\n      {!errorInfo && (\n        <Card\n          __unstable_focusRing\n          as=\"button\"\n          onClick={handleOpen}\n          padding={3}\n          radius={2}\n          tone={MARKER_TONE[marker.level]}\n        >\n          <Flex align=\"flex-start\" gap={3}>\n            <Box flex=\"none\">\n              <Text size={1}>{createElement(MARKER_ICON[marker.level])}</Text>\n            </Box>\n\n            <Stack flex={1} space={2}>\n              <DocumentNodePathBreadcrumbs\n                path={marker.path}\n                schemaType={schemaType}\n                value={value}\n              />\n\n              <Text muted size={1}>\n                {marker.item.message}\n              </Text>\n            </Stack>\n          </Flex>\n        </Card>\n      )}\n    </ErrorBoundary>\n  )\n}\n\nfunction DocumentNodePathBreadcrumbs(props: {\n  path: Path\n  schemaType: SchemaType\n  value: Partial<SanityDocument> | null\n}) {\n  const {path, schemaType, value} = props\n\n  const pathTypes = useMemo(\n    () => getPathTypes({path, schemaType, value}),\n    [path, schemaType, value],\n  )\n\n  return (\n    <Text size={1}>\n      {pathTypes.map((t, i) => (\n        <Fragment key={i}>\n          {i > 0 && <span style={{color: 'var(--card-muted-fg-color)', opacity: 0.5}}> / </span>}\n          <span style={{fontWeight: 500}}>{t.title || t.name}</span>\n        </Fragment>\n      ))}\n    </Text>\n  )\n}\n","import {CheckmarkCircleIcon, ErrorOutlineIcon, WarningOutlineIcon} from '@sanity/icons'\nimport {useMemo} from 'react'\nimport {VALIDATION_INSPECTOR_NAME} from '../../constants'\nimport {ValidationInspector} from './ValidationInspector'\nimport {\n  DocumentInspector,\n  DocumentInspectorMenuItem,\n  DocumentInspectorUseMenuItemProps,\n  FormNodeValidation,\n  isValidationError,\n  isValidationWarning,\n  useValidationStatus,\n} from 'sanity'\n\nfunction useMenuItem(props: DocumentInspectorUseMenuItemProps): DocumentInspectorMenuItem {\n  const {documentId, documentType} = props\n  const {validation: validationMarkers} = useValidationStatus(documentId, documentType)\n\n  const validation: FormNodeValidation[] = useMemo(\n    () =>\n      validationMarkers.map((item) => ({\n        level: item.level,\n        message: item.item.message,\n        path: item.path,\n      })),\n    [validationMarkers],\n  )\n\n  const hasErrors = validation.some(isValidationError)\n  const hasWarnings = validation.some(isValidationWarning)\n\n  const icon = useMemo(() => {\n    if (hasErrors) return ErrorOutlineIcon\n    if (hasWarnings) return WarningOutlineIcon\n    return CheckmarkCircleIcon\n  }, [hasErrors, hasWarnings])\n\n  const tone = useMemo(() => {\n    if (hasErrors) return 'critical'\n    if (hasWarnings) return 'caution'\n    return 'positive'\n  }, [hasErrors, hasWarnings])\n\n  return {\n    hidden: validation.length === 0,\n    icon,\n    title: 'Validation',\n    tone,\n    showAsAction: true,\n  }\n}\n\nexport const validationInspector: DocumentInspector = {\n  name: VALIDATION_INSPECTOR_NAME,\n  component: ValidationInspector,\n  useMenuItem,\n}\n","import {\n  TrashIcon,\n  EditIcon,\n  IconComponent,\n  PublishIcon,\n  UnpublishIcon,\n  CloseIcon,\n  AddCircleIcon,\n} from '@sanity/icons'\n\nexport const TIMELINE_LABELS: {[key: string]: string | undefined} = {\n  create: 'created',\n  delete: 'deleted',\n  discardDraft: 'discarded draft',\n  initial: 'created',\n  editDraft: 'edited',\n  editLive: 'live edited',\n  publish: 'published',\n  unpublish: 'unpublished',\n}\n\nexport const TIMELINE_ICON_COMPONENTS: {[key: string]: IconComponent | undefined} = {\n  create: AddCircleIcon,\n  delete: TrashIcon,\n  discardDraft: CloseIcon,\n  initial: AddCircleIcon,\n  editDraft: EditIcon,\n  editLive: EditIcon,\n  publish: PublishIcon,\n  unpublish: UnpublishIcon,\n}\n","import {IconComponent} from '@sanity/icons'\nimport {TIMELINE_ICON_COMPONENTS, TIMELINE_LABELS} from './constants'\nimport {ChunkType} from 'sanity'\n\nexport function formatTimelineEventLabel(type: ChunkType): string | undefined {\n  return TIMELINE_LABELS[type]\n}\n\nexport function getTimelineEventIconComponent(type: ChunkType): IconComponent | undefined {\n  return TIMELINE_ICON_COMPONENTS[type]\n}\n","import React from 'react'\nimport {AvatarStack} from '@sanity/ui'\nimport {UserAvatar} from 'sanity'\n\ninterface UserAvatarStackProps {\n  maxLength?: number\n  userIds: string[]\n}\n\nexport function UserAvatarStack({maxLength, userIds}: UserAvatarStackProps) {\n  return (\n    <AvatarStack maxLength={maxLength}>\n      {userIds.map((userId) => (\n        <UserAvatar key={userId} user={userId} withTooltip />\n      ))}\n    </AvatarStack>\n  )\n}\n","import {Text, Box, Button, Theme, Flex, rem} from '@sanity/ui'\nimport styled, {css} from 'styled-components'\n\nexport interface IconWrapperProps {\n  theme: Theme\n}\n\nexport const IconWrapper = styled(Flex)(({theme}: IconWrapperProps) => {\n  const borderColor = theme.sanity.color.base.skeleton?.from\n\n  return css`\n    --timeline-hairline-width: 1px;\n    position: relative;\n    z-index: 2;\n    margin: 0;\n    padding: 0;\n\n    &::before {\n      position: absolute;\n      content: '';\n      height: 100%;\n      width: var(--timeline-hairline-width);\n      background: ${borderColor};\n      top: 0;\n      left: calc((100% - var(--timeline-hairline-width)) / 2);\n      z-index: 1;\n    }\n  `\n})\n\nexport const Root = styled(Button)(({\n  $selected,\n  $disabled,\n}: {\n  $selected: boolean\n  $disabled: boolean\n}) => {\n  return css`\n    position: relative;\n    width: 100%;\n\n    /* Line styling */\n    &[data-first] ${IconWrapper}::before {\n      height: 50%;\n      top: unset;\n      bottom: 0;\n    }\n\n    &[data-last] ${IconWrapper}::before {\n      height: 50%;\n    }\n\n    ${$selected &&\n    css`\n      ${IconWrapper}::before {\n        background: transparent;\n      }\n    `}\n\n    ${$disabled &&\n    css`\n      cursor: not-allowed;\n    `}\n  `\n})\n\nexport const IconBox = styled(Box)`\n  background: var(--card-bg-color);\n  border-radius: 50px;\n  position: relative;\n  z-index: 2;\n`\n\nexport const EventLabel = styled(Text)`\n  text-transform: capitalize;\n`\n\nexport const TimestampBox = styled(Box)`\n  min-width: 1rem;\n  margin-left: ${({theme}) => `-${rem(theme.sanity.space[1])}`};\n`\n","import React, {useCallback, createElement, useMemo} from 'react'\nimport {Box, ButtonTone, Card, Flex, Label, Stack, Text} from '@sanity/ui'\nimport {format} from 'date-fns'\nimport {formatTimelineEventLabel, getTimelineEventIconComponent} from './helpers'\nimport {UserAvatarStack} from './userAvatarStack'\nimport {EventLabel, IconBox, IconWrapper, Root, TimestampBox} from './timelineItem.styled'\nimport {ChunkType, Chunk} from 'sanity'\n\nconst TIMELINE_ITEM_EVENT_TONE: Record<ChunkType | 'withinSelection', ButtonTone> = {\n  initial: 'primary',\n  create: 'primary',\n  publish: 'positive',\n  editLive: 'caution',\n  editDraft: 'caution',\n  unpublish: 'critical',\n  discardDraft: 'critical',\n  delete: 'critical',\n  withinSelection: 'primary',\n}\n\ninterface TimelineItemProps {\n  chunk: Chunk\n  isFirst: boolean\n  isLast: boolean\n  isLatest: boolean\n  isSelected: boolean\n  onSelect: (chunk: Chunk) => void\n  timestamp: string\n  type: ChunkType\n}\n\nexport function TimelineItem({\n  chunk,\n  isFirst,\n  isLast,\n  isLatest,\n  isSelected,\n  onSelect,\n  timestamp,\n  type,\n}: TimelineItemProps) {\n  const iconComponent = getTimelineEventIconComponent(type)\n  const authorUserIds = Array.from(chunk.authors)\n  const isSelectable = type !== 'delete'\n  const formattedTimestamp = useMemo(() => {\n    const parsedDate = new Date(timestamp)\n    const formattedDate = format(parsedDate, 'MMM d, yyyy, hh:mm a')\n\n    return formattedDate\n  }, [timestamp])\n\n  const handleClick = useCallback(\n    (evt: React.MouseEvent<HTMLButtonElement>) => {\n      evt.preventDefault()\n      evt.stopPropagation()\n\n      if (isSelectable) {\n        onSelect(chunk)\n      }\n    },\n    [onSelect, chunk, isSelectable],\n  )\n\n  return (\n    <Root\n      $selected={isSelected}\n      $disabled={!isSelectable}\n      data-chunk-id={chunk.id}\n      data-first={isFirst ? true : undefined}\n      data-last={isLast ? true : undefined}\n      data-ui=\"timelineItem\"\n      mode={isSelected ? 'default' : 'bleed'}\n      onClick={handleClick}\n      padding={0}\n      radius={2}\n      tone={isSelected ? 'primary' : TIMELINE_ITEM_EVENT_TONE[chunk.type]}\n    >\n      <Box paddingX={2}>\n        <Flex align=\"stretch\">\n          <IconWrapper align=\"center\">\n            <IconBox padding={2}>\n              <Text size={2}>{iconComponent && createElement(iconComponent)}</Text>\n            </IconBox>\n          </IconWrapper>\n\n          <Stack space={2} margin={2}>\n            {isLatest && (\n              <Flex>\n                <Card\n                  padding={1}\n                  radius={2}\n                  shadow={1}\n                  tone={isSelected ? 'primary' : TIMELINE_ITEM_EVENT_TONE[chunk.type]}\n                >\n                  <Label muted size={0}>\n                    Latest\n                  </Label>\n                </Card>\n              </Flex>\n            )}\n            <Box>\n              <EventLabel size={1} weight=\"medium\">\n                {formatTimelineEventLabel(type) || <code>{type}</code>}\n              </EventLabel>\n            </Box>\n            <TimestampBox paddingX={1}>\n              <Text size={0} muted>\n                {formattedTimestamp}\n              </Text>\n            </TimestampBox>\n          </Stack>\n          <Flex flex={1} justify=\"flex-end\" align=\"center\">\n            <UserAvatarStack maxLength={3} userIds={authorUserIds} />\n          </Flex>\n        </Flex>\n      </Box>\n    </Root>\n  )\n}\n","import {Box, Flex, Stack} from '@sanity/ui'\nimport styled, {css} from 'styled-components'\n\nexport const StackWrapper = styled(Stack)`\n  max-width: 200px;\n`\n\nexport const ListWrapper = styled(Flex)`\n  max-height: calc(100vh - 198px);\n  min-width: 244px;\n`\n\nexport const Root = styled(Box)(({$visible}: {$visible?: boolean}) => {\n  return css`\n    opacity: 0;\n    pointer-events: none;\n\n    ${$visible &&\n    css`\n      opacity: 1;\n      pointer-events: auto;\n    `}\n  `\n})\n","import React, {useCallback, useEffect, useMemo, useState} from 'react'\nimport {Box, Flex, Spinner, Text} from '@sanity/ui'\nimport {TimelineItem} from './timelineItem'\nimport {ListWrapper, Root, StackWrapper} from './timeline.styled'\nimport {Chunk, CommandList, CommandListRenderItemCallback} from 'sanity'\n\ninterface TimelineProps {\n  chunks: Chunk[]\n  disabledBeforeFirstChunk?: boolean\n  firstChunk?: Chunk | null\n  hasMoreChunks: boolean | null\n  lastChunk?: Chunk | null\n  onLoadMore: () => void\n  onSelect: (chunk: Chunk) => void\n}\n\nexport const Timeline = ({\n  chunks,\n  disabledBeforeFirstChunk,\n  hasMoreChunks,\n  lastChunk,\n  onLoadMore,\n  onSelect,\n  firstChunk,\n}: TimelineProps) => {\n  const [mounted, setMounted] = useState(false)\n\n  const filteredChunks = useMemo(() => {\n    return chunks.filter((c) => {\n      if (disabledBeforeFirstChunk && firstChunk) {\n        return c.index < firstChunk.index\n      }\n      return true\n    })\n  }, [chunks, disabledBeforeFirstChunk, firstChunk])\n\n  const selectedIndex = useMemo(\n    () => (lastChunk?.id ? filteredChunks.findIndex((c) => c.id === lastChunk.id) : -1),\n    [lastChunk?.id, filteredChunks],\n  )\n\n  const renderItem = useCallback<CommandListRenderItemCallback<Chunk>>(\n    (chunk, {activeIndex}) => {\n      const isFirst = activeIndex === 0\n      const isLast = (filteredChunks && activeIndex === filteredChunks.length - 1) || false\n      return (\n        <Box paddingBottom={isLast ? 1 : 0} paddingTop={isFirst ? 1 : 0} paddingX={1}>\n          <TimelineItem\n            chunk={chunk}\n            isFirst={isFirst}\n            isLast={isLast}\n            isLatest={activeIndex === 0 && !disabledBeforeFirstChunk}\n            isSelected={activeIndex === selectedIndex}\n            onSelect={onSelect}\n            timestamp={chunk.endTimestamp}\n            type={chunk.type}\n          />\n          {activeIndex === filteredChunks.length - 1 && hasMoreChunks && (\n            <Flex align=\"center\" justify=\"center\" padding={4}>\n              <Spinner muted />\n            </Flex>\n          )}\n        </Box>\n      )\n    },\n    [disabledBeforeFirstChunk, filteredChunks, hasMoreChunks, onSelect, selectedIndex],\n  )\n\n  useEffect(() => setMounted(true), [])\n\n  return (\n    <Root\n      /**\n       * We delay initial rendering if `selectedIndex` is present.\n       * This is a _temporary_ workaround to allow the virtual <CommandList>\n       * to scroll to a specific index prior to being displayed.\n       *\n       * Without this, there'll be a noticeable 'flash' where the virtual list\n       * will render with its child items at the top and then scroll into position.\n       */\n      $visible={!selectedIndex || mounted}\n      data-ui=\"timeline\"\n    >\n      {filteredChunks.length === 0 && (\n        <StackWrapper padding={3} space={3}>\n          <Text size={1} weight=\"semibold\">\n            No document history\n          </Text>\n          <Text muted size={1}>\n            When changing the content of the document, the document versions will appear in this\n            menu.\n          </Text>\n        </StackWrapper>\n      )}\n\n      {filteredChunks.length > 0 && (\n        <ListWrapper direction=\"column\">\n          <CommandList\n            activeItemDataAttr=\"data-hovered\"\n            ariaLabel=\"Document revisions\"\n            autoFocus=\"list\"\n            initialIndex={selectedIndex}\n            initialScrollAlign=\"center\"\n            itemHeight={40}\n            items={filteredChunks}\n            onEndReached={onLoadMore}\n            onEndReachedIndexOffset={20}\n            overscan={5}\n            renderItem={renderItem}\n            wrapAround={false}\n          />\n        </ListWrapper>\n      )}\n    </Root>\n  )\n}\n\nTimeline.displayName = 'Timeline'\n","import {ErrorOutlineIcon} from '@sanity/icons'\nimport {Flex, Stack} from '@sanity/ui'\nimport React from 'react'\nimport {TextWithTone} from 'sanity'\n\nexport function TimelineError() {\n  return (\n    <Flex align=\"flex-start\" gap={3} padding={4}>\n      <TextWithTone tone=\"critical\">\n        <ErrorOutlineIcon />\n      </TextWithTone>\n      <Stack space={4}>\n        <TextWithTone size={1} tone=\"critical\" weight=\"semibold\">\n          An error occurred whilst retrieving document changes.\n        </TextWithTone>\n        <TextWithTone size={1} tone=\"critical\">\n          Document history transactions have not been affected.\n        </TextWithTone>\n      </Stack>\n    </Flex>\n  )\n}\n","import {SelectIcon} from '@sanity/icons'\nimport {Button, Placement, Popover, useClickOutside, useGlobalKeyDown, useToast} from '@sanity/ui'\nimport {format} from 'date-fns'\nimport {upperFirst} from 'lodash'\nimport React, {useCallback, useMemo, useState} from 'react'\nimport styled from 'styled-components'\nimport {useDocumentPane} from '../useDocumentPane'\nimport {TimelineError} from './TimelineError'\nimport {formatTimelineEventLabel} from './helpers'\nimport {Timeline} from './timeline'\nimport {Chunk, useTimelineSelector} from 'sanity'\n\ninterface TimelineMenuProps {\n  chunk: Chunk | null\n  mode: 'rev' | 'since'\n  placement?: Placement\n}\n\nconst Root = styled(Popover)`\n  overflow: hidden;\n  overflow: clip;\n`\n\nexport function TimelineMenu({chunk, mode, placement}: TimelineMenuProps) {\n  const {setTimelineRange, setTimelineMode, timelineError, ready, timelineStore, isDeleted} =\n    useDocumentPane()\n  const [open, setOpen] = useState(false)\n  const [button, setButton] = useState<HTMLButtonElement | null>(null)\n  const [popover, setPopover] = useState<HTMLElement | null>(null)\n  const toast = useToast()\n\n  const chunks = useTimelineSelector(timelineStore, (state) => state.chunks)\n  const loading = useTimelineSelector(timelineStore, (state) => state.isLoading)\n  const hasMoreChunks = useTimelineSelector(timelineStore, (state) => state.hasMoreChunks)\n  const realRevChunk = useTimelineSelector(timelineStore, (state) => state.realRevChunk)\n  const sinceTime = useTimelineSelector(timelineStore, (state) => state.sinceTime)\n\n  const handleOpen = useCallback(() => {\n    setTimelineMode(mode)\n    setOpen(true)\n  }, [mode, setTimelineMode])\n\n  const handleClose = useCallback(() => {\n    setTimelineMode('closed')\n    setOpen(false)\n  }, [setTimelineMode])\n\n  const handleClickOutside = useCallback(() => {\n    if (open) {\n      handleClose()\n    }\n  }, [handleClose, open])\n\n  const handleGlobalKeyDown = useCallback(\n    (event: KeyboardEvent) => {\n      if (open && (event.key === 'Escape' || event.key === 'Tab')) {\n        handleClose()\n        button?.focus()\n      }\n    },\n    [button, handleClose, open],\n  )\n\n  useClickOutside(handleClickOutside, [button, popover])\n  useGlobalKeyDown(handleGlobalKeyDown)\n\n  const selectRev = useCallback(\n    (revChunk: Chunk) => {\n      try {\n        const [sinceId, revId] = timelineStore.findRangeForRev(revChunk)\n        setTimelineMode('closed')\n        setTimelineRange(sinceId, revId)\n      } catch (err) {\n        toast.push({\n          closable: true,\n          description: err.message,\n          status: 'error',\n          title: 'Unable to load revision',\n        })\n      }\n    },\n    [setTimelineMode, setTimelineRange, timelineStore, toast],\n  )\n\n  const selectSince = useCallback(\n    (sinceChunk: Chunk) => {\n      try {\n        const [sinceId, revId] = timelineStore.findRangeForSince(sinceChunk)\n        setTimelineMode('closed')\n        setTimelineRange(sinceId, revId)\n      } catch (err) {\n        toast.push({\n          closable: true,\n          description: err.message,\n          status: 'error',\n          title: 'Unable to load revision',\n        })\n      }\n    },\n    [setTimelineMode, setTimelineRange, timelineStore, toast],\n  )\n\n  const handleLoadMore = useCallback(() => {\n    if (!loading) {\n      timelineStore.loadMore()\n    }\n  }, [loading, timelineStore])\n\n  const content = timelineError ? (\n    <TimelineError />\n  ) : (\n    <>\n      {mode === 'rev' && (\n        <Timeline\n          chunks={chunks}\n          firstChunk={realRevChunk}\n          hasMoreChunks={hasMoreChunks}\n          lastChunk={realRevChunk}\n          onLoadMore={handleLoadMore}\n          onSelect={selectRev}\n        />\n      )}\n      {mode === 'since' && (\n        <Timeline\n          chunks={chunks}\n          disabledBeforeFirstChunk\n          firstChunk={realRevChunk}\n          hasMoreChunks={hasMoreChunks}\n          lastChunk={sinceTime}\n          onLoadMore={handleLoadMore}\n          onSelect={selectSince}\n        />\n      )}\n    </>\n  )\n\n  const timeLabel = useFormattedTimestamp(chunk?.endTimestamp || '')\n\n  const revLabel = chunk\n    ? `${upperFirst(formatTimelineEventLabel(chunk.type))}: ${timeLabel}`\n    : 'Latest version'\n\n  const sinceLabel = chunk ? `Since: ${timeLabel}` : 'Since: unknown version'\n\n  const buttonLabel = mode === 'rev' ? revLabel : sinceLabel\n\n  return (\n    <Root\n      constrainSize\n      content={open && content}\n      data-ui=\"versionMenu\"\n      open={open}\n      placement={placement}\n      portal\n      ref={setPopover}\n    >\n      <Button\n        disabled={!ready}\n        mode=\"bleed\"\n        fontSize={1}\n        padding={2}\n        iconRight={SelectIcon}\n        onClick={open ? handleClose : handleOpen}\n        ref={setButton}\n        selected={open}\n        style={{maxWidth: '100%'}}\n        text={ready ? buttonLabel : 'Loading history'}\n      />\n    </Root>\n  )\n}\n\nexport function useFormattedTimestamp(time: string): string {\n  const formatted = useMemo(() => {\n    const parsedDate = time ? new Date(time) : new Date()\n    const formattedDate = format(parsedDate, 'MMM d, yyyy, hh:mm a')\n    return formattedDate\n  }, [time])\n\n  return formatted\n}\n","import React from 'react'\nimport {Box, Flex, Spinner, Text} from '@sanity/ui'\nimport {Delay} from '../../../../components'\n\nexport function LoadingContent() {\n  return (\n    <Delay ms={300}>\n      <Flex align=\"center\" direction=\"column\" height=\"fill\" justify=\"center\" paddingTop={3}>\n        <Spinner muted />\n        <Box marginTop={3}>\n          <Text align=\"center\" muted size={1}>\n            Loading changes\n          </Text>\n        </Box>\n      </Flex>\n    </Delay>\n  )\n}\n","import {AnnotationDetails, visitDiff, Diff} from 'sanity'\n\nexport function collectLatestAuthorAnnotations(diff: Diff): AnnotationDetails[] {\n  const authorMap = new Map<string, AnnotationDetails>()\n  visitDiff(diff, (child) => {\n    if (child.action === 'unchanged' || !('annotation' in child) || !child.annotation) {\n      return true\n    }\n\n    const {author, timestamp} = child.annotation\n    const previous = authorMap.get(author)\n    if (!previous || previous.timestamp < timestamp) {\n      authorMap.set(author, child.annotation)\n    }\n\n    return true\n  })\n\n  return Array.from(authorMap.values()).sort((a, b) => (a.timestamp < b.timestamp ? 1 : -1))\n}\n","import {ObjectDiff} from '@sanity/diff'\nimport {AvatarStack, BoundaryElementProvider, Box, Card, Flex} from '@sanity/ui'\nimport React, {ReactElement, useRef} from 'react'\nimport styled from 'styled-components'\nimport {TimelineMenu} from '../../timeline'\nimport {useDocumentPane} from '../../useDocumentPane'\nimport {DocumentInspectorHeader} from '../../documentInspector'\nimport {LoadingContent} from './LoadingContent'\nimport {collectLatestAuthorAnnotations} from './helpers'\nimport {\n  ChangeFieldWrapper,\n  ChangeList,\n  DiffTooltip,\n  DocumentChangeContext,\n  DocumentChangeContextInstance,\n  DocumentInspectorProps,\n  NoChanges,\n  ObjectSchemaType,\n  ScrollContainer,\n  UserAvatar,\n  useTimelineSelector,\n} from 'sanity'\n\nconst Scroller = styled(ScrollContainer)`\n  height: 100%;\n  overflow: auto;\n  position: relative;\n  scroll-behavior: smooth;\n`\n\nexport function ChangesInspector(props: DocumentInspectorProps): ReactElement {\n  const {onClose} = props\n  const {documentId, schemaType, timelineError, timelineStore, value} = useDocumentPane()\n  const scrollRef = useRef<HTMLDivElement | null>(null)\n\n  // Subscribe to external timeline state changes\n  const diff = useTimelineSelector(timelineStore, (state) => state.diff)\n  const onOlderRevision = useTimelineSelector(timelineStore, (state) => state.onOlderRevision)\n  const selectionState = useTimelineSelector(timelineStore, (state) => state.selectionState)\n  const sinceTime = useTimelineSelector(timelineStore, (state) => state.sinceTime)\n  const loading = selectionState === 'loading'\n  const isComparingCurrent = !onOlderRevision\n\n  const documentContext: DocumentChangeContextInstance = React.useMemo(\n    () => ({\n      documentId,\n      schemaType,\n      FieldWrapper: ChangeFieldWrapper,\n      rootDiff: diff,\n      isComparingCurrent,\n      value,\n    }),\n    [documentId, diff, isComparingCurrent, schemaType, value],\n  )\n\n  const changeAnnotations = React.useMemo(\n    () => (diff ? collectLatestAuthorAnnotations(diff) : []),\n    [diff],\n  )\n\n  return (\n    <Flex data-testid=\"review-changes-pane\" direction=\"column\" height=\"fill\" overflow=\"hidden\">\n      <DocumentInspectorHeader\n        as=\"header\"\n        closeButtonLabel=\"Close review changes\"\n        flex=\"none\"\n        onClose={onClose}\n        title=\"Review changes\"\n      >\n        <Flex gap={1} padding={3} paddingTop={0} paddingBottom={2}>\n          <Box flex={1}>\n            <TimelineMenu mode=\"since\" chunk={sinceTime} placement=\"bottom-start\" />\n          </Box>\n\n          <Box flex=\"none\">\n            <DiffTooltip annotations={changeAnnotations} description=\"Changes by\" portal>\n              <AvatarStack maxLength={4} aria-label=\"Changes by\">\n                {changeAnnotations.map(({author}) => (\n                  <UserAvatar key={author} user={author} />\n                ))}\n              </AvatarStack>\n            </DiffTooltip>\n          </Box>\n        </Flex>\n      </DocumentInspectorHeader>\n\n      <Card flex={1}>\n        <BoundaryElementProvider element={scrollRef.current}>\n          <Scroller data-ui=\"Scroller\" ref={scrollRef}>\n            <Box flex={1} padding={4}>\n              <Content\n                diff={diff}\n                documentContext={documentContext}\n                error={timelineError}\n                loading={loading}\n                schemaType={schemaType}\n              />\n            </Box>\n          </Scroller>\n        </BoundaryElementProvider>\n      </Card>\n    </Flex>\n  )\n}\n\nfunction Content({\n  error,\n  diff,\n  documentContext,\n  loading,\n  schemaType,\n}: {\n  error?: Error | null\n  diff: ObjectDiff<any> | null\n  documentContext: DocumentChangeContextInstance\n  loading: boolean\n  schemaType: ObjectSchemaType\n}) {\n  if (error) {\n    return <NoChanges />\n  }\n\n  if (loading) {\n    return <LoadingContent />\n  }\n\n  if (!diff) {\n    return <NoChanges />\n  }\n\n  return (\n    <DocumentChangeContext.Provider value={documentContext}>\n      <ChangeList diff={diff} schemaType={schemaType} />\n    </DocumentChangeContext.Provider>\n  )\n}\n","import {RestoreIcon} from '@sanity/icons'\nimport {HISTORY_INSPECTOR_NAME} from '../../constants'\nimport {useDeskTool} from '../../../../useDeskTool'\nimport {ChangesInspector} from './ChangesInspector'\nimport {DocumentInspector} from 'sanity'\n\nexport const changesInspector: DocumentInspector = {\n  name: HISTORY_INSPECTOR_NAME,\n  useMenuItem: () => {\n    const {features} = useDeskTool()\n\n    return {\n      hidden: !features.reviewChanges,\n      icon: RestoreIcon,\n      title: 'Review changes',\n    }\n  },\n  component: ChangesInspector,\n  onClose: ({params}) => ({params: {...params, since: undefined}}),\n  onOpen: ({params}) => ({params: {...params, since: '@lastPublished'}}),\n}\n","import {MasterDetailIcon} from '@sanity/icons'\nimport {lazy} from 'react'\nimport {\n  DeleteAction,\n  DiscardChangesAction,\n  DuplicateAction,\n  HistoryRestoreAction,\n  PublishAction,\n  UnpublishAction,\n} from './documentActions'\nimport {LiveEditBadge} from './documentBadges'\nimport {getIntentState} from './getIntentState'\nimport {router} from './router'\nimport {DeskToolOptions} from './types'\nimport {validationInspector} from './panes/document/inspectors/validation'\nimport {changesInspector} from './panes/document/inspectors/changes'\nimport {definePlugin} from 'sanity'\n\nconst documentActions = [\n  PublishAction,\n  UnpublishAction,\n  DiscardChangesAction,\n  DuplicateAction,\n  DeleteAction,\n  HistoryRestoreAction,\n]\n\nconst documentBadges = [LiveEditBadge]\n\nconst inspectors = [validationInspector, changesInspector]\n\n/**\n * The deskTool is a studio plugin which adds the “desk tool” – a tool within Sanity Studio in which\n * content editors can drill down to specific documents to edit them.\n * You can configure your Studio's desk tool(s).\n *\n * @public\n * @param options - Options for the desk tool. See {@link DeskToolOptions}\n * @example Minimal example\n * ```ts\n * // sanity.config.ts\n * import { defineConfig } from 'sanity'\n * import { deskTool } from 'sanity/desk'\n *\n * export default defineConfig((\n *  // ...\n *  plugins: [\n *    deskTool() // use defaults\n *  ]\n * })\n * ```\n *\n * @example To customise your desk tool\n * ```ts\n * // sanity.config.ts\n * import { defineConfig } from 'sanity'\n * import { deskTool } from 'sanity/desk'\n * import { FaCar } from 'react-icons'\n\n * export default defineConfig((\n *\t // ...\n *   plugins: [\n *    deskTool({\n *      name: 'cars',\n *      title: 'Cars',\n *      icon: FaCar,\n *      structure: (S) => S.documentTypeList('car'),\n *      defaultDocumentNode: (S) =>\n *        S.document().views([\n *          S.view.form(),\n *          S.view.component(Preview).title('Preview')\n *        ])\n *    })\n *  ]\n * })\n * ```\n * */\nexport const deskTool = definePlugin<DeskToolOptions | void>((options) => ({\n  name: '@sanity/desk-tool',\n  document: {\n    actions: (prevActions) => {\n      // NOTE: since it's possible to have several desk tools in one Studio,\n      // we need to check whether the document actions already exist in the Studio config\n      return Array.from(new Set([...prevActions, ...documentActions]))\n    },\n    badges: (prevBadges) => {\n      // NOTE: since it's possible to have several desk tools in one Studio,\n      // we need to check whether the document badges already exist in the Studio config\n      return Array.from(new Set([...prevBadges, ...documentBadges]))\n    },\n    inspectors: (prevInspectors) => {\n      // NOTE: since it's possible to have several desk tools in one Studio,\n      // we need to check whether the inspectors already exist in the Studio config\n      return Array.from(new Set([...prevInspectors, ...inspectors]))\n    },\n  },\n  tools: [\n    {\n      name: options?.name || 'desk',\n      title: options?.title || 'Desk',\n      icon: options?.icon || MasterDetailIcon,\n      component: lazy(() => import('./components/deskTool')),\n      canHandleIntent: (intent, params) => {\n        return Boolean(\n          (intent === 'edit' && params.id) ||\n            (intent === 'create' && params.type) ||\n            (intent === 'create' && params.template),\n        )\n      },\n      // Controlled by sanity/src/desk/components/deskTool/DeskTitle.tsx\n      controlsDocumentTitle: true,\n      getIntentState,\n      options,\n      router,\n    },\n  ],\n}))\n","import {BinaryDocumentIcon, EarthAmericasIcon} from '@sanity/icons'\nimport {DeskToolFeatures, PaneMenuItem} from '../../types'\nimport {INSPECT_ACTION_PREFIX} from './constants'\nimport {DocumentInspector, DocumentInspectorMenuItem, ValidationMarker} from 'sanity'\n\ninterface GetMenuItemsParams {\n  currentInspector?: DocumentInspector\n  features: DeskToolFeatures\n  hasValue: boolean\n  inspectors: DocumentInspector[]\n  previewUrl?: string | null\n  inspectorMenuItems: DocumentInspectorMenuItem[]\n}\n\nfunction getInspectorItems({\n  currentInspector,\n  hasValue,\n  inspectors,\n  inspectorMenuItems,\n}: GetMenuItemsParams): PaneMenuItem[] {\n  return inspectors\n    .map((inspector, index) => {\n      const menuItem = inspectorMenuItems[index]\n\n      if (!menuItem || menuItem.hidden) return null\n\n      return {\n        action: `${INSPECT_ACTION_PREFIX}${inspector.name}`,\n        group: menuItem.showAsAction ? undefined : 'inspectors',\n        icon: menuItem.icon,\n        isDisabled: !hasValue,\n        selected: currentInspector?.name === inspector.name,\n        shortcut: menuItem.hotkeys?.join('+'),\n        showAsAction: menuItem.showAsAction,\n        title: menuItem.title,\n        tone: menuItem.tone,\n      }\n    })\n    .filter(Boolean) as PaneMenuItem[]\n}\n\nfunction getInspectItem({hasValue}: GetMenuItemsParams): PaneMenuItem {\n  return {\n    action: 'inspect',\n    group: 'inspectors',\n    title: 'Inspect',\n    icon: BinaryDocumentIcon,\n    isDisabled: !hasValue,\n    shortcut: 'Ctrl+Alt+I',\n  }\n}\n\nexport function getProductionPreviewItem({previewUrl}: GetMenuItemsParams): PaneMenuItem | null {\n  if (!previewUrl) return null\n\n  return {\n    action: 'production-preview',\n    group: 'links',\n    title: 'Open preview',\n    icon: EarthAmericasIcon,\n    shortcut: 'Ctrl+Alt+O',\n  }\n}\n\nexport function getMenuItems(params: GetMenuItemsParams): PaneMenuItem[] {\n  const inspectorItems = getInspectorItems(params)\n  const items = [\n    // Get production preview item\n    getProductionPreviewItem(params),\n  ].filter(Boolean) as PaneMenuItem[]\n\n  return [\n    ...inspectorItems,\n\n    // TODO: convert to inspector or document view?\n    getInspectItem(params),\n\n    ...items,\n  ]\n}\n","import {useEffect, useState} from 'react'\nimport {SanityDocument} from '@sanity/types'\nimport {useAsObservable} from 'react-rx'\nimport {debounceTime, switchMap, catchError} from 'rxjs/operators'\nimport {from, of} from 'rxjs'\nimport {useSource, isRecord} from 'sanity'\n\nconst isSanityDocument = (value: unknown): value is SanityDocument =>\n  isRecord(value) && typeof value._id === 'string' && typeof value._type === 'string'\n\nexport function usePreviewUrl(value: Partial<SanityDocument> | undefined): string | undefined {\n  const [previewUrl, setPreviewUrl] = useState<string | undefined>(undefined)\n  const [error, setError] = useState<unknown>(null)\n  const {resolveProductionUrl} = useSource().document\n  // @todo refactor out of useAsObservable, and instead use `of() + useMemoObservable` like we did for `useLoadableFromCreateLoadable`\n  const value$ = useAsObservable(value)\n\n  if (error) throw error\n\n  useEffect(() => {\n    value$\n      .pipe(\n        // this so that the preview URL isn't fetched on every keystroke\n        debounceTime(500),\n        switchMap((document) =>\n          isSanityDocument(document) ? from(resolveProductionUrl({document})) : of(undefined),\n        ),\n        catchError((e) => {\n          const message = isRecord(e) && typeof e.message === 'string' ? e.message : 'Unknown error'\n          throw new Error(`An error was thrown while trying to get your preview url: ${message}`)\n        }),\n      )\n      .subscribe({\n        next: setPreviewUrl,\n        error: setError,\n      })\n  }, [resolveProductionUrl, value$])\n\n  return previewUrl\n}\n","import {Template} from 'sanity'\n\ninterface InitialValueOptions {\n  documentType: string\n  panePayload?: unknown\n  templateName?: string\n  templateParams?: Record<string, unknown>\n  urlTemplate?: string\n}\n\n/**\n * @internal\n */\nexport function getInitialValueTemplateOpts(\n  templates: Template[],\n  opts: InitialValueOptions,\n): {templateName: string; templateParams: Record<string, unknown>} {\n  const payload = opts.panePayload || {}\n  const structureNodeTemplate = opts.templateName\n\n  if (opts.urlTemplate && structureNodeTemplate && structureNodeTemplate !== opts.urlTemplate) {\n    // eslint-disable-next-line no-console\n    console.warn(\n      `Conflicting templates: URL says \"${opts.urlTemplate}\", structure node says \"${structureNodeTemplate}\". Using \"${structureNodeTemplate}\".`,\n    )\n  }\n\n  const template = structureNodeTemplate || opts.urlTemplate\n  const typeTemplates = templates.filter((t) => t.schemaType === opts.documentType)\n\n  const templateParams = {\n    ...opts.templateParams,\n    ...(typeof payload === 'object' ? payload || {} : {}),\n  }\n\n  let templateName = template\n\n  // If we have not specified a specific template, and we only have a single\n  // template available for a schema type, use it\n  if (!template && typeTemplates.length === 1) {\n    templateName = typeTemplates[0].id\n  }\n\n  return {templateName: templateName!, templateParams}\n}\n","import React, {memo, useCallback, useEffect, useRef, useState} from 'react'\nimport {DocumentInspector, DocumentInspectorMenuItem, useUnique} from 'sanity'\n\ninterface InspectorMenuItemProps {\n  documentId: string\n  documentType: string\n  index: number\n  setMenuItem: (index: number, node: DocumentInspectorMenuItem) => void\n  useMenuItem: NonNullable<DocumentInspector['useMenuItem']>\n}\n\nconst InspectorMenuItem = memo(function InspectorMenuItem(props: InspectorMenuItemProps) {\n  const {documentId, documentType, index, setMenuItem, useMenuItem} = props\n\n  const node = useUnique(\n    useMenuItem({\n      documentId,\n      documentType,\n    }),\n  )\n\n  useEffect(() => {\n    setMenuItem(index, node)\n  }, [index, node, setMenuItem])\n\n  return <></>\n})\n\ninterface DocumentInspectorMenuItemsResolverProps {\n  documentId: string\n  documentType: string\n  inspectors: DocumentInspector[]\n  onMenuItems: (items: DocumentInspectorMenuItem[]) => void\n}\n\n// The menu item in a document inspector are resolved in a React hook (`useMenuItem`).\n// This means that the menu item needs to be resolved in a React component (in accordance with the rules of hooks).\n// In this component, we map over the configured inspectors and render a `InspectorMenuItem` for each.\n// The `InspectorMenuItem` will resolve the menu item in a React hook and call the `setMenuItem` callback\n// with the resolved menu item and the index of the inspector.\n// Finally, we call the `onMenuItems` callback with the resolved menu items.\nexport function DocumentInspectorMenuItemsResolver(props: DocumentInspectorMenuItemsResolverProps) {\n  const {documentId, documentType, inspectors, onMenuItems} = props\n\n  const len = inspectors.length\n  const lenRef = useRef(len)\n\n  const [menuItems, setMenuItems] = useState<DocumentInspectorMenuItem[]>(() =>\n    Array.from(new Array(len)),\n  )\n\n  const menuItemsRef = useRef(menuItems)\n\n  useEffect(() => {\n    if (lenRef.current !== len) {\n      const newFieldActions = Array.from(new Array(len))\n\n      for (let i = 0; i < len; i++) {\n        newFieldActions[i] = menuItemsRef.current[i]\n      }\n\n      lenRef.current = len\n\n      setMenuItems(() => {\n        menuItemsRef.current = newFieldActions\n        return newFieldActions\n      })\n    }\n  }, [len])\n\n  const setMenuItem = useCallback((index: number, node: DocumentInspectorMenuItem) => {\n    setMenuItems((prev) => {\n      const next = [...prev]\n      next[index] = node\n      menuItemsRef.current = next\n      return next\n    })\n  }, [])\n\n  useEffect(() => {\n    onMenuItems(menuItems.filter(Boolean))\n  }, [menuItems, onMenuItems])\n\n  return (\n    <>\n      {inspectors.map(\n        (inspector, inspectorIndex) =>\n          inspector.useMenuItem && (\n            <InspectorMenuItem\n              documentId={documentId}\n              documentType={documentType}\n              index={inspectorIndex}\n              key={inspector.name}\n              setMenuItem={setMenuItem}\n              useMenuItem={inspector.useMenuItem}\n            />\n          ),\n      )}\n    </>\n  )\n}\n","import React, {memo, useCallback, useEffect, useMemo, useRef, useState} from 'react'\nimport {ObjectSchemaType, Path, SanityDocument, SanityDocumentLike} from '@sanity/types'\nimport {omit, set} from 'lodash'\nimport {useToast} from '@sanity/ui'\nimport {fromString as pathFromString, resolveKeyedPath} from '@sanity/util/paths'\nimport isHotkey from 'is-hotkey'\nimport {isActionEnabled} from '@sanity/schema/_internal'\nimport {usePaneRouter} from '../../components'\nimport {PaneMenuItem} from '../../types'\nimport {useDeskTool} from '../../useDeskTool'\nimport {DocumentPaneContext, DocumentPaneContextValue} from './DocumentPaneContext'\nimport {getMenuItems} from './menuItems'\nimport {DocumentPaneProviderProps} from './types'\nimport {usePreviewUrl} from './usePreviewUrl'\nimport {getInitialValueTemplateOpts} from './getInitialValueTemplateOpts'\nimport {\n  DEFAULT_MENU_ITEM_GROUPS,\n  EMPTY_PARAMS,\n  HISTORY_INSPECTOR_NAME,\n  INSPECT_ACTION_PREFIX,\n} from './constants'\nimport {DocumentInspectorMenuItemsResolver} from './DocumentInspectorMenuItemsResolver'\nimport {\n  DocumentInspector,\n  DocumentPresence,\n  PatchEvent,\n  StateTree,\n  toMutationPatches,\n  getExpandOperations,\n  getPublishedId,\n  setAtPath,\n  useConnectionState,\n  useDocumentOperation,\n  useEditState,\n  useFormState,\n  useInitialValue,\n  usePresenceStore,\n  useSchema,\n  useSource,\n  useTemplates,\n  useUnique,\n  useValidationStatus,\n  getDraftId,\n  useDocumentValuePermissions,\n  useTimelineStore,\n  useTimelineSelector,\n  DocumentFieldAction,\n  DocumentInspectorMenuItem,\n  FieldActionsResolver,\n  EMPTY_ARRAY,\n  DocumentFieldActionNode,\n  FieldActionsProvider,\n} from 'sanity'\n\n/**\n * @internal\n */\n// eslint-disable-next-line complexity, max-statements\nexport const DocumentPaneProvider = memo((props: DocumentPaneProviderProps) => {\n  const {children, index, pane, paneKey} = props\n  const schema = useSchema()\n  const templates = useTemplates()\n  const {\n    actions: documentActions,\n    badges: documentBadges,\n    unstable_fieldActions: fieldActionsResolver,\n    unstable_languageFilter: languageFilterResolver,\n    inspectors: inspectorsResolver,\n  } = useSource().document\n  const presenceStore = usePresenceStore()\n  const paneRouter = usePaneRouter()\n  const setPaneParams = paneRouter.setParams\n  const {features} = useDeskTool()\n  const {push: pushToast} = useToast()\n  const {\n    options,\n    menuItemGroups = DEFAULT_MENU_ITEM_GROUPS,\n    title = null,\n    views: viewsProp = [],\n  } = pane\n  const paneOptions = useUnique(options)\n  const documentIdRaw = paneOptions.id\n  const documentId = getPublishedId(documentIdRaw)\n  const documentType = options.type\n  const params = useUnique(paneRouter.params) || EMPTY_PARAMS\n  const panePayload = useUnique(paneRouter.payload)\n  const {templateName, templateParams} = useMemo(\n    () =>\n      getInitialValueTemplateOpts(templates, {\n        documentType,\n        templateName: paneOptions.template,\n        templateParams: paneOptions.templateParameters,\n        panePayload,\n        urlTemplate: params.template,\n      }),\n    [documentType, paneOptions, params, panePayload, templates],\n  )\n  const initialValueRaw = useInitialValue({\n    documentId,\n    documentType,\n    templateName,\n    templateParams,\n  })\n  const initialValue = useUnique(initialValueRaw)\n  const {patch} = useDocumentOperation(documentId, documentType)\n  const editState = useEditState(documentId, documentType)\n  const {validation: validationRaw} = useValidationStatus(documentId, documentType)\n  const connectionState = useConnectionState(documentId, documentType)\n  const schemaType = schema.get(documentType) as ObjectSchemaType | undefined\n  const value: SanityDocumentLike = editState?.draft || editState?.published || initialValue.value\n  const [isDeleting, setIsDeleting] = useState(false)\n\n  const [inspectorMenuItems, setInspectorMenuItems] = useState<DocumentInspectorMenuItem[]>([])\n\n  // Resolve document actions\n  const actions = useMemo(\n    () => documentActions({schemaType: documentType, documentId}),\n    [documentActions, documentId, documentType],\n  )\n\n  // Resolve document badges\n  const badges = useMemo(\n    () => documentBadges({schemaType: documentType, documentId}),\n    [documentBadges, documentId, documentType],\n  )\n\n  // Resolve document language filter\n  const languageFilter = useMemo(\n    () => languageFilterResolver({schemaType: documentType, documentId}),\n    [documentId, documentType, languageFilterResolver],\n  )\n\n  const validation = useUnique(validationRaw)\n  const views = useUnique(viewsProp)\n\n  const [focusPath, setFocusPath] = useState<Path>(() =>\n    params.path ? pathFromString(params.path) : [],\n  )\n  const activeViewId = params.view || (views[0] && views[0].id) || null\n  const [timelineMode, setTimelineMode] = useState<'since' | 'rev' | 'closed'>('closed')\n\n  const [timelineError, setTimelineError] = useState<Error | null>(null)\n  /**\n   * Create an intermediate store which handles document Timeline + TimelineController\n   * creation, and also fetches pre-requsite document snapshots. Compatible with `useSyncExternalStore`\n   * and made available to child components via DocumentPaneContext.\n   */\n  const timelineStore = useTimelineStore({\n    documentId,\n    documentType,\n    onError: setTimelineError,\n    rev: params.rev,\n    since: params.since,\n  })\n\n  // Subscribe to external timeline state changes\n  const onOlderRevision = useTimelineSelector(timelineStore, (state) => state.onOlderRevision)\n  const revTime = useTimelineSelector(timelineStore, (state) => state.revTime)\n  const sinceAttributes = useTimelineSelector(timelineStore, (state) => state.sinceAttributes)\n  const timelineDisplayed = useTimelineSelector(timelineStore, (state) => state.timelineDisplayed)\n  const timelineReady = useTimelineSelector(timelineStore, (state) => state.timelineReady)\n  const isPristine = useTimelineSelector(timelineStore, (state) => state.isPristine)\n\n  /**\n   * Determine if the current document is deleted.\n   *\n   * When the timeline is available – we check for the absence of an editable document pair\n   * (both draft + published versions) as well as a non 'pristine' timeline (i.e. a timeline that consists\n   * of at least one chunk).\n   *\n   * In the _very rare_ case where the timeline cannot be loaded – we skip this check and always assume\n   * the document is NOT deleted. Since we can't accurately determine document deleted status without history,\n   * skipping this check means that in these cases, users will at least be able to create new documents\n   * without them being incorrectly marked as deleted.\n   */\n  const isDeleted = useMemo(() => {\n    if (!timelineReady) {\n      return false\n    }\n    return Boolean(!editState?.draft && !editState?.published) && !isPristine\n  }, [editState?.draft, editState?.published, isPristine, timelineReady])\n\n  // TODO: this may cause a lot of churn. May be a good idea to prevent these\n  // requests unless the menu is open somehow\n  const previewUrl = usePreviewUrl(value)\n\n  const [presence, setPresence] = useState<DocumentPresence[]>([])\n  useEffect(() => {\n    const subscription = presenceStore.documentPresence(documentId).subscribe((nextPresence) => {\n      setPresence(nextPresence)\n    })\n    return () => {\n      subscription.unsubscribe()\n    }\n  }, [documentId, presenceStore])\n\n  const inspectors: DocumentInspector[] = useMemo(\n    () => inspectorsResolver({documentId, documentType}),\n    [documentId, documentType, inspectorsResolver],\n  )\n\n  const [inspectorName, setInspectorName] = useState<string | null>(() => params.inspect || null)\n\n  // Handle inspector name changes from URL\n  const inspectParamRef = useRef<string | undefined>(params.inspect)\n  useEffect(() => {\n    if (inspectParamRef.current !== params.inspect) {\n      inspectParamRef.current = params.inspect\n      setInspectorName(params.inspect || null)\n    }\n  }, [params.inspect])\n\n  const currentInspector = inspectors?.find((i) => i.name === inspectorName)\n  const resolvedChangesInspector = inspectors.find((i) => i.name === HISTORY_INSPECTOR_NAME)\n\n  const changesOpen = currentInspector?.name === HISTORY_INSPECTOR_NAME\n\n  const hasValue = Boolean(value)\n  const menuItems = useMemo(\n    () =>\n      getMenuItems({\n        currentInspector,\n        features,\n        hasValue,\n        inspectorMenuItems,\n        inspectors,\n        previewUrl,\n      }),\n    [currentInspector, features, hasValue, inspectorMenuItems, inspectors, previewUrl],\n  )\n  const inspectOpen = params.inspect === 'on'\n  const compareValue: Partial<SanityDocument> | null = changesOpen\n    ? sinceAttributes\n    : editState?.published || null\n\n  const fieldActions: DocumentFieldAction[] = useMemo(\n    () => (schemaType ? fieldActionsResolver({documentId, documentType, schemaType}) : []),\n    [documentId, documentType, fieldActionsResolver, schemaType],\n  )\n\n  /**\n   * Note that in addition to connection and edit state, we also wait for a valid document timeline\n   * range to be loaded. This means if we're loading an older revision, the full transaction range must\n   * be loaded in full prior to the document being displayed.\n   *\n   * Previously, visiting studio URLs with timeline params would display the 'current' document and then\n   * 'snap' in the older revision, which was disorienting and could happen mid-edit.\n   *\n   * In the event that the timeline cannot be loaded due to TimelineController errors or blocked requests,\n   * we skip this readiness check to ensure that users aren't locked out of editing. Trying to select\n   * a timeline revision in this instance will display an error localized to the popover itself.\n   */\n  const ready =\n    connectionState === 'connected' && editState.ready && (timelineReady || !!timelineError)\n\n  const displayed: Partial<SanityDocument> | undefined = useMemo(\n    () => (onOlderRevision ? timelineDisplayed || {_id: value._id, _type: value._type} : value),\n    [onOlderRevision, timelineDisplayed, value],\n  )\n\n  const setTimelineRange = useCallback(\n    (newSince: string, newRev: string | null) => {\n      setPaneParams({\n        ...params,\n        since: newSince,\n        rev: newRev || undefined,\n      })\n    },\n    [params, setPaneParams],\n  )\n\n  const handleFocus = useCallback(\n    (nextFocusPath: Path) => {\n      setFocusPath(nextFocusPath)\n      presenceStore.setLocation([\n        {\n          type: 'document',\n          documentId,\n          path: nextFocusPath,\n          lastActiveAt: new Date().toISOString(),\n        },\n      ])\n    },\n    [documentId, presenceStore, setFocusPath],\n  )\n\n  const handleBlur = useCallback(\n    (blurredPath: Path) => {\n      setFocusPath([])\n      // note: we're deliberately not syncing presence here since it would make the user avatar disappear when a\n      // user clicks outside a field without focusing another one\n    },\n    [setFocusPath],\n  )\n\n  const patchRef = useRef<(event: PatchEvent) => void>(() => {\n    throw new Error('Nope')\n  })\n\n  patchRef.current = (event: PatchEvent) => {\n    patch.execute(toMutationPatches(event.patches), initialValue.value)\n  }\n\n  const handleChange = useCallback((event: PatchEvent) => patchRef.current(event), [])\n\n  const closeInspector = useCallback(\n    (closeInspectorName?: string) => {\n      // inspector?: DocumentInspector\n      const inspector = closeInspectorName && inspectors.find((i) => i.name === closeInspectorName)\n\n      if (closeInspectorName && !inspector) {\n        console.warn(`No inspector named \"${closeInspectorName}\"`)\n        return\n      }\n\n      if (!currentInspector) {\n        return\n      }\n\n      if (inspector) {\n        const result = inspector.onClose?.({params}) ?? {params}\n\n        setInspectorName(null)\n        inspectParamRef.current = undefined\n\n        setPaneParams({...result.params, inspect: undefined})\n\n        return\n      }\n\n      if (currentInspector) {\n        const result = currentInspector.onClose?.({params}) ?? {params}\n\n        setInspectorName(null)\n        inspectParamRef.current = undefined\n\n        setPaneParams({...result.params, inspect: undefined})\n      }\n    },\n    [currentInspector, inspectors, params, setPaneParams],\n  )\n\n  const openInspector = useCallback(\n    (nextInspectorName: string, paneParams?: Record<string, string>) => {\n      const nextInspector = inspectors.find((i) => i.name === nextInspectorName)\n\n      if (!nextInspector) {\n        console.warn(`No inspector named \"${nextInspectorName}\"`)\n        return\n      }\n\n      // if the inspector is already open, only update params\n      if (currentInspector?.name === nextInspector.name) {\n        setPaneParams({...params, ...paneParams, inspect: nextInspector.name})\n        return\n      }\n\n      let currentParams = params\n\n      if (currentInspector) {\n        const closeResult = nextInspector.onClose?.({params: currentParams}) ?? {\n          params: currentParams,\n        }\n\n        currentParams = closeResult.params\n      }\n\n      const result = nextInspector.onOpen?.({params: currentParams}) ?? {params: currentParams}\n\n      setInspectorName(nextInspector.name)\n      inspectParamRef.current = nextInspector.name\n\n      setPaneParams({...result.params, ...paneParams, inspect: nextInspector.name})\n    },\n    [currentInspector, inspectors, params, setPaneParams],\n  )\n\n  const handleHistoryClose = useCallback(() => {\n    if (resolvedChangesInspector) {\n      closeInspector(resolvedChangesInspector.name)\n    }\n  }, [closeInspector, resolvedChangesInspector])\n\n  const handleHistoryOpen = useCallback(() => {\n    if (!features.reviewChanges) {\n      return\n    }\n\n    if (resolvedChangesInspector) {\n      openInspector(resolvedChangesInspector.name)\n    }\n  }, [features.reviewChanges, openInspector, resolvedChangesInspector])\n\n  const handlePaneClose = useCallback(() => paneRouter.closeCurrent(), [paneRouter])\n\n  const handlePaneSplit = useCallback(() => paneRouter.duplicateCurrent(), [paneRouter])\n\n  const toggleLegacyInspect = useCallback(\n    (toggle = !inspectOpen) => {\n      if (toggle) {\n        setPaneParams({...params, inspect: 'on'})\n      } else {\n        setPaneParams(omit(params, 'inspect'))\n      }\n    },\n    [inspectOpen, params, setPaneParams],\n  )\n\n  const handleMenuAction = useCallback(\n    (item: PaneMenuItem) => {\n      if (item.action === 'production-preview' && previewUrl) {\n        window.open(previewUrl)\n        return true\n      }\n\n      if (item.action === 'inspect') {\n        toggleLegacyInspect(true)\n        return true\n      }\n\n      if (item.action === 'reviewChanges') {\n        handleHistoryOpen()\n        return true\n      }\n\n      if (typeof item.action === 'string' && item.action.startsWith(INSPECT_ACTION_PREFIX)) {\n        const nextInspectorName = item.action.slice(INSPECT_ACTION_PREFIX.length)\n        const nextInspector = inspectors.find((i) => i.name === nextInspectorName)\n\n        if (nextInspector) {\n          if (nextInspector.name === inspectorName) {\n            closeInspector(nextInspector.name)\n          } else {\n            openInspector(nextInspector.name)\n          }\n          return true\n        }\n      }\n\n      return false\n    },\n    [\n      closeInspector,\n      handleHistoryOpen,\n      inspectorName,\n      inspectors,\n      openInspector,\n      previewUrl,\n      toggleLegacyInspect,\n    ],\n  )\n\n  const handleKeyUp = useCallback(\n    (event: React.KeyboardEvent<HTMLDivElement>) => {\n      for (const item of menuItems) {\n        if (item.shortcut) {\n          if (isHotkey(item.shortcut, event)) {\n            event.preventDefault()\n            event.stopPropagation()\n            handleMenuAction(item)\n            return\n          }\n        }\n      }\n    },\n    [handleMenuAction, menuItems],\n  )\n\n  const handleLegacyInspectClose = useCallback(\n    () => toggleLegacyInspect(false),\n    [toggleLegacyInspect],\n  )\n\n  const [openPath, onSetOpenPath] = useState<Path>([])\n  const [fieldGroupState, onSetFieldGroupState] = useState<StateTree<string>>()\n  const [collapsedPaths, onSetCollapsedPath] = useState<StateTree<boolean>>()\n  const [collapsedFieldSets, onSetCollapsedFieldSets] = useState<StateTree<boolean>>()\n\n  const handleOnSetCollapsedPath = useCallback((path: Path, collapsed: boolean) => {\n    onSetCollapsedPath((prevState) => setAtPath(prevState, path, collapsed))\n  }, [])\n\n  const handleOnSetCollapsedFieldSet = useCallback((path: Path, collapsed: boolean) => {\n    onSetCollapsedFieldSets((prevState) => setAtPath(prevState, path, collapsed))\n  }, [])\n\n  const handleSetActiveFieldGroup = useCallback(\n    (path: Path, groupName: string) =>\n      onSetFieldGroupState((prevState) => setAtPath(prevState, path, groupName)),\n    [],\n  )\n\n  const requiredPermission = value._createdAt ? 'update' : 'create'\n  const liveEdit = Boolean(schemaType?.liveEdit)\n  const docId = value._id ? value._id : 'dummy-id'\n  const docPermissionsInput = useMemo(() => {\n    return {\n      ...value,\n      _id: liveEdit ? getPublishedId(docId) : getDraftId(docId),\n    }\n  }, [liveEdit, value, docId])\n\n  const [permissions, isPermissionsLoading] = useDocumentValuePermissions({\n    document: docPermissionsInput,\n    permission: requiredPermission,\n  })\n\n  const isNonExistent = !value?._id\n\n  const readOnly = useMemo(() => {\n    const hasNoPermission = !isPermissionsLoading && !permissions?.granted\n    const updateActionDisabled = !isActionEnabled(schemaType!, 'update')\n    const createActionDisabled = isNonExistent && !isActionEnabled(schemaType!, 'create')\n    const reconnecting = connectionState === 'reconnecting'\n    const isLocked = editState.transactionSyncLock?.enabled\n\n    return (\n      !ready ||\n      revTime !== null ||\n      hasNoPermission ||\n      updateActionDisabled ||\n      createActionDisabled ||\n      reconnecting ||\n      isLocked ||\n      isDeleting ||\n      isDeleted\n    )\n  }, [\n    connectionState,\n    editState.transactionSyncLock,\n    isNonExistent,\n    isDeleted,\n    isDeleting,\n    isPermissionsLoading,\n    permissions?.granted,\n    ready,\n    revTime,\n    schemaType,\n  ])\n\n  const formState = useFormState(schemaType!, {\n    value: displayed,\n    readOnly,\n    comparisonValue: compareValue,\n    focusPath,\n    openPath,\n    collapsedPaths,\n    presence,\n    validation,\n    collapsedFieldSets,\n    fieldGroupState,\n    changesOpen,\n  })\n\n  const formStateRef = useRef(formState)\n  formStateRef.current = formState\n\n  const setOpenPath = useCallback(\n    (path: Path) => {\n      const ops = getExpandOperations(formStateRef.current!, path)\n      ops.forEach((op) => {\n        if (op.type === 'expandPath') {\n          onSetCollapsedPath((prevState) => setAtPath(prevState, op.path, false))\n        }\n        if (op.type === 'expandFieldSet') {\n          onSetCollapsedFieldSets((prevState) => setAtPath(prevState, op.path, false))\n        }\n        if (op.type === 'setSelectedGroup') {\n          onSetFieldGroupState((prevState) => setAtPath(prevState, op.path, op.groupName))\n        }\n      })\n      onSetOpenPath(path)\n    },\n    [formStateRef],\n  )\n\n  const documentPane: DocumentPaneContextValue = {\n    actions,\n    activeViewId,\n    badges,\n    changesOpen,\n    closeInspector,\n    collapsedFieldSets,\n    collapsedPaths,\n    compareValue,\n    connectionState,\n    displayed,\n    documentId,\n    documentIdRaw,\n    documentType,\n    editState,\n    fieldActions,\n    focusPath,\n    inspector: currentInspector || null,\n    inspectors,\n    menuItems,\n    onBlur: handleBlur,\n    onChange: handleChange,\n    onFocus: handleFocus,\n    onPathOpen: setOpenPath,\n    onHistoryClose: handleHistoryClose,\n    onHistoryOpen: handleHistoryOpen,\n    onInspectClose: handleLegacyInspectClose,\n    onKeyUp: handleKeyUp,\n    onMenuAction: handleMenuAction,\n    onPaneClose: handlePaneClose,\n    onPaneSplit: handlePaneSplit,\n    onSetActiveFieldGroup: handleSetActiveFieldGroup,\n    onSetCollapsedPath: handleOnSetCollapsedPath,\n    onSetCollapsedFieldSet: handleOnSetCollapsedFieldSet,\n    openInspector,\n    index,\n    inspectOpen,\n    validation,\n    menuItemGroups: menuItemGroups || [],\n    paneKey,\n    previewUrl,\n    ready,\n    schemaType: schemaType!,\n    isPermissionsLoading,\n    permissions,\n    setTimelineMode,\n    setTimelineRange,\n    setIsDeleting,\n    isDeleting,\n    isDeleted,\n    timelineError,\n    timelineMode,\n    timelineStore,\n    title,\n    value,\n    views,\n    formState,\n    unstable_languageFilter: languageFilter,\n  }\n\n  useEffect(() => {\n    if (connectionState === 'reconnecting') {\n      pushToast({\n        id: 'sanity/desk/reconnecting',\n        status: 'warning',\n        title: <>Connection lost. Reconnecting…</>,\n      })\n    }\n  }, [connectionState, pushToast])\n\n  // Reset `focusPath` when `documentId` or `params.path` changes\n  useEffect(() => {\n    if (ready && params.path) {\n      const {path, ...restParams} = params\n      const pathFromUrl = resolveKeyedPath(formStateRef.current?.value, pathFromString(path))\n      // Reset focus path when url params path changes\n      setFocusPath(pathFromUrl)\n      setOpenPath(pathFromUrl)\n      // remove the `path`-param from url after we have consumed it as the initial focus path\n      paneRouter.setParams(restParams)\n    }\n  }, [params, documentId, setOpenPath, ready, paneRouter])\n\n  const [rootFieldActionNodes, setRootFieldActionNodes] = useState<DocumentFieldActionNode[]>([])\n\n  return (\n    <DocumentPaneContext.Provider value={documentPane}>\n      {inspectors.length > 0 && (\n        <DocumentInspectorMenuItemsResolver\n          documentId={documentId}\n          documentType={documentType}\n          inspectors={inspectors}\n          onMenuItems={setInspectorMenuItems}\n        />\n      )}\n\n      {/* Resolve root-level field actions */}\n      {fieldActions.length > 0 && schemaType && (\n        <FieldActionsResolver\n          actions={fieldActions}\n          documentId={documentId}\n          documentType={documentType}\n          onActions={setRootFieldActionNodes}\n          path={EMPTY_ARRAY}\n          schemaType={schemaType}\n        />\n      )}\n\n      <FieldActionsProvider actions={rootFieldActionNodes} path={EMPTY_ARRAY}>\n        {children}\n      </FieldActionsProvider>\n    </DocumentPaneContext.Provider>\n  )\n})\n\nDocumentPaneProvider.displayName = 'DocumentPaneProvider'\n","import {SerializePath} from './StructureNodes'\n\n/** @internal */\nexport class SerializeError extends Error {\n  public readonly path: SerializePath\n  public helpId?: HELP_URL\n\n  constructor(\n    message: string,\n    parentPath: SerializePath,\n    pathSegment: string | number | undefined,\n    hint?: string,\n  ) {\n    super(message)\n    const segment = typeof pathSegment === 'undefined' ? '<unknown>' : `${pathSegment}`\n    this.path = (parentPath || []).concat(hint ? `${segment} (${hint})` : segment)\n  }\n\n  withHelpUrl(id: HELP_URL): SerializeError {\n    this.helpId = id\n    return this\n  }\n}\n\n/** @internal */\nexport enum HELP_URL {\n  ID_REQUIRED = 'structure-node-id-required',\n  TITLE_REQUIRED = 'structure-title-required',\n  FILTER_REQUIRED = 'structure-filter-required',\n  INVALID_LIST_ITEM = 'structure-invalid-list-item',\n  COMPONENT_REQUIRED = 'structure-view-component-required',\n  DOCUMENT_ID_REQUIRED = 'structure-document-id-required',\n  DOCUMENT_TYPE_REQUIRED = 'structure-document-type-required',\n  SCHEMA_TYPE_REQUIRED = 'structure-schema-type-required',\n  SCHEMA_TYPE_NOT_FOUND = 'structure-schema-type-not-found',\n  LIST_ITEMS_MUST_BE_ARRAY = 'structure-list-items-must-be-array',\n  QUERY_PROVIDED_FOR_FILTER = 'structure-query-provided-for-filter',\n  ACTION_OR_INTENT_REQUIRED = 'structure-action-or-intent-required',\n  LIST_ITEM_IDS_MUST_BE_UNIQUE = 'structure-list-item-ids-must-be-unique',\n  ACTION_AND_INTENT_MUTUALLY_EXCLUSIVE = 'structure-action-and-intent-mutually-exclusive',\n  API_VERSION_REQUIRED_FOR_CUSTOM_FILTER = 'structure-api-version-required-for-custom-filter',\n}\n","import {SchemaType, SortOrderingItem} from '@sanity/types'\n\nconst IMPLICIT_FIELDS = ['_id', '_type', '_createdAt', '_updatedAt', '_rev']\n\n// Takes a path array and a schema type and builds a GROQ join every time it enters a reference field\nfunction joinReferences(schemaType: SchemaType, path: string[]): string {\n  const [head, ...tail] = path\n\n  if (!('fields' in schemaType)) {\n    return ''\n  }\n\n  const schemaField = schemaType.fields.find((field) => field.name === head)\n  if (!schemaField) {\n    if (!IMPLICIT_FIELDS.includes(head)) {\n      // eslint-disable-next-line no-console\n      console.warn(\n        'The current ordering config targeted the nonexistent field \"%s\" on schema type \"%s\". It should be one of %o',\n        head,\n        schemaType.name,\n        schemaType.fields.map((field) => field.name),\n      )\n    }\n    return ''\n  }\n\n  if ('to' in schemaField.type && schemaField.type.name === 'reference') {\n    const refTypes = schemaField.type.to\n    return `${head}->{${refTypes.map((refType) => joinReferences(refType, tail)).join(',')}}`\n  }\n\n  const tailFields = tail.length > 0 && joinReferences(schemaField.type, tail)\n  const tailWrapper = tailFields ? `{${tailFields}}` : ''\n  return tail.length > 0 ? `${head}${tailWrapper}` : head\n}\n\nexport function getExtendedProjection(schemaType: SchemaType, orderBy: SortOrderingItem[]): string {\n  return orderBy.map((ordering) => joinReferences(schemaType, ordering.field.split('.'))).join(', ')\n}\n","import {SortOrdering} from '@sanity/types'\n\nexport const ORDER_BY_UPDATED_AT: SortOrdering = {\n  title: 'Last edited',\n  name: 'lastEditedDesc',\n  by: [{field: '_updatedAt', direction: 'desc'}],\n}\n\nexport const ORDER_BY_CREATED_AT: SortOrdering = {\n  title: 'Created',\n  name: 'lastCreatedDesc',\n  by: [{field: '_createdAt', direction: 'desc'}],\n}\n\nexport const DEFAULT_SELECTED_ORDERING_OPTION = ORDER_BY_UPDATED_AT\n\nexport const DEFAULT_ORDERING_OPTIONS: SortOrdering[] = [\n  ORDER_BY_UPDATED_AT, // _updatedAt\n  ORDER_BY_CREATED_AT, // _createdAt\n]\n","import {SchemaType, SortOrdering, SortOrderingItem} from '@sanity/types'\nimport {SortIcon} from '@sanity/icons'\nimport {getExtendedProjection} from './util/getExtendedProjection'\nimport {Intent} from './Intent'\nimport {DEFAULT_ORDERING_OPTIONS} from './Sort'\nimport {SerializeOptions, Serializable, SerializePath} from './StructureNodes'\nimport {SerializeError, HELP_URL} from './SerializeError'\nimport {StructureContext} from './types'\n\n/** @internal */\nexport function maybeSerializeMenuItem(\n  item: MenuItem | MenuItemBuilder,\n  index: number,\n  path: SerializePath,\n): MenuItem {\n  return item instanceof MenuItemBuilder ? item.serialize({path, index}) : item\n}\n\n/**\n * Menu item action type\n * @public */\nexport type MenuItemActionType =\n  | string\n  | ((params: Record<string, string> | undefined, scope?: any) => void)\n\n/**\n * Menu items parameters\n *\n * @public */\nexport type MenuItemParamsType = Record<string, string | unknown | undefined>\n\n/**\n * Interface for menu items\n *\n * @public */\nexport interface MenuItem {\n  /** Menu Item title */\n  title: string\n  /** Menu Item action */\n  action?: MenuItemActionType\n  /** Menu Item intent */\n  intent?: Intent\n  /** Menu Item group */\n  group?: string\n  // TODO: align these with TemplateItem['icon']\n  /** Menu Item icon */\n  icon?: React.ComponentType | React.ReactNode\n  /** Menu Item parameters. See {@link MenuItemParamsType} */\n  params?: MenuItemParamsType\n  /** Determine if it will show the MenuItem as action */\n  showAsAction?: boolean\n}\n\n/**\n * Partial menu items\n * @public\n */\nexport type PartialMenuItem = Partial<MenuItem>\n\n/**\n * Class for building menu items.\n *\n * @public */\nexport class MenuItemBuilder implements Serializable<MenuItem> {\n  /** menu item option object. See {@link PartialMenuItem} */\n  protected spec: PartialMenuItem\n\n  constructor(\n    /**\n     * Desk structure context. See {@link StructureContext}\n     */\n    protected _context: StructureContext,\n    spec?: MenuItem,\n  ) {\n    this.spec = spec ? spec : {}\n  }\n\n  /**\n   * Set menu item action\n   * @param action - menu item action. See {@link MenuItemActionType}\n   * @returns menu item builder based on action provided. See {@link MenuItemBuilder}\n   */\n  action(action: MenuItemActionType): MenuItemBuilder {\n    return this.clone({action})\n  }\n\n  /**\n   * Get menu item action\n   * @returns menu item builder action. See {@link PartialMenuItem}\n   */\n  getAction(): PartialMenuItem['action'] {\n    return this.spec.action\n  }\n\n  /**\n   * Set menu item intent\n   * @param intent - menu item intent. See {@link Intent}\n   * @returns menu item builder based on intent provided. See {@link MenuItemBuilder}\n   */\n  intent(intent: Intent): MenuItemBuilder {\n    return this.clone({intent})\n  }\n\n  /**\n   * Get menu item intent\n   * @returns menu item intent. See {@link PartialMenuItem}\n   */\n  getIntent(): PartialMenuItem['intent'] {\n    return this.spec.intent\n  }\n\n  /**\n   * Set menu item title\n   * @param title - menu item title\n   * @returns menu item builder based on title provided. See {@link MenuItemBuilder}\n   */\n  title(title: string): MenuItemBuilder {\n    return this.clone({title})\n  }\n\n  /**\n   * Get menu item title\n   * @returns menu item title\n   */\n  getTitle(): string | undefined {\n    return this.spec.title\n  }\n\n  /**\n   * Set menu item group\n   * @param group - menu item group\n   * @returns menu item builder based on group provided. See {@link MenuItemBuilder}\n   */\n  group(group: string): MenuItemBuilder {\n    return this.clone({group})\n  }\n\n  /**\n   * Get menu item group\n   * @returns menu item group. See {@link PartialMenuItem}\n   */\n  getGroup(): PartialMenuItem['group'] {\n    return this.spec.group\n  }\n\n  /**\n   * Set menu item icon\n   * @param icon - menu item icon\n   * @returns menu item builder based on icon provided. See {@link MenuItemBuilder}\n   */\n  icon(icon: React.ComponentType | React.ReactNode): MenuItemBuilder {\n    return this.clone({icon})\n  }\n\n  /**\n   * Get menu item icon\n   * @returns menu item icon. See {@link PartialMenuItem}\n   */\n  getIcon(): PartialMenuItem['icon'] {\n    return this.spec.icon\n  }\n\n  /**\n   * Set menu item parameters\n   * @param params - menu item parameters. See {@link MenuItemParamsType}\n   * @returns menu item builder based on parameters provided. See {@link MenuItemBuilder}\n   */\n  params(params: MenuItemParamsType): MenuItemBuilder {\n    return this.clone({params})\n  }\n\n  /**\n   * Get meny item parameters\n   * @returns menu item parameters. See {@link PartialMenuItem}\n   */\n  getParams(): PartialMenuItem['params'] {\n    return this.spec.params\n  }\n\n  /**\n   * Set menu item to show as action\n   * @param showAsAction - determine if menu item should show as action\n   * @returns menu item builder based on if it should show as action. See {@link MenuItemBuilder}\n   */\n  showAsAction(showAsAction = true): MenuItemBuilder {\n    return this.clone({showAsAction: Boolean(showAsAction)})\n  }\n\n  /**\n   * Check if menu item should show as action\n   * @returns true if menu item should show as action, false if not. See {@link PartialMenuItem}\n   */\n  getShowAsAction(): PartialMenuItem['showAsAction'] {\n    return this.spec.showAsAction\n  }\n\n  /** Serialize menu item builder\n   * @param options - serialization options. See {@link SerializeOptions}\n   * @returns menu item node based on path provided in options. See {@link MenuItem}\n   */\n  serialize(options: SerializeOptions = {path: []}): MenuItem {\n    const {title, action, intent} = this.spec\n    if (!title) {\n      const hint = typeof action === 'string' ? `action: \"${action}\"` : undefined\n      throw new SerializeError(\n        '`title` is required for menu item',\n        options.path,\n        options.index,\n        hint,\n      ).withHelpUrl(HELP_URL.TITLE_REQUIRED)\n    }\n\n    if (!action && !intent) {\n      throw new SerializeError(\n        `\\`action\\` or \\`intent\\` required for menu item with title ${this.spec.title}`,\n        options.path,\n        options.index,\n        `\"${title}\"`,\n      ).withHelpUrl(HELP_URL.ACTION_OR_INTENT_REQUIRED)\n    }\n\n    if (intent && action) {\n      throw new SerializeError(\n        'cannot set both `action` AND `intent`',\n        options.path,\n        options.index,\n        `\"${title}\"`,\n      ).withHelpUrl(HELP_URL.ACTION_AND_INTENT_MUTUALLY_EXCLUSIVE)\n    }\n\n    return {...this.spec, title}\n  }\n\n  /** Clone menu item builder\n   * @param withSpec - menu item options. See {@link PartialMenuItem}\n   * @returns menu item builder based on context and spec provided. See {@link MenuItemBuilder}\n   */\n  clone(withSpec?: PartialMenuItem): MenuItemBuilder {\n    const builder = new MenuItemBuilder(this._context)\n    builder.spec = {...this.spec, ...(withSpec || {})}\n    return builder\n  }\n}\n\n/** @internal */\nexport interface SortMenuItem extends MenuItem {\n  params: {\n    by: SortOrderingItem[]\n  }\n}\n\n/** @internal */\nexport function getOrderingMenuItem(\n  context: StructureContext,\n  ordering: SortOrdering,\n  extendedProjection?: string,\n): MenuItemBuilder {\n  return new MenuItemBuilder(context)\n    .group('sorting')\n    .title(`Sort by ${ordering.title}`)\n    .icon(SortIcon)\n    .action('setSortOrder')\n    .params({by: ordering.by, extendedProjection})\n}\n\n/** @internal */\nexport function getOrderingMenuItemsForSchemaType(\n  context: StructureContext,\n  typeName: SchemaType | string,\n): MenuItemBuilder[] {\n  const {schema} = context\n  const type = typeof typeName === 'string' ? schema.get(typeName) : typeName\n  if (!type || !('orderings' in type)) {\n    return []\n  }\n\n  return (\n    type.orderings ? type.orderings.concat(DEFAULT_ORDERING_OPTIONS) : DEFAULT_ORDERING_OPTIONS\n  ).map((ordering: SortOrdering) =>\n    getOrderingMenuItem(context, ordering, getExtendedProjection(type, ordering.by)),\n  )\n}\n","import {SerializeOptions, Serializable, SerializePath} from './StructureNodes'\nimport {SerializeError, HELP_URL} from './SerializeError'\nimport {StructureContext} from './types'\n\n/** @internal */\nexport function maybeSerializeMenuItemGroup(\n  item: MenuItemGroup | MenuItemGroupBuilder,\n  index: number,\n  path: SerializePath,\n): MenuItemGroup {\n  return item instanceof MenuItemGroupBuilder ? item.serialize({path, index}) : item\n}\n\n/**\n * Interface for menu item groups\n * @public\n */\nexport interface MenuItemGroup {\n  /** Menu group Id */\n  id: string\n  /** Menu group title */\n  title: string\n}\n\n/**\n * Class for building menu item groups.\n *\n * @public\n */\nexport class MenuItemGroupBuilder implements Serializable<MenuItemGroup> {\n  /** Menu item group ID */\n  protected _id: string\n  /** Menu item group title */\n  protected _title: string\n\n  constructor(\n    /**\n     * Desk structure context. See {@link StructureContext}\n     */\n    protected _context: StructureContext,\n    spec?: MenuItemGroup,\n  ) {\n    this._id = spec ? spec.id : ''\n    this._title = spec ? spec.title : ''\n  }\n\n  /**\n   * Set menu item group ID\n   * @param id - menu item group ID\n   * @returns menu item group builder based on ID provided. See {@link MenuItemGroupBuilder}\n   */\n  id(id: string): MenuItemGroupBuilder {\n    return new MenuItemGroupBuilder(this._context, {id, title: this._title})\n  }\n\n  /**\n   * Get menu item group ID\n   * @returns menu item group ID\n   */\n  getId(): string {\n    return this._id\n  }\n\n  /**\n   * Set menu item group title\n   * @param title - menu item group title\n   * @returns menu item group builder based on title provided. See {@link MenuItemGroupBuilder}\n   */\n  title(title: string): MenuItemGroupBuilder {\n    return new MenuItemGroupBuilder(this._context, {id: this._id, title})\n  }\n\n  /**\n   * Get menu item group title\n   * @returns menu item group title\n   */\n  getTitle(): string {\n    return this._title\n  }\n\n  /**\n   * Serialize menu item group builder\n   * @param options - serialization options (path). See {@link SerializeOptions}\n   * @returns menu item group based on path provided in options. See {@link MenuItemGroup}\n   */\n  serialize(options: SerializeOptions = {path: []}): MenuItemGroup {\n    const {_id, _title} = this\n    if (!_id) {\n      throw new SerializeError(\n        '`id` is required for a menu item group',\n        options.path,\n        options.index,\n        _title,\n      ).withHelpUrl(HELP_URL.ID_REQUIRED)\n    }\n\n    if (!_title) {\n      throw new SerializeError(\n        '`title` is required for a menu item group',\n        options.path,\n        _id,\n      ).withHelpUrl(HELP_URL.TITLE_REQUIRED)\n    }\n\n    return {\n      id: _id,\n      title: _title,\n    }\n  }\n}\n","import {SerializeError} from '../SerializeError'\nimport {SerializePath} from '../StructureNodes'\n\nexport const disallowedPattern = /([^A-Za-z0-9-_.])/\n\nexport function validateId(\n  id: string,\n  parentPath: SerializePath,\n  pathSegment: string | number | undefined,\n): string {\n  if (typeof id !== 'string') {\n    throw new SerializeError(\n      `Structure node id must be of type string, got ${typeof id}`,\n      parentPath,\n      pathSegment,\n    )\n  }\n\n  const [disallowedChar] = id.match(disallowedPattern) || []\n  if (disallowedChar) {\n    throw new SerializeError(\n      `Structure node id cannot contain character \"${disallowedChar}\"`,\n      parentPath,\n      pathSegment,\n    )\n  }\n\n  if (id.startsWith('__edit__')) {\n    throw new SerializeError(\n      `Structure node id cannot start with __edit__`,\n      parentPath,\n      pathSegment,\n    )\n  }\n\n  return id\n}\n","import {camelCase} from 'lodash'\nimport getSlug from 'speakingurl'\nimport {disallowedPattern} from './validateId'\n\nexport function getStructureNodeId(title: string, id?: string): string {\n  if (id) {\n    return id\n  }\n\n  const camelCased = camelCase(title)\n\n  return disallowedPattern.test(camelCased) ? camelCase(getSlug(title)) : camelCased\n}\n","import {SerializeOptions, StructureNode, Serializable, Child} from './StructureNodes'\nimport {SerializeError, HELP_URL} from './SerializeError'\nimport {MenuItem, MenuItemBuilder, maybeSerializeMenuItem} from './MenuItem'\nimport {MenuItemGroup, MenuItemGroupBuilder, maybeSerializeMenuItemGroup} from './MenuItemGroup'\nimport {validateId} from './util/validateId'\nimport {UserComponent} from './types'\nimport {getStructureNodeId} from './util/getStructureNodeId'\n\n/**\n * Interface for component\n *\n * @public\n */\n// TODO: rename to `StructureComponent` since it clashes with React?\nexport interface Component extends StructureNode {\n  /** Component of type {@link UserComponent} */\n  component: UserComponent\n  /** Component child of type {@link Child} */\n  child?: Child\n  /** Component menu items, array of type {@link MenuItem} */\n  menuItems: MenuItem[]\n  /** Component menu item group, array of type {@link MenuItemGroup} */\n  menuItemGroups: MenuItemGroup[]\n  /** Component options */\n  options: {[key: string]: unknown}\n}\n\n/**\n * Interface for component input\n *\n * @public\n */\nexport interface ComponentInput extends StructureNode {\n  /** Component of type {@link UserComponent} */\n  component: UserComponent\n  /** Component child of type {@link Child} */\n  child?: Child\n  /** Component options */\n  options?: {[key: string]: unknown}\n  /** Component menu items. See {@link MenuItem} and {@link MenuItemBuilder}  */\n  menuItems?: (MenuItem | MenuItemBuilder)[]\n  /** Component menu item groups. See {@link MenuItemGroup} and {@link MenuItemGroupBuilder} */\n  menuItemGroups?: (MenuItemGroup | MenuItemGroupBuilder)[]\n}\n\n/**\n * Interface for buildable component\n *\n * @public\n */\nexport interface BuildableComponent extends Partial<StructureNode> {\n  /** Component of type {@link UserComponent} */\n  component?: UserComponent\n  /** Component child of type {@link Child} */\n  child?: Child\n  /** Component options */\n  options?: {[key: string]: unknown}\n  /** Component menu items. See {@link MenuItem} and {@link MenuItemBuilder}  */\n  menuItems?: (MenuItem | MenuItemBuilder)[]\n  /** Component menu item groups. See {@link MenuItemGroup} and {@link MenuItemGroupBuilder} */\n  menuItemGroups?: (MenuItemGroup | MenuItemGroupBuilder)[]\n}\n\n/**\n * Class for building components\n *\n * @public\n */\nexport class ComponentBuilder implements Serializable<Component> {\n  /** component builder option object */\n  protected spec: BuildableComponent\n\n  constructor(spec?: ComponentInput) {\n    this.spec = {options: {}, ...(spec ? spec : {})}\n  }\n\n  /** Set Component ID\n   * @param id - component ID\n   * @returns component builder based on ID provided\n   */\n  id(id: string): ComponentBuilder {\n    return this.clone({id})\n  }\n\n  /** Get ID\n   * @returns ID\n   */\n  getId(): BuildableComponent['id'] {\n    return this.spec.id\n  }\n\n  /** Set Component title\n   * @param title - component title\n   * @returns component builder based on title provided (and ID)\n   */\n  title(title: string): ComponentBuilder {\n    return this.clone({title, id: getStructureNodeId(title, this.spec.id)})\n  }\n\n  /** Get Component title\n   * @returns title\n   */\n  getTitle(): BuildableComponent['title'] {\n    return this.spec.title\n  }\n\n  /** Set Component child\n   * @param child - child component\n   * @returns component builder based on child component provided\n   */\n  child(child: Child): ComponentBuilder {\n    return this.clone({child})\n  }\n\n  /** Get Component child\n   * @returns child component\n   */\n  getChild(): BuildableComponent['child'] {\n    return this.spec.child\n  }\n\n  /** Set component\n   * @param component - user built component\n   * @returns component builder based on component provided\n   */\n  component(component: UserComponent): ComponentBuilder {\n    return this.clone({component})\n  }\n\n  /** Get Component\n   * @returns component\n   */\n  getComponent(): BuildableComponent['component'] {\n    return this.spec.component\n  }\n\n  /** Set Component options\n   * @param options - component options\n   * @returns component builder based on options provided\n   */\n  options(options: {[key: string]: unknown}): ComponentBuilder {\n    return this.clone({options})\n  }\n\n  /** Get Component options\n   * @returns component options\n   */\n  getOptions(): NonNullable<BuildableComponent['options']> {\n    return this.spec.options || {}\n  }\n\n  /** Set Component menu items\n   * @param menuItems - component menu items\n   * @returns component builder based on menuItems provided\n   */\n  menuItems(menuItems: (MenuItem | MenuItemBuilder)[]): ComponentBuilder {\n    return this.clone({menuItems})\n  }\n\n  /** Get Component menu items\n   * @returns menu items\n   */\n  getMenuItems(): BuildableComponent['menuItems'] {\n    return this.spec.menuItems\n  }\n\n  /** Set Component menu item groups\n   * @param menuItemGroups - component menu item groups\n   * @returns component builder based on menuItemGroups provided\n   */\n  menuItemGroups(menuItemGroups: (MenuItemGroup | MenuItemGroupBuilder)[]): ComponentBuilder {\n    return this.clone({menuItemGroups})\n  }\n\n  /** Get Component menu item groups\n   * @returns menu item groups\n   */\n  getMenuItemGroups(): BuildableComponent['menuItemGroups'] {\n    return this.spec.menuItemGroups\n  }\n\n  /** Serialize component\n   * @param options - serialization options\n   * @returns component object based on path provided in options\n   *\n   */\n  serialize(options: SerializeOptions = {path: []}): Component {\n    const {id, title, child, options: componentOptions, component} = this.spec\n    if (!id) {\n      throw new SerializeError(\n        '`id` is required for `component` structure item',\n        options.path,\n        options.index,\n      ).withHelpUrl(HELP_URL.ID_REQUIRED)\n    }\n\n    if (!component) {\n      throw new SerializeError(\n        '`component` is required for `component` structure item',\n        options.path,\n        options.index,\n      ).withHelpUrl(HELP_URL.ID_REQUIRED)\n    }\n\n    return {\n      id: validateId(id, options.path, options.index),\n      title,\n      type: 'component',\n      child,\n      component,\n      options: componentOptions || {},\n      menuItems: (this.spec.menuItems || []).map((item, i) =>\n        maybeSerializeMenuItem(item, i, options.path),\n      ),\n      menuItemGroups: (this.spec.menuItemGroups || []).map((item, i) =>\n        maybeSerializeMenuItemGroup(item, i, options.path),\n      ),\n    }\n  }\n\n  /** Clone component builder (allows for options overriding)\n   * @param withSpec - component builder options\n   * @returns cloned builder\n   */\n  clone(withSpec?: BuildableComponent): ComponentBuilder {\n    const builder = new ComponentBuilder()\n    builder.spec = {...this.spec, ...(withSpec || {})}\n    return builder\n  }\n}\n","import type {SanityClient} from '@sanity/client'\nimport {\n  DEFAULT_STUDIO_CLIENT_OPTIONS,\n  getDraftId,\n  getPublishedId,\n  type SourceClientOptions,\n} from 'sanity'\n\nexport async function resolveTypeForDocument(\n  getClient: (options: SourceClientOptions) => SanityClient,\n  id: string,\n): Promise<string | undefined> {\n  const query = '*[_id in [$documentId, $draftId]]._type'\n  const documentId = getPublishedId(id)\n  const draftId = getDraftId(id)\n\n  const types = await getClient(DEFAULT_STUDIO_CLIENT_OPTIONS).fetch(\n    query,\n    {documentId, draftId},\n    {tag: 'structure.resolve-type'},\n  )\n\n  return types[0]\n}\n","import {kebabCase} from 'lodash'\nimport {Serializable, SerializeOptions, SerializePath} from '../StructureNodes'\nimport {HELP_URL, SerializeError} from '../SerializeError'\nimport {validateId} from '../util/validateId'\nimport {View} from '../types'\nimport {ComponentViewBuilder} from './ComponentView'\nimport {FormViewBuilder} from './FormView'\n\n/**\n * Interface for base view\n *\n * @public */\nexport interface BaseView {\n  /** View id */\n  id: string\n  /** View Title */\n  title: string\n  /** View Icon */\n  icon?: React.ComponentType | React.ReactNode\n}\n\n/**\n * Class for building generic views.\n *\n * @public\n */\nexport abstract class GenericViewBuilder<TView extends Partial<BaseView>, ConcreteImpl>\n  implements Serializable<BaseView>\n{\n  /** Generic view option object */\n  protected spec: TView = {} as TView\n\n  /** Set generic view ID\n   * @param id - generic view ID\n   * @returns generic view builder based on ID provided.\n   */\n  id(id: string): ConcreteImpl {\n    return this.clone({id})\n  }\n  /** Get generic view ID\n   * @returns generic view ID\n   */\n  getId(): TView['id'] {\n    return this.spec.id\n  }\n\n  /** Set generic view title\n   * @param title - generic view title\n   * @returns generic view builder based on title provided and (if provided) its ID.\n   */\n  title(title: string): ConcreteImpl {\n    return this.clone({title, id: this.spec.id || kebabCase(title)})\n  }\n\n  /** Get generic view title\n   * @returns generic view title\n   */\n  getTitle(): TView['title'] {\n    return this.spec.title\n  }\n\n  /** Set generic view icon\n   * @param icon - generic view icon\n   * @returns generic view builder based on icon provided.\n   */\n  icon(icon: React.ComponentType | React.ReactNode): ConcreteImpl {\n    return this.clone({icon})\n  }\n\n  /** Get generic view icon\n   * @returns generic view icon\n   */\n  getIcon(): TView['icon'] {\n    return this.spec.icon\n  }\n\n  /** Serialize generic view\n   * @param options - serialization options. See {@link SerializeOptions}\n   * @returns generic view object based on path provided in options. See {@link BaseView}\n   */\n  serialize(options: SerializeOptions = {path: []}): BaseView {\n    const {id, title, icon} = this.spec\n    if (!id) {\n      throw new SerializeError(\n        '`id` is required for view item',\n        options.path,\n        options.index,\n      ).withHelpUrl(HELP_URL.ID_REQUIRED)\n    }\n\n    if (!title) {\n      throw new SerializeError(\n        '`title` is required for view item',\n        options.path,\n        options.index,\n      ).withHelpUrl(HELP_URL.TITLE_REQUIRED)\n    }\n\n    return {\n      id: validateId(id, options.path, options.index),\n      title,\n      icon,\n    }\n  }\n\n  /** Clone generic view builder (allows for options overriding)\n   * @param withSpec - Partial generic view builder options. See {@link BaseView}\n   * @returns Generic view builder.\n   */\n  abstract clone(withSpec?: Partial<BaseView>): ConcreteImpl\n}\n\nfunction isSerializable(view: BaseView | Serializable<BaseView>): view is Serializable<BaseView> {\n  return typeof (view as Serializable<BaseView>).serialize === 'function'\n}\n\n/** @internal */\nexport function maybeSerializeView(\n  item: View | Serializable<View>,\n  index: number,\n  path: SerializePath,\n): View {\n  return isSerializable(item) ? item.serialize({path, index}) : item\n}\n\n/**\n * View builder. See {@link ComponentViewBuilder} and {@link FormViewBuilder}\n *\n * @public\n */\nexport type ViewBuilder = ComponentViewBuilder | FormViewBuilder\n","import {SerializeOptions} from '../StructureNodes'\nimport {SerializeError, HELP_URL} from '../SerializeError'\nimport type {UserViewComponent} from '../types'\nimport {BaseView, GenericViewBuilder} from './View'\nimport {isRecord} from 'sanity'\n\n/**\n * Interface for component views.\n *\n * @public */\nexport interface ComponentView<TOptions = Record<string, any>> extends BaseView {\n  type: 'component'\n  /** Component view components. See {@link UserViewComponent} */\n  component: UserViewComponent\n  /** Component view options */\n  options: TOptions\n}\n\nconst isComponentSpec = (spec: unknown): spec is ComponentView =>\n  isRecord(spec) && spec.type === 'component'\n\n/**\n * Class for building a component view.\n *\n * @public */\nexport class ComponentViewBuilder extends GenericViewBuilder<\n  Partial<ComponentView>,\n  ComponentViewBuilder\n> {\n  /** Partial Component view option object. See {@link ComponentView} */\n  protected spec: Partial<ComponentView>\n\n  constructor(\n    /**\n     * Component view component or spec\n     * @param componentOrSpec - user view component or partial component view. See {@link UserViewComponent} and {@link ComponentView}\n     */\n    componentOrSpec?: UserViewComponent | Partial<ComponentView>,\n  ) {\n    const spec = isComponentSpec(componentOrSpec) ? {...componentOrSpec} : {options: {}}\n\n    super()\n    this.spec = spec\n\n    const userComponent =\n      typeof componentOrSpec === 'function' ? componentOrSpec : this.spec.component\n\n    if (userComponent) {\n      // Because we're cloning, this'll return a new instance, so grab the spec from it\n      this.spec = this.component(userComponent).spec\n    }\n  }\n\n  /** Set view Component\n   * @param component - component view component. See {@link UserViewComponent}\n   * @returns component view builder based on component view provided. See {@link ComponentViewBuilder}\n   */\n  component(component: UserViewComponent): ComponentViewBuilder {\n    return this.clone({component})\n  }\n\n  /** Get view Component\n   * @returns Partial component view. See {@link ComponentView}\n   */\n  getComponent(): Partial<ComponentView>['component'] {\n    return this.spec.component\n  }\n\n  /** Set view Component options\n   * @param options - component view options\n   * @returns component view builder based on options provided. See {@link ComponentViewBuilder}\n   */\n  options(options: {[key: string]: any}): ComponentViewBuilder {\n    return this.clone({options})\n  }\n\n  /** Get view Component options\n   * @returns component view options. See {@link ComponentView}\n   */\n  getOptions(): ComponentView['options'] {\n    return this.spec.options || {}\n  }\n\n  /** Serialize view Component\n   * @param options - serialization options. See {@link SerializeOptions}\n   * @returns component view based on path provided in options. See {@link ComponentView}\n   *\n   */\n  serialize(options: SerializeOptions = {path: []}): ComponentView {\n    const base = super.serialize(options)\n\n    const component = this.spec.component\n    if (typeof component !== 'function') {\n      throw new SerializeError(\n        '`component` is required and must be a function for `component()` view item',\n        options.path,\n        options.index,\n      ).withHelpUrl(HELP_URL.COMPONENT_REQUIRED)\n    }\n\n    return {\n      ...base,\n      component,\n      options: this.spec.options || {},\n      type: 'component',\n    }\n  }\n\n  /** Clone Component view builder (allows for options overriding)\n   * @param withSpec - partial for component view option. See {@link ComponentView}\n   * @returns component view builder. See {@link ComponentViewBuilder}\n   */\n  clone(withSpec?: Partial<ComponentView>): ComponentViewBuilder {\n    const builder = new ComponentViewBuilder()\n    builder.spec = {...this.spec, ...(withSpec || {})}\n    return builder\n  }\n}\n","import {SerializeOptions} from '../StructureNodes'\nimport {BaseView, GenericViewBuilder} from './View'\n\n/**\n * Interface for form views.\n *\n * @public */\nexport interface FormView extends BaseView {\n  type: 'form'\n}\n\n/**\n * Class for building a form view.\n *\n * @public */\nexport class FormViewBuilder extends GenericViewBuilder<Partial<BaseView>, FormViewBuilder> {\n  /** Document list options. See {@link FormView} */\n  protected spec: Partial<FormView>\n\n  constructor(spec?: Partial<FormView>) {\n    super()\n    this.spec = {id: 'editor', title: 'Editor', ...(spec ? spec : {})}\n  }\n\n  /**\n   * Serialize Form view builder\n   * @param options - Serialize options. See {@link SerializeOptions}\n   * @returns form view builder based on path provided in options. See {@link FormView}\n   */\n  serialize(options: SerializeOptions = {path: []}): FormView {\n    return {\n      ...super.serialize(options),\n      type: 'form',\n    }\n  }\n\n  /**\n   * Clone Form view builder (allows for options overriding)\n   * @param withSpec - Partial form view builder options. See {@link FormView}\n   * @returns form view builder. See {@link FormViewBuilder}\n   */\n  clone(withSpec?: Partial<FormView>): FormViewBuilder {\n    const builder = new FormViewBuilder()\n    builder.spec = {...this.spec, ...(withSpec || {})}\n    return builder\n  }\n}\n","import type {UserViewComponent} from '../types'\nimport {ComponentView, ComponentViewBuilder} from './ComponentView'\nimport {FormView, FormViewBuilder} from './FormView'\n\nexport * from './FormView'\nexport * from './ComponentView'\nexport * from './View'\n\n/** @internal */\nexport const form = (spec?: Partial<FormView>): FormViewBuilder => new FormViewBuilder(spec)\n\n/** @internal */\nexport const component = (\n  componentOrSpec?: UserViewComponent | Partial<ComponentView>,\n): ComponentViewBuilder => new ComponentViewBuilder(componentOrSpec)\n","import {uniq} from 'lodash'\nimport {SchemaType} from '@sanity/types'\nimport {resolveTypeForDocument} from './util/resolveTypeForDocument'\nimport {ChildResolver} from './ChildResolver'\nimport {SerializeOptions, Serializable, Child, DocumentNode, EditorNode} from './StructureNodes'\nimport {SerializeError, HELP_URL} from './SerializeError'\nimport {validateId} from './util/validateId'\nimport {ViewBuilder, maybeSerializeView} from './views/View'\nimport {form} from './views'\nimport type {StructureContext, View} from './types'\nimport {getStructureNodeId} from './util/getStructureNodeId'\n\nconst createDocumentChildResolver =\n  ({resolveDocumentNode, getClient}: StructureContext): ChildResolver =>\n  async (itemId, {params, path}) => {\n    let type = params.type\n\n    const parentPath = path.slice(0, path.length - 1)\n    const currentSegment = path[path.length - 1]\n\n    if (!type) {\n      type = await resolveTypeForDocument(getClient, itemId)\n    }\n\n    if (!type) {\n      throw new SerializeError(\n        `Failed to resolve document, and no type provided in parameters.`,\n        parentPath,\n        currentSegment,\n      )\n    }\n\n    return resolveDocumentNode({documentId: itemId, schemaType: type})\n  }\n\n/**\n * Interface for options of Partial Documents. See {@link PartialDocumentNode}\n *\n * @public */\nexport interface DocumentOptions {\n  /** Document Id */\n  id: string\n  /** Document Type */\n  type: string\n  /** Document Template */\n  template?: string\n  /** Template parameters */\n  templateParameters?: Record<string, unknown>\n}\n\n/**\n * Interface for partial document (focused on the document pane)\n *\n * @public */\nexport interface PartialDocumentNode {\n  /** Document Id */\n  id?: string\n  /** Document title */\n  title?: string\n  /** Document children of type {@link Child} */\n  child?: Child\n  /**\n   * Views for the document pane. See {@link ViewBuilder} and {@link View}\n   */\n  views?: (View | ViewBuilder)[]\n  /**\n   * Document options. See {@link DocumentOptions}\n   */\n  options?: Partial<DocumentOptions>\n}\n\n/**\n * A `DocumentBuilder` is used to build a document node.\n *\n * @public */\nexport class DocumentBuilder implements Serializable<DocumentNode> {\n  /** Component builder option object See {@link PartialDocumentNode} */\n  protected spec: PartialDocumentNode\n\n  constructor(\n    /**\n     * Desk structure context. See {@link StructureContext}\n     */\n    protected _context: StructureContext,\n    spec?: PartialDocumentNode,\n  ) {\n    this.spec = spec ? spec : {}\n  }\n\n  /** Set Document Builder ID\n   * @param id - document builder ID\n   * @returns document builder based on ID provided. See {@link DocumentBuilder}\n   */\n  id(id: string): DocumentBuilder {\n    return this.clone({id})\n  }\n\n  /** Get Document Builder ID\n   * @returns document ID. See {@link PartialDocumentNode}\n   */\n  getId(): PartialDocumentNode['id'] {\n    return this.spec.id\n  }\n\n  /** Set Document title\n   * @param title - document title\n   * @returns document builder based on title provided (and ID). See {@link DocumentBuilder}\n   */\n  title(title: string): DocumentBuilder {\n    return this.clone({title, id: getStructureNodeId(title, this.spec.id)})\n  }\n\n  /** Get Document title\n   * @returns document title. See {@link PartialDocumentNode}\n   */\n  getTitle(): PartialDocumentNode['title'] {\n    return this.spec.title\n  }\n\n  /** Set Document child\n   * @param child - document child\n   * @returns document builder based on child provided. See {@link DocumentBuilder}\n   */\n  child(child: Child): DocumentBuilder {\n    return this.clone({child})\n  }\n\n  /** Get Document child\n   * @returns document child. See {@link PartialDocumentNode}\n   */\n  getChild(): PartialDocumentNode['child'] {\n    return this.spec.child\n  }\n\n  /** Set Document ID\n   * @param documentId - document ID\n   * @returns document builder with document based on ID provided. See {@link DocumentBuilder}\n   */\n  documentId(documentId: string): DocumentBuilder {\n    // Let's try to be a bit helpful and assign an ID from document ID if none is specified\n    const paneId = this.spec.id || documentId\n    return this.clone({\n      id: paneId,\n      options: {\n        ...(this.spec.options || {}),\n        id: documentId,\n      },\n    })\n  }\n\n  /** Get Document ID\n   * @returns document ID. See {@link DocumentOptions}\n   */\n  getDocumentId(): Partial<DocumentOptions>['id'] {\n    return this.spec.options?.id\n  }\n\n  /** Set Document Type\n   * @param documentType - document type\n   * @returns document builder with document based on type provided. See {@link DocumentBuilder}\n   */\n  schemaType(documentType: SchemaType | string): DocumentBuilder {\n    return this.clone({\n      options: {\n        ...(this.spec.options || {}),\n        type: typeof documentType === 'string' ? documentType : documentType.name,\n      },\n    })\n  }\n\n  /** Get Document Type\n   * @returns document type. See {@link DocumentOptions}\n   */\n  getSchemaType(): Partial<DocumentOptions>['type'] {\n    return this.spec.options?.type\n  }\n\n  /** Set Document Template\n   * @param templateId - document template ID\n   * @param parameters - document template parameters\n   * @returns document builder with document based on template provided. See {@link DocumentBuilder}\n   */\n  initialValueTemplate(templateId: string, parameters?: Record<string, unknown>): DocumentBuilder {\n    return this.clone({\n      options: {\n        ...(this.spec.options || {}),\n        template: templateId,\n        templateParameters: parameters,\n      },\n    })\n  }\n\n  /** Get Document Template\n   * @returns document template. See {@link DocumentOptions}\n   */\n  getInitialValueTemplate(): Partial<DocumentOptions>['template'] {\n    return this.spec.options?.template\n  }\n\n  /** Get Document's initial value Template parameters\n   * @returns document template parameters. See {@link DocumentOptions}\n   */\n  getInitialValueTemplateParameters(): Partial<DocumentOptions>['templateParameters'] {\n    return this.spec.options?.templateParameters\n  }\n\n  /** Set Document views\n   * @param views - document views. See {@link ViewBuilder} and {@link View}\n   * @returns document builder with document based on views provided. See {@link DocumentBuilder}\n   */\n  views(views: (View | ViewBuilder)[]): DocumentBuilder {\n    return this.clone({views})\n  }\n\n  /** Get Document views\n   * @returns document views. See {@link ViewBuilder} and {@link View}\n   */\n  getViews(): (View | ViewBuilder)[] {\n    return this.spec.views || []\n  }\n\n  /** Serialize Document builder\n   * @param options - serialization options. See {@link SerializeOptions}\n   * @returns document node based on path, index and hint provided in options. See {@link DocumentNode}\n   */\n  serialize({path = [], index, hint}: SerializeOptions = {path: []}): DocumentNode {\n    const urlId = path[index || path.length - 1]\n\n    // Try to grab document ID / editor ID from URL if not defined\n    const id = this.spec.id || (urlId && `${urlId}`) || ''\n    const options: Partial<DocumentOptions> = {\n      id,\n      type: undefined,\n      template: undefined,\n      templateParameters: undefined,\n      ...this.spec.options,\n    }\n\n    if (typeof id !== 'string' || !id) {\n      throw new SerializeError(\n        '`id` is required for document nodes',\n        path,\n        index,\n        hint,\n      ).withHelpUrl(HELP_URL.ID_REQUIRED)\n    }\n\n    if (!options || !options.id) {\n      throw new SerializeError(\n        'document id (`id`) is required for document nodes',\n        path,\n        id,\n        hint,\n      ).withHelpUrl(HELP_URL.DOCUMENT_ID_REQUIRED)\n    }\n\n    if (!options || !options.type) {\n      throw new SerializeError(\n        'document type (`schemaType`) is required for document nodes',\n        path,\n        id,\n        hint,\n      )\n    }\n\n    const views = (this.spec.views && this.spec.views.length > 0 ? this.spec.views : [form()]).map(\n      (item, i) => maybeSerializeView(item, i, path),\n    )\n\n    const viewIds = views.map((view) => view.id)\n    const dupes = uniq(viewIds.filter((viewId, i) => viewIds.includes(viewId, i + 1)))\n    if (dupes.length > 0) {\n      throw new SerializeError(\n        `document node has views with duplicate IDs: ${dupes.join(',  ')}`,\n        path,\n        id,\n        hint,\n      )\n    }\n\n    return {\n      ...this.spec,\n      child: this.spec.child || createDocumentChildResolver(this._context),\n      id: validateId(id, path, index),\n      type: 'document',\n      options: getDocumentOptions(options),\n      views,\n    }\n  }\n\n  /** Clone Document builder\n   * @param withSpec - partial document node specification used to extend the cloned builder. See {@link PartialDocumentNode}\n   * @returns document builder based on context and spec provided. See {@link DocumentBuilder}\n   */\n  clone(withSpec: PartialDocumentNode = {}): DocumentBuilder {\n    const builder = new DocumentBuilder(this._context)\n    const options = {...(this.spec.options || {}), ...(withSpec.options || {})}\n    builder.spec = {...this.spec, ...withSpec, options}\n    return builder\n  }\n}\n\nfunction getDocumentOptions(spec: Partial<DocumentOptions>): DocumentOptions {\n  const opts: DocumentOptions = {\n    id: spec.id || '',\n    type: spec.type || '*',\n  }\n\n  if (spec.template) {\n    opts.template = spec.template\n  }\n\n  if (spec.templateParameters) {\n    opts.templateParameters = spec.templateParameters\n  }\n\n  return opts\n}\n\n/** @internal */\nexport function documentFromEditor(context: StructureContext, spec?: EditorNode): DocumentBuilder {\n  let doc = spec?.type\n    ? // Use user-defined document fragment as base if possible\n      context.resolveDocumentNode({schemaType: spec.type})\n    : // Fall back to plain old document builder\n      new DocumentBuilder(context)\n\n  if (!spec) return doc\n\n  const {id, type, template, templateParameters} = spec.options\n  doc = doc.id(spec.id).documentId(id)\n\n  if (type) {\n    doc = doc.schemaType(type)\n  }\n  if (template) {\n    doc = doc.initialValueTemplate(template, templateParameters)\n  }\n  if (spec.child) {\n    doc = doc.child(spec.child)\n  }\n\n  return doc\n}\n\n/** @internal */\nexport function documentFromEditorWithInitialValue(\n  {resolveDocumentNode, templates}: StructureContext,\n  templateId: string,\n  parameters?: Record<string, unknown>,\n): DocumentBuilder {\n  const template = templates.find((t) => t.id === templateId)\n\n  if (!template) {\n    throw new Error(`Template with ID \"${templateId}\" not defined`)\n  }\n\n  return resolveDocumentNode({schemaType: template.schemaType}).initialValueTemplate(\n    templateId,\n    parameters,\n  )\n}\n","export const layoutOptions = ['default', 'card', 'media', 'detail', 'block']\n","import {PartialDocumentList, getTypeNamesFromFilter} from './DocumentList'\nimport {StructureNode} from './StructureNodes'\n\n/**\n * Intent parameters (json)\n *\n * @public\n */\nexport type IntentJsonParams = {[key: string]: any}\n\n/**\n * Interface for base intent parameters\n *\n * @public */\nexport interface BaseIntentParams {\n  /* Intent type */\n  type?: string\n  /* Intent Id */\n  id?: string\n  /* Intent template */\n  template?: string\n  /**\n   * Experimental field path\n   * @beta\n   * @experimental\n   * @hidden\n   */\n  path?: string\n}\n\n/** @internal */\nexport const DEFAULT_INTENT_HANDLER = Symbol('Document type list canHandleIntent')\n\n/**\n * Intent parameters\n * See {@link router.BaseIntentParams} and {@link router.IntentJsonParams}\n *\n * @public\n */\nexport type IntentParams = BaseIntentParams | [BaseIntentParams, IntentJsonParams]\n\n/**\n * Interface for intents\n * @public */\n// TODO: intents should be unified somewhere\nexport interface Intent {\n  /** Intent type */\n  type: string\n  /** Intent parameters. See {@link IntentParams}\n   */\n  params?: IntentParams\n}\n\n/**\n * Interface for intent checker\n *\n * @public\n */\nexport interface IntentChecker {\n  (\n    /** Intent name */\n    intentName: string,\n    /** Intent checker parameter */\n    params: {[key: string]: any},\n    /** Structure context. See {@link StructureNode} */\n    context: {pane: StructureNode; index: number},\n  ): boolean\n  /** intent checker identify */\n  identity?: symbol\n}\n\n/** @internal */\nexport const defaultIntentChecker: IntentChecker = (intentName, params, {pane}): boolean => {\n  const isEdit = intentName === 'edit'\n  const isCreate = intentName === 'create'\n  const typedSpec = pane as PartialDocumentList\n  const paneFilter = typedSpec.options?.filter || ''\n  const paneParams = typedSpec.options?.params || {}\n  const typeNames = typedSpec.schemaTypeName\n    ? [typedSpec.schemaTypeName]\n    : getTypeNamesFromFilter(paneFilter, paneParams)\n\n  const initialValueTemplates = typedSpec.initialValueTemplates || []\n\n  if (isCreate && params.template) {\n    return initialValueTemplates.some((tpl) => tpl.templateId === params.template)\n  }\n\n  return (\n    (isEdit && params.id && typeNames.includes(params.type)) ||\n    (isCreate && typeNames.includes(params.type))\n  )\n}\n\ndefaultIntentChecker.identity = DEFAULT_INTENT_HANDLER\n","import {pickBy} from 'lodash'\nimport {ComposeIcon} from '@sanity/icons'\nimport {HELP_URL, SerializeError} from './SerializeError'\nimport {Serializable, SerializeOptions, SerializePath} from './StructureNodes'\nimport {MenuItemBuilder, MenuItem} from './MenuItem'\nimport {IntentParams} from './Intent'\nimport {StructureContext} from './types'\nimport {InitialValueTemplateItem} from 'sanity'\n\n/**\n * A `InitialValueTemplateItemBuilder` is used to build a document node with an initial value set.\n *\n * @public\n */\nexport class InitialValueTemplateItemBuilder implements Serializable<InitialValueTemplateItem> {\n  /** Initial Value template item option object. See {@link InitialValueTemplateItem} */\n  protected spec: Partial<InitialValueTemplateItem>\n\n  constructor(\n    /**\n     * Desk structure context. See {@link StructureContext}\n     */\n    protected _context: StructureContext,\n    spec?: Partial<InitialValueTemplateItem>,\n  ) {\n    this.spec = spec ? spec : {}\n  }\n\n  /** Set initial value template item builder ID\n   * @param id - initial value template item ID\n   * @returns initial value template item based on ID provided. See {@link InitialValueTemplateItemBuilder}\n   */\n  id(id: string): InitialValueTemplateItemBuilder {\n    return this.clone({id})\n  }\n\n  /** Get initial value template item builder ID\n   * @returns initial value template item ID. See {@link InitialValueTemplateItem}\n   */\n  getId(): Partial<InitialValueTemplateItem>['id'] {\n    return this.spec.id\n  }\n\n  /** Set initial value template item title\n   * @param title - initial value template item title\n   * @returns initial value template item based on title provided. See {@link InitialValueTemplateItemBuilder}\n   */\n  title(title: string): InitialValueTemplateItemBuilder {\n    return this.clone({title})\n  }\n\n  /** Get initial value template item title\n   * @returns initial value template item title. See {@link InitialValueTemplateItem}\n   */\n  getTitle(): Partial<InitialValueTemplateItem>['title'] {\n    return this.spec.title\n  }\n\n  /** Set initial value template item description\n   * @param description - initial value template item description\n   * @returns initial value template item builder based on description provided. See {@link InitialValueTemplateItemBuilder}\n   */\n  description(description: string): InitialValueTemplateItemBuilder {\n    return this.clone({description})\n  }\n\n  /** Get initial value template item description\n   * @returns initial value template item description. See {@link InitialValueTemplateItem}\n   */\n  getDescription(): Partial<InitialValueTemplateItem>['description'] {\n    return this.spec.description\n  }\n\n  /** Set initial value template ID\n   * @param templateId - initial value template item template ID\n   * @returns initial value template item based builder on template ID provided. See {@link InitialValueTemplateItemBuilder}\n   */\n  templateId(templateId: string): InitialValueTemplateItemBuilder {\n    // Let's try to be a bit helpful and assign an ID from template ID if none is specified\n    const paneId = this.spec.id || templateId\n    return this.clone({\n      id: paneId,\n      templateId,\n    })\n  }\n\n  /** Get initial value template item template ID\n   * @returns initial value template item ID. See {@link InitialValueTemplateItem}\n   */\n  getTemplateId(): Partial<InitialValueTemplateItem>['templateId'] {\n    return this.spec.templateId\n  }\n\n  /** Get initial value template item template parameters\n   * @param parameters - initial value template item parameters\n   * @returns initial value template item builder based on parameters provided. See {@link InitialValueTemplateItemBuilder}\n   */\n  parameters(parameters: {[key: string]: any}): InitialValueTemplateItemBuilder {\n    return this.clone({parameters})\n  }\n\n  /** Get initial value template item template parameters\n   * @returns initial value template item parameters. See {@link InitialValueTemplateItem}\n   */\n  getParameters(): Partial<InitialValueTemplateItem>['parameters'] {\n    return this.spec.parameters\n  }\n\n  /** Serialize initial value template item\n   * @param options - serialization options. See {@link SerializeOptions}\n   * @returns initial value template item object based on the path, index and hint provided in options. See {@link InitialValueTemplateItem}\n   */\n  serialize({path = [], index, hint}: SerializeOptions = {path: []}): InitialValueTemplateItem {\n    const {spec, _context} = this\n    const {templates} = _context\n\n    if (typeof spec.id !== 'string' || !spec.id) {\n      throw new SerializeError(\n        '`id` is required for initial value template item nodes',\n        path,\n        index,\n        hint,\n      ).withHelpUrl(HELP_URL.ID_REQUIRED)\n    }\n\n    if (!spec.templateId) {\n      throw new SerializeError(\n        'template id (`templateId`) is required for initial value template item nodes',\n        path,\n        spec.id,\n        hint,\n      ).withHelpUrl(HELP_URL.ID_REQUIRED)\n    }\n\n    const template = templates.find((t) => t.id === spec.templateId)\n\n    if (!template) {\n      throw new SerializeError(\n        'template id (`templateId`) is required for initial value template item nodes',\n        path,\n        spec.id,\n        hint,\n      ).withHelpUrl(HELP_URL.ID_REQUIRED)\n    }\n\n    return {\n      id: spec.id,\n      templateId: spec.id,\n      schemaType: template.schemaType,\n      type: 'initialValueTemplateItem',\n      description: spec.description || template.description,\n      title: spec.title || template.title,\n      subtitle: spec.subtitle,\n      icon: spec.icon || template.icon,\n      initialDocumentId: spec.initialDocumentId,\n      parameters: spec.parameters,\n    }\n  }\n\n  /** Clone generic view builder (allows for options overriding)\n   * @param withSpec - initial value template item builder options. See {@link InitialValueTemplateItemBuilder}\n   * @returns initial value template item builder based on the context and options provided. See {@link InitialValueTemplateItemBuilder}\n   */\n  clone(withSpec: Partial<InitialValueTemplateItem> = {}): InitialValueTemplateItemBuilder {\n    const builder = new InitialValueTemplateItemBuilder(this._context)\n    builder.spec = {...this.spec, ...withSpec}\n    return builder\n  }\n}\n\n/** @internal */\nexport function defaultInitialValueTemplateItems(\n  context: StructureContext,\n): InitialValueTemplateItemBuilder[] {\n  const {schema, getStructureBuilder, templates} = context\n\n  // Sort templates by their schema type, in order or definition\n  const typeNames = schema.getTypeNames()\n  const ordered = templates\n    // Don't list templates that require parameters\n    // TODO: this should use the new-document template items instead maybe?\n    .filter((tpl) => !tpl.parameters?.length)\n    .sort((a, b) => typeNames.indexOf(a.schemaType) - typeNames.indexOf(b.schemaType))\n\n  // Create actual template items out of the templates\n  return ordered.map((tpl) => getStructureBuilder().initialValueTemplateItem(tpl.id))\n}\n\n/** @internal */\nexport function maybeSerializeInitialValueTemplateItem(\n  item: InitialValueTemplateItem | InitialValueTemplateItemBuilder,\n  index: number,\n  path: SerializePath,\n): InitialValueTemplateItem {\n  return item instanceof InitialValueTemplateItemBuilder ? item.serialize({path, index}) : item\n}\n\n/** @internal */\nexport function menuItemsFromInitialValueTemplateItems(\n  context: StructureContext,\n  templateItems: InitialValueTemplateItem[],\n): MenuItem[] {\n  const {schema, templates} = context\n  return templateItems.map((item) => {\n    const template = templates.find((t) => t.id === item.templateId)\n    const title = item.title || template?.title || 'Create new'\n    const params = pickBy(\n      {type: template && template.schemaType, template: item.templateId},\n      Boolean,\n    )\n    const intentParams: IntentParams = item.parameters ? [params, item.parameters] : params\n    const schemaType = template && schema.get(template.schemaType)\n\n    return new MenuItemBuilder(context)\n      .title(title)\n      .icon((template && template.icon) || schemaType?.icon || ComposeIcon)\n      .intent({type: 'create', params: intentParams})\n      .serialize()\n  })\n}\n","import {Child, Serializable, SerializeOptions, StructureNode} from './StructureNodes'\nimport {layoutOptions} from './Layout'\nimport {MenuItem, MenuItemBuilder, maybeSerializeMenuItem} from './MenuItem'\nimport {MenuItemGroup, MenuItemGroupBuilder, maybeSerializeMenuItemGroup} from './MenuItemGroup'\nimport {IntentChecker, defaultIntentChecker} from './Intent'\nimport {SerializeError} from './SerializeError'\nimport {\n  InitialValueTemplateItemBuilder,\n  maybeSerializeInitialValueTemplateItem,\n} from './InitialValueTemplateItem'\nimport {validateId} from './util/validateId'\nimport {getStructureNodeId} from './util/getStructureNodeId'\nimport {PreviewLayoutKey, InitialValueTemplateItem} from 'sanity'\n\nfunction noChildResolver() {\n  return undefined\n}\n\n/** @internal */\nexport const shallowIntentChecker: IntentChecker = (intentName, params, {pane, index}): boolean => {\n  return index <= 1 && defaultIntentChecker(intentName, params, {pane, index})\n}\n\n/**\n * Interface for list display options\n *\n * @public */\nexport interface ListDisplayOptions {\n  /** Check if list display should show icons */\n  showIcons?: boolean\n}\n\n/**\n * Interface for base generic list\n *\n * @public\n */\nexport interface BaseGenericList extends StructureNode {\n  /** List layout key. */\n  defaultLayout?: PreviewLayoutKey\n  /** Can handle intent. See {@link IntentChecker} */\n  canHandleIntent?: IntentChecker\n  /** List display options. See {@link ListDisplayOptions} */\n  displayOptions?: ListDisplayOptions\n  /** List child. See {@link Child} */\n  child: Child\n  /** List initial values array. See {@link InitialValueTemplateItem} and {@link InitialValueTemplateItemBuilder} */\n  initialValueTemplates?: (InitialValueTemplateItem | InitialValueTemplateItemBuilder)[]\n}\n\n/**\n * Interface for generic list\n *\n * @public\n */\n// \"POJO\"/verbatim-version - end result\nexport interface GenericList extends BaseGenericList {\n  /** List type */\n  type: string\n  /** List menu items array. See {@link MenuItem} */\n  menuItems: MenuItem[]\n  /** List menu item groups array. See {@link MenuItemGroup} */\n  menuItemGroups: MenuItemGroup[]\n}\n\n/**\n * Interface for buildable generic list\n *\n * @public\n */\n// Used internally in builder classes to make everything optional\nexport interface BuildableGenericList extends Partial<BaseGenericList> {\n  /** List menu items array. See {@link MenuItem} and {@link MenuItemBuilder} */\n  menuItems?: (MenuItem | MenuItemBuilder)[]\n  /** List menu items groups array. See {@link MenuItemGroup} and {@link MenuItemGroupBuilder} */\n  menuItemGroups?: (MenuItemGroup | MenuItemGroupBuilder)[]\n}\n\n/**\n * Interface for generic list input\n * Allows builders and only requires things not inferrable\n *\n * @public */\n// Input version, allows builders and only requires things not inferrable\nexport interface GenericListInput extends StructureNode {\n  /** Input id */\n  id: string\n  /** Input title */\n  title: string\n  /** Input menu items groups. See {@link MenuItem} and {@link MenuItemBuilder} */\n  menuItems?: (MenuItem | MenuItemBuilder)[]\n  /** Input menu items groups. See {@link MenuItemGroup} and {@link MenuItemGroupBuilder} */\n  menuItemGroups?: (MenuItemGroup | MenuItemGroupBuilder)[]\n  /** Input initial value array. See {@link InitialValueTemplateItem} and {@link InitialValueTemplateItemBuilder} */\n  initialValueTemplates?: (InitialValueTemplateItem | InitialValueTemplateItemBuilder)[]\n  /** Input default layout. */\n  defaultLayout?: PreviewLayoutKey\n  /** If input can handle intent. See {@link IntentChecker} */\n  canHandleIntent?: IntentChecker\n  /** Input child of type {@link Child} */\n  child?: Child\n}\n\n/**\n * Class for building generic lists\n *\n * @public\n */\nexport abstract class GenericListBuilder<TList extends BuildableGenericList, ConcreteImpl>\n  implements Serializable<GenericList>\n{\n  /** Check if initial value templates are set */\n  protected initialValueTemplatesSpecified = false\n  /** Generic list option object */\n  protected spec: TList = {} as TList\n\n  /** Set generic list ID\n   * @param id - generic list ID\n   * @returns generic list builder based on ID provided.\n   */\n  id(id: string): ConcreteImpl {\n    return this.clone({id})\n  }\n\n  /** Get generic list ID\n   * @returns generic list ID\n   */\n  getId(): TList['id'] {\n    return this.spec.id\n  }\n\n  /** Set generic list title\n   * @param title - generic list title\n   * @returns generic list builder based on title and ID provided.\n   */\n  title(title: string): ConcreteImpl {\n    return this.clone({title, id: getStructureNodeId(title, this.spec.id)})\n  }\n\n  /** Get generic list title\n   * @returns generic list title\n   */\n  getTitle(): TList['title'] {\n    return this.spec.title\n  }\n\n  /** Set generic list layout\n   * @param defaultLayout - generic list layout key.\n   * @returns generic list builder based on layout provided.\n   */\n  defaultLayout(defaultLayout: PreviewLayoutKey): ConcreteImpl {\n    return this.clone({defaultLayout})\n  }\n\n  /** Get generic list layout\n   * @returns generic list layout\n   */\n  getDefaultLayout(): TList['defaultLayout'] {\n    return this.spec.defaultLayout\n  }\n\n  /** Set generic list menu items\n   * @param menuItems - generic list menu items. See {@link MenuItem} and {@link MenuItemBuilder}\n   * @returns generic list builder based on menu items provided.\n   */\n  menuItems(menuItems: (MenuItem | MenuItemBuilder)[] | undefined): ConcreteImpl {\n    return this.clone({menuItems})\n  }\n\n  /** Get generic list menu items\n   * @returns generic list menu items\n   */\n  getMenuItems(): TList['menuItems'] {\n    return this.spec.menuItems\n  }\n\n  /** Set generic list menu item groups\n   * @param menuItemGroups - generic list menu item groups. See {@link MenuItemGroup} and {@link MenuItemGroupBuilder}\n   * @returns generic list builder based on menu item groups provided.\n   */\n  menuItemGroups(menuItemGroups: (MenuItemGroup | MenuItemGroupBuilder)[]): ConcreteImpl {\n    return this.clone({menuItemGroups})\n  }\n\n  /** Get generic list menu item groups\n   * @returns generic list menu item groups\n   */\n  getMenuItemGroups(): TList['menuItemGroups'] {\n    return this.spec.menuItemGroups\n  }\n\n  /** Set generic list child\n   * @param child - generic list child. See {@link Child}\n   * @returns generic list builder based on child provided (clone).\n   */\n  child(child: Child): ConcreteImpl {\n    return this.clone({child})\n  }\n\n  /** Get generic list child\n   * @returns generic list child\n   */\n  getChild(): TList['child'] {\n    return this.spec.child\n  }\n\n  /** Set generic list can handle intent\n   * @param canHandleIntent - generic list intent checker. See {@link IntentChecker}\n   * @returns generic list builder based on can handle intent provided.\n   */\n  canHandleIntent(canHandleIntent?: IntentChecker): ConcreteImpl {\n    return this.clone({canHandleIntent})\n  }\n\n  /** Get generic list can handle intent\n   * @returns generic list can handle intent\n   */\n  getCanHandleIntent(): TList['canHandleIntent'] {\n    return this.spec.canHandleIntent\n  }\n\n  /** Set generic list display options\n   * @param enabled - allow / disallow for showing icons\n   * @returns generic list builder based on display options (showIcons) provided.\n   */\n  showIcons(enabled = true): ConcreteImpl {\n    return this.clone({\n      displayOptions: {...(this.spec.displayOptions || {}), showIcons: enabled},\n    })\n  }\n\n  /** Get generic list display options\n   * @returns generic list display options (specifically showIcons)\n   */\n  getShowIcons(): boolean | undefined {\n    return this.spec.displayOptions ? this.spec.displayOptions.showIcons : undefined\n  }\n\n  /** Set generic list initial value templates\n   * @param templates - generic list initial value templates. See {@link InitialValueTemplateItemBuilder}\n   * @returns generic list builder based on templates provided.\n   */\n  initialValueTemplates(\n    templates:\n      | InitialValueTemplateItem\n      | InitialValueTemplateItemBuilder\n      | Array<InitialValueTemplateItem | InitialValueTemplateItemBuilder>,\n  ): ConcreteImpl {\n    this.initialValueTemplatesSpecified = true\n    return this.clone({initialValueTemplates: Array.isArray(templates) ? templates : [templates]})\n  }\n\n  /** Get generic list initial value templates\n   * @returns generic list initial value templates\n   */\n  getInitialValueTemplates(): TList['initialValueTemplates'] {\n    return this.spec.initialValueTemplates\n  }\n\n  /** Serialize generic list\n   * @param options - serialization options. See {@link SerializeOptions}\n   * @returns generic list object based on path provided in options. See {@link GenericList}\n   */\n  serialize(options: SerializeOptions = {path: []}): GenericList {\n    const id = this.spec.id || ''\n    const path = options.path\n\n    const defaultLayout = this.spec.defaultLayout\n    if (defaultLayout && !layoutOptions.includes(defaultLayout)) {\n      throw new SerializeError(\n        `\\`layout\\` must be one of ${layoutOptions.map((item) => `\"${item}\"`).join(', ')}`,\n        path,\n        id || options.index,\n        this.spec.title,\n      )\n    }\n\n    const initialValueTemplates = (this.spec.initialValueTemplates || []).map((item, i) =>\n      maybeSerializeInitialValueTemplateItem(item, i, path),\n    )\n\n    return {\n      id: validateId(id, options.path, id || options.index),\n      title: this.spec.title,\n      type: 'genericList',\n      defaultLayout,\n      child: this.spec.child || noChildResolver,\n      canHandleIntent: this.spec.canHandleIntent || shallowIntentChecker,\n      displayOptions: this.spec.displayOptions,\n      initialValueTemplates,\n      menuItems: (this.spec.menuItems || []).map((item, i) =>\n        maybeSerializeMenuItem(item, i, path),\n      ),\n      menuItemGroups: (this.spec.menuItemGroups || []).map((item, i) =>\n        maybeSerializeMenuItemGroup(item, i, path),\n      ),\n    }\n  }\n\n  /** Clone generic list builder (allows for options overriding)\n   * @param _withSpec - generic list options.\n   * @returns generic list builder.\n   */\n  abstract clone(_withSpec?: object): ConcreteImpl\n}\n","import {SchemaType, SortOrderingItem} from '@sanity/types'\nimport {ComposeIcon} from '@sanity/icons'\nimport {generateHelpUrl} from '@sanity/generate-help-url'\nimport {resolveTypeForDocument} from './util/resolveTypeForDocument'\nimport {SerializeError, HELP_URL} from './SerializeError'\nimport {SerializeOptions, Child} from './StructureNodes'\nimport {ChildResolver, ChildResolverOptions, ItemChild} from './ChildResolver'\nimport {\n  GenericListBuilder,\n  BuildableGenericList,\n  GenericList,\n  GenericListInput,\n} from './GenericList'\nimport {DocumentBuilder} from './Document'\nimport {StructureContext} from './types'\nimport {DEFAULT_STUDIO_CLIENT_OPTIONS, InitialValueTemplateItem} from 'sanity'\n\nconst validateFilter = (spec: PartialDocumentList, options: SerializeOptions) => {\n  const filter = spec.options?.filter.trim() || ''\n\n  if (['*', '{'].includes(filter[0])) {\n    throw new SerializeError(\n      `\\`filter\\` cannot start with \\`${filter[0]}\\` - looks like you are providing a query, not a filter`,\n      options.path,\n      spec.id,\n      spec.title,\n    ).withHelpUrl(HELP_URL.QUERY_PROVIDED_FOR_FILTER)\n  }\n\n  return filter\n}\n\nconst createDocumentChildResolverForItem =\n  (context: StructureContext): ChildResolver =>\n  (itemId: string, options: ChildResolverOptions): ItemChild | Promise<ItemChild> | undefined => {\n    const parentItem = options.parent as DocumentList\n    const template = options.params?.template\n      ? context.templates.find((tpl) => tpl.id === options.params.template)\n      : undefined\n    const type = template\n      ? template.schemaType\n      : parentItem.schemaTypeName || resolveTypeForDocument(context.getClient, itemId)\n\n    return Promise.resolve(type).then((schemaType) =>\n      schemaType\n        ? context.resolveDocumentNode({schemaType, documentId: itemId})\n        : new DocumentBuilder(context).id('editor').documentId(itemId).schemaType(''),\n    )\n  }\n\n/**\n * Partial document list\n *\n * @public\n */\nexport interface PartialDocumentList extends BuildableGenericList {\n  /** Document list options. See {@link DocumentListOptions} */\n  options?: DocumentListOptions\n  /** Schema type name */\n  schemaTypeName?: string\n}\n\n/**\n * Interface for document list input\n *\n * @public\n */\nexport interface DocumentListInput extends GenericListInput {\n  /** Document list options. See {@link DocumentListOptions} */\n  options: DocumentListOptions\n}\n\n/**\n * Interface for document list\n *\n * @public\n */\nexport interface DocumentList extends GenericList {\n  type: 'documentList'\n  /** Document list options. See {@link DocumentListOptions} */\n  options: DocumentListOptions\n  /** Document list child. See {@link Child} */\n  child: Child\n  /** Document schema type name */\n  schemaTypeName?: string\n}\n\n/**\n * Interface for document List options\n *\n * @public\n */\nexport interface DocumentListOptions {\n  /** Document list filter */\n  filter: string\n  /** Document list parameters */\n  params?: Record<string, unknown>\n  /** Document list API version */\n  apiVersion?: string\n  /** Document list API default ordering array. */\n  defaultOrdering?: SortOrderingItem[]\n}\n\n/**\n * Class for building document list\n *\n * @public\n */\nexport class DocumentListBuilder extends GenericListBuilder<\n  PartialDocumentList,\n  DocumentListBuilder\n> {\n  /** Document list options. See {@link PartialDocumentList} */\n  protected spec: PartialDocumentList\n\n  constructor(\n    /**\n     * Desk structure context. See {@link StructureContext}\n     */\n    protected _context: StructureContext,\n    spec?: DocumentListInput,\n  ) {\n    super()\n    this.spec = spec || {}\n    this.initialValueTemplatesSpecified = Boolean(spec?.initialValueTemplates)\n  }\n\n  /** Set API version\n   * @param apiVersion - API version\n   * @returns document list builder based on the options and API version provided. See {@link DocumentListBuilder}\n   */\n  apiVersion(apiVersion: string): DocumentListBuilder {\n    return this.clone({options: {...(this.spec.options || {filter: ''}), apiVersion}})\n  }\n\n  /** Get API version\n   * @returns API version\n   */\n  getApiVersion(): string | undefined {\n    return this.spec.options?.apiVersion\n  }\n\n  /** Set Document list filter\n   * @param filter - filter\n   * @returns document list builder based on the options and filter provided. See {@link DocumentListBuilder}\n   */\n  filter(filter: string): DocumentListBuilder {\n    return this.clone({options: {...(this.spec.options || {}), filter}})\n  }\n\n  /** Get Document list filter\n   * @returns filter\n   */\n  getFilter(): string | undefined {\n    return this.spec.options?.filter\n  }\n\n  /** Set Document list schema type name\n   * @param type - schema type name.\n   * @returns document list builder based on the schema type name provided. See {@link DocumentListBuilder}\n   */\n  schemaType(type: SchemaType | string): DocumentListBuilder {\n    const schemaTypeName = typeof type === 'string' ? type : type.name\n    return this.clone({schemaTypeName})\n  }\n\n  /** Get Document list schema type name\n   * @returns schema type name\n   */\n  getSchemaType(): string | undefined {\n    return this.spec.schemaTypeName\n  }\n\n  /** Set Document list options' parameters\n   * @param params - parameters\n   * @returns document list builder based on the options provided. See {@link DocumentListBuilder}\n   */\n  params(params: Record<string, unknown>): DocumentListBuilder {\n    return this.clone({\n      options: {...(this.spec.options || {filter: ''}), params},\n    })\n  }\n\n  /** Get Document list options' parameters\n   * @returns options\n   */\n  getParams(): Record<string, unknown> | undefined {\n    return this.spec.options?.params\n  }\n\n  /** Set Document list default ordering\n   * @param ordering - default sort ordering array. See {@link SortOrderingItem}\n   * @returns document list builder based on ordering provided. See {@link DocumentListBuilder}\n   */\n  defaultOrdering(ordering: SortOrderingItem[]): DocumentListBuilder {\n    if (!Array.isArray(ordering)) {\n      throw new Error('`defaultOrdering` must be an array of order clauses')\n    }\n\n    return this.clone({\n      options: {...(this.spec.options || {filter: ''}), defaultOrdering: ordering},\n    })\n  }\n\n  /** Get Document list default ordering\n   * @returns default ordering. See {@link SortOrderingItem}\n   */\n  getDefaultOrdering(): SortOrderingItem[] | undefined {\n    return this.spec.options?.defaultOrdering\n  }\n\n  /** Serialize Document list\n   * @param options - serialization options. See {@link SerializeOptions}\n   * @returns document list object based on path provided in options. See {@link DocumentList}\n   */\n  serialize(options: SerializeOptions = {path: []}): DocumentList {\n    if (typeof this.spec.id !== 'string' || !this.spec.id) {\n      throw new SerializeError(\n        '`id` is required for document lists',\n        options.path,\n        options.index,\n        this.spec.title,\n      ).withHelpUrl(HELP_URL.ID_REQUIRED)\n    }\n\n    if (!this.spec.options || !this.spec.options.filter) {\n      throw new SerializeError(\n        '`filter` is required for document lists',\n        options.path,\n        this.spec.id,\n        this.spec.title,\n      ).withHelpUrl(HELP_URL.FILTER_REQUIRED)\n    }\n\n    const hasSimpleFilter = this.spec.options?.filter === '_type == $type'\n    if (!hasSimpleFilter && this.spec.options.filter && !this.spec.options.apiVersion) {\n      console.warn(\n        `No apiVersion specified for document type list with custom filter: \\`${this.spec.options.filter}\\`. This will be required in the future. See %s for more info.`,\n        generateHelpUrl(HELP_URL.API_VERSION_REQUIRED_FOR_CUSTOM_FILTER),\n      )\n    }\n    return {\n      ...super.serialize(options),\n      type: 'documentList',\n      schemaTypeName: this.spec.schemaTypeName,\n      child: this.spec.child || createDocumentChildResolverForItem(this._context),\n      options: {\n        ...this.spec.options,\n        // @todo: make specifying .apiVersion required when using custom (non-simple) filters in v4\n        apiVersion: this.spec.options.apiVersion || DEFAULT_STUDIO_CLIENT_OPTIONS.apiVersion,\n        filter: validateFilter(this.spec, options),\n      },\n    }\n  }\n\n  /** Clone Document list builder (allows for options overriding)\n   * @param withSpec - override document list spec. See {@link PartialDocumentList}\n   * @returns document list builder. See {@link DocumentListBuilder}\n   */\n  clone(withSpec?: PartialDocumentList): DocumentListBuilder {\n    const builder = new DocumentListBuilder(this._context)\n    builder.spec = {...this.spec, ...(withSpec || {})}\n\n    if (!this.initialValueTemplatesSpecified) {\n      builder.spec.initialValueTemplates = inferInitialValueTemplates(this._context, builder.spec)\n    }\n\n    if (!builder.spec.schemaTypeName) {\n      builder.spec.schemaTypeName = inferTypeName(builder.spec)\n    }\n\n    return builder\n  }\n\n  /** Get Document list spec\n   * @returns document list spec. See {@link PartialDocumentList}\n   */\n  getSpec(): PartialDocumentList {\n    return this.spec\n  }\n}\n\nfunction inferInitialValueTemplates(\n  context: StructureContext,\n  spec: PartialDocumentList,\n): InitialValueTemplateItem[] | undefined {\n  const {document} = context\n  const {schemaTypeName, options} = spec\n  const {filter, params} = options || {filter: '', params: {}}\n  const typeNames = schemaTypeName\n    ? [schemaTypeName]\n    : Array.from(new Set(getTypeNamesFromFilter(filter, params)))\n\n  if (typeNames.length === 0) {\n    return undefined\n  }\n\n  return typeNames\n    .flatMap((schemaType) =>\n      document.resolveNewDocumentOptions({\n        type: 'structure',\n        schemaType,\n      }),\n    )\n    .map((option) => ({...option, icon: ComposeIcon}))\n}\n\nfunction inferTypeName(spec: PartialDocumentList): string | undefined {\n  const {options} = spec\n  const {filter, params} = options || {filter: '', params: {}}\n  const typeNames = getTypeNamesFromFilter(filter, params)\n  return typeNames.length === 1 ? typeNames[0] : undefined\n}\n\n/** @internal */\nexport function getTypeNamesFromFilter(\n  filter: string,\n  params: Record<string, unknown> = {},\n): string[] {\n  let typeNames = getTypeNamesFromEqualityFilter(filter, params)\n\n  if (typeNames.length === 0) {\n    typeNames = getTypeNamesFromInTypesFilter(filter, params)\n  }\n\n  return typeNames\n}\n\n// From _type == \"movie\" || _type == $otherType\nfunction getTypeNamesFromEqualityFilter(\n  filter: string,\n  params: Record<string, unknown> = {},\n): string[] {\n  const pattern =\n    /\\b_type\\s*==\\s*(['\"].*?['\"]|\\$.*?(?:\\s|$))|\\B(['\"].*?['\"]|\\$.*?(?:\\s|$))\\s*==\\s*_type/g\n  const matches: string[] = []\n  let match\n  while ((match = pattern.exec(filter)) !== null) {\n    matches.push(match[1] || match[2])\n  }\n\n  return matches\n    .map((candidate) => {\n      const typeName = candidate[0] === '$' ? params[candidate.slice(1)] : candidate\n      const normalized = ((typeName as string) || '').trim().replace(/^[\"']|[\"']$/g, '')\n      return normalized\n    })\n    .filter(Boolean)\n}\n\n// From _type in [\"dog\", \"cat\", $otherSpecies]\nfunction getTypeNamesFromInTypesFilter(\n  filter: string,\n  params: Record<string, unknown> = {},\n): string[] {\n  const pattern = /\\b_type\\s+in\\s+\\[(.*?)\\]/\n  const matches = filter.match(pattern)\n  if (!matches) {\n    return []\n  }\n\n  return matches[1]\n    .split(/,\\s*/)\n    .map((match) => match.trim().replace(/^[\"']+|[\"']+$/g, ''))\n    .map((item) => (item[0] === '$' ? params[item.slice(1)] : item))\n    .filter(Boolean) as string[]\n}\n","import {find} from 'lodash'\nimport {SerializePath, SerializeOptions, Divider} from './StructureNodes'\nimport {ChildResolverOptions, ChildResolver} from './ChildResolver'\nimport {SerializeError, HELP_URL} from './SerializeError'\nimport {ListItem, ListItemBuilder} from './ListItem'\nimport {IntentChecker} from './Intent'\nimport {isDocumentListItem} from './DocumentListItem'\nimport {\n  GenericListBuilder,\n  BuildableGenericList,\n  GenericList,\n  GenericListInput,\n  shallowIntentChecker,\n} from './GenericList'\nimport {StructureContext} from './types'\nimport {isRecord} from 'sanity'\n\nconst getArgType = (thing: ListItem) => {\n  if (thing instanceof ListBuilder) {\n    return 'ListBuilder'\n  }\n\n  if (isPromise<ListItem>(thing)) {\n    return 'Promise'\n  }\n\n  return Array.isArray(thing) ? 'array' : typeof thing\n}\n\nconst isListItem = (item: ListItem | Divider): item is ListItem => {\n  return item.type === 'listItem'\n}\n\nconst defaultCanHandleIntent: IntentChecker = (intentName: string, params, context) => {\n  const pane = context.pane as List\n  const items = pane.items || []\n  return (\n    items\n      .filter(isDocumentListItem)\n      .some((item) => item.schemaType.name === params.type && item._id === params.id) ||\n    shallowIntentChecker(intentName, params, context)\n  )\n}\n\nconst resolveChildForItem: ChildResolver = (itemId: string, options: ChildResolverOptions) => {\n  const parentItem = options.parent as List\n  const items = parentItem.items.filter(isListItem)\n  const target = (items.find((item) => item.id === itemId) || {child: undefined}).child\n\n  if (!target || typeof target !== 'function') {\n    return target\n  }\n\n  return typeof target === 'function' ? target(itemId, options) : target\n}\n\nfunction maybeSerializeListItem(\n  item: ListItem | ListItemBuilder | Divider,\n  index: number,\n  path: SerializePath,\n): ListItem | Divider {\n  if (item instanceof ListItemBuilder) {\n    return item.serialize({path, index})\n  }\n\n  const listItem = item as ListItem\n  if (listItem && listItem.type === 'divider') {\n    return item as Divider\n  }\n\n  if (!listItem || listItem.type !== 'listItem') {\n    const gotWhat = (listItem && listItem.type) || getArgType(listItem)\n    const helpText = gotWhat === 'array' ? ' - did you forget to spread (...moreItems)?' : ''\n    throw new SerializeError(\n      `List items must be of type \"listItem\", got \"${gotWhat}\"${helpText}`,\n      path,\n      index,\n    ).withHelpUrl(HELP_URL.INVALID_LIST_ITEM)\n  }\n\n  return item\n}\n\nfunction isPromise<T>(thing: unknown): thing is PromiseLike<T> {\n  return isRecord(thing) && typeof thing.then === 'function'\n}\n\n/**\n * Interface for List\n *\n * @public\n */\nexport interface List extends GenericList {\n  type: 'list'\n  /** List items. See {@link ListItem} and {@link Divider} */\n  items: (ListItem | Divider)[]\n}\n\n/**\n * Interface for list input\n *\n * @public\n */\nexport interface ListInput extends GenericListInput {\n  /** List input items array. See {@link ListItem}, {@link ListItemBuilder} and {@link Divider} */\n  items?: (ListItem | ListItemBuilder | Divider)[]\n}\n\n/**\n * Interface for buildable list\n *\n * @public\n */\nexport interface BuildableList extends BuildableGenericList {\n  /** List items. See {@link ListItem}, {@link ListItemBuilder} and {@link Divider} */\n  items?: (ListItem | ListItemBuilder | Divider)[]\n}\n\n/**\n * A `ListBuilder` is used to build a list of items in the desk tool.\n *\n * @public */\nexport class ListBuilder extends GenericListBuilder<BuildableList, ListBuilder> {\n  /** buildable list option object. See {@link BuildableList} */\n  protected spec: BuildableList\n\n  constructor(\n    /**\n     * Desk structure context. See {@link StructureContext}\n     */\n    protected _context: StructureContext,\n    spec?: ListInput,\n  ) {\n    super()\n    this.spec = spec ? spec : {}\n    this.initialValueTemplatesSpecified = Boolean(spec && spec.initialValueTemplates)\n  }\n\n  /**\n   * Set list builder based on items provided\n   * @param items - list items. See {@link ListItemBuilder}, {@link ListItem} and {@link Divider}\n   * @returns list builder based on items provided. See {@link ListBuilder}\n   */\n  items(items: (ListItemBuilder | ListItem | Divider)[]): ListBuilder {\n    return this.clone({items})\n  }\n\n  /** Get list builder items\n   * @returns list items. See {@link BuildableList}\n   */\n  getItems(): BuildableList['items'] {\n    return this.spec.items\n  }\n\n  /** Serialize list builder\n   * @param options - serialization options. See {@link SerializeOptions}\n   * @returns list based on path in options. See {@link List}\n   */\n  serialize(options: SerializeOptions = {path: []}): List {\n    const id = this.spec.id\n    if (typeof id !== 'string' || !id) {\n      throw new SerializeError(\n        '`id` is required for lists',\n        options.path,\n        options.index,\n      ).withHelpUrl(HELP_URL.ID_REQUIRED)\n    }\n\n    const items = typeof this.spec.items === 'undefined' ? [] : this.spec.items\n    if (!Array.isArray(items)) {\n      throw new SerializeError(\n        '`items` must be an array of items',\n        options.path,\n        options.index,\n      ).withHelpUrl(HELP_URL.LIST_ITEMS_MUST_BE_ARRAY)\n    }\n\n    const path = (options.path || []).concat(id)\n    const serializedItems = items.map((item, index) => maybeSerializeListItem(item, index, path))\n    const dupes = serializedItems.filter((val, i) => find(serializedItems, {id: val.id}, i + 1))\n\n    if (dupes.length > 0) {\n      const dupeIds = dupes.map((item) => item.id).slice(0, 5)\n      const dupeDesc = dupes.length > 5 ? `${dupeIds.join(', ')}...` : dupeIds.join(', ')\n      throw new SerializeError(\n        `List items with same ID found (${dupeDesc})`,\n        options.path,\n        options.index,\n      ).withHelpUrl(HELP_URL.LIST_ITEM_IDS_MUST_BE_UNIQUE)\n    }\n\n    return {\n      ...super.serialize(options),\n      type: 'list',\n      canHandleIntent: this.spec.canHandleIntent || defaultCanHandleIntent,\n      child: this.spec.child || resolveChildForItem,\n      items: serializedItems,\n    }\n  }\n\n  /**\n   * Clone list builder and return new list builder based on context and spec provided\n   * @param withSpec - list options. See {@link BuildableList}\n   * @returns new list builder based on context and spec provided. See {@link ListBuilder}\n   */\n  clone(withSpec?: BuildableList): ListBuilder {\n    const builder = new ListBuilder(this._context)\n    builder.spec = {...this.spec, ...(withSpec || {})}\n    return builder\n  }\n}\n","import {SchemaType} from '@sanity/types'\nimport {Observable} from 'rxjs'\nimport {SerializeOptions, Serializable, Collection, CollectionBuilder} from './StructureNodes'\nimport {ChildResolver, ItemChild} from './ChildResolver'\nimport {DocumentListBuilder} from './DocumentList'\nimport {SerializeError, HELP_URL} from './SerializeError'\nimport {ListBuilder} from './List'\nimport {DocumentBuilder} from './Document'\nimport {ComponentBuilder} from './Component'\nimport {validateId} from './util/validateId'\nimport {StructureContext} from './types'\nimport {getStructureNodeId} from './util/getStructureNodeId'\n\n/**\n * Unserialized list item child.\n * See {@link Collection}, {@link CollectionBuilder}, {@link ChildResolver} and {@link ItemChild}\n *\n * @public\n */\nexport type UnserializedListItemChild =\n  | Collection\n  | CollectionBuilder\n  | ChildResolver\n  | Observable<ItemChild>\n\n/**\n * Child of List Item\n * See {@link Collection}, {@link ChildResolver}, {@link ItemChild}\n * @public\n */\nexport type ListItemChild = Collection | ChildResolver | Observable<ItemChild> | undefined\n\n/**\n * Interface for serialize list item options\n *\n * @public\n */\nexport interface ListItemSerializeOptions extends SerializeOptions {\n  /** Check if list item title is optional */\n  titleIsOptional?: boolean\n}\n\n/**\n * Interface for ist item display options\n *\n * @public */\nexport interface ListItemDisplayOptions {\n  /** Check if list item display should show icon */\n  showIcon?: boolean\n}\n\n/**\n * interface for list item input\n *\n * @public */\nexport interface ListItemInput {\n  /** List item id */\n  id: string\n  /** List item title */\n  title?: string\n  /** List item icon */\n  icon?: React.ComponentType | React.ReactNode\n  /** List item child. See {@link ListItemChild} */\n  child?: ListItemChild\n  /** List item display options. See {@link ListItemDisplayOptions} */\n  displayOptions?: ListItemDisplayOptions\n  /** List item schema type. See {@link SchemaType} */\n  schemaType?: SchemaType | string\n}\n\n/**\n * Interface for List Item\n *\n * @public */\nexport interface ListItem {\n  /** List item id */\n  id: string\n  /** List item type */\n  type: string\n  /** List item title */\n  title?: string\n  /** List item icon */\n  icon?: React.ComponentType | React.ReactNode\n  /** List item child. See {@link ListItemChild} */\n  child?: ListItemChild\n  /** List item display options. See {@link ListItemDisplayOptions} */\n  displayOptions?: ListItemDisplayOptions\n  /** List item schema type. See {@link SchemaType} */\n  schemaType?: SchemaType\n}\n\n/**\n * Interface for unserialized list items.\n *\n * @public\n */\nexport interface UnserializedListItem {\n  /** List item ID */\n  id: string\n  /** List item title */\n  title: string\n  /** List item icon */\n  icon?: React.ComponentType | React.ReactNode\n  /** List item child. See {@link UnserializedListItemChild} */\n  child?: UnserializedListItemChild\n  /** List item display options. See {@link ListItemDisplayOptions} */\n  displayOptions?: ListItemDisplayOptions\n  /** List item schema. See {@link SchemaType} */\n  schemaType?: SchemaType | string\n}\n\n/**\n * Partial list item. See {@link UnserializedListItem}\n *\n * @public */\nexport type PartialListItem = Partial<UnserializedListItem>\n\n/**\n * Class for building list items\n *\n * @public */\nexport class ListItemBuilder implements Serializable<ListItem> {\n  /** List item option object. See {@link PartialListItem} */\n  protected spec: PartialListItem\n\n  constructor(\n    /**\n     * Desk structure context. See {@link StructureContext}\n     */\n    protected _context: StructureContext,\n    spec?: ListItemInput,\n  ) {\n    this.spec = spec ? spec : {}\n  }\n\n  /**\n   * Set list item ID\n   * @returns list item builder based on ID provided. See {@link ListItemBuilder}\n   */\n  id(id: string): ListItemBuilder {\n    return this.clone({id})\n  }\n\n  /**\n   * Get list item ID\n   * @returns list item ID. See {@link PartialListItem}\n   */\n  getId(): PartialListItem['id'] {\n    return this.spec.id\n  }\n\n  /**\n   * Set list item title\n   * @returns list item builder based on title provided. See {@link ListItemBuilder}\n   */\n  title(title: string): ListItemBuilder {\n    return this.clone({title, id: getStructureNodeId(title, this.spec.id)})\n  }\n\n  /**\n   * Get list item title\n   * @returns list item title. See {@link PartialListItem}\n   */\n  getTitle(): PartialListItem['title'] {\n    return this.spec.title\n  }\n\n  /**\n   * Set list item icon\n   * @returns list item builder based on icon provided. See {@link ListItemBuilder}\n   */\n  icon(icon: React.ComponentType | React.ReactNode): ListItemBuilder {\n    return this.clone({icon})\n  }\n\n  /**\n   * Set if list item should show icon\n   * @returns list item builder based on showIcon provided. See {@link ListItemBuilder}\n   */\n  showIcon(enabled = true): ListItemBuilder {\n    return this.clone({\n      displayOptions: {...(this.spec.displayOptions || {}), showIcon: enabled},\n    })\n  }\n\n  /**\n   * Check if list item should show icon\n   * @returns true if it should show the icon, false if not, undefined if not set\n   */\n  getShowIcon(): boolean | undefined {\n    return this.spec.displayOptions ? this.spec.displayOptions.showIcon : undefined\n  }\n\n  /**\n   *Get list item icon\n   * @returns list item icon. See {@link PartialListItem}\n   */\n  getIcon(): PartialListItem['icon'] {\n    return this.spec.icon\n  }\n\n  /**\n   * Set list item child\n   * @param child - list item child. See {@link UnserializedListItemChild}\n   * @returns list item builder based on child provided. See {@link ListItemBuilder}\n   */\n  child(child: UnserializedListItemChild): ListItemBuilder {\n    return this.clone({child})\n  }\n\n  /**\n   * Get list item child\n   * @returns list item child. See {@link PartialListItem}\n   */\n  getChild(): PartialListItem['child'] {\n    return this.spec.child\n  }\n\n  /**\n   * Set list item schema type\n   * @param schemaType - list item schema type. See {@link SchemaType}\n   * @returns list item builder based on schema type provided. See {@link ListItemBuilder}\n   */\n  schemaType(schemaType: SchemaType | string): ListItemBuilder {\n    return this.clone({schemaType})\n  }\n\n  /**\n   * Get list item schema type\n   * @returns list item schema type. See {@link PartialListItem}\n   */\n  getSchemaType(): PartialListItem['schemaType'] {\n    const schemaType = this.spec.schemaType\n\n    if (typeof schemaType === 'string') {\n      return this._context.schema.get(schemaType)\n    }\n\n    return this.spec.schemaType\n  }\n\n  /** Serialize list item builder\n   * @param options - serialization options. See {@link ListItemSerializeOptions}\n   * @returns list item node based on path provided in options. See {@link ListItem}\n   */\n  serialize(options: ListItemSerializeOptions = {path: []}): ListItem {\n    const {id, title, child} = this.spec\n    if (typeof id !== 'string' || !id) {\n      throw new SerializeError(\n        '`id` is required for list items',\n        options.path,\n        options.index,\n      ).withHelpUrl(HELP_URL.ID_REQUIRED)\n    }\n\n    if (!options.titleIsOptional && (typeof title !== 'string' || !title)) {\n      throw new SerializeError('`title` is required for list items', options.path, id).withHelpUrl(\n        HELP_URL.TITLE_REQUIRED,\n      )\n    }\n\n    let schemaType = this.spec.schemaType\n    if (typeof schemaType === 'string') {\n      const type = this._context.schema.get(schemaType)\n      if (!type) {\n        throw new SerializeError(\n          `Could not find type \"${schemaType}\" in schema`,\n          options.path,\n          id,\n        ).withHelpUrl(HELP_URL.SCHEMA_TYPE_NOT_FOUND)\n      }\n\n      schemaType = type\n    }\n\n    const serializeOptions = {path: options.path.concat(id), hint: 'child'}\n    let listChild =\n      child instanceof ComponentBuilder ||\n      child instanceof DocumentListBuilder ||\n      child instanceof DocumentBuilder ||\n      child instanceof ListBuilder\n        ? child.serialize(serializeOptions)\n        : child\n\n    // In the case of a function, create a bound version that will pass the correct serialize\n    // context, so we may lazily resolve it at some point in the future without losing context\n    if (typeof listChild === 'function') {\n      const originalChild = listChild\n      listChild = (itemId, childOptions) => {\n        return originalChild(itemId, {...childOptions, serializeOptions})\n      }\n    }\n\n    return {\n      ...this.spec,\n      id: validateId(id, options.path, options.index),\n      schemaType,\n      child: listChild,\n      title,\n      type: 'listItem',\n    }\n  }\n\n  /** Clone list item builder\n   * @param withSpec - partial list item options. See {@link PartialListItem}\n   * @returns list item builder based on context and spec provided. See {@link ListItemBuilder}\n   */\n  clone(withSpec?: PartialListItem): ListItemBuilder {\n    const builder = new ListItemBuilder(this._context)\n    builder.spec = {...this.spec, ...(withSpec || {})}\n    return builder\n  }\n}\n","import {SchemaType} from '@sanity/types'\nimport {SerializeOptions} from './StructureNodes'\nimport {ListItemBuilder, ListItem, UnserializedListItem, ListItemInput} from './ListItem'\nimport {SerializeError, HELP_URL} from './SerializeError'\nimport {DocumentBuilder} from './Document'\nimport {StructureContext} from './types'\nimport {isRecord} from 'sanity'\n\n/**\n * Interface for document list item input\n *\n * @public\n */\nexport interface DocumentListItemInput extends ListItemInput {\n  /** Document list item input schema type. See {@link SchemaType} */\n  schemaType: SchemaType | string\n}\n\n/**\n * Interface for document list item\n *\n * @public\n */\nexport interface DocumentListItem extends ListItem {\n  /** Document schema type. See {@link SchemaType} */\n  schemaType: SchemaType\n  /** Document ID */\n  _id: string\n}\n\n/**\n * Partial document list item\n *\n * @public\n */\nexport type PartialDocumentListItem = Partial<UnserializedListItem>\n\nconst createDefaultChildResolver =\n  (context: StructureContext, spec: PartialDocumentListItem) => (documentId: string) => {\n    const schemaType =\n      spec.schemaType &&\n      (typeof spec.schemaType === 'string' ? spec.schemaType : spec.schemaType.name)\n\n    return schemaType\n      ? context.resolveDocumentNode({schemaType, documentId})\n      : new DocumentBuilder(context).id('documentEditor').documentId(documentId)\n  }\n\n/**\n * Class for building a document list item\n *\n * @public\n */\nexport class DocumentListItemBuilder extends ListItemBuilder {\n  /** Document list options. See {@link PartialDocumentListItem} */\n  protected spec: PartialDocumentListItem\n\n  constructor(\n    /**\n     * Desk structure context. See {@link StructureContext}\n     */\n    protected _context: StructureContext,\n    spec?: DocumentListItemInput,\n  ) {\n    super(_context, spec)\n    this.spec = spec ? spec : {}\n  }\n\n  /**\n   * Serialize document list item\n   * @param options - serialization options. See {@link SerializeOptions}\n   * @returns document list item object based on path provided in options. See {@link DocumentListItem}\n   */\n  serialize(options: SerializeOptions = {path: []}): DocumentListItem {\n    const spec = super.serialize({...options, titleIsOptional: true})\n\n    if (!spec.schemaType) {\n      throw new SerializeError(\n        '`schemaType` is required for document list items',\n        options.path,\n        options.index,\n      ).withHelpUrl(HELP_URL.SCHEMA_TYPE_REQUIRED)\n    }\n\n    const child = spec.child || createDefaultChildResolver(this._context, spec)\n    return {...spec, child, schemaType: spec.schemaType, _id: spec.id}\n  }\n\n  /** Clone Document list item builder (allows for options overriding)\n   * @param withSpec - Document list item builder options. See {@link PartialDocumentListItem}\n   * @returns document list item builder. See {@link DocumentListItemBuilder}\n   */\n  clone(withSpec?: PartialDocumentListItem): DocumentListItemBuilder {\n    const builder = new DocumentListItemBuilder(this._context)\n    builder.spec = {...this.spec, ...(withSpec || {})}\n    return builder\n  }\n}\n\n/** @internal */\nexport function isDocumentListItem(item: unknown): item is DocumentListItem {\n  return isRecord(item) && typeof item.schemaType !== 'undefined' && typeof item._id === 'string'\n}\n","import {SchemaType} from '@sanity/types'\nimport {DocumentListBuilder, DocumentListInput, PartialDocumentList} from './DocumentList'\nimport {Child} from './StructureNodes'\nimport {DEFAULT_INTENT_HANDLER} from './Intent'\nimport {GenericListInput} from './GenericList'\nimport {StructureContext} from './types'\n\n/**\n * Interface for document type list input\n *\n * @public\n */\nexport interface DocumentTypeListInput extends Partial<GenericListInput> {\n  /** Document type list input schema type. See {@link SchemaType} */\n  schemaType: SchemaType | string\n}\n\n/**\n * Class for building a document type list\n *\n * @public\n */\nexport class DocumentTypeListBuilder extends DocumentListBuilder {\n  /** Document list options. See {@link PartialDocumentList} */\n  protected spec: PartialDocumentList\n\n  constructor(\n    /**\n     * Desk structure context. See {@link StructureContext}\n     */\n    protected _context: StructureContext,\n    spec?: DocumentListInput,\n  ) {\n    super(_context)\n    this.spec = spec ? spec : {}\n  }\n\n  /**\n   * Set Document type list child\n   * @param child - Child component. See {@link Child}\n   * @returns document type list builder based on child component provided without default intent handler. See {@link DocumentTypeListBuilder}\n   */\n  child(child: Child): DocumentTypeListBuilder {\n    return this.cloneWithoutDefaultIntentHandler({child})\n  }\n\n  /** Clone Document type list builder (allows for options overriding)\n   * @param withSpec - Document type list builder options. See {@link PartialDocumentList}\n   * @returns document type list builder. See {@link DocumentTypeListBuilder}\n   */\n  clone(withSpec?: PartialDocumentList): DocumentTypeListBuilder {\n    const parent = super.clone(withSpec)\n    const builder = new DocumentTypeListBuilder(this._context)\n    builder.spec = {...this.spec, ...parent.getSpec(), ...(withSpec || {})}\n    return builder\n  }\n\n  /** Clone Document type list builder (allows for options overriding) and remove default intent handler\n   * @param withSpec - Document type list builder options. See {@link PartialDocumentList}\n   * @returns document type list builder without default intent handler. See {@link DocumentTypeListBuilder}\n   */\n  cloneWithoutDefaultIntentHandler(withSpec?: PartialDocumentList): DocumentTypeListBuilder {\n    const parent = super.clone(withSpec)\n    const builder = new DocumentTypeListBuilder(this._context)\n    const canHandleIntent = this.spec.canHandleIntent\n    const shouldOverride = canHandleIntent && canHandleIntent.identity === DEFAULT_INTENT_HANDLER\n    const override = shouldOverride ? {canHandleIntent: undefined} : {}\n    builder.spec = {\n      ...parent.getSpec(),\n      ...this.spec,\n      ...(withSpec || {}),\n      ...override,\n    }\n    return builder\n  }\n}\n","import {SchemaType} from '@sanity/types'\nimport {startCase} from 'lodash'\nimport {StackCompactIcon, StackIcon} from '@sanity/icons'\nimport {MenuItemBuilder, getOrderingMenuItemsForSchemaType} from './MenuItem'\nimport {DEFAULT_SELECTED_ORDERING_OPTION} from './Sort'\nimport {DocumentListBuilder} from './DocumentList'\nimport {ListItemBuilder, ListItem} from './ListItem'\nimport {DocumentTypeListBuilder, DocumentTypeListInput} from './DocumentTypeList'\nimport {defaultIntentChecker} from './Intent'\nimport {List} from './List'\nimport {Collection} from './StructureNodes'\nimport {StructureContext} from './types'\n\nfunction shouldShowIcon(schemaType: SchemaType): boolean {\n  const preview = schemaType.preview\n  return Boolean(preview && (preview.prepare || (preview.select && preview.select.media)))\n}\n\nconst BUNDLED_DOC_TYPES = ['sanity.imageAsset', 'sanity.fileAsset']\n\nfunction isBundledDocType(typeName: string) {\n  return BUNDLED_DOC_TYPES.includes(typeName)\n}\n\nfunction isDocumentType(schemaType: SchemaType) {\n  return schemaType.type?.name === 'document'\n}\n\nfunction isList(collection: Collection): collection is List {\n  return collection.type === 'list'\n}\n\nexport function getDocumentTypes({schema}: StructureContext): string[] {\n  return schema\n    .getTypeNames()\n    .filter((n) => {\n      const schemaType = schema.get(n)\n      return schemaType && isDocumentType(schemaType)\n    })\n    .filter((n) => !isBundledDocType(n))\n}\n\nexport function getDocumentTypeListItems(context: StructureContext): ListItemBuilder[] {\n  const types = getDocumentTypes(context)\n  return types.map((typeName) => getDocumentTypeListItem(context, typeName))\n}\n\nexport function getDocumentTypeListItem(\n  context: StructureContext,\n  typeName: string,\n): ListItemBuilder {\n  const {schema} = context\n\n  const type = schema.get(typeName)\n  if (!type) {\n    throw new Error(`Schema type with name \"${typeName}\" not found`)\n  }\n\n  const title = type.title || startCase(typeName)\n\n  return new ListItemBuilder(context)\n    .id(typeName)\n    .title(title)\n    .schemaType(type)\n    .child((id, childContext) => {\n      const parent = childContext.parent as Collection\n      const parentItem = isList(parent)\n        ? (parent.items.find((item) => item.id === id) as ListItem)\n        : null\n\n      let list = getDocumentTypeList(context, typeName)\n      if (parentItem && parentItem.title) {\n        list = list.title(parentItem.title)\n      }\n\n      return list\n    })\n}\n\nexport function getDocumentTypeList(\n  context: StructureContext,\n  typeNameOrSpec: string | DocumentTypeListInput,\n): DocumentListBuilder {\n  const {schema, resolveDocumentNode} = context\n\n  const schemaType = typeof typeNameOrSpec === 'string' ? typeNameOrSpec : typeNameOrSpec.schemaType\n  const typeName = typeof schemaType === 'string' ? schemaType : schemaType.name\n  const spec: DocumentTypeListInput =\n    typeof typeNameOrSpec === 'string' ? {schemaType} : typeNameOrSpec\n\n  const type = schema.get(typeName)\n  if (!type) {\n    throw new Error(`Schema type with name \"${typeName}\" not found`)\n  }\n\n  const title = type.title || startCase(typeName)\n  const showIcons = shouldShowIcon(type)\n\n  return new DocumentTypeListBuilder(context)\n    .id(spec.id || typeName)\n    .title(spec.title || title)\n    .filter('_type == $type')\n    .params({type: typeName})\n    .schemaType(type)\n    .showIcons(showIcons)\n    .defaultOrdering(DEFAULT_SELECTED_ORDERING_OPTION.by)\n    .menuItemGroups(\n      spec.menuItemGroups || [\n        {id: 'sorting', title: 'Sort'},\n        {id: 'layout', title: 'Layout'},\n        {id: 'actions', title: 'Actions'},\n      ],\n    )\n    .child(\n      spec.child ||\n        ((documentId: string) => resolveDocumentNode({schemaType: typeName, documentId})),\n    )\n    .canHandleIntent(spec.canHandleIntent || defaultIntentChecker)\n    .menuItems(\n      spec.menuItems || [\n        // Create new (from action button) will be added in serialization step of GenericList\n\n        // Sort by <Y>\n        ...getOrderingMenuItemsForSchemaType(context, type),\n\n        // Display as <Z>\n        new MenuItemBuilder(context)\n          .group('layout')\n          .title('Compact view')\n          .icon(StackCompactIcon)\n          .action('setLayout')\n          .params({layout: 'default'}),\n\n        new MenuItemBuilder(context)\n          .group('layout')\n          .title('Detailed view')\n          .icon(StackIcon)\n          .action('setLayout')\n          .params({layout: 'detail'}),\n\n        // Create new (from menu) will be added in serialization step of GenericList\n      ],\n    )\n}\n","import {uniqueId} from 'lodash'\nimport type {SchemaType} from '@sanity/types'\nimport {isValidElementType} from 'react-is'\nimport {ListBuilder} from './List'\nimport {\n  getDocumentTypeListItems,\n  getDocumentTypeListItem,\n  getDocumentTypeList,\n} from './documentTypeListItems'\nimport {MenuItemBuilder, getOrderingMenuItemsForSchemaType, getOrderingMenuItem} from './MenuItem'\nimport {ListItemBuilder} from './ListItem'\nimport {MenuItemGroupBuilder} from './MenuItemGroup'\nimport {DocumentListBuilder} from './DocumentList'\nimport type {Divider} from './StructureNodes'\nimport {DocumentBuilder, documentFromEditor, documentFromEditorWithInitialValue} from './Document'\nimport {ComponentInput, ComponentBuilder} from './Component'\nimport {DocumentListItemBuilder} from './DocumentListItem'\nimport * as views from './views'\nimport {\n  InitialValueTemplateItemBuilder,\n  defaultInitialValueTemplateItems,\n  menuItemsFromInitialValueTemplateItems,\n} from './InitialValueTemplateItem'\nimport type {\n  StructureBuilder,\n  UserComponent,\n  StructureContext,\n  DefaultDocumentNodeResolver,\n} from './types'\nimport {Source, getConfigContextFromSource, getPublishedId} from 'sanity'\n\n/** @internal */\nexport interface StructureBuilderOptions {\n  source: Source\n  defaultDocumentNode?: DefaultDocumentNodeResolver\n}\n\nfunction hasIcon(schemaType?: SchemaType | string): boolean {\n  if (!schemaType || typeof schemaType === 'string') {\n    return false\n  }\n\n  return Boolean(schemaType.icon)\n}\n\nfunction getDefaultStructure(context: StructureContext): ListBuilder {\n  const items = getDocumentTypeListItems(context)\n  return new ListBuilder(context)\n    .id('__root__')\n    .title('Content')\n    .items(items)\n    .showIcons(items.some((item) => hasIcon(item.getSchemaType())))\n}\n\n/** @internal */\nexport function createStructureBuilder({\n  defaultDocumentNode,\n  source,\n}: StructureBuilderOptions): StructureBuilder {\n  const configContext = getConfigContextFromSource(source)\n  const context: StructureContext = {\n    ...source,\n    getStructureBuilder: () => structureBuilder,\n    resolveDocumentNode: (options) => {\n      let builder =\n        defaultDocumentNode?.(structureBuilder, {...options, ...configContext}) ||\n        new DocumentBuilder(context)\n\n      if (!builder.getId()) {\n        builder = builder.id('documentEditor')\n      }\n\n      if (options.documentId) {\n        builder = builder.documentId(getPublishedId(options.documentId))\n      }\n\n      return builder.schemaType(options.schemaType)\n    },\n  }\n\n  const structureBuilder: StructureBuilder = {\n    defaults: () => getDefaultStructure(context),\n    documentTypeList: (...args) => getDocumentTypeList(context, ...args),\n    documentTypeListItem: (...args) => getDocumentTypeListItem(context, ...args),\n    documentTypeListItems: (...args) => getDocumentTypeListItems(context, ...args),\n    document: (...args) => new DocumentBuilder(context, ...args),\n    documentWithInitialValueTemplate: (...args) =>\n      documentFromEditorWithInitialValue(context, ...args),\n    defaultDocument: context.resolveDocumentNode,\n\n    list: (...args) => new ListBuilder(context, ...args),\n    listItem: (...args) => new ListItemBuilder(context, ...args),\n\n    menuItem: (...args) => new MenuItemBuilder(context, ...args),\n    menuItemGroup: (...args) => new MenuItemGroupBuilder(context, ...args),\n    menuItemsFromInitialValueTemplateItems: (...args) =>\n      menuItemsFromInitialValueTemplateItems(context, ...args),\n\n    documentList: (...args) => new DocumentListBuilder(context, ...args),\n    documentListItem: (...args) => new DocumentListItemBuilder(context, ...args),\n\n    orderingMenuItem: (...args) => getOrderingMenuItem(context, ...args),\n    orderingMenuItemsForType: (...args) => getOrderingMenuItemsForSchemaType(context, ...args),\n\n    editor: (...args) => documentFromEditor(context, ...args),\n\n    defaultInitialValueTemplateItems: (...args) =>\n      defaultInitialValueTemplateItems(context, ...args),\n\n    initialValueTemplateItem: (\n      templateId: string,\n      parameters?: Record<string, unknown>,\n    ): InitialValueTemplateItemBuilder =>\n      new InitialValueTemplateItemBuilder(context, {\n        id: templateId,\n        parameters,\n        templateId,\n      }),\n\n    component: (spec?: ComponentInput | UserComponent) => {\n      return isValidElementType(spec)\n        ? new ComponentBuilder().component(spec as UserComponent)\n        : new ComponentBuilder(spec as ComponentInput)\n    },\n\n    divider: (): Divider => ({id: uniqueId('__divider__'), type: 'divider'}),\n\n    view: views,\n    context,\n  }\n\n  return structureBuilder\n}\n","import React, {useMemo, useState} from 'react'\nimport {DeskToolContext} from './DeskToolContext'\nimport {createStructureBuilder, DefaultDocumentNodeResolver} from './structureBuilder'\nimport {DeskToolContextValue, StructureResolver, UnresolvedPaneNode} from './types'\nimport {useConfigContextFromSource, useDocumentStore, useSource} from 'sanity'\n\n/** @internal */\nexport interface DeskToolProviderProps {\n  structure?: StructureResolver\n  defaultDocumentNode?: DefaultDocumentNodeResolver\n  children: React.ReactNode\n}\n\n/** @internal */\nexport function DeskToolProvider({\n  defaultDocumentNode,\n  structure: resolveStructure,\n  children,\n}: DeskToolProviderProps): React.ReactElement {\n  const [layoutCollapsed, setLayoutCollapsed] = useState(false)\n  const source = useSource()\n  const configContext = useConfigContextFromSource(source)\n  const documentStore = useDocumentStore()\n\n  const S = useMemo(() => {\n    return createStructureBuilder({\n      defaultDocumentNode,\n      source,\n    })\n  }, [defaultDocumentNode, source])\n\n  const rootPaneNode = useMemo(() => {\n    // TODO: unify types and remove cast\n    if (resolveStructure)\n      return resolveStructure(S, {\n        ...configContext,\n        documentStore,\n      }) as UnresolvedPaneNode\n    return S.defaults() as UnresolvedPaneNode\n  }, [S, resolveStructure, configContext, documentStore])\n\n  const features: DeskToolContextValue['features'] = useMemo(\n    () => ({\n      backButton: layoutCollapsed,\n      resizablePanes: !layoutCollapsed,\n      reviewChanges: !layoutCollapsed,\n      splitPanes: !layoutCollapsed,\n      splitViews: !layoutCollapsed,\n    }),\n    [layoutCollapsed],\n  )\n\n  const deskTool: DeskToolContextValue = useMemo(() => {\n    return {\n      features,\n      layoutCollapsed,\n      setLayoutCollapsed,\n      rootPaneNode,\n      structureContext: S.context,\n    }\n  }, [features, layoutCollapsed, rootPaneNode, S.context])\n\n  return <DeskToolContext.Provider value={deskTool}>{children}</DeskToolContext.Provider>\n}\n"],"names":["Delay","_ref","children","ms","ready","setReady","useState","useEffect","timeoutId","setTimeout","clearTimeout","jsx","Fragment","DocTitle","props","document","documentValue","schema","useSchema","schemaType","get","_type","error","value","useValuePreview","jsxs","message","title","style","color","TimeAgo","_ref2","time","timeAgo","useTimeAgo","isClientError","e","POLL_INTERVAL","visiblePoll$","getVisiblePoll$","fromEvent","pipe","startWith","map","visibilityState","distinctUntilChanged","switchMap","visible","timer","EMPTY","shareReplay","refCount","bufferSize","getDocumentExistence","documentId","_ref3","versionedClient","draftId","getDraftId","publishedId","getPublishedId","requestOptions","uri","getDataUrl","concat","json","query","excludeContent","tag","observable","request","_ref4","omitted","nonExistant","filter","doc","reason","length","some","id","fetchCrossDatasetReferences","context","checkDocumentId","of","totalCount","references","currentDataset","config","dataset","url","catchError","statusCode","useInternalReferences","createHookFromObservableFactory","_ref5","documentStore","referencesClause","totalClause","fetchQuery","listenQuery","fetch","listen","transitions","throttleTime","useCrossDatasetReferences","_ref6","useReferringDocuments","useClient","DEFAULT_STUDIO_CLIENT_OPTIONS","useDocumentStore","internalReferences","isInternalReferencesLoading","useMemo","crossDatasetReferences","isCrossDatasetReferencesLoading","projectIds","Array","from","Set","crossDatasetReference","projectId","Boolean","sort","datasetNames","datasetName","hasUnknownDatasetNames","isLoading","PublishedStatus","updatedAt","_updatedAt","statusLabel","Tooltip","portal","content","Box","padding","Text","size","TextWithTone","tone","dimmed","muted","PublishIcon","DraftStatus","EditIcon","PaneItemPreview","icon","layout","presence","isRecord","isValidElement","isString","isNumber","draft","published","useMemoObservable","getPreviewStateObservable","documentPreviewStore","_id","status","Inline","space","DocumentPreviewPresence","SanityDefaultPreview","getPreviewValueWithFallback","isPlaceholder","missingContext","Error","PaneRouterContext","createContext","index","groupIndex","siblingIndex","payload","params","hasGroupSiblings","groupLength","routerPanesState","BackLink","ChildLink","ReferenceChildLink","handleEditReference","ParameterizedLink","replaceCurrent","closeCurrentAndAfter","closeCurrent","duplicateCurrent","setView","setParams","setPayload","navigateIntent","forwardRef","ref","useContext","panes","slice","state","StateLink","PaneLayoutContext","usePaneLayout","pane","childId","childPayload","childParameters","rest","documentType","parentRefPath","template","type","pathToString","currentPanes","nextParams","useUnique","nextPayload","nextState","currentGroup","currentSibling","nextSibling","nextGroup","nextPanes","usePaneRouter","EMPTY_ARRAY","ReferencePreviewLink","onClick","documentPresence","useDocumentPresence","useDocumentPreviewStore","Link","useCallback","LinkComponent","linkProps","name","PreviewCard","__unstable_focusRing","as","radius","_a","_b","_c","_d","_e","ChevronWrapper","styled","__template","CrossDatasetReferencesDetails","default","details","CrossDatasetReferencesSummary","summary","Table","table","_ref8","theme","rem","sanity","_ref9","_ref10","DocumentIdFlex","Flex","OtherReferenceCount","difference","placement","Container","width","InfoOutlineIcon","ConfirmDeleteDialogBody","_ref11","documentTitle","action","onReferenceLinkClick","toast","useToast","renderPreviewItem","item","UnknownIcon","subtitle","documentCount","toLocaleString","normalizedDatasetNames","datasetsCount","datasetNameList","join","Card","marginBottom","flex","WarningOutlineIcon","marginLeft","shadow","direction","Stack","borderTop","margin","paddingY","align","marginRight","DocumentsIcon","textOverflow","ChevronDownIcon","overflow","paddingBottom","paddingX","Label","minWidth","reference","_ref12","gap","justify","CopyToClipboard","text","onCopy","push","Button","mode","CopyIcon","fontSize","DialogBody","attrs","LoadingContainer","ConfirmDeleteDialog","_ref13","onCancel","onConfirm","dialogId","useId","capitalizedAction","substring","toUpperCase","showConfirmButton","Dialog","header","footer","Grid","columns","onClose","onClickOutside","Spinner","marginTop","ConfirmDeleteDialogContainer","setError","handleRetry","ErrorBoundary","onCatch","MENU_GROUP_POPOVER_PROPS","constrainSize","PaneMenuButtonItem","disabled","isAfterGroup","node","MenuDivider","expanded","child","childIndex","key","MenuGroup","popover","PaneContextMenuItemResolver","intent","PaneContextIntentMenuItem","PaneContextMenuItem","tooltipContent","TooltipOfDisabled","MenuItem","hotkeys","hotkey","split","iconRight","selected","CheckmarkIcon","onAction","pressed","intentLink","useIntentLink","handleClick","event","href","CONTEXT_MENU_POPOVER_PROPS","nodesHasTone","nodes","PaneContextMenuButton","hasCritical","hasCaution","MenuButton","button","StatusButton","EllipsisVerticalIcon","menu","Menu","nodeIndex","PANE_DEBUG","PANE_COLLAPSED_WIDTH","PANE_DEFAULT_MIN_WIDTH","PaneContext","Root","Layer","PaneDivider","_ref14","element","resize","dragging","setDragging","handleMouseDown","preventDefault","startX","pageX","handleMouseMove","deltaX","handleMouseUp","window","removeEventListener","addEventListener","onMouseDown","Pane","currentMinWidth","currentMinWidthProp","currentMaxWidth","currentMaxWidthProp","flexProp","minWidthProp","maxWidth","maxWidthProp","restProps","rootElement","setRootElement","collapse","collapsed","layoutCollapsed","expand","expandedElement","mount","find","p","paneIndex","indexOf","nextPane","isLast","nextCollapsed","forwardedRef","useForwardedRef","setRef","refValue","current","handleCollapse","handleExpand","contextValue","hidden","divider","LegacyLayerProvider","zOffset","Infinity","Provider","BoundaryElementProvider","height","usePane","displayName","PaneContent","forwardedAs","RootCard","PaneFooter","_f","Layout","TitleCard","_ref15","fg","bg","card","enabled","css","TitleTextSkeleton","TextSkeleton","TitleText","TabsBox","_ref16","rgba","base","PaneHeader","actions","backButton","contentAfter","loading","subActions","tabs","tabIndex","paneElement","paneRect","useElementRect","layoutStyle","innerHeight","handleTitleClick","handleLayoutClick","showTabsOrSubActions","LayerProvider","sizing","paddingLeft","animated","weight","paddingTop","PaneHeaderActionButton","PaneHeaderMenuItemActionButton","PaneHeaderMenuGroupActionButton","console","warn","PaneHeaderActionIntentButton","disabledTooltipContent","label","idx","isMenuNodeButton","renderAsButton","isNotMenuNodeButton","negate","resolveMenuNodes","fieldActions","menuItems","menuItemGroups","keyOffset","i","a","mapFieldActionToPaneMenuNode","groups","itemGroup","group","g","ungroupedItems","shortcut","actionHandler","showAsAction","childIdx","IntentButton","Link2","linkRef","IntentLink","role","InsufficientPermissionsMessageTooltip","_ref17","reveal","currentUser","useCurrentUser","InsufficientPermissionsMessage","POPOVER_PROPS","getIntent","templates","typeName","t","templateId","baseParams","initialDocumentId","parameters","PaneHeaderCreateButton","_ref18","templateItems","useTemplates","templatePermissions","isTemplatePermissionsLoading","useTemplatePermissions","nothingGranted","every","permission","granted","permissionsById","reduce","acc","ComposeIcon","firstItem","permissions","itemIndex","isNonNullable","hashObject","sortObject","v","isArray","Object","entries","_ref19","_ref20","keyA","keyB","localeCompare","normalize","JSON","parse","stringify","PaneHeaderActions","memo","initialValueTemplateItems","initialValueTemplateItemsFromStructure","actionHandlers","EMPTY_OBJECT","handleAction","handler","menuNodes","actionNodes","contextMenuNodes","initialValueTemplateItemFromMenuItems","menuItemIndex","intentParams","templateParams","_ref21","initialValueTemplateItem","description","combinedInitialValueTemplates","uniqBy","DocumentPaneContext","useDocumentPane","documentPane","DISABLED_REASON_TITLE","NOTHING_TO_DELETE","DeleteAction","_ref22","onComplete","setIsDeleting","paneSetIsDeleting","delete","deleteOp","useDocumentOperation","isDeleting","isConfirmDialogOpen","setConfirmDialogOpen","handleCancel","handleConfirm","execute","handle","isPermissionsLoading","useDocumentPairPermissions","TrashIcon","operationLabel","onHandle","dialog","component","NO_CHANGES","NOT_PUBLISHED","DiscardChangesAction","_ref23","liveEdit","discardChanges","ResetIcon","NOTHING_TO_DUPLICATE","DuplicateAction","_ref24","duplicate","useRouter","isDuplicating","setDuplicating","dupeId","uuid","HistoryRestoreAction","_ref25","revision","restore","useDocumentOperationEvent","prevEvent","useRef","op","isRevisionInitialVersion","isRevisionLatestVersion","RestoreIcon","LIVE_EDIT_ENABLED","ALREADY_PUBLISHED","NOT_READY","getDisabledReason","publishedAt","PublishAction","publishState","setPublishState","publish","validationStatus","useValidationStatus","syncState","useSyncState","changesOpen","onHistoryOpen","editState","useEditState","_rev","hasValidationErrors","validation","isValidationErrorMarker","publishScheduled","setPublishScheduled","isSyncing","isValidating","hasDraft","doPublish","validationComplete","didPublish","delay","transactionSyncLock","UnpublishAction","_ref26","unpublish","UnpublishIcon","LiveEditBadge","_DEBUG","EMPTY_PARAMS","LOADING_PANE","Symbol","DOCUMENT_PANEL_PORTAL_ELEMENT","activePanes","setActivePanes","getIntentState","routerState","editDocumentId","isTemplate","canHandleIntent","call","schemaTypeName","options","paneParams","legacyEditParamsToState","decodeURIComponent","err","encodePanesSegment","encodeChunks","encodeURIComponent","legacyEditParamsToPath","toState","pathSegment","parsePanesSegment","toPath","router","route","create","intents","path","transform","panePattern","isParam","str","test","isPayload","exclusiveParams","isTruthy","parseChunks","chunks","initial","chunk","tryParseBase64Payload","firstSibling","paneIsFirstSibling","sameAsFirst","encodedPayload","btoa","encodedParams","entry","valueFromFirstSibling","includes","_ref27","flat","parseOldPanesSegment","restOfSiblings","segment","sibling","omit","buffer","match","payloadChunk","tryParsePayload","data","atob","DOCUMENT_PANEL_MIN_WIDTH","DOCUMENT_PANEL_INITIAL_MIN_WIDTH","DOCUMENT_INSPECTOR_MIN_WIDTH","DOCUMENT_INSPECTOR_MAX_WIDTH","INSPECT_ACTION_PREFIX","DEFAULT_MENU_ITEM_GROUPS","HISTORY_INSPECTOR_NAME","VALIDATION_INSPECTOR_NAME","position","zIndex","lineHeight","display","left","bottom","right","borderBottom","opacity","DocumentInspectorHeader","closeButtonLabel","CloseIcon","DeskToolContext","useDeskTool","deskTool","div","Resizer","onResize","onResizeStart","mouseXRef","Resizable","setElement","elementWidthRef","targetWidth","setTargetWidth","handleResizeStart","offsetWidth","handleResize","w","Math","min","max","getPathTypes","result","s","jsonType","field","fields","f","itemType","ofType","_key","values","MARKER_ICON","ErrorOutlineIcon","warning","info","MARKER_TONE","ValidationInspector","onFocus","onPathOpen","handleOpen","marker","ValidationCard","onOpen","errorInfo","setErrorInfo","level","createElement","DocumentNodePathBreadcrumbs","pathTypes","fontWeight","useMenuItem","validationMarkers","hasErrors","isValidationError","hasWarnings","isValidationWarning","CheckmarkCircleIcon","validationInspector","TIMELINE_LABELS","discardDraft","editDraft","editLive","TIMELINE_ICON_COMPONENTS","AddCircleIcon","formatTimelineEventLabel","getTimelineEventIconComponent","UserAvatarStack","_ref28","maxLength","userIds","AvatarStack","userId","UserAvatar","user","withTooltip","_g","IconWrapper","_ref29","borderColor","skeleton","_ref30","$selected","$disabled","IconBox","EventLabel","TimestampBox","_ref31","TIMELINE_ITEM_EVENT_TONE","withinSelection","TimelineItem","_ref32","isFirst","isLatest","isSelected","onSelect","timestamp","iconComponent","authorUserIds","authors","isSelectable","formattedTimestamp","parsedDate","Date","formattedDate","format","evt","stopPropagation","StackWrapper","ListWrapper","_ref33","$visible","Timeline","_ref34","disabledBeforeFirstChunk","hasMoreChunks","lastChunk","onLoadMore","firstChunk","mounted","setMounted","filteredChunks","c","selectedIndex","findIndex","renderItem","_ref35","activeIndex","endTimestamp","CommandList","activeItemDataAttr","ariaLabel","autoFocus","initialIndex","initialScrollAlign","itemHeight","items","onEndReached","onEndReachedIndexOffset","overscan","wrapAround","TimelineError","Popover","TimelineMenu","_ref36","setTimelineRange","setTimelineMode","timelineError","timelineStore","isDeleted","open","setOpen","setButton","setPopover","useTimelineSelector","realRevChunk","sinceTime","handleClose","handleClickOutside","handleGlobalKeyDown","focus","useClickOutside","useGlobalKeyDown","selectRev","revChunk","sinceId","revId","findRangeForRev","closable","selectSince","sinceChunk","findRangeForSince","handleLoadMore","loadMore","timeLabel","useFormattedTimestamp","revLabel","upperFirst","sinceLabel","buttonLabel","SelectIcon","formatted","LoadingContent","collectLatestAuthorAnnotations","diff","authorMap","Map","visitDiff","annotation","author","previous","set","b","Scroller","ScrollContainer","ChangesInspector","scrollRef","onOlderRevision","selectionState","isComparingCurrent","documentContext","React","FieldWrapper","ChangeFieldWrapper","rootDiff","changeAnnotations","DiffTooltip","annotations","_ref37","Content","_ref38","NoChanges","DocumentChangeContext","ChangeList","changesInspector","features","reviewChanges","_ref39","since","_ref40","documentActions","documentBadges","inspectors","definePlugin","prevActions","badges","prevBadges","prevInspectors","tools","MasterDetailIcon","lazy","Promise","resolve","then","require","controlsDocumentTitle","getInspectorItems","_ref41","currentInspector","hasValue","inspectorMenuItems","inspector","menuItem","isDisabled","getInspectItem","_ref42","BinaryDocumentIcon","getProductionPreviewItem","_ref43","previewUrl","EarthAmericasIcon","getMenuItems","inspectorItems","isSanityDocument","usePreviewUrl","setPreviewUrl","resolveProductionUrl","useSource","value$","useAsObservable","debounceTime","subscribe","next","getInitialValueTemplateOpts","opts","panePayload","structureNodeTemplate","templateName","urlTemplate","typeTemplates","InspectorMenuItem","setMenuItem","DocumentInspectorMenuItemsResolver","onMenuItems","len","lenRef","setMenuItems","menuItemsRef","newFieldActions","prev","inspectorIndex","DocumentPaneProvider","paneKey","unstable_fieldActions","fieldActionsResolver","unstable_languageFilter","languageFilterResolver","inspectorsResolver","presenceStore","usePresenceStore","paneRouter","setPaneParams","pushToast","views","viewsProp","paneOptions","documentIdRaw","templateParameters","initialValueRaw","useInitialValue","initialValue","patch","validationRaw","connectionState","useConnectionState","setInspectorMenuItems","languageFilter","focusPath","setFocusPath","pathFromString","activeViewId","view","timelineMode","setTimelineError","useTimelineStore","onError","rev","revTime","sinceAttributes","timelineDisplayed","timelineReady","isPristine","setPresence","subscription","nextPresence","unsubscribe","inspectorName","setInspectorName","inspect","inspectParamRef","resolvedChangesInspector","inspectOpen","compareValue","displayed","newSince","newRev","handleFocus","nextFocusPath","setLocation","lastActiveAt","toISOString","handleBlur","blurredPath","patchRef","toMutationPatches","patches","handleChange","closeInspector","closeInspectorName","openInspector","nextInspectorName","nextInspector","currentParams","closeResult","handleHistoryClose","handleHistoryOpen","handlePaneClose","handlePaneSplit","toggleLegacyInspect","toggle","arguments","undefined","handleMenuAction","startsWith","handleKeyUp","isHotkey","handleLegacyInspectClose","openPath","onSetOpenPath","fieldGroupState","onSetFieldGroupState","collapsedPaths","onSetCollapsedPath","collapsedFieldSets","onSetCollapsedFieldSets","handleOnSetCollapsedPath","prevState","setAtPath","handleOnSetCollapsedFieldSet","handleSetActiveFieldGroup","groupName","requiredPermission","_createdAt","docId","docPermissionsInput","useDocumentValuePermissions","isNonExistent","readOnly","hasNoPermission","updateActionDisabled","isActionEnabled","createActionDisabled","reconnecting","isLocked","formState","useFormState","comparisonValue","formStateRef","setOpenPath","ops","getExpandOperations","forEach","onBlur","onChange","onHistoryClose","onInspectClose","onKeyUp","onMenuAction","onPaneClose","onPaneSplit","onSetActiveFieldGroup","onSetCollapsedFieldSet","restParams","pathFromUrl","resolveKeyedPath","rootFieldActionNodes","setRootFieldActionNodes","FieldActionsResolver","onActions","FieldActionsProvider","SerializeError","constructor","parentPath","hint","__publicField","withHelpUrl","helpId","HELP_URL","IMPLICIT_FIELDS","joinReferences","head","tail","schemaField","refTypes","to","refType","tailFields","tailWrapper","getExtendedProjection","orderBy","ordering","ORDER_BY_UPDATED_AT","by","ORDER_BY_CREATED_AT","DEFAULT_SELECTED_ORDERING_OPTION","DEFAULT_ORDERING_OPTIONS","maybeSerializeMenuItem","MenuItemBuilder","serialize","_context","spec","clone","getAction","getTitle","getGroup","getIcon","getParams","getShowAsAction","TITLE_REQUIRED","ACTION_OR_INTENT_REQUIRED","ACTION_AND_INTENT_MUTUALLY_EXCLUSIVE","withSpec","builder","getOrderingMenuItem","extendedProjection","SortIcon","getOrderingMenuItemsForSchemaType","orderings","maybeSerializeMenuItemGroup","MenuItemGroupBuilder","_title","getId","ID_REQUIRED","disallowedPattern","validateId","disallowedChar","getStructureNodeId","camelCased","camelCase","getSlug","ComponentBuilder","getChild","getComponent","getOptions","getMenuItemGroups","componentOptions","resolveTypeForDocument","getClient","types","GenericViewBuilder","kebabCase","isSerializable","maybeSerializeView","isComponentSpec","ComponentViewBuilder","componentOrSpec","userComponent","COMPONENT_REQUIRED","FormViewBuilder","form","createDocumentChildResolver","_ref44","resolveDocumentNode","itemId","_ref45","currentSegment","DocumentBuilder","paneId","getDocumentId","getSchemaType","initialValueTemplate","getInitialValueTemplate","getInitialValueTemplateParameters","getViews","urlId","DOCUMENT_ID_REQUIRED","viewIds","dupes","uniq","viewId","getDocumentOptions","documentFromEditor","documentFromEditorWithInitialValue","_ref46","layoutOptions","DEFAULT_INTENT_HANDLER","defaultIntentChecker","intentName","_ref47","isEdit","isCreate","typedSpec","paneFilter","typeNames","getTypeNamesFromFilter","initialValueTemplates","tpl","identity","InitialValueTemplateItemBuilder","getDescription","getTemplateId","getParameters","defaultInitialValueTemplateItems","getStructureBuilder","getTypeNames","ordered","maybeSerializeInitialValueTemplateItem","menuItemsFromInitialValueTemplateItems","pickBy","noChildResolver","shallowIntentChecker","_ref48","GenericListBuilder","defaultLayout","getDefaultLayout","getCanHandleIntent","showIcons","displayOptions","getShowIcons","initialValueTemplatesSpecified","getInitialValueTemplates","validateFilter","trim","QUERY_PROVIDED_FOR_FILTER","createDocumentChildResolverForItem","parentItem","parent","DocumentListBuilder","apiVersion","getApiVersion","getFilter","defaultOrdering","getDefaultOrdering","FILTER_REQUIRED","hasSimpleFilter","generateHelpUrl","API_VERSION_REQUIRED_FOR_CUSTOM_FILTER","inferInitialValueTemplates","inferTypeName","getSpec","flatMap","resolveNewDocumentOptions","option","getTypeNamesFromEqualityFilter","getTypeNamesFromInTypesFilter","pattern","matches","exec","candidate","normalized","replace","getArgType","thing","ListBuilder","isPromise","isListItem","defaultCanHandleIntent","isDocumentListItem","resolveChildForItem","target","maybeSerializeListItem","ListItemBuilder","listItem","gotWhat","helpText","INVALID_LIST_ITEM","getItems","LIST_ITEMS_MUST_BE_ARRAY","serializedItems","val","dupeIds","dupeDesc","LIST_ITEM_IDS_MUST_BE_UNIQUE","showIcon","getShowIcon","titleIsOptional","SCHEMA_TYPE_NOT_FOUND","serializeOptions","listChild","originalChild","childOptions","createDefaultChildResolver","DocumentListItemBuilder","SCHEMA_TYPE_REQUIRED","DocumentTypeListBuilder","cloneWithoutDefaultIntentHandler","shouldOverride","override","shouldShowIcon","preview","prepare","select","media","BUNDLED_DOC_TYPES","isBundledDocType","isDocumentType","isList","collection","getDocumentTypes","_ref49","n","getDocumentTypeListItems","getDocumentTypeListItem","startCase","childContext","list","getDocumentTypeList","typeNameOrSpec","StackCompactIcon","StackIcon","hasIcon","getDefaultStructure","createStructureBuilder","_ref50","defaultDocumentNode","source","configContext","getConfigContextFromSource","structureBuilder","defaults","documentTypeList","_len","args","documentTypeListItem","_len2","_key2","documentTypeListItems","_len3","_key3","_len4","_key4","documentWithInitialValueTemplate","_len5","_key5","defaultDocument","_len6","_key6","_len7","_key7","_len8","_key8","menuItemGroup","_len9","_key9","_len10","_key10","documentList","_len11","_key11","documentListItem","_len12","_key12","orderingMenuItem","_len13","_key13","orderingMenuItemsForType","_len14","_key14","editor","_len15","_key15","_len16","_key16","isValidElementType","uniqueId","DeskToolProvider","_ref51","structure","resolveStructure","setLayoutCollapsed","useConfigContextFromSource","S","rootPaneNode","resizablePanes","splitPanes","splitViews","structureContext"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAEO,SAASA,KAAMA,CAAAC,IAAA,EAMC;EAAA,IAND;IACpBC,QAAA;IACAC,EAAK,GAAA;EACP,CAGuB,GAAAF,IAAA;EACrB,MAAM,CAACG,KAAO,EAAAC,QAAQ,CAAI,GAAAC,KAAAA,CAAAA,QAAA,CAASH,MAAM,CAAC,CAAA;EAE1CI,KAAAA,CAAAA,SAAA,CAAU,MAAM;IACd,IAAIJ,MAAM,CAAG,EAAA;MACJ,OAAA,KAAA,CAAA;IACT;IAEA,MAAMK,YAAYC,UAAW,CAAA,MAAMJ,QAAS,CAAA,IAAI,GAAGF,EAAE,CAAA;IAErD,OAAO,MAAM;MACXO,YAAA,CAAaF,SAAS,CAAA;IAAA,CACxB;EAAA,CACF,EAAG,CAACL,EAAE,CAAC,CAAA;EAEH,IAAA,CAACC,KAAS,IAAA,CAACF,QAAU,EAAA;IACvB,sBAASS,UAAA,CAAAA,GAAA,CAAAC,mBAAA,EAAA,CAAA,CAAA,CAAA;EACX;EAEA,OAAO,OAAOV,QAAA,KAAa,UAAa,GAAAA,QAAA,CAAA,CAAa,GAAAA,QAAA;AACvD;ACpBO,SAASW,SAASC,KAAsB,EAAA;EACvC,MAAA;IAACC,QAAU,EAAAC;EAAiB,CAAA,GAAAF,KAAA;EAClC,MAAMG,SAASC,MAAAA,CAAAA,SAAU,EAAA;EACzB,MAAMC,UAAa,GAAAF,MAAA,CAAOG,GAAI,CAAAJ,aAAA,CAAcK,KAAK,CAAA;EAEjD,MAAM;IAACC,KAAA;IAAOC;EAAK,CAAA,GAAIC,+BAAgB,CAAA;IACrCL,UAAA;IACAI,KAAO,EAAAP;EAAA,CACR,CAAA;EAED,IAAI,CAACG,UAAY,EAAA;IACf,sCAAQ,MAAK,EAAA;MAAAjB,QAAA,EAAA,CAAA,uBAAA,EAAsBc,aAAc,CAAAK,KAAA;IAAM,CAAA,CAAA;EACzD;EAEA,IAAIC,KAAO,EAAA;IACT,sBAASG,UAAA,CAAAA,IAAA,CAAAb,mBAAA,EAAA;MAAAV,QAAA,EAAA,CAAA,SAAA,EAAQoB,KAAM,CAAAI,OAAA;IAAQ,CAAA,CAAA;EACjC;EAEO,sBAAAf,UAAA,CAAAA,GAAA,CAAAC,mBAAA,EAAA;IAAGV,QAAO,EAAA,CAAAqB,KAAA,IAAA,IAAA,GAAA,KAAA,CAAA,GAAAA,KAAA,CAAAI,KAAA,KAAA,eAAUhB,UAAA,CAAAA,GAAA,CAAA,MAAA,EAAA;MAAKiB,KAAO,EAAA;QAACC,KAAO,EAAA;MAA+B,CAAA;MAAA3B,QAAA,EAAA;KAAQ;EAAQ,CAAA,CAAA;AAChG;ACpBgB,SAAA4B,OAAAA,CAAAC,KAAA,EAA8B;EAAA,IAAtB;IAACC;GAAqB,GAAAD,KAAA;EACtC,MAAAE,OAAA,GAAUC,kBAAWF,IAAI,CAAA;EAExB,OAAA,eAAAP,UAAA,CAAAA,IAAA,CAAC,MAAK,EAAA;IAAAE,KAAA,EAAOM,OAAU;IAAA/B,QAAA,EAAA,CAAA+B,OAAA,EAAQ,MAAA;EAAI,CAAA,CAAA;AAC5C;ACcA,SAASE,cAAcC,CAA8B,EAAA;EACnD,IAAI,OAAOA,CAAM,KAAA,QAAA,EAAiB,OAAA,KAAA;EAClC,IAAI,CAACA,CAAA,EAAU,OAAA,KAAA;EACR,OAAA,YAAA,IAAgBA,KAAK,UAAc,IAAAA,CAAA;AAC5C;AAEA,MAAMC,aAAgB,GAAA,GAAA;AAGtB,IAAIC,YAAA;AACJ,MAAMC,kBAAkBA,CAAA,KAAM;EAC5B,IAAI,CAACD,YAAc,EAAA;IACFA,YAAA,GAAAE,IAAA,CAAAA,SAAA,CAAUzB,QAAU,EAAA,kBAAkB,CAAE,CAAA0B,IAAA;IAAA;IAErDC,SAAAA,CAAAA,UAAU,IAAI,CAAA,EACdC,SAAAA,CAAAA,GAAI,CAAA,MAAM5B,QAAS,CAAA6B,eAAA,KAAoB,SAAS,CAAA,EAChDC,8BAAqB,CAAA,CAAA,EACrBC,SAAA,CAAAA,SAAA,CAAWC,OACT,IAAAA,OAAA;IAAA;IAEIC,IAAA,CAAAA,KAAA,CAAM,GAAGX,aAAa,CAAA,GACtBY,IAAA,CAAAA,KACN,CAAA,EACAC,SAAAA,CAAAA,YAAY;MAACC,QAAA,EAAU,IAAM;MAAAC,UAAA,EAAY;KAAE,CAAA,CAC7C;EACF;EACO,OAAAd,YAAA;AACT,CAAA;AAsCA,SAASe,oBACPA,CAAAC,UAAA,EAAAC,KAAA,EAEgC;EAAA,IADhC;IAACC;GAC+B,GAAAD,KAAA;EAC1B,MAAAE,OAAA,GAAUC,kBAAWJ,UAAU,CAAA;EAC/B,MAAAK,WAAA,GAAcC,sBAAeN,UAAU,CAAA;EAC7C,MAAMO,cAAiB,GAAA;IACrBC,KAAKN,eAAgB,CAAAO,UAAA,CAAW,OAAO,EAAG,CAAAC,MAAA,CAAAP,OAAA,EAAO,KAAIO,MAAa,CAAAL,WAAA,CAAA,CAAA;IAClEM,IAAM,EAAA,IAAA;IACNC,KAAA,EAAO;MAACC,cAAA,EAAgB;IAAM,CAAA;IAC9BC,GAAK,EAAA;EAAA,CACP;EACA,OAAOZ,eAAgB,CAAAa,UAAA,CAAWC,OAA8B,CAAAT,cAAc,CAAE,CAAApB,IAAA,CAC9EE,aAAI,CAAA4B,KAAA,IAAe;IAAA,IAAd;MAACC;KAAa,GAAAD,KAAA;IACjB,MAAME,cAAcD,OAAQ,CAAAE,MAAA,CAAQC,GAAQ,IAAAA,GAAA,CAAIC,WAAW,WAAW,CAAA;IAClE,IAAAH,WAAA,CAAYI,WAAW,CAAG,EAAA;MAErB,OAAA,KAAA,CAAA;IACT;IAEI,IAAAJ,WAAA,CAAYI,WAAW,CAAG,EAAA;MAErB,OAAAlB,WAAA;IACT;IAGO,OAAAc,WAAA,CAAYK,KAAMH,GAAA,IAAQA,IAAII,EAAO,KAAAtB,OAAO,IAAIE,WAAc,GAAAF,OAAA;EAAA,CACtE,CAAA,CACH;AACF;AAMA,SAASuB,2BAAAA,CACP1B,YACA2B,OAC0D,EAAA;EACpD,MAAA;IAACzB;EAAmB,CAAA,GAAAyB,OAAA;EAE1B,OAAO1C,gBAAkB,CAAA,CAAAE,IAAA,CACvBK,SAAAA,CAAAA,SAAU,CAAA,MAAMO,oBAAqB,CAAAC,UAAA,EAAY2B,OAAO,CAAC,CAAA,EACzDnC,SAAA,CAAAA,SAAA,CAAWoC,eAAoB,IAAA;IAC7B,IAAI,CAACA,eAAiB,EAAA;MACpB,OAAOC,IAAAA,CAAAA,GAAG;QAACC,UAAA,EAAY;QAAGC,UAAY,EAAA;OAAG,CAAA;IAC3C;IAEM,MAAAC,cAAA,GAAiB9B,eAAgB,CAAA+B,MAAA,CAAA,CAAS,CAAAC,OAAA;IAEzC,OAAAhC,eAAA,CAAgBa,WACpBC,OAAQ,CAAA;MACPmB,GAAK,EAAA,mBAAA,CAAoBzB,MAAc,CAAAsB,cAAA,EAAA,aAAA,CAAA,CAActB,MAAe,CAAAkB,eAAA,EAAA,sDAAA,CAAA;MACpEd,GAAK,EAAA;IACN,CAAA,CACA,CAAA3B,IAAA,CACCiD,SAAA,CAAAA,UAAA,CAAYtD,CAAM,IAAA;MAIhB,IAAID,aAAc,CAAAC,CAAC,CAAK,IAAAA,CAAA,CAAEuD,eAAe,GAAK,EAAA;QAC5C,OAAOR,IAAAA,CAAAA,GAAG;UAACC,UAAA,EAAY;UAAGC,UAAY,EAAA;SAAG,CAAA;MAC3C;MAEM,MAAAjD,CAAA;IAAA,CACP,CAAA,CACH;EAAA,CACH,CAAA,CACH;AACF;AAEA,MAAMwD,qBAAwB,GAAAC,MAAA,CAAAA,+BAAA,CAC5BC,KAAA,IAA0D;EAAA,IAAzD,CAACxC,UAAY,EAAAyC,aAAa,CAA+B,GAAAD,KAAA;EACxD,MAAME,gBAAmB,GAAA,gDAAA;EACzB,MAAMC,WAAc,GAAA,mCAAA;EACpB,MAAMC,UAAa,GAAA,gBAAA,CAAiBlC,MAAgB,CAAAgC,gBAAA,EAAA,gBAAA,CAAA,CAAiBhC,MAAW,CAAAiC,WAAA,EAAA,GAAA,CAAA;EAChF,MAAME,WAAc,GAAA,4BAAA;EAEpB,OAAOJ,aAAc,CAAAI,WAAA,CACnB;IAACC,KAAA,EAAOF,UAAY;IAAAG,MAAA,EAAQF;EAAW,CAAA,EACvC;IAAC7C;EAAU,CAAA,EACX;IAACc,KAAK,yBAA2B;IAAAkC,WAAA,EAAa,CAAC,QAAU,EAAA,WAAW,CAAG;IAAAC,YAAA,EAAc;EAAI,CAAA,CAC3F;AACF,CACF,CAAA;AAEA,MAAMC,yBAA4B,GAAAX,MAAA,CAAAA,+BAAA,CAChCY,KAAA,IAA2D;EAAA,IAA1D,CAACnD,UAAY,EAAAE,eAAe,CAA8B,GAAAiD,KAAA;EAEzD,OAAOlE,gBAAkB,CAAA,CAAAE,IAAA,CACvBK,SAAA,CAAAA,SAAA,CAAU,MACRkC,4BAA4B1B,UAAY,EAAA;IACtCE;EAAA,CACD,CACH,CAAA,CACF;AACF,CACF,CAAA;AAEO,SAASkD,sBAAsBpD,UAAwC,EAAA;EACtE,MAAAE,eAAA,GAAkBmD,iBAAUC,MAAAA,CAAAA,6BAA6B,CAAA;EAE/D,MAAMb,gBAAgBc,MAAAA,CAAAA,gBAAiB,EAAA;EACjC,MAAAlD,WAAA,GAAcC,sBAAeN,UAAU,CAAA;EAEvC,MAAA,CAACwD,kBAAoB,EAAAC,2BAA2B,CAAI,GAAAnB,qBAAA,CACxDoB,KAAA,CAAAA,OAAA,CAAQ,MAAM,CAACrD,WAAA,EAAaoC,aAAa,CAAG,EAAA,CAACA,aAAe,EAAApC,WAAW,CAAC,CAAA,CAC1E;EAEM,MAAA,CAACsD,sBAAwB,EAAAC,+BAA+B,CAAI,GAAAV,yBAAA,CAChEQ,KAAA,CAAAA,OAAA,CAAQ,MAAM,CAACrD,WAAA,EAAaH,eAAe,CAAG,EAAA,CAACG,WAAa,EAAAH,eAAe,CAAC,CAAA,CAC9E;EAEM,MAAA2D,UAAA,GAAaH,KAAAA,CAAAA,QAAQ,MAAM;IAC/B,OAAOI,KAAM,CAAAC,IAAA,CACX,IAAIC,GAAA,CACFL,iEAAwB5B,UACrB,CAAA1C,GAAA,CAAK4E,qBAA0B,IAAAA,qBAAA,CAAsBC,WACrD9C,MAAO,CAAA+C,OAAA,CACZ,GACAC,IAAK,CAAA,CAAA;EAAA,CACN,EAAA,CAACT,sBAAwB,IAAA,IAAA,GAAA,KAAA,CAAA,GAAAA,sBAAA,CAAA5B,UAAU,CAAC,CAAA;EAEjC,MAAAsC,YAAA,GAAeX,KAAAA,CAAAA,QAAQ,MAAM;IACjC,OAAOI,KAAM,CAAAC,IAAA,CACX,IAAIC,GAAA,CACFL,sBAAwB,IAAA,IAAA,GAAA,KAAA,CAAA,GAAAA,sBAAA,CAAA5B,UAAA,CAErB1C,GAAI,CAAC4E,0BAA0BA,qBAAuB,IAAA,IAAA,GAAA,KAAA,CAAA,GAAAA,qBAAA,CAAAK,WAAA,KAAe,EACrE,CAAA,CAAAlD,MAAA,CAAQkD,WAAA,IAAgBH,OAAQ,CAAAG,WAAW,KAAKA,WAAgB,KAAA,EAAA,CACrE,GACAF,IAAK,CAAA,CAAA;EAAA,CACN,EAAA,CAACT,sBAAwB,IAAA,IAAA,GAAA,KAAA,CAAA,GAAAA,sBAAA,CAAA5B,UAAU,CAAC,CAAA;EAEjC,MAAAwC,sBAAA,GAAyBb,KAAAA,CAAAA,QAAQ,MAAM;IACpC,OAAAS,OAAA,CACLR,iEAAwB5B,UAAW,CAAAP,IAAA,CAChCyC,qBAAA,IAA0B,OAAOA,qBAAA,CAAsBK,WAAgB,KAAA,QAAA,CAAA,CAE5E;EAAA,CACC,EAAA,CAACX,sBAAwB,IAAA,IAAA,GAAA,KAAA,CAAA,GAAAA,sBAAA,CAAA5B,UAAU,CAAC,CAAA;EAEhC,OAAA;IACLD,UAAa,EAAA,CAAA,CAAA0B,kBAAA,IAAA,IAAA,GAAA,KAAA,CAAA,GAAAA,kBAAA,CAAoB1B,UAAc,KAAA,CAAA,KAAA,CAAM6B,iEAAwB7B,UAAc,KAAA,CAAA,CAAA;IAC3F+B,UAAA;IACAQ,YAAA;IACAE,sBAAA;IACAf,kBAAA;IACAG,sBAAA;IACAa,WAAWf,2BAA+B,IAAAG;EAAA,CAC5C;AACF;AC1OO,SAASa,gBAAgBjH,KAAmE,EAAA;EAC3F,MAAA;IAACC;EAAY,CAAA,GAAAD,KAAA;EACnB,MAAMkH,SAAY,GAAAjH,QAAA,IAAY,YAAgB,IAAAA,QAAA,IAAYA,QAAS,CAAAkH,UAAA;EAC7D,MAAAC,WAAA,GAAcnH,WAAW,WAAc,GAAA,eAAA;EAG3C,sBAAAJ,UAAA,CAAAA,GAAA,CAACwH,EAAA,CAAAA,OAAA,EAAA;IACCC,MAAM,EAAA,IAAA;IACNC,OAAA,EAAA,eACG1H,UAAA,CAAAA,GAAA,CAAA2H,MAAA,EAAA;MAAIC,OAAS,EAAA,CAAA;MACZrI,wCAACsI,EAAAA,CAAAA,IAAK,EAAA;QAAAC,IAAA,EAAM,CACT;QAAAvI,QAAA,EAAAa,QAAA,GACGU,eAAAA,UAAAA,CAAAA,IAAA,CAAAb,UAAAA,CAAAA,QAAA,EAAA;UAAAV,QAAA,EAAA,CAAA,YAAA,EAAW8H,SAAa,IAAArH,eAAAA,UAAAA,CAAAA,GAAA,CAACmB,OAAQ,EAAA;YAAAE,IAAA,EAAMgG;UAAW,CAAA,CAAA;SAAG,CAEvD,GAAA,eAAArH,UAAA,CAAAA,GAAA,CAAAC,mBAAA,EAAA;UAAEV,QAAa,EAAA;QAAA,CAAA;MAEnB,CAAA;KACF,CAAA;IAGFA,wCAACwI,MAAAA,CAAAA,YAAa,EAAA;MAAAC,IAAA,EAAK,UAAW;MAAAC,MAAA,EAAQ,CAAC7H,QAAU;MAAA8H,KAAA,EAAO,CAAC9H,QAAA;MAAU0H,MAAM,CACvE;MAAAvI,QAAA,iBAAAS,UAAA,CAAAA,GAAA,CAACmI,KAAY,CAAAA,WAAA,EAAA;QAAA,YAAA,EAAYZ;MAAa,CAAA;KACxC;EAAA,CAAA,CACF;AAEJ;ACzBO,SAASa,YAAYjI,KAAmE,EAAA;EACvF,MAAA;IAACC;EAAY,CAAA,GAAAD,KAAA;EACnB,MAAMkH,SAAY,GAAAjH,QAAA,IAAY,YAAgB,IAAAA,QAAA,IAAYA,QAAS,CAAAkH,UAAA;EAGjE,sBAAAtH,UAAA,CAAAA,GAAA,CAACwH,EAAA,CAAAA,OAAA,EAAA;IACCC,MAAM,EAAA,IAAA;IACNC,OAAA,EAAA,eACG1H,UAAA,CAAAA,GAAA,CAAA2H,MAAA,EAAA;MAAIC,OAAS,EAAA,CAAA;MACZrI,wCAACsI,EAAAA,CAAAA,IAAK,EAAA;QAAAC,IAAA,EAAM,CACT;QAAAvI,QAAA,EAAAa,QAAA,GACGU,eAAAA,UAAAA,CAAAA,IAAA,CAAAb,UAAAA,CAAAA,QAAA,EAAA;UAAAV,QAAA,EAAA,CAAA,SAAA,EAAQ8H,SAAa,IAAArH,eAAAA,UAAAA,CAAAA,GAAA,CAACmB,OAAQ,EAAA;YAAAE,IAAA,EAAMgG;UAAW,CAAA,CAAA;SAAG,CAEpD,GAAA,eAAArH,UAAA,CAAAA,GAAA,CAAAC,mBAAA,EAAA;UAAEV,QAAoB,EAAA;QAAA,CAAA;MAE1B,CAAA;KACF,CAAA;IAGFA,QAAC,EAAA,eAAAS,UAAA,CAAAA,GAAA,CAAA+H,mBAAA,EAAA;MAAaC,IAAK,EAAA,SAAA;MAAUC,QAAQ,CAAC7H,QAAA;MAAU8H,KAAO,EAAA,CAAC9H,QAAU;MAAA0H,IAAA,EAAM,CACtE;MAAAvI,QAAA,EAAAS,eAAAA,UAAAA,CAAAA,GAAA,CAACqI,iBAAS,CAAA;KACZ;EAAA,CAAA,CACF;AAEJ;ACHO,SAASC,gBAAgBnI,KAA6B,EAAA;EAC3D,MAAM;IAACoI,IAAM;IAAAC,MAAA;IAAQC,QAAU;IAAAjI,UAAA;IAAYI;EAAS,CAAA,GAAAT,KAAA;EACpD,MAAMa,QACH0H,MAAS,CAAAA,QAAA,CAAA9H,KAAA,CAAMI,KAAK,CAAK,IAAA2H,oBAAA,CAAe/H,MAAMI,KAAK,CAAA,IACpD4H,iBAAAA,CAAAA,OAAS,CAAAhI,KAAA,CAAMI,KAAK,CACpB,IAAA6H,iBAAAA,CAAAA,OAAA,CAASjI,MAAMI,KAAK,CAAA,GAChBJ,MAAMI,KACN,GAAA,IAAA;EAIN,MAAM;IAAC8H,KAAA;IAAOC,SAAW;IAAA5B;EAAa,CAAA,GAAA6B,OAAA,CAAAA,iBAAA,CACpC,MAAMC,MAAAA,CAAAA,yBAA0B,CAAA9I,KAAA,CAAM+I,sBAAsB1I,UAAY,EAAAI,KAAA,CAAMuI,KAAKnI,KAAK,CAAA,EACxF,CAACb,KAAM,CAAA+I,oBAAA,EAAsB1I,UAAY,EAAAI,KAAA,CAAMuI,KAAKnI,KAAK,CAAA,CAC3D;EAEA,MAAMoI,SAASjC,SAAY,GAAA,IAAA,GACxBrG,eAAAA,UAAAA,CAAAA,IAAA,CAAAuI,EAAAA,CAAAA,MAAA,EAAA;IAAOC,OAAO,CACZ;IAAA/J,QAAA,EAAA,CAAAkJ,QAAA,IAAYA,QAAS,CAAAvE,MAAA,GAAS,CAAK,IAAAlE,eAAAA,UAAAA,CAAAA,GAAA,CAACuJ;MAAwBd;KAAoB,CAAA,EACjFzI,eAAAA,UAAAA,CAAAA,GAAA,CAACoH,eAAgB,EAAA;MAAAhH,QAAA,EAAU2I;IAAW,CAAA,CAAA,EACtC/I,eAAAA,UAAAA,CAAAA,GAAA,CAACoI,WAAY,EAAA;MAAAhI,QAAA,EAAU0I;IAAO,CAAA,CAAA;EAChC,CAAA,CAAA;EAIA,sBAAA9I,UAAA,CAAAA,GAAA,CAACwJ,MAAA,CAAAA,oBAAA,EAAA;IACE,GAAGC,MAA4B,CAAAA,2BAAA,CAAA;MAAC7I,KAAO;MAAAkI,KAAA;MAAOC;KAAU,CAAA;IACzDW,aAAe,EAAAvC,SAAA;IACfoB,IAAA;IACAC,MAAA;IACAY;EAAA,CAAA,CACF;AAEJ;AC1DA,SAASO,cAAiCA,CAAA,EAAA;EAClC,MAAA,IAAIC,MAAM,gCAAgC,CAAA;AAClD;AAOO,MAAMC,oBAAoBC,KAAAA,CAAAA,aAAsC,CAAA;EACrEC,KAAO,EAAA,CAAA;EACPC,UAAY,EAAA,CAAA;EACZC,YAAc,EAAA,CAAA;EACdC,OAAS,EAAA,KAAA,CAAA;EACTC,QAAQ,CAAC,CAAA;EACTC,gBAAkB,EAAA,KAAA;EAClBC,WAAa,EAAA,CAAA;EACbC,kBAAkB,EAAC;EACnBC,QAAA,EAAUA,CAAA,KAAMZ,cAAe,CAAA,CAAA;EAC/Ba,SAAA,EAAWA,CAAA,KAAMb,cAAe,CAAA,CAAA;EAChCc,kBAAA,EAAoBA,CAAA,KAAMd,cAAe,CAAA,CAAA;EACzCe,mBAAA,EAAqBA,CAAA,KAAMf,cAAe,CAAA,CAAA;EAC1CgB,iBAAA,EAAmBA,CAAA,KAAMhB,cAAe,CAAA,CAAA;EACxCiB,cAAA,EAAgBA,CAAA,KAAMjB,cAAe,CAAA,CAAA;EACrCkB,oBAAA,EAAsBA,CAAA,KAAMlB,cAAe,CAAA,CAAA;EAC3CmB,YAAA,EAAcA,CAAA,KAAMnB,cAAe,CAAA,CAAA;EACnCoB,gBAAA,EAAkBA,CAAA,KAAMpB,cAAe,CAAA,CAAA;EACvCqB,OAAA,EAASA,CAAA,KAAMrB,cAAe,CAAA,CAAA;EAC9BsB,SAAA,EAAWA,CAAA,KAAMtB,cAAe,CAAA,CAAA;EAChCuB,UAAA,EAAYA,CAAA,KAAMvB,cAAe,CAAA,CAAA;EACjCwB,cAAA,EAAgBA,CAAA,KAAMxB,cAAe,CAAA;AACvC,CAAC,CAAA;AC1BM,MAAMY,QAAW,GAAAa,KAAAA,CAAAA,UAAA,CAAW,SAASb,SAAAA,CAC1CpK,OACAkL,GACA,EAAA;EACA,MAAM;IAACf,gBAAA;IAAkBN;EAAU,CAAA,GAAIsB,iBAAWzB,iBAAiB,CAAA;EAC7D,MAAA0B,KAAA,GAAQlF,KAAAA,CAAAA,OAAQ,CAAA,MAAMiE,gBAAiB,CAAAkB,KAAA,CAAM,CAAG,EAAAxB,UAAU,CAAG,EAAA,CAACA,UAAY,EAAAM,gBAAgB,CAAC,CAAA;EAC3F,MAAAmB,KAAA,GAAQpF,KAAAA,CAAAA,QAAQ,OAAO;IAACkF;GAAS,CAAA,EAAA,CAACA,KAAK,CAAC,CAAA;EAE9C,OAAQvL,eAAAA,UAAAA,CAAAA,GAAA,CAAA0L,QAAAA,CAAAA,SAAA,EAAA;IAAW,GAAGvL,KAAA;IAAOkL;IAAUI;EAAc,CAAA,CAAA;AACvD,CAAC,CAAA;ACXY,MAAAE,iBAAA,GAAoB7B,oBAA6C,IAAI,CAAA;ACG3E,SAAS8B,aAAwCA,CAAA,EAAA;EAChD,MAAAC,IAAA,GAAOP,iBAAWK,iBAAiB,CAAA;EAEzC,IAAI,CAACE,IAAM,EAAA;IACH,MAAA,IAAIjC,MAAM,mCAAmC,CAAA;EACrD;EAEO,OAAAiC,IAAA;AACT;ACTO,MAAMrB,SAAY,GAAAY,KAAAA,CAAAA,UAAA,CAAW,SAASZ,UAAAA,CAC3CrK,OACAkL,GACA,EAAA;EACA,MAAM;IAACS,OAAS;IAAAC,YAAA;IAAcC,eAAiB;IAAA,GAAGC;EAAQ,CAAA,GAAA9L,KAAA;EAC1D,MAAM;IAACmK,gBAAA;IAAkBN;EAAU,CAAA,GAAIsB,iBAAWzB,iBAAiB,CAAA;EAGjE,sBAAA7J,UAAA,CAAAA,GAAA,CAAC0L,QAAA,CAAAA,SAAA,EAAA;IACE,GAAGO,IAAA;IACJZ,GAAA;IACAI,KAAO,EAAA;MACLF,KAAO,EAAA,CACL,GAAGjB,gBAAA,CAAiBkB,KAAM,CAAA,CAAA,EAAGxB,aAAa,CAAC,CAAA,EAC3C,CAAC;QAAC5F,EAAI,EAAA0H,OAAA;QAAS3B,QAAQ6B,eAAiB;QAAA9B,OAAA,EAAS6B;OAAa,CAAA;IAElE;EAAA,CAAA,CACF;AAEJ,CAAC,CAAA;ACtBM,MAAMtB,kBAAqB,GAAAW,KAAA,CAAAA,UAAA,CAAW,SAASX,mBAAAA,CAAAA,KAAAA,EAEpDY,GACA,EAAA;EAAA,IAFA;IAAC1I,UAAA;IAAYuJ,YAAc;IAAAC,aAAA;IAAe5M,QAAU;IAAA6M,QAAA;IAAU,GAAGH;EAAA;EAI/D,sBAAAjM,UAAA,CAAAA,GAAA,CAACwK,SAAA,EAAA;IACE,GAAGyB,IAAA;IACJZ,GAAA;IACAS,OAAS,EAAAnJ,UAAA;IACToJ,cAAcK,QAAU,IAAA,IAAA,GAAA,KAAA,CAAA,GAAAA,QAAA,CAAAjC,MAAA;IACxB6B,eAAiB,EAAA;MACfK,IAAM,EAAAH,YAAA;MACNC,aAAA,EAAeG,mBAAaH,aAAa,CAAA;MACzC,IAAIC,QAAA,IAAY;QAACA,QAAA,EAAUA,qCAAUhI;MAAE,CAAA;IACzC,CAAA;IAEC7E;EAAA,CAAA,CACH;AAEJ,CAAC,CAAA;ACVM,MAAMoL,iBAAoB,GAAAS,KAAAA,CAAAA,UAAA,CAAW,SAAST,kBAAAA,CACnDxK,OACAkL,GACA,EAAA;EACA,MAAM;IAACf,gBAAkB,EAAAiC,YAAA;IAAcvC;IAAYC;GAAY,GAAIqB,KAAAA,CAAAA,WAAWzB,iBAAiB,CAAA;EAC/F,MAAM;IAACM,MAAA;IAAQD,OAAS;IAAA,GAAG+B;GAAQ,GAAA9L,KAAA;EAC7B,MAAAqM,UAAA,GAAaC,iBAAUtC,MAAM,CAAA;EAC7B,MAAAuC,WAAA,GAAcD,iBAAUvC,OAAO,CAAA;EAE/B,MAAAyC,SAAA,GAAYtG,KAAAA,CAAAA,QAAQ,MAAM;IACxB,MAAAuG,YAAA,GAAeL,aAAavC,UAAU,CAAA;IACtC,MAAA6C,cAAA,GAAiBD,aAAa3C,YAAY,CAAA;IAEhD,MAAM6C,WAAc,GAAA;MAClB,GAAGD,cAAA;MACH1C,MAAA,EAAQqC,kCAAcK,cAAe,CAAA1C,MAAA;MACrCD,OAAA,EAASwC,oCAAeG,cAAe,CAAA3C;IAAA,CACzC;IAEA,MAAM6C,SAAY,GAAA,CAChB,GAAGH,YAAA,CAAapB,KAAM,CAAA,CAAA,EAAGvB,YAAY,CAAA,EACrC6C,WAAA,EACA,GAAGF,YAAA,CAAapB,KAAM,CAAAvB,YAAA,GAAe,CAAC,CAAA,CACxC;IAEA,MAAM+C,SAAY,GAAA,CAChB,GAAGT,YAAA,CAAaf,KAAM,CAAA,CAAA,EAAGxB,UAAU,CAAA,EACnC+C,SAAA,EACA,GAAGR,YAAA,CAAaf,KAAM,CAAAxB,UAAA,GAAa,CAAC,CAAA,CACtC;IAEO,OAAA;MAACuB,OAAOyB;KAAS;EAAA,GACvB,CAACT,YAAA,EAAcvC,YAAYwC,UAAY,EAAAE,WAAA,EAAazC,YAAY,CAAC,CAAA;EAEpE,qCAAQyB,QAAU,CAAAA,SAAA,EAAA;IAAAL,GAAA;IAAW,GAAGY,IAAA;IAAMR,OAAOkB;EAAW,CAAA,CAAA;AAC1D,CAAC,CAAA;ACxCM,SAASM,aAAwCA,CAAA,EAAA;EACtD,OAAO3B,KAAAA,CAAAA,WAAWzB,iBAAiB,CAAA;AACrC;ACCA,MAAMqD,cAAkB,EAAC;AAQlB,SAASC,qBAAqBhN,KAAkC,EAAA;EACrE,MAAM;IAACiN,OAAA;IAASf,IAAM;IAAAzL;EAAA,CAAS,GAAAT,KAAA;EACzB,MAAA6C,WAAA,GAAcC,MAAe,CAAAA,cAAA,CAAArC,KAAA,IAAA,IAAA,GAAA,KAAA,CAAA,GAAAA,KAAA,CAAOuI,GAAG,CAAA;EACvC,MAAAkE,gBAAA,GAAmBC,2BAAoBtK,WAAW,CAAA;EACxD,MAAMkG,uBAAuBqE,MAAAA,CAAAA,uBAAwB,EAAA;EAC/C,MAAA;IAAC9C;GAAkB,GAAIwC,aAAc,EAAA;EAE3C,MAAMO,IAAO,GAAAC,KAAA,CAAAA,WAAA,CACX,SAASC,cAAcC,SAAwC,EAAA;IAE3D,sBAAA3N,UAAA,CAAAA,GAAA,CAACyK,kBAAA,EAAA;MACC9H,YAAY/B,KAAO,IAAA,IAAA,GAAA,KAAA,CAAA,GAAAA,KAAA,CAAAuI,GAAA;MACnB+C,cAAcG,IAAM,IAAA,IAAA,GAAA,KAAA,CAAA,GAAAA,IAAA,CAAAuB,IAAA;MACpBzB,aAAe,EAAAe,WAAA;MACd,GAAGS;IAAA,CAAA,CACN;EAEJ,CAAA,EACA,CAAClD,kBAAA,EAAoB4B,IAAM,IAAA,IAAA,GAAA,KAAA,CAAA,GAAAA,IAAA,CAAAuB,IAAA,EAAMhN,+BAAOuI,GAAG,CAAA,CAC7C;EAGE,sBAAAnJ,UAAA,CAAAA,GAAA,CAAC6N,MAAA,CAAAA,WAAA,EAAA;IACCC,oBAAoB,EAAA,IAAA;IACpBC,EAAI,EAAAP,IAAA;IACJ,SAAQ,EAAA,GAAA;IACRJ,OAAA;IACAxF,OAAS,EAAA,CAAA;IACToG,MAAQ,EAAA,CAAA;IAERzO,QAAA,iBAAAS,UAAA,CAAAA,GAAA,CAACsI,eAAA,EAAA;MACCY,oBAAA;MACAX,MAAM8D,IAAM,IAAA,IAAA,GAAA,KAAA,CAAA,GAAAA,IAAA,CAAA9D,IAAA;MACZC,MAAO,EAAA,SAAA;MACPC,QAAU,EAAA,CAAA4E,gBAAA,IAAA,IAAA,GAAA,KAAA,CAAA,GAAAA,gBAAA,CAAkBnJ,MAAS,IAAA,CAAA,GAAImJ,gBAAmB,GAAAH,WAAA;MAC5D1M,UAAY,EAAA6L,IAAA;MACZzL;IAAA,CACF;EAAA,CAAA,CACF;AAEJ;;;;;;AC5DA,IAAAqN,IAAA,EAAAC,IAAA,EAAAC,IAAA,EAAAC,IAAA,EAAAC,IAAA;AAKO,MAAMC,cAAiB,GAAAC,eAAAA,CAAAA,OAAA,CAAO5G,EAAG,CAAAA,GAAA,CAAA,CAAVsG,IAAW,KAAAA,IAAA,GAAAO,YAAA,CAAA,CAAA,0BAAA,CAAA,CAAA,CAAA,CAAA;AAIlC,MAAMC,6BAAgC,GAAAF,eAAA,CAAAG,OAAA,CAAOC,OAAP,CAAAT,IAAA,KAAAA,IAAA,GAAcM,+CAGjC,2CAAd,CAAA,CAAA,CAAA,EAAAF,cAAA,CAAA;AAKC,MAAAM,6BAAA,GAAgCL,eAAAA,CAAAA,OAAO,CAAAM,OAAA,CAAPV,IAAc,KAAAA,IAAA,GAAAK,YAAA,CAAA,CAAA,mFAAA,CAAA,CAAA,CAAA,CAAA;AAQpD,MAAMM,QAAQP,eAAO,CAAAG,OAAA,CAAAK,KAAA,CAAPX,IAAY,KAAAA,IAAA,GAAAI,YAAA,CAAA,CAAA,sDAAA,EAGqB,4DAIA,mCAIE,EAAA,gEAAA,CAAA,CAAA,CAAA,EARzCQ,KAAA;EAAA,IAAC;IAACC;EAAW,CAAA,GAAAD,KAAA;EAAA,OAAAE,MAAA,CAAID,MAAME,MAAO,CAAA7F,KAAA,CAAM,CAAC,CAAC,CAAA;AAAA,GAItC8F,KAAA;EAAA,IAAC;IAACH;GAAW,GAAAG,KAAA;EAAA,OAAAF,EAAAA,CAAAA,GAAA,CAAID,MAAME,MAAO,CAAA7F,KAAA,CAAM,CAAC,CAAC,CAAA;AAAA,GAIpC+F,MAAA;EAAA,IAAC;IAACJ;GAAW,GAAAI,MAAA;EAAA,OAAAH,EAAAA,CAAAA,GAAA,CAAID,MAAME,MAAO,CAAA7F,KAAA,CAAM,CAAC,CAAC,CAAA;AAAA,EAAA;AAQhD,MAAMgG,cAAiB,GAAAf,eAAAA,CAAAA,OAAA,CAAOgB,EAAI,CAAAA,IAAA,CAAA,CAAXlB,IAAY,KAAAA,IAAA,GAAAG,YAAA,CAAA,CAAA,yBAAA,CAAA,CAAA,CAAA,CAAA;AAI7B,MAAAgB,mBAAA,GAAuBrP,KAAuD,IAAA;EACzF,MAAMsP,UAAa,GAAAtP,KAAA,CAAMsE,UAAa,GAAAtE,KAAA,CAAMuE,UAAW,CAAAR,MAAA;EAEvD,IAAI,CAACuL,UAAA,EAAmB,OAAA,IAAA;EAGtB,OAAA,eAAA3O,UAAA,CAAAA,IAAA,CAACuI,EAAO,CAAAA,MAAA,EAAA;IAAAC,KAAA,EAAO,CACb;IAAA/J,QAAA,EAAA,CAAA,eAAAuB,UAAA,CAAAA,IAAA,CAAC+G,EAAK,CAAAA,IAAA,EAAA;MAAAC,IAAA,EAAM,CAAG;MAAAI,KAAA,EAAK,IACjB;MAAA3I,QAAA,EAAA,CAAAkQ,UAAA,EAAW,kBAAA,EAAiBA,UAAA,KAAe,IAAI,EAAK,GAAA,GAAA,EAAI,YAAA,EAAW,GAAA;KACtE,CAAA,EAAA,eAEAzP,UAAA,CAAAA,GAAA,CAACwH,EAAA,CAAAA,OAAA,EAAA;MACCC,MAAM,EAAA,IAAA;MACNiI,SAAU,EAAA,KAAA;MACVhI,OACE,EAAA1H,eAAAA,UAAAA,CAAAA,GAAA,CAAC2P,EAAU,CAAAA,SAAA,EAAA;QAAAC,KAAA,EAAO;QAChBrQ,QAAC,EAAAS,eAAAA,UAAAA,CAAAA,GAAA,CAAA2H,EAAA,CAAAA,GAAA,EAAA;UAAIC,OAAS,EAAA,CAAA;UACZrI,wCAACsI,EAAK,CAAAA,IAAA,EAAA;YAAAC,IAAA,EAAM,CAAG;YAAAvI,QAAA,EAAA;UAAA,CAGf;QACF,CAAA;OACF,CAAA;MAGFA,QAAA,EAAAS,eAAAA,UAAAA,CAAAA,GAAA,CAAC6H,EAAAA,CAAAA;QAAKC,IAAM,EAAA,CAAA;QAAGI,OAAK,IAClB;QAAA3I,QAAA,EAAA,eAAAS,UAAA,CAAAA,GAAA,CAAC6P,yBAAgB;MACnB,CAAA;IAAA,CACF,CAAA;EACF,CAAA,CAAA;AAEJ,CAAA;AC/CO,SAASC,uBAAwBA,CAAAC,MAAA,EASA;EAAA,IATA;IACtCzJ,sBAAA;IACAH,kBAAA;IACA6J,aAAA;IACAvL,UAAA;IACAwL,MAAA;IACAjJ,YAAA;IACAE,sBAAA;IACAgJ;EACF,CAAwC,GAAAH,MAAA;EACtC,MAAMzP,SAASC,MAAAA,CAAAA,SAAU,EAAA;EACzB,MAAM4P,QAAQC,EAAAA,CAAAA,QAAS,EAAA;EAEvB,MAAMC,iBAAoB,GAAA5C,KAAA,CAAAA,WAAA,CACvB6C,IAAc,IAAA;IACb,MAAMjE,IAAO,GAAA/L,MAAA,CAAOG,GAAI,CAAA6P,IAAA,CAAK5P,KAAK,CAAA;IAClC,IAAI2L,IAAM,EAAA;MACR,qCAAQc,oBAAqB,EAAA;QAAAd,IAAA;QAAYzL,KAAO,EAAA0P,IAAA;QAAMlD,SAAS8C;MAAsB,CAAA,CAAA;IACvF;IAEA;MAAA;MAEElQ;MAAAA,UAAAA,CAAAA,GAAA,CAAC2H,EAAAA,CAAAA,GAAI,EAAA;QAAAC,OAAA,EAAS,CACZ;QAAArI,QAAA,EAAA,eAAAS,UAAA,CAAAA,GAAA,CAACwJ,MAAA,CAAAA,oBAAA,EAAA;UACCjB,IAAM,EAAAgI,KAAA,CAAAA,WAAA;UACNvP,KAAM,EAAA,qBAAA;UACNwP,QAAA,EAAU,OAAOnN,MAAK,CAAAiN,IAAA,CAAAnH,GAAA,CAAA;UACtBX,MAAO,EAAA;QAAA,CAAA;OAEX;IAAA;EAEJ,CAAA,EACA,CAAClI,QAAQ4P,oBAAoB,CAAA,CAC/B;EAEA,IAAA,CAAI/J,kBAAoB,IAAA,IAAA,GAAA,KAAA,CAAA,GAAAA,kBAAA,CAAA1B,UAAA,MAAe,CAAK,IAAA,CAAA6B,sBAAA,IAAA,IAAA,GAAA,KAAA,CAAA,GAAAA,sBAAA,CAAwB7B,gBAAe,CAAG,EAAA;IAElF,OAAA,eAAA3D,UAAA,CAAAA,IAAA,CAAC+G,EAAK,CAAAA,IAAA,EAAA;MAAAkG,EAAA,EAAG,GAAI;MAAAxO,QAAA,EAAA,CAAA,2BAAA,EACe0Q,MAAA,EAAO,GAAA,EAAA,+BAAE,QAAO,EAAA;QAAA1Q,QAAA,EAAA,CAAA,QAAA,EAAEyQ,aAAA,EAAc,QAAA;OAAC,CAAA,EAAS,GAAA;IACtE,CAAA,CAAA;EAEJ;EAEM,MAAAS,aAAA,GACJnK,uBAAuB7B,UAAe,KAAA,CAAA,GAClC,eACA,EAAG,CAAApB,MAAA,CAAAiD,sBAAA,CAAuB7B,UAAW,CAAAiM,cAAA,CAAgB,CAAA,EAAA,YAAA,CAAA;EAM3D,MAAMC,sBAAyB,GAAA,CAC7B,GAAG3J,YAAA,EACH,IAAIE,sBAAA,GAAyB,CAAC,aAAa,IAAI,EAAC,EAClD;EACA,MAAM0J,gBACJD,sBAAuB,CAAAzM,MAAA,KAAW,IAC9B,iBACA,GAAA,EAAA,CAAGb,8BAAuBa,MAAM,EAAA,WAAA,CAAA;EAElC,IAAA2M,eAAA,GAAkB,SACpB,CAAAxN,MAAA,CAAAsN,sBAAA,CAAuBzM,MAAW,KAAA,CAAA,GAAI,KAAK,GAC7C,EAAA,IAAA,CAAA,CAAKb,MAAuB,CAAAsN,sBAAA,CAAAG,IAAA,CAAK,IAAI,CAAA,CAAA;EAGjC,IAAA5J,sBAAA,IAA0ByJ,sBAAuB,CAAAzM,MAAA,KAAW,CAAG,EAAA;IAC/C2M,eAAA,GAAA,qBAAA;EACpB;EAEA,sCACGE,OACC,EAAA;IAAAxR,QAAA,EAAA,CAAA,eAAAS,UAAA,CAAAA,GAAA,CAAC+Q,EAAK,CAAAA,IAAA,EAAA;MAAAnJ,OAAA,EAAS,CAAG;MAAAoG,MAAA,EAAQ,CAAG;MAAAhG,IAAA,EAAK,SAAU;MAAAgJ,YAAA,EAAc,CAAG;MAAAC,IAAA,EAAK,MAChE;MAAA1R,QAAA,EAAA,eAAAuB,eAAA,CAACyO,EAAAA,CAAAA,IACC,EAAA;QAAAhQ,QAAA,EAAA,CAAAS,eAAAA,UAAAA,CAAAA,GAAA,CAAC6H;UAAK,aAAY,EAAA,MAAA;UAAOC,MAAM,CAC7B;UAAAvI,QAAA,iBAAAS,UAAA,CAAAA,GAAA,CAACkR,4BAAmB;QACtB,CAAA,CAAA,EAAA,eACClR,cAAA,CAAA2H,EAAAA,CAAAA,GAAA,EAAA;UAAIsJ,IAAM,EAAA,CAAA;UAAGE,UAAY,EAAA,CAAA;UACxB5R,QAAC,EAAA,eAAAS,cAAA,CAAA6H,EAAAA,CAAAA,IAAA,EAAA;YAAKC,IAAM,EAAA,CAAA;YACTvI,QAAe,EAAAkF,UAAA,KAAA,CAAA,GAAA,eACZ3D,eAAA,CAAAb,UAAAA,CAAAA,QAAA,EAAA;cAAAV,QAAA,EAAA,CAAA,6BAAA,EAAuByQ,aAAA,EAAc,QAAA;YAAA,CAAC,IAGrClP,eAAAA,UAAAA,CAAAA,IAAA,CAAAb,UAAA,CAAAA,QAAA,EAAA;cAAAV,QAAA,EAAA,CAAAkF,UAAA,CAAWiM,cAAe,CAAA,CAAA,EAAE,4BAAA,EAAsBV,aAAA,EAAc,QAAA;YACnE,CAAA;UAEJ,CAAA;SACF,CAAA;MAAA,CACF;IACF,CAAA,CAAA,gCAECrI,EAAI,CAAAA,GAAA,EAAA;MAAAsJ,IAAA,EAAK;MAAOD,YAAc,EAAA,CAAA;MAC7BzR,yCAACsI,EAAK,CAAAA,IAAA,EAAA;QAAAtI,QAAA,EAAA,CAAA,yBAAA,EACoB0Q,MAAA,EAAO,SAAA,EAAGD,aAAA,EAAc,qDAAA;MAAA,CAElD;IACF,CAAA,CAAA,EAAA,eAEChQ,UAAA,CAAAA,GAAA,CAAA+Q,EAAA,CAAAA,IAAA,EAAA;MAAK/C,MAAQ,EAAA,CAAA;MAAGoD,MAAQ,EAAA,CAAA;MAAGJ,YAAc,EAAA,CAAA;MAAGC,IAAK,EAAA,MAAA;MAChD1R,QAAC,iBAAAuB,UAAA,CAAAA,IAAA,CAAAyO,EAAA,CAAAA,IAAA,EAAA;QAAK8B,WAAU,QACb;QAAA9R,QAAA,EAAA,CAAmB4G,kBAAA,CAAA1B,UAAA,GAAa,CAC/B,IAAA,eAAA3D,UAAA,CAAAA,IAAA,CAACwQ,EAAM,CAAAA,KAAA,EAAA;UAAAvD,EAAA,EAAG,IAAK;UAAAnG,OAAA,EAAS,CAAG;UAAA0B,KAAA,EAAO,CAAG;UAAA,aAAA,EAAY,qBAC9C;UAAA/J,QAAA,EAAA,CAAA4G,kBAAA,IAAA,IAAA,GAAA,KAAA,CAAA,GAAAA,kBAAA,CAAoBzB,UAAW,CAAA1C,GAAA,CAAKsO,IAAA,mBAClCtQ,UAAA,CAAAA,GAAA,CAAA2H,EAAA,CAAAA,GAAA,EAAA;YAAIoG,EAAG,EAAA,IAAA;YACLxO,QAAkB,EAAA8Q,iBAAA,CAAAC,IAAI;UADP,CAAA,EAAAA,IAAA,CAAKnH,GAEvB,CAAA,CAAA,EAGDhD,kBAAmB,CAAA1B,UAAA,GAAa0B,kBAAmB,CAAAzB,UAAA,CAAWR,yBAC5DlE,UAAA,CAAAA,GAAA,CAAA2H,EAAA,CAAAA,GAAA,EAAA;YAAIoG,EAAG,EAAA,IAAA;YAAKnG,SAAS,CACpB;YAAArI,QAAA,iBAAAS,UAAA,CAAAA,GAAA,CAACwP,mBAAqB,EAAA;cAAA,GAAGrJ;YAAoB,CAAA;WAC/C,CAAA;SAEJ,CAAA,EAGDG,sBAAA,CAAuB7B,aAAa,CACnC,mBAAA3D,UAAA,CAAAA,IAAA,CAAC2N,6BAAA,EAAA;UACC,aAAY,EAAA,0BAAA;UACZxN,KAAO,EAAA;YAAA;YAELsQ,SACE,EAAApL,kBAAA,CAAmB1B,UAAa,GAAA,CAAA,GAC5B,4CACA,GAAA,KAAA;UACR,CAAA;UAEAlF,QAAA,EAAA,CAAAS,eAAAA,UAAAA,CAAAA,GAAA,CAAC4O;YACCrP,QAAC,EAAA,eAAAS,UAAA,CAAAA,GAAA,CAAA+Q,EAAA,CAAAA,IAAA,EAAA;cAAKhD,IAAG,GAAI;cAAAyD,MAAA,EAAQ;cAAGxD,MAAQ,EAAA,CAAA;cAAGoD,MAAQ,EAAA,CAAA;cAAGK,UAAU,CACtD;cAAAlS,QAAA,EAAAuB,eAAAA,UAAAA,CAAAA,IAAA,CAACyO,EAAAA,CAAAA;gBAAKmC,KAAM,EAAA,QAAA;gBAASF,QAAQ,CAC3B;gBAAAjS,QAAA,EAAA,CAAA,eAAAS,UAAA,CAAAA,GAAA,CAAC2H,EAAI,CAAAA,GAAA,EAAA;kBAAAwJ,UAAA,EAAY,CAAG;kBAAAQ,WAAA,EAAa,CAC/B;kBAAApS,QAAA,iBAAAS,UAAA,CAAAA,GAAA,CAAC6H,EAAK,CAAAA,IAAA,EAAA;oBAAAC,IAAA,EAAM,CACV;oBAAAvI,QAAA,EAAAS,eAAAA,UAAAA,CAAAA,GAAA,CAAC4R,KAAAA,CAAAA,aAAc,EAAA,CAAA,CAAA;kBACjB,CAAA;iBACF,CAAA,EAAA,eACC9Q,UAAA,CAAAA,IAAA,CAAAyO,EAAA,CAAAA,IAAA,EAAA;kBAAKoC,WAAa,EAAA,CAAA;kBAAGN,WAAU,QAC9B;kBAAA9R,QAAA,EAAA,CAAA,eAAAS,cAAA,CAAC2H,EAAAA,CAAAA,GAAI,EAAA;oBAAAqJ,YAAA,EAAc,CACjB;oBAAAzR,QAAA,iBAAAuB,UAAA,CAAAA,IAAA,CAAC+G,OACE,EAAA;sBAAAtI,QAAA,EAAA,CAAAkR,aAAA,EAAc,MAAA,EAAKG,aAAA;oBAAA,CACtB;kBACF,CAAA,CAAA,EAAA,eACC5Q,UAAA,CAAAA,GAAA,CAAA2H,EAAA,CAAAA,GAAA,EAAA;oBACCpI,QAAC,EAAA,eAAAS,UAAA,CAAAA,GAAA,CAAA6H,OAAA,EAAA;sBAAK7G,KAAO,EAAA6P,eAAA;sBAAiBgB,YAAa,EAAA,UAAA;sBAAW/J,IAAM,EAAA,CAAA;sBAAGI,KAAK,EAAA,IAAA;sBACjE3I;oBACH,CAAA;mBACF,CAAA;iBACF,CAAA,EACAS,eAAAA,UAAAA,CAAAA,GAAA,CAACsO;kBACC/O,QAAC,EAAA,eAAAS,UAAA,CAAAA,GAAA,CAAA6H,EAAA,CAAAA,IAAA,EAAA;oBAAKK,OAAK,IACT;oBAAA3I,QAAA,EAAAS,eAAAA,UAAAA,CAAAA,GAAA,CAAC8R,KAAAA,CAAAA,eAAgB,EAAA,CAAA,CAAA;kBAAA,CACnB;gBACF,CAAA,CAAA;cACF,CAAA;YACF,CAAA;WACF,CAAA,EAAA,+BAECnK,EAAAA,CAAAA,GAAI,EAAA;YAAAoK,QAAA,EAAS;YAAOC,aAAe,EAAA,CAAA;YAAGC,UAAU,CAC/C;YAAA1S,QAAA,EAAA,CAAA,eAAAuB,eAAA,CAACgO,KACC,EAAA;cAAAvP,QAAA,EAAA,CAAA,eAACS,UAAA,CAAAA,GAAA,CAAA,OAAA,EAAA;gBACCT,yCAAC,IACC,EAAA;kBAAAA,QAAA,EAAA,CAAA,eAAAS,UAAA,CAAAA,GAAA,CAAC,IACC,EAAA;oBAAAT,QAAA,EAAA,eAAAS,UAAA,CAAAA,GAAA,CAACkS,QAAM,EAAA;sBAAAhK,KAAA,EAAK,IAAC;sBAAAJ,IAAA,EAAM,CAAG;sBAAA7G,KAAA,EAAO;wBAACkR,QAAA,EAAU;sBAAM,CAAA;sBAAG5S;oBAEjD,CAAA;mBACF,CAAA,EACAS,eAAAA,UAAAA,CAAAA,GAAA,CAAC;oBACCT,QAAC,EAAA,eAAAS,UAAA,CAAAA,GAAA,CAAAkS,EAAA,CAAAA,KAAA,EAAA;sBAAMhK,OAAK,IAAC;sBAAAJ,IAAA,EAAM,CAAG;sBAAAvI,QAAA,EAAA;oBAAA,CAEtB;kBACF,CAAA,CAAA,EACAS,eAAAA,UAAAA,CAAAA,GAAA,CAAC;oBACCT,QAAC,EAAA,eAAAS,UAAA,CAAAA,GAAA,CAAAkS,EAAA,CAAAA,KAAA,EAAA;sBAAMhK,OAAK,IAAC;sBAAAJ,IAAA,EAAM,CAAG;sBAAAvI,QAAA,EAAA;oBAAA,CAEtB;kBACF,CAAA,CAAA;gBAAA,CACF;cACF,CAAA,CAAA,EAAA,8BACC,OACE,EAAA;gBAAAA,QAAA,EAAA+G,sBAAA,CAAuB5B,UACrB,CAAAX,MAAA,CAAQqO,SAAuD,IAAA;kBAC9D,OAAO,WAAe,IAAAA,SAAA;gBAAA,CACvB,EACApQ,GAAI,CAAA,CAAAqQ,MAAA,EAAuCtI,KAAA;kBAAA,IAAtC;oBAAClD,SAAW;oBAAAI,WAAA;oBAAatE;mBAAa,GAAA0P,MAAA;kBAAA;oBAAA;oBAAA;oCAEzC,IACC,EAAA;sBAAA9S,QAAA,EAAA,CAAAS,eAAAA,UAAAA,CAAAA,GAAA,CAAC;wBACCT,QAAC,EAAA,eAAAS,UAAA,CAAAA,GAAA,CAAA6H,EAAA,CAAAA,IAAA,EAAA;0BAAKC,IAAM,EAAA,CAAA;0BAAIvI;yBAAU;sBAC5B,CAAA,CAAA,EACAS,eAAAA,UAAAA,CAAAA,GAAA,CAAC;wBACCT,QAAC,EAAAS,eAAAA,UAAAA,CAAAA,GAAA,CAAA6H,EAAAA,CAAAA,IAAA,EAAA;0BAAKC,MAAM,CAAI;0BAAAvI,QAAA,EAAA0H,WAAA,IAAe;yBAAc;sBAC/C,CAAA,CAAA,EACAjH,eAAAA,UAAAA,CAAAA,GAAA,CAAC;wBACCT,QAAC,EAAAuB,eAAAA,UAAAA,CAAAA,IAAA,CAAAwO,cAAA,EAAA;0BAAeoC,OAAM,QAAS;0BAAAY,GAAA,EAAK,CAAG;0BAAAC,OAAA,EAAQ,UAC7C;0BAAAhT,QAAA,EAAA,CAAA,eAAAS,cAAA,CAAC6H,EAAAA,CAAAA;4BAAKgK,YAAa,EAAA,UAAA;4BAAW/J,IAAM,EAAA,CAAA;4BACjCvI,wBAAc;2BACjB,CAAA,EACCoD,UACC,mBAAA3C,UAAA,CAAAA,GAAA,CAACwS,wBAAA,CAAA9D,OAAA,EAAA;4BACC+D,IAAM,EAAA9P,UAAA;4BAEN+P,QAAQA,CAAA,KAAM;8BAEZvC,KAAA,CAAMwC,IAAK,CAAA;gCACT3R,KAAO,EAAA,kCAAA;gCACPoI,MAAQ,EAAA;8BAAA,CACT,CAAA;4BACH,CAAA;4BAEA7J,QAAA,iBAAAS,UAAA,CAAAA,GAAA,CAAC4S,EAAA,CAAAA,MAAA,EAAA;8BACC5R,KAAM,EAAA,sBAAA;8BACN6R,IAAK,EAAA,OAAA;8BACLtK,IAAM,EAAAuK,KAAA,CAAAA,QAAA;8BACNC,QAAU,EAAA;4BAAA,CACZ;0BAAA,CACF,CAAA;wBAAA,CAEJ;sBACF,CAAA,CAAA;oBAjCO,CAAA,EAAA,EAAA,CAAG1P,MAAU,CAAAV,UAAA,EAAA,GAAA,CAAA,CAAIU,MAkC1B,CAAA0G,KAAA,CAAA;kBAAA;gBAAA,CACD;eACL,CAAA;aACF,CAAA,EAEA/J,eAAAA,UAAAA,CAAAA,GAAA,CAAC2H;cAAIC,OAAS,EAAA,CAAA;cACZrI,wCAACiQ,mBAAqB,EAAA;gBAAA,GAAGlJ;eAAwB;YACnD,CAAA,CAAA;WACF,CAAA;QAAA,CACF,CAAA;MAAA,CAEJ;IACF,CAAA,CAAA,EAAA,eAECtG,cAAA,CAAA2H,EAAAA,CAAAA,GAAA,EAAA;MAAIsJ,IAAK,EAAA,MAAA;MACR1R,yCAACsI,OAAK,EAAA;QAAAtI,QAAA,EAAA,CAAA,SAAA,EACI0Q,MAAA,EAAO,iFAAA;MAAA,CAEjB;IACF,CAAA,CAAA;EACF,CAAA,CAAA;AAEJ;;;;;;AChRA,IAAAhC,IAAA,EAAAC,IAAA;AAQO,MAAM8E,UAAa,GAAAzE,eAAA,CAAAG,OAAA,CAAO/G,MAAG,CAAA,CAAEsL,KAAM,CAAA;EAC1CrL,OAAS,EAAA;AACX,CAAC,EAFyBqG,IAExB,KAAAA,IAAA,GAAAO,YAAA,CAAA,CAAA,+BAAA,CAAA,CAAA,CAAA,CAAA;AAKK,MAAM0E,gBAAmB,GAAA3E,eAAA,CAAAG,OAAA,CAAOa,OAAI,CAAA,CAAE0D,KAAM,CAAA;EACjDvB,KAAO,EAAA,QAAA;EACPL,SAAW,EAAA,QAAA;EACXkB,OAAS,EAAA;AACX,CAAC,EAJ+BrE,IAI9B,KAAAA,IAAA,GAAAM,YAAA,CAAA,CAAA,sBAAA,CAAA,CAAA,CAAA,CAAA;AAgCK,SAAS2E,mBAAoBA,CAAAC,MAAA,EAMP;EAAA,IANO;IAClChP,EAAA;IACAiI,IAAA;IACA4D,MAAS,GAAA,QAAA;IACToD,QAAA;IACAC;EACF,CAA6B,GAAAF,MAAA;EACrB,MAAAG,QAAA,GAAW,yBAAyBlQ,MAAM,CAAAmQ,KAAAA,CAAAA,KAAA,CAAA,CAAA,CAAA;EAC1C,MAAA;IACJrN,kBAAA;IACAG,sBAAA;IACAa,SAAA;IACA1C,UAAA;IACA+B,UAAA;IACAQ,YAAA;IACAE;EAAA,CACF,GAAInB,sBAAsB3B,EAAE,CAAA;EACtB,MAAAqP,iBAAA,GAAoB,EAAG,CAAApQ,MAAA,CAAA4M,MAAA,CAAOyD,SAAU,CAAA,CAAA,EAAG,CAAC,CAAA,CAAEC,WAAY,CAAA,CAAA,CAAA,CAAItQ,MAAO,CAAA4M,MAAA,CAAAyD,SAAA,CAAU,CAAC,CAAA,CAAA;EAEtF,MAAM1D,gBAAiBhQ,eAAAA,UAAAA,CAAAA,GAAA,CAAAE,QAAA,EAAA;IAASE,QAAU,EAAAiG,KAAAA,CAAAA,OAAA,CAAQ,OAAO;MAAC8C,GAAA,EAAK/E,EAAI;MAAA1D,KAAA,EAAO2L;KAAQ,CAAA,EAAA,CAACjI,EAAI,EAAAiI,IAAI,CAAC;EAAG,CAAA,CAAA;EAC/F,MAAMuH,oBAAoB,CAACzM,SAAA;EAGzB,sBAAAnH,UAAA,CAAAA,GAAA,CAAC6T,EAAA,CAAAA,MAAA,EAAA;IACCjE,KAAO,EAAA,CAAA;IACPxL,EAAI,EAAAmP,QAAA;IACJO,MAAA,EAAQ,GAAGzQ,MAAiB,CAAAoQ,iBAAA,EAAA,YAAA,CAAA;IAC5BM,MACE,EAAA,eAAAjT,UAAA,CAAAA,IAAA,CAACkT,EAAK,CAAAA,IAAA,EAAA;MAAAC,OAAA,EAASL,iBAAoB,GAAA,CAAA,GAAI,CAAG;MAAAtB,GAAA,EAAK,CAAG;MAAAL,QAAA,EAAU,CAAG;MAAAR,QAAA,EAAU,CACvE;MAAAlS,QAAA,EAAA,CAAA,eAAAS,cAAA,CAAC4S,EAAAA,CAAAA;QAAOC,IAAK,EAAA,OAAA;QAAQzF,OAAS,EAAAiG,QAAA;QAAUZ,MAAK;OAAS,CAAA,EAErDmB,iBACC,mBAAA5T,UAAA,CAAAA,GAAA,CAAC4S,EAAA,CAAAA,MAAA,EAAA;QACC,aAAY,EAAA,uBAAA;QACZH,MAAMhO,UAAa,GAAA,CAAA,GAAI,GAAGpB,MAAiB,CAAAoQ,iBAAA,EAAA,SAAA,CAAA,GAAY,GAAGpQ,MAAiB,CAAAoQ,iBAAA,EAAA,MAAA,CAAA;QAC3EzL,IAAK,EAAA,UAAA;QACLoF,OAAS,EAAAkG;MAAA,CACX,CAAA;KAEJ,CAAA;IAEFY,OAAS,EAAAb,QAAA;IACTc,cAAgB,EAAAd,QAAA;IAEhB9T,QAAC,EAAAS,eAAAA,UAAAA,CAAAA,GAAA,CAAAgT,UAAA,EAAA;MACEzT,QAA0B,EAAA+G,sBAAA,IAAAH,kBAAA,IAAsB,CAACgB,SAChD,kBAAAnH,UAAA,CAAAA,GAAA,CAAC8P,uBAAA,EAAA;QACCxJ,sBAAA;QACAH,kBAAA;QACA6J,aAAA;QACA7I,SAAA;QACA1C,UAAA;QACAwL,MAAA;QACAzJ,UAAA;QACAQ,YAAA;QACAE,sBAAA;QACAgJ,oBAAsB,EAAAmD;MAAA,CAGxB,CAAA,GAAA,eAAAvS,UAAA,CAAAA,IAAA,CAACoS,gBAAiB,EAAA;QAAA,aAAA,EAAY,mBAC5B;QAAA3T,QAAA,EAAA,CAACS,eAAAA,UAAAA,CAAAA,GAAA,CAAAoU,EAAA,CAAAA,OAAA,EAAA;UAAQlM,OAAK;QAAC,CAAA,CAAA,EAAA,eACdlI,UAAA,CAAAA,GAAA,CAAA2H,EAAA,CAAAA,GAAA,EAAA;UAAI0M,SAAW,EAAA,CAAA;UACd9U,QAAC,EAAAS,eAAAA,UAAAA,CAAAA,GAAA,CAAA6H,EAAAA,CAAAA,IAAA,EAAA;YAAK6J,KAAM,EAAA,QAAA;YAASxJ,KAAK,EAAA,IAAA;YAACJ,IAAM,EAAA,CAAA;YAAGvI;UAEpC,CAAA;SACF,CAAA;MAAA,CACF;IAEJ,CAAA;EAAA,CAAA,CACF;AAEJ;AChHA,SAAS+U,6BAA6BnU,KAAiC,EAAA;EACrE,MAAMiE,KAAKoP,KAAAA,CAAAA,KAAM,EAAA;EACjB,MAAM,CAAC7S,KAAA,EAAO4T,QAAQ,CAAA,GAAI5U,eAA2B,IAAI,CAAA;EACzD,MAAM6U,cAAc/G,KAAAA,CAAAA,WAAY,CAAA,MAAM8G,SAAS,IAAI,CAAA,EAAG,EAAE,CAAA;EAExD,OAAO5T,KACL,GAAA,eAAAX,UAAA,CAAAA,GAAA,CAAC6T,EAAA,CAAAA,MAAA,EAAA;IACCzP,IAAI,eAAgB,CAAAf,MAAA,CAAAe,EAAA,CAAA;IACpB,aAAY,EAAA,6BAAA;IACZ0P,MAAO,EAAA,OAAA;IACPC,QACG/T,eAAAA,UAAAA,CAAAA,GAAA,CAAAuP,EAAA,CAAAA,IAAA,EAAA;MAAK0C,QAAU,EAAA,CAAA;MAAGR,UAAU,CAAG;MAAAJ,SAAA,EAAU,QACxC;MAAA9R,QAAA,EAAAS,eAAAA,UAAAA,CAAAA,GAAA,CAAC4S;QAAOC,IAAK,EAAA,OAAA;QAAQJ,MAAK,OAAQ;QAAArF,OAAA,EAASoH;MAAa,CAAA;KAC1D,CAAA;IAEFN,SAAS/T,KAAM,CAAAkT,QAAA;IAEf9T,wCAACoI,EAAAA,CAAAA,GAAI,EAAA;MAAAC,OAAA,EAAS;MACZrI,QAAC,iBAAAS,UAAA,CAAAA,GAAA,CAAA6H,EAAA,CAAAA,IAAA,EAAA;QAAKtI;OAAsD;IAC9D,CAAA;EAAA,CACF,CAAA,GAAA,8BAECkV,EAAAA,CAAAA,aAAc,EAAA;IAAAC,OAAA,EAASH;IACtBhV,QAAC,iBAAAS,UAAA,CAAAA,GAAA,CAAAmT,mBAAA,EAAA;MAAqB,GAAGhT;IAAO,CAAA;EAClC,CAAA,CAAA;AAEJ;AC5BA,MAAMwU,wBAAyC,GAAA;EAC7CC,aAAe,EAAA,IAAA;EACflF,SAAW,EAAA,YAAA;EACXjI,MAAQ,EAAA;AACV,CAAA;AAEO,SAASoN,mBAAmB1U,KAIhC,EAAA;EACD,MAAM;IAAC2U,QAAA;IAAUC,YAAc;IAAAC;EAAA,CAAQ,GAAA7U,KAAA;EAEnC,IAAA6U,IAAA,CAAK3I,SAAS,SAAW,EAAA;IAC3B,qCAAQ4I,cAAY,EAAA,CAAA,CAAA,CAAA;EACtB;EAEI,IAAAD,IAAA,CAAK3I,SAAS,OAAS,EAAA;IACrB,IAAA2I,IAAA,CAAKzV,QAAS,CAAA2E,MAAA,KAAW,CAAG,EAAA;MACvB,OAAA,IAAA;IACT;IAEA,IAAI8Q,KAAKE,QAAU,EAAA;MACjB,sBAEKpU,UAAA,CAAAA,IAAA,CAAAb,mBAAA,EAAA;QAAAV,QAAA,EAAA,CAAAwV,YAAA,kCAAiBE,EAAY,CAAAA,WAAA,EAAA,EAAA,CAAA,EAC7BD,KAAKhU,KACJ,mBAAAhB,UAAA,CAAAA,GAAA,CAAC2H,MAAI,EAAA;UAAAC,OAAA,EAAS;UAAGoK,aAAe,EAAA,CAAA;UAC9BzS,QAAC,EAAAS,eAAAA,UAAAA,CAAAA,GAAA,CAAAkS,EAAAA,CAAAA,KAAA,EAAA;YAAMhK,OAAK,IAAC;YAAAJ,IAAA,EAAM,CAChB;YAAAvI,QAAA,EAAAyV,IAAA,CAAKhU;UACR,CAAA;SACF,CAAA,EAEDgU,IAAK,CAAAzV,QAAA,CAASyC,GAAI,CAAA,CAACmT,OAAOC,UAAY,KAAA;UAzCjD,IAAAnH,EAAA;UA0CY,sBAAAjO,UAAA,CAAAA,GAAA,CAAC6U,kBAAA,EAAA;YACCC,QAAU,EAAAA,QAAA,IAAYhO,OAAQ,CAAAkO,IAAA,CAAKF,QAAQ,CAAA;YAC3CC,gBAAc9G,EAAK,GAAA+G,IAAA,CAAAzV,QAAA,CAAS6V,aAAa,CAAC,CAAA,KAA5B,mBAA+B/I,IAAS,MAAA,OAAA;YAEtD2I,IAAM,EAAAG;UAAA,CAAA,EADDA,KAAM,CAAAE,GAAA,CAEb;QAAA,CACD,CAAA;MACH,CAAA,CAAA;IAEJ;IAEA,sBAEKvU,UAAA,CAAAA,IAAA,CAAAb,mBAAA,EAAA;MAAAV,QAAA,EAAA,CAAAwV,YAAA,kCAAiBE,EAAY,CAAAA,WAAA,EAAA,EAAA,CAAA,EAAA,eAC9BjV,UAAA,CAAAA,GAAA,CAACsV,EAAA,CAAAA,SAAA,EAAA;QACCR,QAAA;QACAvM,MAAMyM,IAAK,CAAAzM,IAAA;QACXgN,OAAS,EAAAZ,wBAAA;QACTlC,MAAMuC,IAAK,CAAAhU,KAAA;QAEVzB,QAAK,EAAAyV,IAAA,CAAAzV,QAAA,CAASyC,GAAI,CAAA,CAACmT,OAAOC,UAAY,KAAA;UA9DjD,IAAAnH,EAAA;UA+DY,sBAAAjO,UAAA,CAAAA,GAAA,CAAC6U,kBAAA,EAAA;YACCC,QAAU,EAAAA,QAAA,IAAYhO,OAAQ,CAAAkO,IAAA,CAAKF,QAAQ,CAAA;YAC3CC,gBAAc9G,EAAK,GAAA+G,IAAA,CAAAzV,QAAA,CAAS6V,aAAa,CAAC,CAAA,KAA5B,mBAA+B/I,IAAS,MAAA,OAAA;YAEtD2I,IAAM,EAAAG;UAAA,CAAA,EADDA,KAAM,CAAAE,GAAA,CAEb;QAAA,CACD;MAAA,CACH,CAAA;IACF,CAAA,CAAA;EAEJ;EAEA,sBAEKvU,UAAA,CAAAA,IAAA,CAAAb,mBAAA,EAAA;IAAAV,QAAA,EAAA,CAAAwV,YAAA,kCAAiBE,EAAY,CAAAA,WAAA,EAAA,EAAA,CAAA,EAC9BjV,eAAAA,UAAAA,CAAAA,GAAA,CAACwV,2BAA4B,EAAA;MAAAV,QAAA;MAAoBE;IAAY,CAAA,CAAA;EAC/D,CAAA,CAAA;AAEJ;AAEA,SAASQ,4BAA4BrV,KAAkD,EAAA;EAC/E,MAAA;IAAC6U;EAAQ,CAAA,GAAA7U,KAAA;EAEf,IAAI6U,KAAKS,MAAQ,EAAA;IACf,qCAAQC,yBAA2B,EAAA;MAAA,GAAGvV,KAAO;MAAAsV,MAAA,EAAQT,KAAKS;IAAQ,CAAA,CAAA;EACpE;EAEO,OAAA,eAAAzV,UAAA,CAAAA,GAAA,CAAC2V,mBAAqB,EAAA;IAAA,GAAGxV;EAAO,CAAA,CAAA;AACzC;AAEA,SAASwV,oBAAoBxV,KAAkD,EAAA;EA7F/E,IAAA8N,EAAA;EA8FQ,MAAA;IAAC6G,QAAU;IAAAE;EAAQ,CAAA,GAAA7U,KAAA;EACnB,MAAAyV,cAAA,GAAiB,OAAOZ,IAAA,CAAKF,QAAa,KAAA,QAAA,IAAA,eAC7C9U,UAAA,CAAAA,GAAA,CAAA6H,EAAA,CAAAA,IAAA,EAAA;IAAKC,IAAM,EAAA,CAAA;IAAIvI,QAAK,EAAAyV,IAAA,CAAAF,QAAA,CAAS7Q;EAAO,CAAA,CAAA;EAGvC,sBACGjE,UAAA,CAAAA,GAAA,CAAA6V,MAAA,CAAAA,iBAAA,EAAA;IAAkBnO,OAAS,EAAAkO,cAAA;IAAgBlG,WAAU,MACpD;IAAAnQ,QAAA,iBAAAS,UAAA,CAAAA,GAAA,CAAC8V,EAAA,CAAAA,QAAA,EAAA;MACChB,QAAU,EAAAA,QAAA,IAAYhO,OAAQ,CAAAkO,IAAA,CAAKF,QAAQ,CAAA;MAC3CiB,OAAS,EAAA,CAAA9H,EAAA,GAAA+G,IAAA,CAAKgB,MAAL,KAAA,IAAA,GAAA,KAAA,CAAA,GAAA/H,EAAA,CAAagI,KAAM,CAAA,GAAA,CAAA;MAC5B1N,MAAMyM,IAAK,CAAAzM,IAAA;MACX2N,SAAW,EAAAlB,IAAA,CAAKkB,SAAc,IAAAlB,IAAA,CAAKmB,QAAY,IAAAC,KAAA,CAAAA,aAAA;MAE/ChJ,SAAS4H,IAAK,CAAAqB,QAAA;MACdC,SAAStB,IAAK,CAAAmB,QAAA;MACd1D,MAAMuC,IAAK,CAAAhU,KAAA;MACXgH,MAAMgN,IAAK,CAAAhN;IAAA,CAEf;EAAA,CAAA,CAAA;AAEJ;AAEA,SAAS0N,0BAA0BvV,KAIhC,EAAA;EAxHH,IAAA8N,EAAA;EAyHE,MAAM;IAAC6G,QAAA;IAAUW,MAAQ;IAAAT;EAAA,CAAQ,GAAA7U,KAAA;EAC3B,MAAAyV,cAAA,GAAiB,OAAOZ,IAAA,CAAKF,QAAa,KAAA,QAAA,IAAA,eAC7C9U,UAAA,CAAAA,GAAA,CAAA6H,EAAA,CAAAA,IAAA,EAAA;IAAKC,IAAM,EAAA,CAAA;IAAIvI,QAAK,EAAAyV,IAAA,CAAAF,QAAA,CAAS7Q;EAAO,CAAA,CAAA;EAEjC,MAAAsS,UAAA,GAAaC,uBAAc;IAACf,MAAA,EAAQA,OAAOpJ,IAAM;IAAAlC,MAAA,EAAQsL,MAAO,CAAAtL;EAAA,CAAO,CAAA;EAE7E,MAAMsM,WAAc,GAAAhJ,KAAA,CAAAA,WAAA,CACjBiJ,KAAsC,IAAA;IACrCH,UAAA,CAAWnJ,QAAQsJ,KAAK,CAAA;IACxB1B,IAAA,CAAKqB,QAAS,CAAA,CAAA;EAChB,CAAA,EACA,CAACE,YAAYvB,IAAI,CAAA,CACnB;EAEA,sBACGhV,UAAA,CAAAA,GAAA,CAAA6V,MAAA,CAAAA,iBAAA,EAAA;IAAkBnO,OAAS,EAAAkO,cAAA;IAAgBlG,WAAU,MACpD;IAAAnQ,QAAA,iBAAAS,UAAA,CAAAA,GAAA,CAAC8V,EAAA,CAAAA,QAAA,EAAA;MACC/H,EAAG,EAAA,GAAA;MACH+G,QAAU,EAAAA,QAAA,IAAYhO,OAAQ,CAAAkO,IAAA,CAAKF,QAAQ,CAAA;MAC3CiB,OAAS,EAAA,CAAA9H,EAAA,GAAA+G,IAAA,CAAKgB,MAAL,KAAA,IAAA,GAAA,KAAA,CAAA,GAAA/H,EAAA,CAAagI,KAAM,CAAA,GAAA,CAAA;MAC5BU,MAAMJ,UAAW,CAAAI,IAAA;MACjBpO,MAAMyM,IAAK,CAAAzM,IAAA;MACX2N,SAAA,EAAWlB,IAAK,CAAAmB,QAAA,GAAWC,KAAAA,CAAAA,aAAgB,GAAA,KAAA,CAAA;MAC3ChJ,OAAS,EAAAqJ,WAAA;MACTH,SAAStB,IAAK,CAAAmB,QAAA;MACd1D,MAAMuC,IAAK,CAAAhU,KAAA;MACXgH,MAAMgN,IAAK,CAAAhN;IAAA,CAEf;EAAA,CAAA,CAAA;AAEJ;AC5IA,MAAM4O,0BAA2C,GAAA;EAC/ChC,aAAe,EAAA,IAAA;EACflF,SAAW,EAAA,QAAA;EACXjI,MAAQ,EAAA;AACV,CAAA;AAEA,SAASoP,YAAAA,CAAaC,OAAwB9O,IAAmD,EAAA;EACxF,OAAA8O,KAAA,CAAM3S,IAAK,CAAC6Q,IAAS,IAAA;IAC1B,OACGA,IAAK,CAAA3I,IAAA,KAAS,MAAU,IAAA2I,IAAA,CAAKhN,IAAS,KAAAA,IAAA,IACtCgN,IAAK,CAAA3I,IAAA,KAAS,OAAW,IAAAwK,YAAA,CAAa7B,IAAK,CAAAzV,QAAA,EAAUyI,IAAI,CAAA;EAAA,CAE7D,CAAA;AACH;AAOO,SAAS+O,sBAAsB5W,KAAmC,EAAA;EACjE,MAAA;IAAC2W;EAAS,CAAA,GAAA3W,KAAA;EAChB,MAAMiE,KAAKoP,KAAAA,CAAAA,KAAM,EAAA;EAEX,MAAAwD,WAAA,GAAcH,YAAa,CAAAC,KAAA,EAAO,UAAU,CAAA;EAC5C,MAAAG,UAAA,GAAaJ,YAAa,CAAAC,KAAA,EAAO,SAAS,CAAA;EAG9C,sBAAA9W,UAAA,CAAAA,GAAA,CAACkX,EAAA,CAAAA,UAAA,EAAA;IACCC,MACE,iBAAAnX,UAAA,CAAAA,GAAA,CAACoX,MAAA,CAAAA,YAAA,EAAA;MACC7O,IAAM,EAAA8O,KAAA,CAAAA,oBAAA;MACNxE,IAAK,EAAA,OAAA;MACL7R,KAAM,EAAA,WAAA;MAENgH,IAAM,EAAAgP,WAAA,GAAc,UAAa,GAAAC,UAAA,GAAa,SAAY,GAAA,KAAA;IAAA,CAC5D,CAAA;IAEF7S,EAAA;IACAkT,MACGtX,eAAAA,UAAAA,CAAAA,GAAA,CAAAuX,EAAAA,CAAAA,IAAA,EAAA;MACEhY,gBAAMyC,GAAI,CAAA,CAACgT,MAAMwC,SAAc,KAAA;QApD1C,IAAAvJ,EAAA;QAqDY,MAAM8G,iBAAe9G,EAAM,GAAA6I,KAAA,CAAAU,SAAA,GAAY,CAAC,CAAA,KAAnB,mBAAsBnL,IAAS,MAAA,OAAA;QAEpD,OAAQrM,eAAAA,UAAAA,CAAAA,GAAA,CAAA6U,kBAAA,EAAA;UAAmBE,YAA2C;UAAAC;SAAA,EAAVA,KAAKK,GAAiB,CAAA;MACnF,CAAA;KACH,CAAA;IAEFE,OAAS,EAAAqB;EAAA,CAAA,CACX;AAEJ;AC3DO,MAAMa,UAAa,GAAA,KAAA;AAKnB,MAAMC,oBAAuB,GAAA,EAAA;AAK7B,MAAMC,yBAAyBD,oBAAuB,GAAA,CAAA;ACPhD,MAAAE,WAAA,GAAc9N,oBAAuC,IAAI,CAAA;;;;;;ACNtE,IAAAmE,IAAA;AAKA,MAAM4J,MAAO,GAAAtJ,eAAAA,CAAAA,OAAA,CAAOuJ,EAAK,CAAAA,KAAA,CAAA,CAAZ7J,IAAa,KAAAA,IAAA,GAAAO,YAAA,CAAA,CAAA,0vBAAA,CAAA,CAAA,CAAA,CAAA;AAmDnB,SAASuJ,WAAYA,CAAAC,MAAA,EAMzB;EAAA,IANyB;IAC1BlD,QAAA;IACAmD;EACF,CAGG,GAAAD,MAAA;EACK,MAAA;IAACE;GAAM,GAAItM,aAAc,EAAA;EAC/B,MAAM,CAACuM,QAAA,EAAUC,WAAW,CAAA,GAAIzY,eAAS,KAAK,CAAA;EAE9C,MAAM0Y,eAAkB,GAAA5K,KAAA,CAAAA,WAAA,CACrBiJ,KAAe,IAAA;IACd,IAAI,CAACuB,OAAA,EAAS;IAEdG,WAAA,CAAY,IAAI,CAAA;IAEhB1B,KAAA,CAAM4B,cAAe,CAAA,CAAA;IAErB,MAAMC,SAAS7B,KAAM,CAAA8B,KAAA;IAEdN,MAAA,CAAA,OAAA,EAASD,SAAS,CAAC,CAAA;IAEpB,MAAAQ,eAAA,GAAmBhX,CAAkB,IAAA;MACzCA,CAAA,CAAE6W,cAAe,CAAA,CAAA;MAEX,MAAAI,MAAA,GAASjX,EAAE+W,KAAQ,GAAAD,MAAA;MAElBL,MAAA,CAAA,MAAA,EAAQD,SAASS,MAAM,CAAA;IAAA,CAChC;IAEM,MAAAC,aAAA,GAAiBlX,CAAkB,IAAA;MACvCA,CAAA,CAAE6W,cAAe,CAAA,CAAA;MAEjBF,WAAA,CAAY,KAAK,CAAA;MAEVQ,MAAA,CAAAC,mBAAA,CAAoB,aAAaJ,eAAe,CAAA;MAChDG,MAAA,CAAAC,mBAAA,CAAoB,WAAWF,aAAa,CAAA;MAE5CT,MAAA,CAAA,KAAA,EAAOD,SAAS,CAAC,CAAA;IAAA,CAC1B;IAEOW,MAAA,CAAAE,gBAAA,CAAiB,aAAaL,eAAe,CAAA;IAC7CG,MAAA,CAAAE,gBAAA,CAAiB,WAAWH,aAAa,CAAA;EAClD,CAAA,EACA,CAACV,SAASC,MAAM,CAAA,CAClB;EAGE,sBAAAlY,UAAA,CAAAA,GAAA,CAAC6X,MAAA,EAAA;IACC,eAAA,EAAe/C,WAAW,EAAK,GAAA,KAAA,CAAA;IAC/B,eAAA,EAAeqD,WAAW,EAAK,GAAA,KAAA,CAAA;IAC/BY,WAAa,EAAAV;EAAA,CAAA,CACf;AAEJ;;;;;;AC9GA,IAAApK,IAAA;AAoBA,MAAM4J,MAAO,GAAAtJ,eAAAA,CAAAA,OAAA,CAAOwC,EAAI,CAAAA,IAAA,CAAA,CAAX9C,IAAY,KAAAA,IAAA,GAAAO,YAAA,CAAA,CAAA,sLAAA,CAAA,CAAA,CAAA,CAAA;AAclB,MAAMwK,IAAO,GAAA5N,KAAAA,CAAAA,UAAA,CAAW,SAAS4N,KAAAA,CACtC7Y,OAGAkL,GACA,EAAA;EAvCF,IAAA4C,GAAA,EAAAC,EAAA,EAAAC,EAAA;EAwCQ,MAAA;IACJ5O,QAAA;IACA0Z,eAAiB,EAAAC,mBAAA;IACjBC,eAAiB,EAAAC,mBAAA;IACjBnI,MAAMoI,QAAW,GAAA,CAAA;IACjBjV,EAAA;IACA+N,QAAU,EAAAmH,YAAA;IACVC,QAAU,EAAAC,YAAA;IACVrD,QAAW,GAAA,KAAA;IACX,GAAGsD;EACD,CAAA,GAAAtZ,KAAA;EACJ,MAAM,CAACuZ,WAAA,EAAaC,cAAc,CAAA,GAAIha,eAAgC,IAAI,CAAA;EACpE,MAAA;IACJia,QAAA;IACAC,SAAW,EAAAC,eAAA;IACXC,MAAA;IACAC,eAAA;IACAC,KAAA;IACA1O;MACEK,aAAc,CAAA,CAAA;EAClB,MAAMC,OAAON,KAAM,CAAA2O,IAAA,CAAMC,CAAM,IAAAA,CAAA,CAAElC,YAAYyB,WAAW,CAAA;EACxD,MAAMU,SAAY,GAAAvO,IAAA,IAAQN,KAAM,CAAA8O,OAAA,CAAQxO,IAAI,CAAA;EAC5C,MAAMyO,WAAW,OAAOF,SAAA,KAAc,WAAW7O,KAAM,CAAA6O,SAAA,GAAY,CAAC,CAAI,GAAA,KAAA,CAAA;EAClE,MAAAG,MAAA,GAASH,SAAc,KAAA7O,KAAA,CAAMrH,MAAS,GAAA,CAAA;EAE5C,MAAM2V,SAAY,GAAAC,eAAA,GAAkB,KAAQ,GAAA,CAAAjO,IAAA,IAAA,IAAA,GAAA,KAAA,CAAA,GAAAA,IAAA,CAAMgO,SAAa,KAAA,KAAA;EACzD,MAAAW,aAAA,GAAA,CAAgBF,qCAAUT,SAAa,KAAA,KAAA;EACvC,MAAAY,YAAA,GAAeC,mBAAgBrP,GAAG,CAAA;EACxC,MAAM4F,IAAOhD,GAAAA,CAAAA,GAAAA,GAAApC,IAAM,IAAA,IAAA,GAAA,KAAA,CAAA,GAAAA,IAAA,CAAAoF,IAAA,KAAN,OAAAhD,GAAc,GAAAoL,QAAA;EACrB,MAAAJ,eAAA,GAAA,CAAkB/K,EAAM,GAAArC,IAAA,IAAA,IAAA,GAAA,KAAA,CAAA,GAAAA,IAAA,CAAAoN,eAAA,KAAN,IAAyB,GAAA/K,EAAA,GAAAgL,mBAAA;EAC3C,MAAAC,eAAA,GAAA,CAAkBhL,EAAM,GAAAtC,IAAA,IAAA,IAAA,GAAA,KAAA,CAAA,GAAAA,IAAA,CAAAsN,eAAA,KAAN,IAAyB,GAAAhL,EAAA,GAAAiL,mBAAA;EAEjD,MAAMuB,MAAS,GAAAlN,KAAA,CAAAA,WAAA,CACZmN,QAAoC,IAAA;IACnCjB,cAAA,CAAeiB,QAAQ,CAAA;IACvBH,YAAA,CAAaI,OAAU,GAAAD,QAAA;EACzB,CAAA,EACA,CAACH,YAAY,CAAA,CACf;EAEA7a,KAAAA,CAAAA,SAAA,CAAU,MAAM;IACd,IAAI,CAAC8Z,WAAA,EAAoB,OAAA,KAAA,CAAA;IACzB,OAAOO,MAAMP,WAAa,EAAA;MACxBT,eAAiB,EAAAC,mBAAA;MACjBC,eAAiB,EAAAC,mBAAA;MACjBnI,IAAM,EAAAoI,QAAA;MACNjV,EAAA;MACA+N,QAAU,EAAAmH,YAAA;MACVC,QAAU,EAAAC;IAAA,CACX,CAAA;EAAA,CACA,EAAA,CACDN,mBAAA,EACAE,mBAAA,EACAC,QAAA,EACAjV,EAAA,EACAkV,YAAA,EACAE,YAAA,EACAS,KAAA,EACAP,WAAA,CACD,CAAA;EAEK,MAAAoB,cAAA,GAAiBrN,KAAAA,CAAAA,YAAY,MAAM;IACvC,IAAI,CAACiM,WAAA,EAAa;IAClBE,QAAA,CAASF,WAAW,CAAA;EAAA,CACnB,EAAA,CAACE,QAAU,EAAAF,WAAW,CAAC,CAAA;EAEpB,MAAAqB,YAAA,GAAetN,KAAAA,CAAAA,YAAY,MAAM;IACrC,IAAI,CAACiM,WAAA,EAAa;IAClBK,MAAA,CAAOL,WAAW,CAAA;EAAA,CACjB,EAAA,CAACK,MAAQ,EAAAL,WAAW,CAAC,CAAA;EAExB,MAAMsB,YAAe,GAAA3U,KAAA,CAAAA,OAAA,CACnB,OAAO;IACLuT,QAAU,EAAAkB,cAAA;IACVjB,SAAA,EAAWC,kBAAkB,KAAQ,GAAAD,SAAA;IACrCE,MAAQ,EAAAgB,YAAA;IACRhR,KAAO,EAAAqQ,SAAA;IACPG,MAAA;IACAb;EAAA,CACF,CAAA,EACA,CAACG,SAAW,EAAAiB,cAAA,EAAgBC,cAAcR,MAAQ,EAAAT,eAAA,EAAiBM,WAAWV,WAAW,CAAA,CAC3F;EAEM,MAAAvH,QAAA,GAAW9L,KAAAA,CAAAA,QAAQ,MAAM;IAC7B,IAAIyT,eAAiB,EAAA;MACZ,OAAA,KAAA,CAAA;IACT;IAEI,IAAAD,SAAA,EAAkB,OAAAnC,oBAAA;IAEtB,IAAIuB,oBAAoB,CAAG,EAAA;MACzB,OAAOK,YAAgB,IAAA3B,sBAAA;IACzB;IAEA,IAAI4C,MAAQ,EAAA;MACV,OAAOjB,YAAgB,IAAA3B,sBAAA;IACzB;IAEA,OAAOsB,mBAAmBK,YAAgB,IAAA3B,sBAAA;EAAA,GACzC,CAACkC,SAAA,EAAWZ,iBAAiBsB,MAAQ,EAAAT,eAAA,EAAiBR,YAAY,CAAC,CAAA;EAEhE,MAAAC,QAAA,GAAWlT,KAAAA,CAAAA,QAAQ,MAAM;IACzB,IAAAwT,SAAA,EAAkB,OAAAnC,oBAAA;IAEtB,IAAIoC,mBAAmBS,MAAQ,EAAA;MACtB,OAAA,KAAA,CAAA;IACT;IAEA,IAAIA,MAAQ,EAAA;MACV,IAAIf,YAAc,EAAA;QAChB,OAAOL,eAAmB,IAAA,IAAA,GAAAA,eAAA,GAAAK,YAAA;MAC5B;MAEO,OAAA,KAAA,CAAA;IACT;IAEA,OAAOL,eAAmB,IAAA,IAAA,GAAAA,eAAA,GAAAK,YAAA;EAAA,GACzB,CAACK,SAAA,EAAWV,iBAAiBoB,MAAQ,EAAAT,eAAA,EAAiBN,YAAY,CAAC,CAAA;EAEhE,MAAAyB,MAAA,GAASnB,mBAAmB,CAACS,MAAA;EAEnC,MAAMW,OAAU,GAAA7U,KAAA,CAAAA,OAAA,CACd,MACE,CAACkU,MAAA,IACD,CAACT,eAAA,IAAA,8BACEqB,0BAAoB,EAAA;IAAAC,OAAA,EAAQ,aAC3B;IAAA7b,QAAA,EAAAS,eAAAA,UAAAA,CAAAA,GAAA,CAAC+X;MAAYjD,QAAU,EAAA+E,SAAA,IAAaW,aAAe;MAAAvC,OAAA,EAASyB;IAAa,CAAA;GAC3E,CAAA,EAEJ,CAACG,SAAA,EAAWU,MAAQ,EAAAT,eAAA,EAAiBU,eAAed,WAAW,CAAA,CACjE;EAEA,MAAMzY,KAAQ,GAAAoF,KAAA,CAAAA,OAAA,CACZ,OAAO;IACL4K,IAAA;IACAkB,QAAA;IACAoH,QAAA,EAAUA,QAAa,KAAA8B,QAAA,GAAW,KAAY,CAAA,GAAA9B;EAAA,CAChD,CAAA,EACA,CAACtI,IAAM,EAAAkB,QAAA,EAAUoH,QAAQ,CAAA,CAC3B;EAEA,sBAEIzY,UAAA,CAAAA,IAAA,CAAAb,mBAAA,EAAA;IAAAV,QAAA,EAAA,CAACS,eAAAA,UAAAA,CAAAA,GAAA,CAAAmb,MAAAA,CAAAA,mBAAA,EAAA;MAAoBC,SAAQ,MAC3B;MAAA7b,QAAA,EAAAS,eAAAA,UAAAA,CAAAA,GAAA,CAAC4X,YAAY0D,QAAZ,EAAA;QAAqB1a,OAAOoa,YAC3B;QAAAzb,QAAA,EAAA,eAAAuB,UAAA,CAAAA,IAAA,CAAC+W,MAAA,EAAA;UACC,aAAY,EAAA,MAAA;UACZ,SAAQ,EAAA,MAAA;UACR7P,IAAK,EAAA,SAAA;UACLiT,MAAA;UACA7W,EAAA;UACA2N,QAAA,EAAU+H,kBAAkB,KAAY,CAAA,GAAA,QAAA;UACvC,GAAGL,SAAA;UACJ,qBAAA,EAAqBI,YAAY,EAAK,GAAA,KAAA,CAAA;UACtC,iBAAiB,EAAAO,SAAA;UACjB,oBAAA,EAAoBjE,WAAW,EAAK,GAAA,KAAA,CAAA;UACpC9K,GAAK,EAAAsP,MAAA;UACL1Z,KAAA;UAEC1B,QAAA,EAAA,CACCkY,UAAA,EAYA,eAGDzX,UAAA,CAAAA,GAAA,CAAAub,EAAA,CAAAA,uBAAA,EAAA;YAAwBtD,OAAS,EAAAyB,WAAA;YAC/Bna,QAAC,EAAA,CAAA0b,MAAA,IACCjb,eAAAA,UAAAA,CAAAA,GAAA,CAAAuP,EAAAA,CAAAA,IAAA,EAAA;cAAK8B,SAAU,EAAA,QAAA;cAASmK,MAAO,EAAA,MAAA;cAC7Bjc;YACH,CAAA;WAEJ,CAAA;QAAA;OAEJ;IACF,CAAA,CAAA,EAEC2b,OAAA;EACH,CAAA,CAAA;AAEJ,CAAC,CAAA;AC5NM,SAASO,OAA4BA,CAAA,EAAA;EACpC,MAAA5P,IAAA,GAAOP,iBAAWsM,WAAW,CAAA;EAEnC,IAAI,CAAC/L,IAAM,EAAA;IACH,MAAA,IAAIjC,MAAM,6BAA6B,CAAA;EAC/C;EAEO,OAAAiC,IAAA;AACT;;;;;;ACjBA,IAAAoC,IAAA;AAGO,MAAM4J,MAAO,GAAAtJ,eAAAA,CAAAA,OAAA,CAAOwC,EAAI,CAAAA,IAAA,CAAA,CAAX9C,IAAY,KAAAA,IAAA,GAAAO,YAAA,CAAA,CAAA,6CAAA,CAAA,CAAA,CAAA,CAAA;AAKhCqJ,MAAA,CAAK6D,WAAc,GAAA,mBAAA;ACSZ,MAAMC,WAAc,GAAAvQ,KAAAA,CAAAA,UAAA,CAAW,SAASuQ,YAAAA,CAC7Cxb,OACAkL,GACA,EAAA;EACA,MAAM;IAAC0C,EAAI;IAAAxO,QAAA;IAAUwS;IAAUnK,OAAS;IAAA,GAAG6R;EAAa,CAAA,GAAAtZ,KAAA;EAClD,MAAA;IAAC0Z;GAAS,GAAI4B,OAAQ,EAAA;EAC5B,MAAM;IAAC5B,SAAA,EAAWC;EAAe,CAAA,GAAIlO,aAAc,CAAA,CAAA;EAGjD,sBAAA5L,UAAA,CAAAA,GAAA,CAAC6X,MAAA,EAAA;IACC,aAAY,EAAA,cAAA;IACZ+D,WAAa,EAAA7N,EAAA;IACZ,GAAG0L,SAAA;IACJxI,IAAM,EAAA,CAAA;IACNgK,MAAQ,EAAApB,SAAA;IACR9H,QAAA,EAAU+H,kBAAkB,KAAY,CAAA,GAAA/H,QAAA;IACxCnK,OAAA;IACAyD,GAAA;IACArD,IAAK,EAAA,SAAA;IAEJzI;EAAA,CAAA,CACH;AAEJ,CAAC,CAAA;;;;;;ACxCD,IAAA0O,IAAA,EAAAC,IAAA;AAGO,MAAM2J,MAAO,GAAAtJ,eAAAA,CAAAA,OAAA,CAAOuJ,EAAK,CAAAA,KAAA,CAAA,CAAZ7J,IAAa,KAAAA,IAAA,GAAAO,YAAA,CAAA,CAAA,yOAAA,CAAA,CAAA,CAAA,CAAA;AAe1B,MAAMqN,QAAW,GAAAtN,eAAAA,CAAAA,OAAA,CAAOwC,EAAI,CAAAA,IAAA,CAAA,CAAX7C,IAAY,KAAAA,IAAA,GAAAM,YAAA,CAAA,CAAA,oDAAA,CAAA,CAAA,CAAA,CAAA;ACF7B,MAAMsN,UAAa,GAAA1Q,KAAAA,CAAAA,UAAA,CAAW,SAAS0Q,WAAAA,CAC5C3b,OACAkL,GACA,EAAA;EACM,MAAA;IAAC9L,QAAU;IAAAqI;EAAW,CAAA,GAAAzH,KAAA;EACtB,MAAA;IAAC0Z;GAAS,GAAI4B,OAAQ,EAAA;EAG1B,OAAA,eAAAzb,UAAA,CAAAA,GAAA,CAACmb;IAAoBC,OAAQ,EAAA,YAAA;IAC3B7b,wCAACsY,MAAK,EAAA;MAAA,aAAA,EAAY;MAAcoD,MAAQ,EAAApB,SAAA;MAAWxO;MACjD9L,QAAC,iBAAAS,UAAA,CAAAA,GAAA,CAAA6b,QAAA,EAAA;QAAS7T,MAAK,SACb;QAAAzI,QAAA,EAAAS,eAAAA,UAAAA,CAAAA,GAAA,CAAC2H,EAAAA,CAAAA;UAAIC,OAAmB;UAAArI;QAAS,CAAA;MACnC,CAAA;IACF,CAAA;EACF,CAAA,CAAA;AAEJ,CAAC,CAAA;;;;;;AChCD,IAAA0O,IAAA,EAAAC,IAAA,EAAAC,IAAA,EAAAC,IAAA,EAAAC,IAAA,EAAA0N,IAAA;AAGO,MAAMlE,MAAO,GAAAtJ,eAAAA,CAAAA,OAAA,CAAOuJ,EAAK,CAAAA,KAAA,CAAA,CAAZ7J,IAAa,KAAAA,IAAA,GAAAO,YAAA,CAAA,CAAA,iRAAA,CAAA,CAAA,CAAA,CAAA;AAgB1B,MAAMwN,MAAS,GAAAzN,eAAAA,CAAAA,OAAA,CAAOgB,EAAI,CAAAA,IAAA,CAAA,CAAXrB,IAAY,KAAAA,IAAA,GAAAM,YAAA,CAAA,CAAA,+GAAA,CAAA,CAAA,CAAA,CAAA;AAQ3B,MAAMyN,YAAY1N,eAAAA,CAAAA,OAAO,CAAAwC,EAAAA,CAAAA,IAAI,EAAEmL,MAAA,IAA6B;EAAA,IAA5B;IAACjN;GAA2B,GAAAiN,MAAA;EACjE,MAAM;IAACC,EAAI;IAAAC;MAAMnN,KAAM,CAAAE,MAAA,CAAOjO,MAAMmb,IAAK,CAAAC,OAAA;EAGzC,OAAOC,UAAG,CAAApO,IAAA,KAAAA,IAAA,GAAAK,YAAA,CAAA,CAAA,0BAAA,EACc,4CAGT,EAAA,cAAA,CAAA,CAAA,CAAA,EAHO4N,EAGT,EAAAD,EAAA,CAAA;AAGf,CAAC,CAAA;AAEM,MAAMK,iBAAoB,GAAAjO,eAAAA,CAAAA,OAAA,CAAOkO,EAAY,CAAAA,YAAA,CAAA,CAAnBrO,IAAoB,KAAAA,IAAA,GAAAI,YAAA,CAAA,CAAA,wCAAA,CAAA,CAAA,CAAA,CAAA;AAK9C,MAAMkO,SAAY,GAAAnO,eAAAA,CAAAA,OAAA,CAAO1G,EAAI,CAAAA,IAAA,CAAA,CAAXwG,IAAY,KAAAA,IAAA,GAAAG,YAAA,CAAA,CAAA,0CAAA,CAAA,CAAA,CAAA,CAAA;AAK9B,MAAMmO,UAAUpO,eAAAA,CAAAA,OAAO,CAAA5G,EAAAA,CAAAA,GAAG,EAAEiV,MAAA,IAA6B;EAAA,IAA5B;IAAC3N;GAA2B,GAAA2N,MAAA;EAC9D,MAAM;IAAC1b,KAAA;IAAOoI;GAAK,GAAI2F,KAAM,CAAAE,MAAA;EAE7B,OAAOoN,MAAG,CAAAA,GAAA,CAAAR,IAAA,KAAAA,IAAA,GAAAvN,YAAA,CAAA,CAAA,8bAAA,EAuBW,6SAY6C,EAAA,yCAAA,EAC7C,kDAbRlF,KAAM,CAAA,CAAC,CAYwB,EAAAuT,OAAA,CAAK3b,MAAM4b,IAAK,CAAAV,EAAA,EAAI,CAAC,CAAA,EACpD9S,MAAM,CAAC,CAAA,CAAA;AAItB,CAAC,CAAA;ACpEM,MAAMyT,UAAa,GAAA3R,KAAAA,CAAAA,UAAA,CAAW,SAAS2R,WAAAA,CAC5C5c,OACAkL,GACA,EAAA;EACM,MAAA;IAAC2R;IAASC,UAAY;IAAAC,YAAA;IAAcC;IAASC,UAAY;IAAAC,IAAA;IAAMC,QAAU;IAAAtc;EAAS,CAAA,GAAAb,KAAA;EACxF,MAAM;IAACyZ,QAAU;IAAAC,SAAA;IAAWE;IAAQL,WAAa,EAAA6D;EAAA,IAAe9B,OAAQ,EAAA;EAClE,MAAA+B,QAAA,GAAWC,EAAAA,CAAAA,cAAe,CAAAF,WAAA,IAAe,IAAI,CAAA;EAEnD,MAAMG,WAAc,GAAArX,KAAA,CAAAA,OAAA,CAClB,OAAO;IACLuJ,KAAO,EAAAiK,SAAA,GAAA,CAAY2D,QAAU,IAAA,IAAA,GAAA,KAAA,CAAA,GAAAA,QAAA,CAAAhC,MAAA,KAAU5C,OAAO+E,WAAc,GAAA,KAAA;EAAA,CAC9D,CAAA,EACA,CAAC9D,WAAW2D,QAAQ,CAAA,CACtB;EAEM,MAAAI,gBAAA,GAAmBnQ,KAAAA,CAAAA,YAAY,MAAM;IACrC,IAAAoM,SAAA,EAAW;IACND,QAAA,EAAA;EAAA,CACR,EAAA,CAACA,QAAU,EAAAC,SAAS,CAAC,CAAA;EAElB,MAAAgE,iBAAA,GAAoBpQ,KAAAA,CAAAA,YAAY,MAAM;IAC1C,IAAI,CAACoM,SAAA,EAAW;IACTE,MAAA,EAAA;EAAA,CACN,EAAA,CAACF,SAAW,EAAAE,MAAM,CAAC,CAAA;EAEtB,MAAM+D,oBAAuB,GAAAhX,OAAA,CAAQ,CAAC+S,SAAA,KAAcwD,QAAQD,UAAW,CAAA,CAAA;EAGrE,OAAApd,eAAAA,UAAAA,CAAAA,GAAA,CAAC+d,EAAAA,CAAAA,aAAc,EAAA;IAAA3C,OAAA,EAAS,GACtB;IAAA7b,QAAA,EAAA,eAAAS,cAAA,CAAC6X;MAAK,gBAAgB,EAAAgC,SAAA,GAAY,EAAK,GAAA,KAAA,CAAA;MAAW,aAAY,EAAA,aAAA;MAAcxO;MAC1E9L,QAAC,EAAA,eAAAS,UAAA,CAAAA,GAAA,CAAAmb,MAAA,CAAAA,mBAAA,EAAA;QAAoBC,OAAQ,EAAA,YAAA;QAC3B7b,QAAC,EAAAuB,eAAAA,UAAAA,CAAAA,IAAA,CAAAiQ,EAAA,CAAAA,IAAA,EAAA;UAAK,kBAAgB8I,SAAY,GAAA,EAAA,GAAK,KAAW,CAAA;UAAA7R,IAAA,EAAK,SACrD;UAAAzI,QAAA,EAAA,CAACuB,eAAAA,UAAAA,CAAAA,IAAA,CAAAkb,MAAA,EAAA;YAAO5O,SAASyQ,iBAAmB;YAAAjW,OAAA,EAAS;YAAGoW,MAAO,EAAA,QAAA;YAAS/c,OAAOyc,WACpE;YAAAne,QAAA,EAAA,CAAA0d,UAAA,kCACEtV,EAAI,CAAAA,GAAA,EAAA;cAAAsJ,IAAA,EAAK,MAAO;cAAArJ,OAAA,EAAS;cACvBrI,QACH,EAAA0d;aAAA,CAAA,EAAA,eAGFnc,UAAA,CAAAA,IAAA,CAACmb,SAAA,EAAA;cACCnO,oBAAoB,EAAA,IAAA;cACpBmD,IAAM,EAAA,CAAA;cACN2K,WAAY,EAAA,QAAA;cACZjK,WAAA,EAAaqL,UAAU,CAAI,GAAA,CAAA;cAC3B5P,OAAS,EAAAwQ,gBAAA;cACTK,WAAA,EAAahB,aAAa,CAAI,GAAA,CAAA;cAC9BxL,QAAU,EAAA,CAAA;cACV6L,QAAA;cAEC/d,QAAA,EAAA,CAAA4d,OAAA,IAAA,eAAYnd,UAAA,CAAAA,GAAA,CAAAwc,iBAAA,EAAA;gBAAkB0B,QAAQ,EAAA,IAAA;gBAAClQ,QAAQ;eAAG,CAAA,EAClD,CAACmP,WACCnd,eAAAA,UAAAA,CAAAA,GAAA,CAAA0c,SAAA,EAAA;gBAAU7K,cAAa,UAAW;gBAAAsM,MAAA,EAAO;gBACvC5e,QACH,EAAAyB;eAAA,CAAA;YAAA,CAEJ,CAAA,EAECgc,OACC,IAAA,eAAAhd,UAAA,CAAAA,GAAA,CAACuP,OAAK,EAAA;cAAAmC,KAAA,EAAM,QAAS;cAAAuJ,MAAA,EAAQpB,SAC3B;cAAAta,QAAA,EAAAS,eAAAA,UAAAA,CAAAA,GAAA,CAACmb,MAAAA,CAAAA,mBAAoB,EAAA;gBAAAC,OAAA,EAAQ,YAAc;gBAAA7b,QAAA,EAAAyd;cAAQ,CAAA;aACrD,CAAA;WAEJ,CAAA,EAECc,oBACC,mBAAAhd,UAAA,CAAAA,IAAA,CAACyO,EAAA,CAAAA,IAAA,EAAA;YACCmC,KAAM,EAAA,QAAA;YACNuJ,MAAQ,EAAApB,SAAA;YACR9H,QAAS,EAAA,MAAA;YACTC,aAAe,EAAA,CAAA;YACfC,QAAU,EAAA,CAAA;YACVmM,UAAY,EAAA,CAAA;YAEZ7e,QAAA,EAAA,CAAAS,eAAAA,UAAAA,CAAAA,GAAA,CAAC2c;cAAQ1L,IAAM,EAAA,CAAA;cAAGU,aAAayL,UAAa,GAAA,CAAA,GAAI;cAC7C7d,QACH,EAAA8d;YAAA,CAAA,CAAA,EAECD,UAAc,IAAAA,UAAA;UAAA,CACjB,CAAA,EAGD,CAACvD,aAAaqD,YAAgB,IAAAA,YAAA;QACjC,CAAA;MACF,CAAA;KACF;EACF,CAAA,CAAA;AAEJ,CAAC,CAAA;AClGM,SAASmB,uBAAuBle,KAAoC,EAAA;EACnE,MAAA;IAAC6U,IAAM;IAAApN;EAAW,CAAA,GAAAzH,KAAA;EAEpB,IAAA6U,IAAA,CAAK3I,SAAS,MAAQ,EAAA;IACjB,OAAA,eAAArM,UAAA,CAAAA,GAAA,CAACse,8BAA+B,EAAA;MAAAtJ,IAAA;MAAYpN;IAAkB,CAAA,CAAA;EACvE;EAEI,IAAAoN,IAAA,CAAK3I,SAAS,OAAS,EAAA;IAClB,OAAA,eAAArM,UAAA,CAAAA,GAAA,CAACue,+BAAgC,EAAA;MAAAvJ,IAAA;MAAYpN;IAAkB,CAAA,CAAA;EACxE;EAEQ4W,OAAA,CAAAC,IAAA,CAAK,0DAA0DzJ,IAAI,CAAA;EAEpE,OAAA,IAAA;AACT;AAOO,SAASsJ,+BAA+Bne,KAA4C,EAAA;EAnC3F,IAAA8N,EAAA;EAoCQ,MAAA;IAAC+G,IAAM;IAAApN;EAAW,CAAA,GAAAzH,KAAA;EAExB,IAAI6U,KAAKS,MAAQ,EAAA;IACf,qCAAQiJ,4BAA8B,EAAA;MAAA,GAAGve,KAAO;MAAAsV,MAAA,EAAQT,KAAKS;IAAQ,CAAA,CAAA;EACvE;EAEM,MAAAkJ,sBAAA,GAAyB,OAAO3J,IAAA,CAAKF,QAAa,KAAA,QAAA,IAAA,eACrD9U,UAAA,CAAAA,GAAA,CAAA6H,EAAA,CAAAA,IAAA,EAAA;IAAKC,IAAM,EAAA,CAAA;IAAIvI,QAAK,EAAAyV,IAAA,CAAAF,QAAA,CAAS7Q;EAAO,CAAA,CAAA;EAGvC,sBACGjE,UAAA,CAAAA,GAAA,CAAA6V,MAAA,CAAAA,iBAAA,EAAA;IAAkBnO,OAAS,EAAAiX,sBAAA;IAAwBjP,WAAU,QAC5D;IAAAnQ,QAAA,iBAAAS,UAAA,CAAAA,GAAA,CAACoX,MAAA,CAAAA,YAAA,EAAA;MACCtC,QAAA,EAAUhO,OAAQ,CAAAkO,IAAA,CAAKF,QAAQ,CAAA;MAC/BkB,MAAQ,EAAA,CAAA/H,EAAA,GAAA+G,IAAA,CAAKgB,MAAL,KAAA,IAAA,GAAA,KAAA,CAAA,GAAA/H,EAAA,CAAagI,KAAM,CAAA,GAAA,CAAA;MAC3B1N,MAAMyM,IAAK,CAAAzM,IAAA;MACXqW,KAAA,EAAOD,sBAAyB,GAAA,KAAA,CAAA,GAAY3J,IAAK,CAAAhU,KAAA;MAEjDoM,SAAS4H,IAAK,CAAAqB,QAAA;MACdzO,OAAA;MACAuO,UAAUnB,IAAK,CAAAmB,QAAA;MACfnO,MAAMgN,IAAK,CAAAhN;IAAA,CAEf;EAAA,CAAA,CAAA;AAEJ;AAEA,SAAS0W,6BAA6Bve,KAInC,EAAA;EAnEH,IAAA8N,EAAA;EAoEE,MAAM;IAACwH,MAAA;IAAQT,IAAM;IAAApN;EAAA,CAAW,GAAAzH,KAAA;EAC1B,MAAAwe,sBAAA,GAAyB,OAAO3J,IAAA,CAAKF,QAAa,KAAA,QAAA,IAAA,eACrD9U,UAAA,CAAAA,GAAA,CAAA6H,EAAA,CAAAA,IAAA,EAAA;IAAKC,IAAM,EAAA,CAAA;IAAIvI,QAAK,EAAAyV,IAAA,CAAAF,QAAA,CAAS7Q;EAAO,CAAA,CAAA;EAEjC,MAAAsS,UAAA,GAAaC,uBAAc;IAACf,MAAA,EAAQA,OAAOpJ,IAAM;IAAAlC,MAAA,EAAQsL,MAAO,CAAAtL;EAAA,CAAO,CAAA;EAE7E,MAAMsM,WAAc,GAAAhJ,KAAA,CAAAA,WAAA,CACjBiJ,KAAyC,IAAA;IACxCH,UAAA,CAAWnJ,QAAQsJ,KAAK,CAAA;IACxB1B,IAAA,CAAKqB,QAAS,CAAA,CAAA;EAChB,CAAA,EACA,CAACE,YAAYvB,IAAI,CAAA,CACnB;EAEA,sBACGhV,UAAA,CAAAA,GAAA,CAAA6V,MAAA,CAAAA,iBAAA,EAAA;IAAkBnO,OAAS,EAAAiX,sBAAA;IAAwBjP,WAAU,QAC5D;IAAAnQ,QAAA,iBAAAS,UAAA,CAAAA,GAAA,CAACoX,MAAA,CAAAA,YAAA,EAAA;MACCrJ,EAAG,EAAA,GAAA;MACH+G,QAAA,EAAUhO,OAAQ,CAAAkO,IAAA,CAAKF,QAAQ,CAAA;MAC/BkB,MAAQ,EAAA,CAAA/H,EAAA,GAAA+G,IAAA,CAAKgB,MAAL,KAAA,IAAA,GAAA,KAAA,CAAA,GAAA/H,EAAA,CAAagI,KAAM,CAAA,GAAA,CAAA;MAC3BU,MAAMJ,UAAW,CAAAI,IAAA;MACjBpO,MAAMyM,IAAK,CAAAzM,IAAA;MACXqW,KAAA,EAAOD,sBAAyB,GAAA,KAAA,CAAA,GAAY3J,IAAK,CAAAhU,KAAA;MACjDoM,OAAS,EAAAqJ,WAAA;MACT7O,OAAA;MACAuO,UAAUnB,IAAK,CAAAmB,QAAA;MACfnO,MAAMgN,IAAK,CAAAhN;IAAA,CAEf;EAAA,CAAA,CAAA;AAEJ;AAOA,SAASuW,gCAAgCpe,KAA6C,EAAA;EAzGtF,IAAA8N,EAAA;EA0GQ,MAAA;IAAC+G,IAAM;IAAApN;EAAW,CAAA,GAAAzH,KAAA;EAGtB,sBAAAH,UAAA,CAAAA,GAAA,CAACkX,EAAA,CAAAA,UAAA,EAAA;IACCC,MACE,iBAAAnX,UAAA,CAAAA,GAAA,CAACoX,MAAA,CAAAA,YAAA,EAAA;MACCtC,UAAUE,IAAK,CAAAF,QAAA;MACfvM,IAAA,EAAA,CAAM0F,EAAK,GAAA+G,IAAA,CAAAzM,IAAA,KAAL,IAAa,GAAA0F,EAAA,GAAAsC,KAAA,CAAAA,WAAA;MACnBqO,OAAO5J,IAAK,CAAAhU,KAAA;MACZ4G;IAAA,CACF,CAAA;IAEFxD,IAAIoP,KAAAA,CAAAA,KAAM,CAAA,CAAA;IACV8D,IAAA,gCACGC,EACE,CAAAA,IAAA,EAAA;MAAAhY,QAAA,EAAAyV,IAAA,CAAKzV,SAASyC,GAAI,CAAA,CAACmT,OAAO0J,GAAQ,KAAA;QAzH7C5Q,IAAAA,GAAAA;QA2Hc,sBAAAjO,UAAA,CAAAA,GAAA,CAAC6U,kBAAA,EAAA;UACCC,QAAA,EAAUhO,OAAQ,CAAAkO,IAAA,CAAKF,QAAQ,CAAA;UAC/BC,YAAA,EAAA,CAAA,CAAc9G,MAAA+G,IAAK,CAAAzV,QAAA,CAASsf,MAAM,CAAC,CAAA,KAArB,IAAA5Q,GAAAA,KAAAA,CAAAA,GAAAA,GAAAA,CAAwB5B,IAAS,MAAA,OAAA;UAE/C2I,IAAM,EAAAG;QAAA,CAAA,EADDA,KAAM,CAAAE,GAAA,CAEb;MAEH,CAAA;KACH;EAAA,CAAA,CAEJ;AAEJ;;;;;;ACvIA,IAAApH,IAAA;AAGO,MAAM4J,MAAO,GAAAtJ,eAAAA,CAAAA,OAAA,CAAOwC,EAAAA,CAAAA,IAAI,CAAA,CAAX9C,IAAY,KAAAA,IAAA,GAAAO,YAAA,CAAA,CAAA,+XAAA,CAAA,CAAA,CAAA,CAAA;ACGzB,SAASsQ,iBAAiB9J,IAA6D,EAAA;EAC5F,OAAA,CAAQA,KAAK3I,IAAS,KAAA,MAAA,IAAU2I,IAAK,CAAA3I,IAAA,KAAS,YAAY2I,IAAK,CAAA+J,cAAA;AACjE;AAEa,MAAAC,mBAAA,GAAsBC,wBAAOH,gBAAgB,CAAA;AAEnD,SAASI,iBAAiB/U,MAKb,EAAA;EAjBpB,IAAA8D,EAAA,EAAAC,EAAA;EAkBE,MAAM;IAACiR,YAAe,GAAA,EAAI;IAAAC,SAAA;IAAWC;GAAkB,GAAAlV,MAAA;EAEvD,MAAM2M,QAAyB,EAAC;EAEhC,IAAIwI,SAAY,GAAA,CAAA;EAEhB,KAAA,IAASC,IAAI,CAAG,EAAAA,CAAA,GAAIJ,YAAa,CAAAjb,MAAA,EAAQqb,KAAK,CAAG,EAAA;IACzC,MAAAC,CAAA,GAAIL,aAAaI,CAAC,CAAA;IAElBzI,KAAA,CAAAnE,IAAA,CAAK8M,6BAA6BD,CAAG,EAAA,EAAA,CAAGnc,UAAC,GAAI,CAAA,CAAAA,MAAA,CAAAmc,CAAA,CAAEnT,KAAM,CAAC,CAAA;EAC9D;EAEAiT,SAAA,IAAaxI,KAAM,CAAA5S,MAAA;EAEnB,MAAMwb,SAA2B,EAAC;EAElC,KAAA,MAAWC,aAAaN,cAAgB,EAAA;IAChC,MAAAO,KAAA,GAAQF,OAAOxF,IAAK,CAAC2F,KAAMA,CAAE,CAAAxK,GAAA,KAAQsK,UAAUvb,EAAE,CAAA;IAEvD,IAAI,CAACwb,KAAO,EAAA;MACVF,MAAA,CAAO/M,IAAK,CAAA;QACVtG,IAAM,EAAA,OAAA;QACNgJ,KAAKsK,SAAU,CAAAvb,EAAA;QAEf7E,UAAU,EAAC;QACX2V,QAAU,EAAA,IAAA;QACV6J,cAAgB,EAAA,KAAA;QAChB/d,OAAO2e,SAAU,CAAA3e;MAAA,CAClB,CAAA;IACH;EACF;EAEA,MAAM8e,iBAAkC,EAAC;EAEzC,KAAA,IAASP,IAAI,CAAG,EAAAA,CAAA,GAAIH,SAAU,CAAAlb,MAAA,EAAQqb,KAAK,CAAG,EAAA;IACtC,MAAAjP,IAAA,GAAO8O,UAAUG,CAAC,CAAA;IAEpB,IAAAK,KAAA,GAAQtP,IAAK,CAAAsP,KAAA,IAASF,MAAO,CAAAxF,IAAA,CAAM2F,CAAM,IAAAA,CAAA,CAAExK,GAAQ,KAAA/E,IAAA,CAAKsP,KAAK,CAAA;IAE7D,IAAAtP,IAAA,CAAKsP,KAAS,IAAA,CAACA,KAAO,EAAA;MAChBA,KAAA,GAAA;QACNvT,IAAM,EAAA,OAAA;QACNgJ,KAAK/E,IAAK,CAAAsP,KAAA;QAEV1K,QAAU,EAAA,IAAA;QACV3M,MAAM+H,IAAK,CAAA/H,IAAA;QACXvH,OAAOsP,IAAK,CAAAsP,KAAA;QACZrgB,UAAU,EAAC;QACXwf,cAAgB,EAAA;MAAA,CAClB;MACAW,MAAA,CAAO/M,KAAKiN,KAAK,CAAA;IACnB;IAEA,IAAIA,KAAO,EAAA;MACTA,KAAA,CAAMrgB,SAASoT,IAAK,CAAA;QAClBtG,IAAM,EAAA,MAAA;QACNgJ,GAAA,EAAK,EAAG,CAAAhS,MAAA,CAAAic,SAAA,GAAYC,CAAC,EAAA,OAAA,CAAA;QAErBvJ,QAAQ1F,IAAK,CAAAyP,QAAA;QACbxX,MAAM+H,IAAK,CAAA/H,IAAA;QACX8N,QAAU,EAAAA,CAAA,KAAMlM,MAAO,CAAA6V,aAAA,CAAc1P,IAAI,CAAA;QACzCyO,cAAA,EAAA,CAAgB9Q,EAAK,GAAAqC,IAAA,CAAA2P,YAAA,KAAL,IAAqB,GAAAhS,EAAA,GAAA,KAAA;QACrCkI,UAAU7F,IAAK,CAAA6F,QAAA;QACfnV,OAAOsP,IAAK,CAAAtP,KAAA;QACZgH,MAAMsI,IAAK,CAAAtI;MAAA,CACZ,CAAA;IAAA,CACI,MAAA;MACL8X,cAAA,CAAenN,IAAK,CAAA;QAClBtG,IAAM,EAAA,MAAA;QACNgJ,GAAA,EAAK,EAAG,CAAAhS,MAAA,CAAAic,SAAA,GAAYC,CAAC,EAAA,OAAA,CAAA;QAErBvJ,QAAQ1F,IAAK,CAAAyP,QAAA;QACbxX,MAAM+H,IAAK,CAAA/H,IAAA;QACX8N,QAAU,EAAAA,CAAA,KAAMlM,MAAO,CAAA6V,aAAA,CAAc1P,IAAI,CAAA;QACzCyO,cAAA,EAAA,CAAgB7Q,EAAK,GAAAoC,IAAA,CAAA2P,YAAA,KAAL,IAAqB,GAAA/R,EAAA,GAAA,KAAA;QACrCiI,UAAU7F,IAAK,CAAA6F,QAAA;QACfnV,OAAOsP,IAAK,CAAAtP,KAAA;QACZgH,MAAMsI,IAAK,CAAAtI;MAAA,CACZ,CAAA;IACH;EACF;EAEA,OAAO,CAAC,GAAG8X,cAAA,EAAgB,GAAGJ,MAAA,EAAQ,GAAG5I,KAAK,CAAA;AAChD;AAEA,SAAS2I,4BAAAA,CAA6BD,GAAgCnK,GAA4B,EAAA;EAvGlG,IAAApH,EAAA,EAAAC,EAAA,EAAAC,EAAA;EAwGM,IAAAqR,CAAA,CAAEnT,SAAS,SAAW,EAAA;IACjB,OAAA;MACLA,IAAM,EAAA,SAAA;MACNgJ;IAAA,CACF;EACF;EAEI,IAAAmK,CAAA,CAAEnT,SAAS,OAAS,EAAA;IACf,OAAA;MACLA,IAAM,EAAA,OAAA;MACNgJ,GAAA;MAEA9V,QAAA,EAAUigB,EAAEjgB,QAAS,CAAAyC,GAAA,CAAI,CAACmT,KAAO,EAAA+K,QAAA,KAC/BT,4BAA6B,CAAAtK,KAAA,EAAO,EAAG,CAAA9R,MAAA,CAAAgS,GAAA,EAAG,GAAI,CAAA,CAAAhS,MAAA,CAAA6c,QAAA,EAAQ,GAAI,CAAA,CAAA7c,MAAA,CAAA8R,KAAA,CAAM9I,IAAM,CAAA,CACxE,CAAA;MACAyI,UAAU0K,CAAE,CAAA1K,QAAA;MACZI,QAAA,EAAA,CAAUjH,EAAE,GAAAuR,CAAA,CAAAtK,QAAA,KAAF,IAAc,GAAAjH,EAAA,GAAA,IAAA;MACxB1F,MAAMiX,CAAE,CAAAjX,IAAA;MACRvH,OAAOwe,CAAE,CAAAxe,KAAA;MACT+d,cAAA,EAAA,CAAgB7Q,EAAE,GAAAsR,CAAA,CAAAT,cAAA,KAAF,IAAoB,GAAA7Q,EAAA,GAAA;IAAA,CACtC;EACF;EAEO,OAAA;IACL7B,IAAM,EAAA,MAAA;IACNgJ,GAAA;IACAI,QAAQ+J,CAAE,CAAA/J,MAAA;IACVX,UAAU0K,CAAE,CAAA1K,QAAA;IACZvM,MAAMiX,CAAE,CAAAjX,IAAA;IACR2N,WAAWsJ,CAAE,CAAAtJ,SAAA;IACbG,UAAUmJ,CAAE,CAAAnJ,QAAA;IACZ0I,cAAA,EAAA,CAAgB5Q,EAAE,GAAAqR,CAAA,CAAAT,cAAA,KAAF,IAAoB,GAAA5Q,EAAA,GAAA,KAAA;IACpCgI,UAAUqJ,CAAE,CAAArJ,QAAA;IACZnV,OAAOwe,CAAE,CAAAxe,KAAA;IACTgH,MAAMwX,CAAE,CAAAxX;EAAA,CACV;AACF;ACrIO,MAAMmY,YAAe,GAAA/U,KAAAA,CAAAA,UAAA,CAAW,SAAS+U,aAAAA,CAC9ChgB,OACAkL,GACA,EAAA;EACA,MAAM;IAACoK,MAAA;IAAQ,GAAGgE;EAAA,CAAa,GAAAtZ,KAAA;EAE/B,MAAMqN,IAAO,GAAAnH,KAAA,CAAAA,OAAA,CACX;EAAA;EAEE+E,KAAAA,CAAAA,UAAW,CAAA,SAASoC,KAClB4S,CAAAzS,SAAA,EACA0S,OACA,EAAA;IAEE,OAAA,eAAArgB,UAAA,CAAAA,GAAA,CAACsgB,QAAY,CAAAA,UAAA,EAAA;MAAA,GAAG3S,SAAW;MAAA8H,MAAA,EAAQA,MAAO,CAAApJ,IAAA;MAAMlC,MAAQ,EAAAsL,MAAA,CAAOtL,MAAQ;MAAAkB,GAAA,EAAKgV;IAAS,CAAA,CAAA;EAAA,CAExF,CAAA,EACH,CAAC5K,MAAM,CAAA,CACT;EAEA,OAAOtV,KAAM,CAAA2U,QAAA,GAAA,eACV9U,UAAA,CAAAA,GAAA,CAAA4S,EAAA,CAAAA,MAAA,EAAA;IAAQ,GAAGzS,KAAA;IAAO4N,EAAG,EAAA,GAAA;IAAIwS,IAAK,EAAA,MAAA;IAAO,eAAc,EAAA;EAAA,CAAO,CAE3D,GAAA,eAAAvgB,UAAA,CAAAA,GAAA,CAAC4S,EAAA,CAAAA,MAAA,EAAA;IACE,GAAG6G,SAAA;IACJ1L,EAAI,EAAAP,IAAA;IACJ,SAAQ,EAAA,GAAA;IACRnC;EAAA,CAAA,CACF;AAEJ,CAAC,CAAA;AC3BM,SAASmV,qCAAsCA,CAAAC,MAAA,EAIP;EAAA,IAJO;IACpDC,MAAA;IACAvD,OAAA;IACA5d;EACF,CAA+C,GAAAkhB,MAAA;EAC7C,MAAME,cAAcC,MAAAA,CAAAA,cAAe,EAAA;EAEnC,IAAI,CAACF,MAAQ,EAAA;IACX,OAAA;MAAUnhB;IAAS,CAAA,CAAA;EACrB;EAGE,sBAAAS,UAAA,CAAAA,GAAA,CAACwH,EAAA,CAAAA,OAAA,EAAA;IACCE,OACE,EAAAyV,OAAA,GAAA,eACGnd,cAAA,CAAA2H,EAAAA,CAAAA,GAAA,EAAA;MAAIC,OAAS,EAAA,CAAA;MACZrI,QAAC,iBAAAS,UAAA,CAAAA,GAAA,CAAA6H,EAAA,CAAAA,IAAA,EAAA;QAAKtI,QAAQ,EAAA;MAAA,CAAA;IAChB,CAAA,CAEA,GAAAS,eAAAA,UAAAA,CAAAA,GAAA,CAAC6gB;MAA+BF;KAA0B,CAAA;IAG9DlZ,MAAM,EAAA,IAAA;IAINlI,QAAA,iBAAAS,UAAA,CAAAA,GAAA,CAAC;MAAKT;IAAS,CAAA;EAAA,CAAA,CACjB;AAEJ;ACrBA,MAAMuhB,aAA8B,GAAA;EAClClM,aAAe,EAAA,IAAA;EACflF,SAAW,EAAA,QAAA;EACXjI,MAAQ,EAAA;AACV,CAAA;AAEA,MAAMsZ,SAAY,GAAAA,CAChBzgB,MACA,EAAA0gB,SAAA,EACA1Q,IACiC,KAAA;EA5BnC,IAAArC,EAAA;EA6BQ,MAAAgT,QAAA,GAAA,CAAWhT,EAAU,GAAA+S,SAAA,CAAA9G,IAAA,CAAMgH,CAAA,IAAMA,EAAE9c,EAAO,KAAAkM,IAAA,CAAK6Q,UAAU,CAAA,KAA9C,IAAiD,GAAA,KAAA,CAAA,GAAAlT,EAAA,CAAAzN,UAAA;EAClE,IAAI,CAACygB,QAAA,EAAiB,OAAA,IAAA;EAEtB,MAAMG,UAAa,GAAA;IACjBhV,UAAUkE,IAAK,CAAA6Q,UAAA;IACf9U,IAAM,EAAA4U,QAAA;IACN7c,IAAIkM,IAAK,CAAA+Q;EAAA,CACX;EAEO,OAAA;IACLhV,IAAM,EAAA,QAAA;IACNlC,QAAQmG,IAAK,CAAAgR,UAAA,GAAa,CAACF,UAAY,EAAA9Q,IAAA,CAAKgR,UAAU,CAAI,GAAAF;EAAA,CAC5D;AACF,CAAA;AAMgB,SAAAG,sBAAAA,CAAAC,MAAA,EAAqE;EAAA,IAA9C;IAACC;GAA6C,GAAAD,MAAA;EACnF,MAAMlhB,SAASC,MAAAA,CAAAA,SAAU,EAAA;EACzB,MAAMygB,YAAYU,MAAAA,CAAAA,YAAa,EAAA;EAE/B,MAAM,CAACC,mBAAA,EAAqBC,4BAA4B,CAAA,GAAIC,6BAAuB,CAAA;IACjFJ;EAAA,CACD,CAAA;EAEK,MAAAK,cAAA,GAAiBzb,KAAAA,CAAAA,QAAQ,MAAM;IACnC,OACE,CAACub,4BACD,KAAAD,mBAAA,IAAA,IAAA,GAAA,KAAA,CAAA,GAAAA,mBAAA,CAAqBI,MAAOC,UAAA,IAAe,CAACA,UAAW,CAAAC,OAAA,CAAA,CAAA;EAAA,CAExD,EAAA,CAACL,4BAA8B,EAAAD,mBAAmB,CAAC,CAAA;EAEhD,MAAAO,eAAA,GAAkB7b,KAAAA,CAAAA,QAAQ,MAAM;IACpC,IAAI,CAACsb,mBAAA,EAAqB,OAAO,EAAC;IAClC,OAAOA,mBAAoB,CAAAQ,MAAA,CACzB,CAACC,KAAKJ,UAAe,KAAA;MACfI,GAAA,CAAAJ,UAAA,CAAW5d,EAAE,CAAI,GAAA4d,UAAA;MACd,OAAAI,GAAA;IACT,CAAA,EACA,CAAC,CAAA,CACH;EAAA,CACF,EAAG,CAACT,mBAAmB,CAAC,CAAA;EAExB,IAAIG,cAAgB,EAAA;IAClB,sBACG9hB,UAAA,CAAAA,GAAA,CAAAwgB,qCAAA,EAAA;MAAsCE,MAAM,EAAA,IAAA;MAACvD,SAASyE,4BACrD;MAAAriB,QAAA,iBAAAS,UAAA,CAAAA,GAAA,CAAC4S,EAAA,CAAAA,MAAA,EAAA;QACC,YAAW,EAAA,0BAAA;QACXrK,IAAM,EAAA8Z,KAAA,CAAAA,WAAA;QACNxP,IAAK,EAAA,OAAA;QACLiC,QAAQ,EAAA,IAAA;QACR,aAAY,EAAA;MAAA,CAEhB;IAAA,CAAA,CAAA;EAEJ;EAEI,IAAA2M,aAAA,CAAcvd,WAAW,CAAG,EAAA;IACxB,MAAAoe,SAAA,GAAYb,cAAc,CAAC,CAAA;IAC3B,MAAAc,WAAA,GAAcL,eAAgB,CAAAI,SAAA,CAAUle,EAAE,CAAA;IAC1C,MAAA0Q,QAAA,GAAW,EAACyN,WAAa,IAAA,IAAA,GAAA,KAAA,CAAA,GAAAA,WAAA,CAAAN,OAAA,CAAA;IAC/B,MAAMxM,MAAS,GAAAsL,SAAA,CAAUzgB,MAAQ,EAAA0gB,SAAA,EAAWsB,SAAS,CAAA;IACrD,IAAI,CAAC7M,MAAA,EAAe,OAAA,IAAA;IAGlB,sBAAAzV,UAAA,CAAAA,GAAA,CAACwgB,qCAAA,EAAA;MACCE,MAAQ,EAAA5L,QAAA;MACRqI,OAAS,EAAAyE,4BAAA;MAETriB,QAAA,iBAAAS,UAAA,CAAAA,GAAA,CAACmgB,YAAA,EAAA;QACC,cAAYmC,SAAU,CAAAthB,KAAA;QACtBuH,IAAA,EAAM+Z,UAAU/Z,IAAQ,IAAA8Z,KAAA,CAAAA,WAAA;QACxB5M,MAAA;QACA5C,IAAK,EAAA,OAAA;QACLiC,QAAA;QACA,aAAY,EAAA;MAAA,CACd;IAAA,CAAA,CACF;EAEJ;EAGE,sBAAA9U,UAAA,CAAAA,GAAA,CAACkX,EAAA,CAAAA,UAAA,EAAA;IACCC,MAAA,gCAASvE,EAAO,CAAAA,MAAA,EAAA;MAAArK,IAAA,EAAM8Z;MAAaxP,IAAK,EAAA,OAAA;MAAQ,eAAY;KAA6B,CAAA;IACzFzO,EAAG,EAAA,aAAA;IACHkT,IAAA,iCACGC,OACC,EAAA;MAAAhY,QAAA,EAAA,CAAA,eAAAS,UAAA,CAAAA,GAAA,CAAC2H,EAAI,CAAAA,GAAA,EAAA;QAAAsK,QAAA,EAAU,CAAG;QAAAmM,UAAA,EAAY,CAAG;QAAApM,aAAA,EAAe,CAC9C;QAAAzS,QAAA,EAAA,eAAAS,UAAA,CAAAA,GAAA,CAACkS,EAAM,CAAAA,KAAA,EAAA;UAAAhK,KAAA,EAAK,IAAC;UAAA3I,QAAA,EAAA;QAAM,CAAA;OACrB,CAAA,EAECkiB,aAAc,CAAAzf,GAAA,CAAI,CAACsO,IAAA,EAAMkS,SAAc,KAAA;QAChC,MAAAD,WAAA,GAAcL,eAAgB,CAAA5R,IAAA,CAAKlM,EAAE,CAAA;QACrC,MAAA0Q,QAAA,GAAW,EAACyN,WAAa,IAAA,IAAA,GAAA,KAAA,CAAA,GAAAA,WAAA,CAAAN,OAAA,CAAA;QAC/B,MAAMxM,MAAS,GAAAsL,SAAA,CAAUzgB,MAAQ,EAAA0gB,SAAA,EAAW1Q,IAAI,CAAA;QAC1C,MAAAlE,QAAA,GAAW4U,UAAU9G,IAAK,CAACgH,KAAMA,CAAE,CAAA9c,EAAA,KAAOkM,KAAK6Q,UAAU,CAAA;QAC3D,IAAA,CAAC/U,YAAY,CAACqJ,MAAA,EAAe,OAAA,IAAA;QAEjC,MAAMjI,IAAO,GAAApC,KAAA,CAAAA,UAAA,CAAW,CAACuC,SAAA,EAAW0S,OAClC,KAAAvL,QAAA,iCACG,QAAO,EAAA;UAAAzI,IAAA,EAAK,QAAS;UAAAyI,QAAA,EAAQ,IAAE;UAAA,GAAGnH,SAAW;UAAAtC,GAAA,EAAKgV;QAAS,CAAA,CAE5D,kBAAArgB,UAAA,CAAAA,GAAA,CAACsgB,QAAA,CAAAA,UAAA,EAAA;UACE,GAAG3S,SAAA;UACJ8H,QAAQA,MAAO,CAAApJ,IAAA;UACflC,QAAQsL,MAAO,CAAAtL,MAAA;UACfkB,GAAK,EAAAgV;QAAA,CACP,CAAA,CAEJ;QAEA7S,IAAA,CAAKkO,WAAc,GAAA,MAAA;QAGjB,sBAAA1b,UAAA,CAAAA,GAAA,CAACwgB,qCAAA,EAAA;UAECE,MAAQ,EAAA5L,QAAA;UACRqI,OAAS,EAAAyE,4BAAA;UAETriB,QAAA,iBAAAS,UAAA,CAAAA,GAAA,CAAC8V,EAAA,CAAAA,QAAA,EAAA;YACC/H,EAAI,EAAAP,IAAA;YACJ,SAAA,EAASsH,WAAW,QAAW,GAAA,GAAA;YAC/BrC,IAAA,EAAMnC,IAAK,CAAAtP,KAAA,IAASoL,QAAS,CAAApL,KAAA;YAC7B,YAAY,EAAA8T,QAAA,GAAW,0BAA6B,GAAAxE,IAAA,CAAKtP,SAASoL,QAAS,CAAApL,KAAA;YAC3E8T,QAAA;YACA,eAAa,uBAAwB,CAAAzR,MAAA,CAAAmf,SAAA;UAAA,CACvC;QAAA,CAAA,EAXKlS,IAAK,CAAAlM,EAAA,CAYZ;MAAA,CAEH,CAAA;KACH,CAAA;IAEFmR,OAAS,EAAAuL;EAAA,CAAA,CACX;AAEJ;AC5JA,SAAS2B,cAAiB7hB,KAAmC,EAAA;EACpD,OAAAA,KAAA,KAAU,QAAQA,KAAU,KAAA,KAAA,CAAA;AACrC;AAKA,MAAM8hB,UAAA,GAAc9hB,KAAmB,IAAA;EAC/B,MAAA+hB,UAAA,GAAcC,CAAwB,IAAA;IACtC,IAAA,OAAOA,CAAM,KAAA,QAAA,IAAY,CAACA,CAAA,EAAU,OAAAA,CAAA;IACpC,IAAAnc,KAAA,CAAMoc,QAAQD,CAAC,CAAA,EAAU,OAAAA,CAAA,CAAE5gB,IAAI2gB,UAAU,CAAA;IAC7C,OAAOG,OAAOC,OAAQ,CAAAH,CAAC,CAAE,CAAA7b,IAAA,CAAK,CAAAic,MAAA,EAAAC,MAAA;MAAA,IAAC,CAACC,IAAI,CAAG,GAAAF,MAAA;MAAA,IAAA,CAACG,IAAI,CAAM,GAAAF,MAAA;MAAA,OAAAC,IAAA,CAAKE,aAAc,CAAAD,IAAA,EAAM,IAAI,CAAC;IAAA,EAAA;EAAA,CAClF;EAEM,MAAAE,SAAA,GAAaT,CAAe,IAAAU,IAAA,CAAKC,MAAMD,IAAK,CAAAE,SAAA,CAAUZ,CAAC,CAAC,CAAA;EAE9D,OAAOU,KAAKE,SAAU,CAAAb,UAAA,CAAWU,SAAU,CAAAziB,KAAK,CAAC,CAAC,CAAA;AACpD,CAAA;AASO,MAAM6iB,iBAAoB,GAAAC,KAAA,CAAAA,IAAA,CAAK,SAASD,kBAAAA,CAAkBtjB,KAA+B,EAAA;EACxF,MAAA;IACJwjB,2BAA2BC,sCAAyC,GAAA1W,MAAA,CAAAA,WAAA;IACpEkS,SAAY,GAAAlS,MAAA,CAAAA,WAAA;IACZmS,cAAiB,GAAAnS,MAAA,CAAAA,WAAA;IACjB2W,cAAiB,GAAAC,MAAA,CAAAA;EACf,CAAA,GAAA3jB,KAAA;EAEJ,MAAM6gB,YAAYU,MAAAA,CAAAA,YAAa,EAAA;EAE/B,MAAMqC,YAAe,GAAAtW,KAAA,CAAAA,WAAA,CAClB6C,IAAuB,IAAA;IACtB,IAAI,OAAOA,IAAK,CAAAL,MAAA,KAAW,YAAY,EAAEK,IAAA,CAAKL,UAAU4T,cAAiB,CAAA,EAAA;MAC/DrF,OAAA,CAAAC,IAAA,CAAK,wBAA0B,EAAAnO,IAAA,CAAKL,MAAM,CAAA;MAC3C,OAAA,KAAA;IACT;IAEM,MAAA+T,OAAA;IAAA;IAEJ,OAAO1T,IAAA,CAAKL,MAAW,KAAA,UAAA,GACnBK,IAAK,CAAAL,MAAA,GACL,OAAOK,IAAA,CAAKL,MAAW,KAAA,QAAA,GACvB4T,cAAe,CAAAvT,IAAA,CAAKL,MAAM,CAC1B,GAAA,IAAA;IAEN,IAAI+T,OAAS,EAAA;MACXA,OAAA,CAAQ1T,KAAKnG,MAAgC,CAAA;MACtC,OAAA,IAAA;IACT;IAEO,OAAA,KAAA;EACT,CAAA,EACA,CAAC0Z,cAAc,CAAA,CACjB;EAEA,MAAMI,SAAY,GAAA5d,KAAA,CAAAA,OAAA,CAChB,MACE6Y,gBAAiB,CAAA;IACfc,aAAe,EAAA+D,YAAA;IACf1E,cAAA;IACAD,SAAW,EAAAA,SAAA,CAGRrb,MAAO,CAACuM,IAAM,IAAA;MA/EzB,IAAArC,EAAA;MA+EiC,OAAA,CAAA,CAAAA,EAAA,GAAAqC,IAAA,CAAAmF,MAAA,KAAL,mBAAapJ,IAAS,MAAA,QAAA;IAAA,CAAQ;EAAA,CACnD,CAAA,EACH,CAAC0X,YAAc,EAAA1E,cAAA,EAAgBD,SAAS,CAAA,CAC1C;EAEM,MAAA8E,WAAA,GAAc7d,cAAQ,MAAM4d,SAAA,CAAUlgB,OAAO+a,gBAAgB,CAAA,EAAG,CAACmF,SAAS,CAAC,CAAA;EAC3E,MAAAE,gBAAA,GAAmB9d,cAAQ,MAAM4d,SAAA,CAAUlgB,OAAOib,mBAAmB,CAAA,EAAG,CAACiF,SAAS,CAAC,CAAA;EAEnF,MAAAG,qCAAA,GAAwC/d,KAAAA,CAAAA,QAAQ,MAAM;IAC1D,OAAO+Y,SACJ,CAAApd,GAAA,CAAI,CAACsO,IAAA,EAAM+T,aAAkB,KAAA;MAzFpC,IAAApW,EAAA;MA0FY,IAAA,CAAA,CAAAA,EAAA,GAAAqC,IAAA,CAAKmF,MAAL,KAAA,IAAA,GAAA,KAAA,CAAA,GAAAxH,EAAA,CAAa5B,IAAS,MAAA,QAAA,EAAiB,OAAA,IAAA;MAErC,MAAA;QAAClC;MAAM,CAAA,GAAImG,IAAK,CAAAmF,MAAA;MACtB,IAAI,CAACtL,MAAA,EAAe,OAAA,IAAA;MAEpB,MAAMma,eAAe7d,KAAM,CAAAoc,OAAA,CAAQ1Y,MAAM,CAAI,GAAAA,MAAA,CAAO,CAAC,CAAI,GAAAA,MAAA;MACzD,MAAMoa,iBAAiB9d,KAAM,CAAAoc,OAAA,CAAQ1Y,MAAM,CAAI,GAAAA,MAAA,CAAO,CAAC,CAAI,GAAA,KAAA,CAAA;MAKrD,MAAAgX,UAAA,GAAamD,YAAa,CAAAlY,QAAA,IAAYkY,YAAa,CAAAjY,IAAA;MACzD,IAAI,CAAC8U,UAAA,EAAmB,OAAA,IAAA;MAGxB,MAAM/U,WAAW4U,SAAU,CAAA9G,IAAA,CAAMgH,CAAM,IAAAA,CAAA,CAAE9c,OAAO+c,UAAU,CAAA;MAE1D,IAAI,CAAC/U,QAAA,EAAiB,OAAA,IAAA;MAEtB,MAAMiV,oBAAoBiD,YAAa,CAAAlgB,EAAA;MAEhC,OAAA;QACLkM,IAAA;QACAlE,QAAA;QACAmY,cAAA;QACAF,aAAA;QACAhD;MAAA,CACF;IACD,CAAA,CAAA,CACAtd,MAAO,CAAA0e,aAAa,CACpB,CAAAzgB,GAAA,CAAIwiB,MAAA,IAAwE;MAAA,IAAvE;QAACnD,iBAAmB;QAAA/Q,IAAA;QAAMlE,QAAU;QAAAiY,aAAA;QAAeE;OAAoB,GAAAC,MAAA;MAC3E,MAAMC,wBAAqD,GAAA;QACzDrgB,IAAI,UAAW,CAAAf,MAAA,CAAAghB,aAAA,CAAA;QACfhD,iBAAA;QACAF,YAAY/U,QAAS,CAAAhI,EAAA;QACrBiI,IAAM,EAAA,0BAAA;QACNrL,KAAA,EAAOsP,IAAK,CAAAtP,KAAA,IAASoL,QAAS,CAAApL,KAAA;QAC9BuH,MAAM+H,IAAK,CAAA/H,IAAA;QACXmc,aAAatY,QAAS,CAAAsY,WAAA;QACtBpD,UAAY,EAAAiD,cAAA;QACZ/jB,YAAY4L,QAAS,CAAA5L;MAAA,CACvB;MAEO,OAAAikB,wBAAA;IAAA,CACR,CAAA;EAAA,CACF,EAAA,CAACrF,SAAW,EAAA4B,SAAS,CAAC,CAAA;EAEnB,MAAA2D,6BAAA,GAAgCte,KAAAA,CAAAA,QAAQ,MAAM;IAE3C,OAAAue,eAAA,CAAAlW,OAAA,CACL,CAAC,GAAG0V,qCAAuC,EAAA,GAAGR,sCAAsC,CAAA,EACnFtT,IAAS,IAAAoS,UAAA,CAAW,CAACpS,IAAA,CAAK+Q,mBAAmB/Q,IAAK,CAAA6Q,UAAA,EAAY7Q,IAAK,CAAAgR,UAAU,CAAC,CAAA,CACjF;EAAA,CACC,EAAA,CAAC8C,qCAAuC,EAAAR,sCAAsC,CAAC,CAAA;EAGhF,OAAA,eAAA9iB,UAAA,CAAAA,IAAA,CAACyO,EAAK,CAAAA,IAAA,EAAA;IAAA+C,GAAA,EAAK,CACR;IAAA/S,QAAA,EAAA,CAAAolB,6BAAA,CAA8BzgB,MAAS,GAAA,CAAA,IACrClE,eAAAA,UAAAA,CAAAA,GAAA,CAAAuhB,sBAAA,EAAA;MAAuBE,eAAekD;KAA+B,CAAA,EAGvET,WAAA,CAAYliB,IAAKgT,IAAA,kCACfqJ,sBAAsC,EAAA;MAAArJ;IAAA,CAAA,EAAVA,IAAK,CAAAK,GAAiB,CACpD,CAAA,EAEA8O,iBAAiBjgB,MAAS,GAAA,CAAA,IAAMlE,eAAAA,UAAAA,CAAAA,GAAA,CAAA+W,qBAAA,EAAA;MAAsBD,OAAOqN;KAAkB,CAAA;EAClF,CAAA,CAAA;AAEJ,CAAC,CAAA;ACrEY,MAAAU,mBAAA,GAAsB/a,oBAA+C,IAAI,CAAA;ACrF/E,SAASgb,eAA4CA,CAAA,EAAA;EACpD,MAAAC,YAAA,GAAezZ,iBAAWuZ,mBAAmB,CAAA;EAEnD,IAAI,CAACE,YAAc,EAAA;IACX,MAAA,IAAInb,MAAM,qCAAqC,CAAA;EACvD;EAEO,OAAAmb,YAAA;AACT;ACEA,MAAMC,uBAAwB,GAAA;EAC5BC,iBAAmB,EAAA;AACrB,CAAA;AAGO,MAAMC,eAAwCC,MAAA,IAAmC;EAAA,IAAlC;IAAC/gB;IAAIiI,IAAM;IAAAvD,KAAA;IAAOsc;GAAgB,GAAAD,MAAA;EACtF,MAAM;IAACE,aAAA,EAAeC;EAAiB,CAAA,GAAIR,eAAgB,CAAA,CAAA;EAC3D,MAAM;IAACS,MAAQ,EAAAC;EAAA,CAAY,GAAAC,MAAAA,CAAAA,oBAAA,CAAqBrhB,IAAIiI,IAAI,CAAA;EACxD,MAAM,CAACqZ,UAAA,EAAYL,aAAa,CAAA,GAAI1lB,eAAS,KAAK,CAAA;EAClD,MAAM,CAACgmB,mBAAA,EAAqBC,oBAAoB,CAAA,GAAIjmB,eAAS,KAAK,CAAA;EAE5D,MAAAkmB,YAAA,GAAepY,KAAAA,CAAAA,YAAY,MAAM;IACrCmY,oBAAA,CAAqB,KAAK,CAAA;IACfR,UAAA,EAAA;EAAA,CACb,EAAG,CAACA,UAAU,CAAC,CAAA;EAET,MAAAU,aAAA,GAAgBrY,KAAAA,CAAAA,YAAY,MAAM;IACtC4X,aAAA,CAAc,IAAI,CAAA;IAClBO,oBAAA,CAAqB,KAAK,CAAA;IAC1BN,iBAAA,CAAkB,IAAI,CAAA;IACtBE,QAAA,CAASO,OAAQ,CAAA,CAAA;IACNX,UAAA,EAAA;EACV,CAAA,EAAA,CAACI,QAAU,EAAAJ,UAAA,EAAYE,iBAAiB,CAAC,CAAA;EAEtC,MAAAU,MAAA,GAASvY,KAAAA,CAAAA,YAAY,MAAM;IAC/BmY,oBAAA,CAAqB,IAAI,CAAA;EAC3B,CAAA,EAAG,EAAE,CAAA;EAEL,MAAM,CAACrD,WAAA,EAAa0D,oBAAoB,CAAA,GAAIC,iCAA2B,CAAA;IACrE9hB,EAAA;IACAiI,IAAA;IACA2V,UAAY,EAAA;EAAA,CACb,CAAA;EAED,MAAMrB,cAAcC,MAAAA,CAAAA,cAAe,EAAA;EAEnC,IAAI,CAACqF,oBAAA,IAAwB,EAAC1D,WAAA,IAAA,IAAA,GAAA,KAAA,CAAA,GAAAA,WAAA,CAAaN,OAAS,CAAA,EAAA;IAC3C,OAAA;MACLja,IAAM,EAAA,UAAA;MACNO,IAAM,EAAA4d,KAAA,CAAAA,SAAA;MACNrR,QAAU,EAAA,IAAA;MACV8J,KAAO,EAAA,QAAA;MACP5d,KACE,iBAAAhB,UAAA,CAAAA,GAAA,CAAC6gB,MAAA,CAAAA,8BAAA,EAAA;QACCuF,cAAe,EAAA,sBAAA;QACfzF;MAAA,CACF;IAAA,CAEJ;EACF;EAEO,OAAA;IACL3Y,IAAM,EAAA,UAAA;IACNO,IAAM,EAAA4d,KAAA,CAAAA,SAAA;IACNrR,QAAU,EAAA4Q,UAAA,IAAc5e,OAAQ,CAAA0e,QAAA,CAAS1Q,QAAQ,CAAK,IAAAmR,oBAAA;IACtDjlB,OACGwkB,QAAS,CAAA1Q,QAAA,IACRkQ,uBAAsB,CAAAQ,QAAA,CAAS1Q,QAA8C,CAC/E,IAAA,EAAA;IACF8J,KAAA,EAAO8G,aAAa,gBAAc,GAAA,QAAA;IAClC3F,QAAU,EAAA,YAAA;IACVsG,QAAU,EAAAL,MAAA;IACVM,QAAQX,mBAAuB,IAAA;MAC7BtZ,IAAM,EAAA,QAAA;MACNka,SACE,iBAAAvmB,UAAA,CAAAA,GAAA,CAACmT,4BAAA,EAAA;QACClD,MAAO,EAAA,QAAA;QACP7L,EAAA,EAAA,CAAI0E,+BAAOK,GAAO,KAAA/E,EAAA;QAClBiI,IAAA;QACAgH,QAAU,EAAAwS,YAAA;QACVvS,SAAW,EAAAwS;MAAA,CACb;IAEJ;EAAA,CACF;AACF,CAAA;AAEAZ,YAAA,CAAajV,MAAS,GAAA,QAAA;AC9EtB,MAAM+U,uBAAwB,GAAA;EAC5BwB,UAAY,EAAA,0CAAA;EACZC,aAAe,EAAA;AACjB,CAAA;AAGO,MAAMC,uBAAgDC,MAAA,IAMvD;EAAA,IANwD;IAC5DviB,EAAA;IACAiI,IAAA;IACAtD,SAAA;IACA6d,QAAA;IACAxB;EACF,CAAM,GAAAuB,MAAA;EACJ,MAAM;IAACE;EAAkB,CAAA,GAAApB,MAAA,CAAAA,oBAAA,CAAqBrhB,IAAIiI,IAAI,CAAA;EACtD,MAAM,CAACsZ,mBAAA,EAAqBC,oBAAoB,CAAA,GAAIjmB,eAAS,KAAK,CAAA;EAClE,MAAM,CAAC4iB,WAAA,EAAa0D,oBAAoB,CAAA,GAAIC,iCAA2B,CAAA;IACrE9hB,EAAA;IACAiI,IAAA;IACA2V,UAAY,EAAA;EAAA,CACb,CAAA;EACD,MAAMrB,cAAcC,MAAAA,CAAAA,cAAe,EAAA;EAE7B,MAAAkF,aAAA,GAAgBrY,KAAAA,CAAAA,YAAY,MAAM;IACtCoZ,cAAA,CAAed,OAAQ,CAAA,CAAA;IACZX,UAAA,EAAA;EAAA,CACV,EAAA,CAACyB,cAAgB,EAAAzB,UAAU,CAAC,CAAA;EAEzB,MAAAY,MAAA,GAASvY,KAAAA,CAAAA,YAAY,MAAM;IAC/BmY,oBAAA,CAAqB,IAAI,CAAA;EAC3B,CAAA,EAAG,EAAE,CAAA;EAEL,MAAMU,MAA4C,GAAAjgB,KAAA,CAAAA,OAAA,CAChD,MACEsf,mBAAuB,IAAA;IACrBtZ,IAAM,EAAA,SAAA;IACNrE,IAAM,EAAA,UAAA;IACNqL,QAAU,EAAA+R,UAAA;IACV9R,SAAW,EAAAwS,aAAA;IACX/kB,OAAA;MAAWxB,QAAkE,EAAA;IAAA,CAAA;EAC/E,CAAA,EACF,CAACumB,aAAe,EAAAH,mBAAA,EAAqBP,UAAU,CAAA,CACjD;EAEI,IAAA,CAACrc,aAAa6d,QAAU,EAAA;IACnB,OAAA,IAAA;EACT;EAEA,IAAI,CAACX,oBAAA,IAAwB,EAAC1D,WAAA,IAAA,IAAA,GAAA,KAAA,CAAA,GAAAA,WAAA,CAAaN,OAAS,CAAA,EAAA;IAC3C,OAAA;MACLja,IAAM,EAAA,UAAA;MACNO,IAAM,EAAAue,KAAA,CAAAA,SAAA;MACNhS,QAAU,EAAA,IAAA;MACV8J,KAAO,EAAA,iBAAA;MACP5d,KACE,iBAAAhB,UAAA,CAAAA,GAAA,CAAC6gB,MAAA,CAAAA,8BAAA,EAAA;QACCuF,cAAe,EAAA,kCAAA;QACfzF;MAAA,CACF;IAAA,CAEJ;EACF;EAEO,OAAA;IACL3Y,IAAM,EAAA,UAAA;IACNO,IAAM,EAAAue,KAAA,CAAAA,SAAA;IACNhS,QAAU,EAAAhO,OAAA,CAAQ+f,cAAe,CAAA/R,QAAQ,CAAK,IAAAmR,oBAAA;IAC9CjlB,OACG6lB,cAAe,CAAA/R,QAAA,IACdkQ,uBAAsB,CAAA6B,cAAA,CAAe/R,QAA8C,CACrF,IAAA,EAAA;IACF8J,KAAO,EAAA,iBAAA;IACPyH,QAAU,EAAAL,MAAA;IACVM;EAAA,CACF;AACF,CAAA;AAEAI,oBAAA,CAAqBzW,MAAS,GAAA,gBAAA;AC7E9B,MAAM+U,uBAAwB,GAAA;EAC5B+B,oBAAsB,EAAA;AACxB,CAAA;AAGO,MAAMC,kBAA2CC,MAAA,IAA4B;EAAA,IAA3B;IAAC7iB,EAAI;IAAAiI,IAAA;IAAM+Y;GAAgB,GAAA6B,MAAA;EAClF,MAAM;IAACC;EAAa,CAAA,GAAAzB,MAAA,CAAAA,oBAAA,CAAqBrhB,IAAIiI,IAAI,CAAA;EAC3C,MAAA;IAAClB;GAAc,GAAIgc,QAAAA,CAAAA,SAAU,EAAA;EACnC,MAAM,CAACC,aAAA,EAAeC,cAAc,CAAA,GAAI1nB,eAAS,KAAK,CAAA;EACtD,MAAM,CAAC4iB,WAAA,EAAa0D,oBAAoB,CAAA,GAAIC,iCAA2B,CAAA;IACrE9hB,EAAA;IACAiI,IAAA;IACA2V,UAAY,EAAA;EAAA,CACb,CAAA;EAED,MAAMrB,cAAcC,MAAAA,CAAAA,cAAe,EAAA;EAE7B,MAAAoF,MAAA,GAASvY,KAAAA,CAAAA,YAAY,MAAM;IAC/B,MAAM6Z,SAASC,IAAAA,CAAAA,IAAK,EAAA;IAEpBF,cAAA,CAAe,IAAI,CAAA;IACnBH,SAAA,CAAUnB,QAAQuB,MAAM,CAAA;IACxBnc,cAAA,CAAe,MAAQ,EAAA;MAAC/G,EAAI,EAAAkjB,MAAA;MAAQjb;IAAK,CAAA,CAAA;IAC9B+Y,UAAA,EAAA;KACV,CAAC8B,SAAA,EAAW/b,cAAgB,EAAAia,UAAA,EAAY/Y,IAAI,CAAC,CAAA;EAEhD,IAAI,CAAC4Z,oBAAA,IAAwB,EAAC1D,WAAA,IAAA,IAAA,GAAA,KAAA,CAAA,GAAAA,WAAA,CAAaN,OAAS,CAAA,EAAA;IAC3C,OAAA;MACL1Z,IAAM,EAAAuK,KAAA,CAAAA,QAAA;MACNgC,QAAU,EAAA,IAAA;MACV8J,KAAO,EAAA,WAAA;MACP5d,KACE,iBAAAhB,UAAA,CAAAA,GAAA,CAAC6gB,MAAA,CAAAA,8BAAA,EAAA;QACCuF,cAAe,EAAA,yBAAA;QACfzF;MAAA,CACF;IAAA,CAEJ;EACF;EAEO,OAAA;IACLpY,IAAM,EAAAuK,KAAA,CAAAA,QAAA;IACNgC,QAAU,EAAAsS,aAAA,IAAiBtgB,OAAQ,CAAAogB,SAAA,CAAUpS,QAAQ,CAAK,IAAAmR,oBAAA;IAC1DrH,KAAA,EAAOwI,gBAAgB,mBAAiB,GAAA,WAAA;IACxCpmB,OACGkmB,SAAU,CAAApS,QAAA,IACTkQ,uBAAsB,CAAAkC,SAAA,CAAUpS,QAA8C,CAChF,IAAA,EAAA;IACFuR,QAAU,EAAAL;EAAA,CACZ;AACF,CAAA;AAEAgB,eAAA,CAAgB/W,MAAS,GAAA,WAAA;ACrDlB,MAAMuX,uBAAgDC,MAAA,IAAsC;EAAA,IAArC;IAACrjB;IAAIiI,IAAM;IAAAqb,QAAA;IAAUtC;GAAgB,GAAAqC,MAAA;EACjG,MAAM;IAACE;EAAW,CAAA,GAAAlC,MAAA,CAAAA,oBAAA,CAAqBrhB,IAAIiI,IAAI,CAAA;EACzC,MAAAqK,KAAA,GAAQkR,MAAAA,CAAAA,yBAA0B,CAAAxjB,EAAA,EAAIiI,IAAI,CAAA;EAC1C,MAAA;IAAClB;GAAc,GAAIgc,QAAAA,CAAAA,SAAU,EAAA;EAC7B,MAAAU,SAAA,GAAYC,aAAOpR,KAAK,CAAA;EAC9B,MAAM,CAACiP,mBAAA,EAAqBC,oBAAoB,CAAA,GAAIjmB,eAAS,KAAK,CAAA;EAE5D,MAAAmmB,aAAA,GAAgBrY,KAAAA,CAAAA,YAAY,MAAM;IACtCka,OAAA,CAAQ5B,QAAQ2B,QAAS,CAAA;IACdtC,UAAA,EAAA;EACV,CAAA,EAAA,CAACuC,OAAS,EAAAD,QAAA,EAAUtC,UAAU,CAAC,CAAA;EAKlCxlB,KAAAA,CAAAA,SAAA,CAAU,MAAM;IACV,IAAA,CAAC8W,KAAS,IAAAA,KAAA,KAAUmR,SAAU,CAAAhN,OAAA,EAAS;IAE3C,IAAInE,KAAM,CAAArK,IAAA,KAAS,SAAa,IAAAqK,KAAA,CAAMqR,OAAO,SAAW,EAAA;MACtD5c,cAAA,CAAe,MAAQ,EAAA;QAAC/G,EAAI;QAAAiI;MAAK,CAAA,CAAA;IACnC;IAEAwb,SAAA,CAAUhN,OAAU,GAAAnE,KAAA;KACnB,CAACA,KAAA,EAAOtS,EAAI,EAAA+G,cAAA,EAAgBkB,IAAI,CAAC,CAAA;EAE9B,MAAA2Z,MAAA,GAASvY,KAAAA,CAAAA,YAAY,MAAM;IAC/BmY,oBAAA,CAAqB,IAAI,CAAA;EAC3B,CAAA,EAAG,EAAE,CAAA;EAEC,MAAAU,MAAA,GAA2CjgB,KAAAA,CAAAA,QAAQ,MAAM;IAC7D,IAAIsf,mBAAqB,EAAA;MAChB,OAAA;QACLtZ,IAAM,EAAA,SAAA;QACNrE,IAAM,EAAA,UAAA;QACNqL,QAAU,EAAA+R,UAAA;QACV9R,SAAW,EAAAwS,aAAA;QACX/kB,OAAA;UAAWxB,QAA+C,EAAA;QAAA,CAAA;MAAA,CAC5D;IACF;IAEO,OAAA,IAAA;EACN,CAAA,EAAA,CAACumB,aAAe,EAAAH,mBAAA,EAAqBP,UAAU,CAAC,CAAA;EAEnD,MAAM4C,2BAA2BN,QAAa,KAAA,UAAA;EAC9C,MAAMO,0BAA0BP,QAAa,KAAA,KAAA,CAAA;EAE7C,IAAIO,uBAAyB,EAAA;IACpB,OAAA,IAAA;EACT;EAEO,OAAA;IACLrJ,KAAO,EAAA,SAAA;IACP1d,KAAO,EAAA,SAAA;IACPmlB,QAAU,EAAAL,MAAA;IACVhlB,KAAA,EAAOgnB,2BACH,0CACA,GAAA,yBAAA;IACJzf,IAAM,EAAA2f,KAAA,CAAAA,WAAA;IACN5B,MAAA;IACAxR,QAAU,EAAAkT;EAAA,CACZ;AACF,CAAA;AAEAR,oBAAA,CAAqBvX,MAAS,GAAA,SAAA;AC1D9B,MAAM+U,uBAAwB,GAAA;EAC5BmD,iBAAmB,EAAA,iEAAA;EACnBC,iBAAmB,EAAA,mBAAA;EACnB5B,UAAY,EAAA,wBAAA;EACZ6B,SAAW,EAAA;AACb,CAAA;AAEA,SAASC,iBAAAA,CACPrkB,QACAskB,WACA,EAAA;EACI,IAAAtkB,MAAA,KAAW,uBAAuBskB,WAAa,EAAA;IAE/C,OAAAvoB,eAAAA,UAAAA,CAAAA,GAAA,CAAAC,UAAAA,CAAAA,QAAA,EAAA;MACEV,yCAAC,MAAK,EAAA;QAAAA,QAAA,EAAA,CAAA,YAAA,EACMS,eAAAA,UAAAA,CAAAA,GAAA,CAACmB,OAAQ,EAAA;UAAAE,IAAA,EAAMknB;QAAa,CAAA,CAAA;MACxC,CAAA;IACF,CAAA,CAAA;EAEJ;EACA,OAAOvD,wBAAsB/gB,MAAM,CAAA;AACrC;AAIa,MAAAukB,aAAA,GAA0CroB,KAAU,IAAA;EAzCjE,IAAA8N,EAAA;EA0CE,MAAM;IAAC7J,EAAI;IAAAiI,IAAA;IAAMua,QAAU;IAAA9d,KAAA;IAAOC;EAAa,CAAA,GAAA5I,KAAA;EAC/C,MAAM,CAACsoB,YAAA,EAAcC,eAAe,CAAA,GAAI/oB,eAA4C,IAAI,CAAA;EACxF,MAAM;IAACgpB;EAAW,CAAA,GAAAlD,MAAA,CAAAA,oBAAA,CAAqBrhB,IAAIiI,IAAI,CAAA;EACzC,MAAAuc,gBAAA,GAAmBC,MAAAA,CAAAA,mBAAoB,CAAAzkB,EAAA,EAAIiI,IAAI,CAAA;EAC/C,MAAAyc,SAAA,GAAYC,MAAAA,CAAAA,YAAa,CAAA3kB,EAAA,EAAIiI,IAAI,CAAA;EACvC,MAAM;IAAC2c,WAAa;IAAAC,aAAA;IAAetmB,UAAY;IAAAuJ;EAAA,IAAgB4Y,eAAgB,EAAA;EACzE,MAAAoE,SAAA,GAAYC,MAAAA,CAAAA,YAAa,CAAAxmB,UAAA,EAAYuJ,YAAY,CAAA;EAEvD,MAAMwb,aAAYwB,SAAW,IAAA,IAAA,GAAA,KAAA,CAAA,GAAAA,SAAA,CAAApgB,KAAA,MAASogB,SAAW,IAAA,IAAA,GAAA,KAAA,CAAA,GAAAA,SAAA,CAAAngB,SAAA,CAAA,IAAa,CAAI,CAAA,EAAAqgB,IAAA;EAElE,MAAMC,mBAAsB,GAAAT,gBAAA,CAAiBU,UAAW,CAAAnlB,IAAA,CAAKolB,KAAuB,CAAAA,uBAAA,CAAA;EAEpF,MAAM,CAACC,gBAAA,EAAkBC,mBAAmB,CAAA,GAAI9pB,eAAkB,KAAK,CAAA;EACvE,MAAM+pB,YAAYZ,SAAU,CAAAY,SAAA;EAC5B,MAAMC,eAAef,gBAAiB,CAAAe,YAAA;EACtC,MAAM,CAACpH,WAAA,EAAa0D,oBAAoB,CAAA,GAAIC,iCAA2B,CAAA;IACrE9hB,EAAA;IACAiI,IAAA;IACA2V,UAAY,EAAA;EAAA,CACb,CAAA;EAED,MAAMrB,cAAcC,MAAAA,CAAAA,cAAe,EAAA;EAGnC,MAAM5f,KAAQ,GAAA2nB,OAAA,CAAQ7T,QAClB,GAAAwT,iBAAA,CAAkBK,OAAQ,CAAA7T,QAAA,EAAA,CAAW/L,SAAa,IAAA,CAAI,CAAA,EAAAzB,UAAU,CAAK,IAAA,EAAA,GACrE+hB,sBACA,yFACA,GAAA,EAAA;EAEE,MAAAO,QAAA,GAAW9iB,QAAQgC,KAAK,CAAA;EAExB,MAAA+gB,SAAA,GAAYpc,KAAAA,CAAAA,YAAY,MAAM;IAClCkb,OAAA,CAAQ5C,OAAQ,CAAA,CAAA;IAChB2C,eAAA,CAAgB,YAAY,CAAA;EAAA,CAC9B,EAAG,CAACC,OAAO,CAAC,CAAA;EAEZ/oB,KAAAA,CAAAA,SAAA,CAAU,MAAM;IAEd,MAAMkqB,kBACJ,GAAAlB,gBAAA,CAAiBe,YAAiB,KAAA,KAAA,IAASf,iBAAiBlB,QAAa,KAAAA,QAAA;IAE3E,IAAI,CAAC8B,gBAAA,IAAoBE,SAAa,IAAA,CAACI,kBAAoB,EAAA;MACzD;IACF;IAEA,IAAI,CAACT,mBAAqB,EAAA;MACdQ,SAAA,EAAA;IACZ;IACAJ,mBAAA,CAAoB,KAAK,CAAA;EAAA,CACxB,EAAA,CACDC,SAAA,EACAG,SAAA,EACAR,mBAAA,EACAG,gBAAA,EACAZ,gBAAiB,CAAAlB,QAAA,EACjBA,QAAA,EACAiC,YAAA,EACAf,gBAAiB,CAAAe,YAAA,CAClB,CAAA;EAED/pB,KAAAA,CAAAA,SAAA,CAAU,MAAM;IACR,MAAAmqB,UAAA,GAAatB,YAAiB,KAAA,YAAA,IAAgB,CAACmB,QAAA;IACrD,IAAIG,UAAY,EAAA;MACd,IAAIf,WAAa,EAAA;QAEDC,aAAA,EAAA;MAChB;IACF;IACM,MAAAtc,SAAA,GAAYod,aAAa,WAAc,GAAA,IAAA;IACvC,MAAAC,KAAA,GAAQD,aAAa,GAAM,GAAA,GAAA;IAC3B,MAAA1nB,KAAA,GAAQvC,WAAW,MAAM;MAC7B4oB,eAAA,CAAgB/b,SAAS,CAAA;OACxBqd,KAAK,CAAA;IACD,OAAA,MAAMjqB,aAAasC,KAAK,CAAA;KAC9B,CAAC2mB,WAAA,EAAaP,YAAc,EAAAmB,QAAA,EAAUX,aAAa,CAAC,CAAA;EAEjD,MAAAjD,MAAA,GAASvY,KAAAA,CAAAA,YAAY,MAAM;IAC/B,IACEqb,UAAUY,SACV,IAAAd,gBAAA,CAAiBe,YACjB,IAAAf,gBAAA,CAAiBlB,aAAaA,QAC9B,EAAA;MACA+B,mBAAA,CAAoB,IAAI,CAAA;IAAA,CACnB,MAAA;MACKI,SAAA,EAAA;IACZ;EAAA,CACC,EAAA,CACDf,SAAU,CAAAY,SAAA,EACVd,gBAAiB,CAAAe,YAAA,EACjBf,gBAAiB,CAAAlB,QAAA,EACjBA,QAAA,EACAmC,SAAA,CACD,CAAA;EAED,IAAIjD,QAAU,EAAA;IACL,OAAA;MACL5e,IAAM,EAAA,UAAA;MACN4W,KAAO,EAAA,SAAA;MACP5d,KACE,EAAA,qGAAA;MACF8T,QAAU,EAAA;IAAA,CACZ;EACF;EAEA,IAAI,CAACmR,oBAAA,IAAwB,EAAC1D,WAAA,IAAA,IAAA,GAAA,KAAA,CAAA,GAAAA,WAAA,CAAaN,OAAS,CAAA,EAAA;IAC3C,OAAA;MACLja,IAAM,EAAA,UAAA;MACN4W,KAAO,EAAA,SAAA;MACP5d,KACE,iBAAAhB,UAAA,CAAAA,GAAA,CAAC6gB,MAAA,CAAAA,8BAAA,EAAA;QACCuF,cAAe,EAAA,uBAAA;QACfzF;MAAA,CACF,CAAA;MAEF7L,QAAU,EAAA;IAAA,CACZ;EACF;EAEA,MAAMA,QAAW,GAAAhO,OAAA,CACf0iB,gBAAA,KAAA,CACEvb,EAAW,GAAAib,SAAA,IAAA,IAAA,GAAA,KAAA,CAAA,GAAAA,SAAA,CAAAe,mBAAA,KAAX,IAAgC,GAAA,KAAA,CAAA,GAAAhc,EAAA,CAAAqO,OAAA,CAAA,IAChCmM,iBAAiB,YACjB,IAAAA,YAAA,KAAiB,WACjB,IAAAY,mBAAA,IACAV,OAAQ,CAAA7T,QAAA,CACZ;EAEO,OAAA;IACLA,UAAUA,QAAY,IAAAmR,oBAAA;IACtBje,IAAM,EAAA,UAAA;IACN4W,KAAA;IAAA;IAEE6J,iBAAiB,WACb,GAAA,WAAA,GACAe,gBAAoB,IAAAf,YAAA,KAAiB,eACrC,kBACA,GAAA,SAAA;IAAA;IAAA;IAGNlgB,IAAA,EAAMkgB,YAAiB,KAAA,WAAA,GAAcrS,KAAAA,CAAAA,aAAgB,GAAAjO,KAAA,CAAAA,WAAA;IAAA;IAErDnH,OAAOwoB,gBACH,GAAA,+CAAA,GACAf,iBAAiB,WAAe,IAAAA,YAAA,KAAiB,eACjD,IACA,GAAAznB,KAAA;IACJ+e,QAAA,EAAUjL,QAAY,IAAA0U,gBAAA,GAAmB,IAAO,GAAA,YAAA;IAChDnD,QAAU,EAAAL;EAAA,CACZ;AACF,CAAA;AAEAwC,aAAA,CAAcvY,MAAS,GAAA,SAAA;ACtLvB,MAAM+U,qBAAwB,GAAA;EAC5ByB,aAAe,EAAA;AACjB,CAAA;AAGO,MAAMyD,kBAA2CC,MAAA,IAMlD;EAAA,IANmD;IACvD/lB,EAAA;IACAiI,IAAA;IACAvD,KAAA;IACAsc,UAAA;IACAwB;EACF,CAAM,GAAAuD,MAAA;EACJ,MAAM;IAACC;EAAa,CAAA,GAAA3E,MAAA,CAAAA,oBAAA,CAAqBrhB,IAAIiI,IAAI,CAAA;EACjD,MAAM,CAACsZ,mBAAA,EAAqBC,oBAAoB,CAAA,GAAIjmB,eAAS,KAAK,CAAA;EAClE,MAAM,CAAC4iB,WAAA,EAAa0D,oBAAoB,CAAA,GAAIC,iCAA2B,CAAA;IACrE9hB,EAAA;IACAiI,IAAA;IACA2V,UAAY,EAAA;EAAA,CACb,CAAA;EACD,MAAMrB,cAAcC,MAAAA,CAAAA,cAAe,EAAA;EAE7B,MAAAiF,YAAA,GAAepY,KAAAA,CAAAA,YAAY,MAAM;IACrCmY,oBAAA,CAAqB,KAAK,CAAA;IACfR,UAAA,EAAA;EAAA,CACb,EAAG,CAACA,UAAU,CAAC,CAAA;EAET,MAAAU,aAAA,GAAgBrY,KAAAA,CAAAA,YAAY,MAAM;IACtCmY,oBAAA,CAAqB,KAAK,CAAA;IAC1BwE,SAAA,CAAUrE,OAAQ,CAAA,CAAA;IACPX,UAAA,EAAA;EAAA,CACV,EAAA,CAACA,UAAY,EAAAgF,SAAS,CAAC,CAAA;EAEpB,MAAA9D,MAAA,GAAgDjgB,KAAAA,CAAAA,QAAQ,MAAM;IAClE,IAAIsf,mBAAqB,EAAA;MAChB,OAAA;QACLtZ,IAAM,EAAA,QAAA;QACN6H,OAAS,EAAAkR,UAAA;QACT1d,OACE,iBAAA1H,UAAA,CAAAA,GAAA,CAACmT,4BAAA,EAAA;UACC/O,EAAA,EAAA,CAAI0E,+BAAOK,GAAO,KAAA/E,EAAA;UAClBiI,IAAA;UACA4D,MAAO,EAAA,WAAA;UACPoD,QAAU,EAAAwS,YAAA;UACVvS,SAAW,EAAAwS;QAAA,CACb;MAAA,CAEJ;IACF;IAEO,OAAA,IAAA;EAAA,CACT,EAAG,CAAChd,KAAO,EAAA1E,EAAA,EAAIyhB,cAAcC,aAAe,EAAAH,mBAAA,EAAqBP,UAAY,EAAA/Y,IAAI,CAAC,CAAA;EAElF,IAAIua,QAAU,EAAA;IACL,OAAA,IAAA;EACT;EAEA,IAAI,CAACX,oBAAA,IAAwB,EAAC1D,WAAA,IAAA,IAAA,GAAA,KAAA,CAAA,GAAAA,WAAA,CAAaN,OAAS,CAAA,EAAA;IAC3C,OAAA;MACLja,IAAM,EAAA,UAAA;MACNO,IAAM,EAAA8hB,KAAA,CAAAA,aAAA;MACNzL,KAAO,EAAA,WAAA;MACP5d,KACE,iBAAAhB,UAAA,CAAAA,GAAA,CAAC6gB,MAAA,CAAAA,8BAAA,EAAA;QACCuF,cAAe,EAAA,yBAAA;QACfzF;MAAA,CACF,CAAA;MAEF7L,QAAU,EAAA;IAAA,CACZ;EACF;EAEO,OAAA;IACL9M,IAAM,EAAA,UAAA;IACNO,IAAM,EAAA8hB,KAAA,CAAAA,aAAA;IACNvV,QAAU,EAAAhO,OAAA,CAAQsjB,SAAU,CAAAtV,QAAQ,CAAK,IAAAmR,oBAAA;IACzCrH,KAAO,EAAA,WAAA;IACP5d,OAAOopB,SAAU,CAAAtV,QAAA,GACbkQ,qBAAsB,CAAAoF,SAAA,CAAUtV,QAA8C,CAC9E,GAAA,EAAA;IACJuR,QAAA,EAAUA,CAAA,KAAMT,oBAAA,CAAqB,IAAI,CAAA;IACzCU;EAAA,CACF;AACF,CAAA;AAEA4D,eAAA,CAAgBja,MAAS,GAAA,WAAA;AC7FZ,MAAAqa,aAAA,GAAyCnqB,KAAU,IAAA;EACxD,MAAA;IAACymB;EAAY,CAAA,GAAAzmB,KAAA;EAEnB,IAAIymB,QAAU,EAAA;IACL,OAAA;MACLhI,KAAO,EAAA,MAAA;MACP1d,KAAO,EAAA;IAAA,CACT;EACF;EAEO,OAAA,IAAA;AACT,CAAA;ACXO,MAAMqpB,MAAS,GAAA,KAAA;AAEf,MAAMC,iBAAe,CAAA,CAAC;AAChB,MAAAC,YAAA,GAAeC,OAAO,cAAc,CAAA;AAE1C,MAAMC,6BAAgC,GAAA,4BAAA;ACJ7C,MAAMlf,KAEF,GAAA;EAACmf,WAAa,EAAA;CAAE;AAEb,SAASC,eAAetf,KAAoD,EAAA;EACjFE,KAAA,CAAMmf,WAAc,GAAArf,KAAA;AACtB;AAQO,SAASuf,cACdA,CAAArV,MAAA,EACAtL,MACA,EAAA4gB,WAAA,EACA7gB,OAC2F,EAAA;EAvB7F,IAAA+D,EAAA;EAwBQ,MAAA1C,KAAA,GAAA,CAAQwf,WAAa,IAAA,IAAA,GAAA,KAAA,CAAA,GAAAA,WAAA,CAAAxf,KAAA,KAAS,EAAC;EAC/B,MAAAqf,WAAA,GAAcnf,KAAM,CAAAmf,WAAA,IAAe,EAAC;EACpC,MAAAI,cAAA,GAAiB7gB,MAAO,CAAA/F,EAAA,IAAMmjB,IAAK,CAAAA,IAAA,CAAA,CAAA;EACnC,MAAA0D,UAAA,GAAaxV,MAAW,KAAA,QAAA,IAAYtL,MAAO,CAAAiC,QAAA;EAGjD,KAAA,IAASmT,IAAIqL,WAAY,CAAA1mB,MAAA,GAAS,CAAG,EAAAqb,CAAA,IAAK,GAAGA,CAAK,EAAA,EAAA;IAC1C,MAAA1T,IAAA,GAAO+e,YAAYrL,CAAC,CAAA;IAE1B,IAAI,OAAO1T,IAAS,KAAA,QAAA,EAAU;IAI9B,IAAA,CAAA,CACEoC,EAAK,GAAApC,IAAA,CAAAqf,eAAA,KAAL,IAAuB,GAAA,KAAA,CAAA,GAAAjd,EAAA,CAAAkd,IAAA,CAAAtf,IAAA,EAAA4J,MAAA,EAAQtL,MAAQ,EAAA;MACrC0B,IAAA;MACA9B,KAAO,EAAAwV;IAAA,CACT,CAAA;IAAA;IAEC1T,IAAA,CAAKQ,IAAS,KAAA,cAAA,IACbR,IAAK,CAAAuf,cAAA,KAAmBjhB,OAAOkC,IAC/B,IAAAR,IAAA,CAAKwf,OAAQ,CAAAtnB,MAAA,KAAW,gBAC1B,EAAA;MACA,MAAMunB,aAAaL,UAAa,GAAA;QAAC7e,QAAU,EAAAjC,MAAA,CAAOiC;MAAY,CAAA,GAAAoe,cAAA;MAEvD,OAAA;QACLjf,OAAOA,KACJ,CAAAC,KAAA,CAAM,CAAG,EAAA+T,CAAC,EACVlc,MAAO,CAAA,CAAC,CAAC;UAACe,IAAI4mB,cAAgB;UAAA7gB,MAAA,EAAQmhB;UAAYphB;QAAO,CAAC,CAAC,CAAC;MAAA,CACjE;IACF;EACF;EAEO,OAAA;IAACuL,MAAgB;IAAAtL,MAAA;IAAQD;GAAO;AACzC;ACtDA,MAAMsgB,iBAAe,CAAA,CAAC;AAKf,SAASe,wBAAwBphB,MAAyC,EAAA;EAC3E,IAAA;IACF,OAAOmZ,IAAK,CAAAC,KAAA,CAAMiI,kBAAmB,CAAArhB,MAAM,CAAC,CAAA;WACrCshB,GAAK,EAAA;IAEZjN,OAAA,CAAQC,KAAK,iCAAiC,CAAA;IAC9C,OAAO,EAAC;EACV;AACF;AAEO,SAASiN,mBAAmBngB,KAA4B,EAAA;EAC7D,OAAA,CAAQA,SAAS,EAAC,EACfvJ,IAAK4d,KAAA,IAAUA,MAAM5d,GAAI,CAAA2pB,YAAY,CAAE,CAAA7a,IAAA,CAAK,GAAG,CAAC,CAAA,CAChD9O,IAAI4pB,kBAAkB,CAAA,CACtB9a,KAAK,GAAG,CAAA;AACb;AAKO,SAAS+a,uBAAuB1hB,MAAyC,EAAA;EACvE,OAAAmZ,IAAA,CAAKE,UAAUrZ,MAAM,CAAA;AAC9B;AAOO,SAAS2hB,QAAQC,WAAwC,EAAA;EACvD,OAAAC,iBAAA,CAAkBR,kBAAmB,CAAAO,WAAW,CAAC,CAAA;AAC1D;AAKO,SAASE,OAAO1gB,KAAkC,EAAA;EACvD,OAAOmgB,mBAAmBngB,KAAK,CAAA;AACjC;AAEa,MAAA2gB,MAAA,GAASC,QAAAA,CAAAA,KAAM,CAAAC,MAAA,CAAO,GAAK,EAAA;AAAA;AAEtCD,QAAA,CAAAA,KAAA,CAAME,QAAQ,SAAS,CAAA;AAAA;AAGvBF,QAAA,CAAAA,KAAA,CAAMC,OAAO,6BAA+B,EAAA,CAC1CD,QAAAA,CAAAA,MAAMC,MAAO,CAAA;EACXE,IAAM,EAAA,UAAA;EACNC,SAAA,EAAW;IAACpiB,MAAQ,EAAA;MAAC2hB,SAASP,uBAAyB;MAAAU,MAAA,EAAQJ;;EAAuB;AAAA,CACvF,CAAA,CACF,CAAA;AAAA;AAGDM,QAAAA,CAAAA,MAAMC,MAAO,CAAA;EACXE,IAAM,EAAA,SAAA;EAAA;EAEN/sB,QAAA,EAAU,CAAC4sB,QAAM,CAAAA,KAAA,CAAAC,MAAA,CAAO,YAAYD,QAAAA,CAAAA,KAAM,CAAAC,MAAA,CAAO,wBAAwB,CAAC,CAAC,CAAA;EAC3EG,SAAW,EAAA;IACThhB,KAAA,EAAO;MAACugB,OAAA;MAASG;IAAM;EACzB;AAAA,CACD,CAAA,CACF,CAAA;AAKD,MAAMO,WAAc,GAAA,qCAAA;AACpB,MAAMC,OAAU,GAACC,GAAgB,IAAA,mBAAA,CAAoBC,KAAKD,GAAG,CAAA;AAC7D,MAAME,SAAY,GAACF,GACjB,IAAA,kEAAA,CAAmEC,KAAKD,GAAG,CAAA;AAC7E,MAAMG,eAAkB,GAAA,CAAC,MAAQ,EAAA,OAAA,EAAS,OAAO,SAAS,CAAA;AAa1D,MAAMC,QAAW,GAAAhmB,OAAA;AAEjB,SAASimB,WAAAA,CAAYC,QAAkBC,OAA+C,EAAA;EACpF,OAAOD,MAAO,CAAA7K,MAAA,CACZ,CAACtW,MAAMqhB,KAAU,KAAA;IACX,IAAAT,OAAA,CAAQS,KAAK,CAAG,EAAA;MAClB,MAAM7X,MAAM6X,KAAM,CAAA1hB,KAAA,CAAM,GAAG0hB,KAAM,CAAA7S,OAAA,CAAQ,GAAG,CAAC,CAAA;MAC7C,MAAMzZ,KAAQ,GAAAssB,KAAA,CAAM1hB,KAAM,CAAA6J,GAAA,CAAInR,SAAS,CAAC,CAAA;MACxC2H,IAAA,CAAK1B,MAAS,GAAA;QAAC,GAAG0B,IAAA,CAAK1B,MAAQ;QAAA,CAACqhB,kBAAmB,CAAAnW,GAAG,CAAC,GAAGmW,kBAAmB,CAAA5qB,KAAK;MAAC,CAAA;IAAA,CACrF,MAAA,IAAWgsB,SAAU,CAAAM,KAAK,CAAG,EAAA;MACtBrhB,IAAA,CAAA3B,OAAA,GAAUijB,sBAAsBD,KAAK,CAAA;IAAA,CACrC,MAAA;MAEG1O,OAAA,CAAAC,IAAA,CAAK,uCAAuCyO,KAAK,CAAA;IAC3D;IAEO,OAAArhB,IAAA;EACT,CAAA,EACA;IAAC,GAAGohB,OAAA;IAAS9iB,MAAQ,EAAAqgB,cAAA;IAActgB,SAAS,KAAS;EAAA,CAAA,CACvD;AACF;AAEA,SAASyhB,YAAAA,CAAa9f,IAAyB,EAAA9B,KAAA,EAAe6V,KAAgC,EAAA;EAC5F,MAAM;IAAC1V,OAAS;IAAAC,MAAA,GAAS,CAAC,CAAA;IAAG/F;GAAM,GAAAyH,IAAA;EAC7B,MAAA,CAACuhB,YAAY,CAAI,GAAAxN,KAAA;EACvB,MAAMyN,qBAAqBxhB,IAAS,KAAAuhB,YAAA;EACpC,MAAME,WAAc,GAAAvjB,KAAA,KAAU,CAAK,IAAA3F,EAAA,KAAOgpB,YAAa,CAAAhpB,EAAA;EACjD,MAAAmpB,cAAA,GAAiB,OAAOrjB,OAAY,KAAA,WAAA,GAAc,SAAYsjB,IAAK,CAAAlK,IAAA,CAAKE,SAAU,CAAAtZ,OAAO,CAAC,CAAA;EAEhG,MAAMujB,gBAAgB3K,MAAO,CAAAC,OAAA,CAAQ5Y,MAAM,CACxC,CAAApG,MAAA,CAAQ2pB,KAAqC,IAAA;IA1HlD,IAAAzf,EAAA;IA2HY,MAAA,CAACoH,GAAK,EAAAzU,KAAK,CAAI,GAAA8sB,KAAA;IACrB,IAAI,CAAC9sB,KAAA,EAAc,OAAA,KAAA;IACf,IAAAysB,kBAAA,EAA2B,OAAA,IAAA;IAGzB,MAAAM,qBAAA,GAAA,CAAwB1f,EAAa,GAAAmf,YAAA,CAAAjjB,MAAA,KAAb,IAAsB,GAAA,KAAA,CAAA,GAAA8D,EAAA,CAAAoH,GAAA,CAAA;IACpD,IAAIzU,KAAU,KAAA+sB,qBAAA,IAAyB,CAACd,eAAA,CAAgBe,SAASvY,GAAG,CAAA,EAAU,OAAA,KAAA;IACvE,OAAA,IAAA;EAAA,CACR,CAAA,CACArT,GAAI,CAAA6rB,MAAA;IAAA,IAAC,CAACxY,GAAK,EAAAzU,KAAK,CAAM,GAAAitB,MAAA;IAAA,OAAA,EAAA,CAAGxqB,0BAAmBgS,GAAG,CAAA,EAAC,GAAI,CAAA,CAAAhS,MAAA,CAAAuoB,kBAAA,CAAmBhrB,KAAK,CAAG,CAAA;EAAA,EAAA;EAGhF,OAAA,CAAC0sB,cAAc,EAAK,GAAAlpB,EAAE,EACnBf,MAAO,CAAA,CAACoqB,cAAcvpB,MAAS,GAAA,CAAA,IAAKupB,eAAeF,cAAc,CAAA,CAAExpB,OAAO+oB,QAAQ,CAAA,CAAEgB,KAAM,CAAA,CAAA,CAC1Fhd,IAAK,CAAA,GAAG,CAAK,IAAA,GAAA;AAEpB;AAEO,SAASkb,kBAAkBU,GAA0B,EAAA;EAC1D,IAAIA,GAAI,CAAArS,OAAA,CAAQ,IAAI,CAAA,KAAM,CAAI,CAAA,EAAA;IAC5B,OAAO0T,qBAAqBrB,GAAG,CAAA;EACjC;EAEA,OAAOA,IACJzW,KAAM,CAAA,GAAG,CACT,CAAAjU,GAAA,CAAK4d,KAAU,IAAA;IACR,MAAA,CAACwN,YAAc,EAAA,GAAGY,cAAc,CAAA,GAAIpO,KAAM,CAAA3J,KAAA,CAAM,GAAG,CAAA,CAAEjU,GAAI,CAACisB,OAAY,IAAA;MAC1E,MAAM,CAAC7pB,EAAI,EAAA,GAAG4oB,MAAM,CAAI,GAAAiB,OAAA,CAAQhY,MAAM,GAAG,CAAA;MACzC,OAAO8W,WAAY,CAAAC,MAAA,EAAQ;QAAC5oB;MAAG,CAAA,CAAA;IAAA,CAChC,CAAA;IAEM,OAAA,CACLgpB,YAAA,EACA,GAAGY,cAAA,CAAehsB,GAAI,CAACksB,OAAa,KAAA;MAClC,GAAGd,YAAA;MACH,GAAGc,OAAA;MACH9pB,EAAA,EAAI8pB,OAAQ,CAAA9pB,EAAA,IAAMgpB,YAAa,CAAAhpB,EAAA;MAC/B+F,MAAA,EAAQ;QAAC,GAAGgkB,aAAAA,CAAAA,OAAK,CAAAf,YAAA,CAAajjB,QAAQ0iB,eAAe,CAAA;QAAG,GAAGqB,OAAA,CAAQ/jB;MAAM,CAAA;MACzED,OAAA,EAASgkB,OAAQ,CAAAhkB,OAAA,IAAWkjB,YAAa,CAAAljB;IAAA,CACzC,CAAA,CAAA,CACJ;EAAA,CACD,CACA,CAAAnG,MAAA,CAAQ6b,KAAU,IAAAA,KAAA,CAAM1b,SAAS,CAAC,CAAA;AACvC;AAEA,SAAS6pB,qBAAqBrB,GAA0B,EAAA;EACtD,MAAMM,SAA0B,EAAC;EAEjC,IAAIoB,MAAS,GAAA1B,GAAA;EACb,OAAO0B,OAAOlqB,MAAQ,EAAA;IACd,MAAA,CAACmqB,OAAOjqB,EAAI,EAAAkqB,YAAY,IAAIF,MAAO,CAAAC,KAAA,CAAM7B,WAAW,CAAA,IAAK,EAAC;IAChE,IAAI,CAAC6B,KAAO,EAAA;MACDD,MAAA,GAAAA,MAAA,CAAO5iB,MAAM,CAAC,CAAA;MACvB;IACF;IAEM,MAAAtB,OAAA,GAAUokB,YAAgB,IAAAC,eAAA,CAAgBD,YAAY,CAAA;IAC5DtB,MAAA,CAAOra,IAAK,CAAA;MAACvO,EAAI;MAAA8F;IAAQ,CAAA,CAAA;IAEhBkkB,MAAA,GAAAA,MAAA,CAAO5iB,KAAM,CAAA6iB,KAAA,CAAMnqB,MAAM,CAAA;EACpC;EAEA,OAAO,CAAC8oB,MAAM,CAAA;AAChB;AAEA,SAASuB,gBAAgBjrB,IAAc,EAAA;EACjC,IAAA;IACK,OAAAggB,IAAA,CAAKC,MAAMjgB,IAAI,CAAA;WACfmoB,GAAK,EAAA;IAEJjN,OAAA,CAAAC,IAAA,CAAK,8BAA+B,CAAApb,MAAA,CAAAooB,GAAA,CAAI1qB,OAAS,CAAA,CAAA;IAClD,OAAA,KAAA,CAAA;EACT;AACF;AAEA,SAASosB,sBAAsBqB,IAAc,EAAA;EAC3C,OAAOA,IAAO,GAAAD,eAAA,CAAgBE,IAAK,CAAAD,IAAI,CAAC,CAAI,GAAA,KAAA,CAAA;AAC9C;ACrMO,MAAME,wBAA2B,GAAA,GAAA;AACjC,MAAMC,gCAAmC,GAAA,GAAA;AAEzC,MAAMC,4BAA+B,GAAA,GAAA;AACrC,MAAMC,4BAA+B,GAAA,GAAA;AAErC,MAAMrE,eAA8D,CAAA,CAAC;AAErE,MAAMsE,qBAAwB,GAAA,UAAA;AAExB,MAAAC,wBAAA,GAAgD,CAAC;EAAC3qB,EAAA,EAAI;AAAe,CAAA,EAAA;EAACA,EAAI,EAAA;AAAA,CAAQ,CAAA;AAGxF,MAAM4qB,sBAAyB,GAAA,qBAAA;AAC/B,MAAMC,yBAA4B,GAAA,wBAAA;ACJzC,MAAMpX,MAAA,GAAOtJ,eAAAA,CAAAA,OAAO,CAAAwC,EAAAA,CAAAA,IAAI,CAAE,CAAA;EACxBme,QAAU,EAAA,UAAA;EACVC,MAAQ,EAAA,CAAA;EACRC,UAAY,EAAA,CAAA;EAEZ,SAAW,EAAA;IACT1nB,OAAS,EAAA,IAAA;IACT2nB,OAAS,EAAA,OAAA;IACTH,QAAU,EAAA,UAAA;IACVI,IAAM,EAAA,CAAA;IACNC,MAAQ,EAAA,CAAA,CAAA;IACRC,KAAO,EAAA,CAAA;IACPC,YAAc,EAAA,oCAAA;IACdC,OAAS,EAAA;EACX;AACF,CAAC,CAAA;AAGM,SAASC,wBACdxvB,KACA,EAAA;EACM,MAAA;IAAC4N,IAAI6N,WAAa;IAAArc,QAAA;IAAUqwB;IAAkB1b,OAAS;IAAAlT,KAAA;IAAO,GAAGyY;EAAa,CAAA,GAAAtZ,KAAA;EAEpF,OACGW,eAAAA,UAAAA,CAAAA,IAAA,CAAA+W,MAAA,EAAA;IAAM,GAAG4B,SAAA;IAAW1L,IAAI6N,WACvB;IAAArc,QAAA,EAAA,CAACuB,eAAAA,UAAAA,CAAAA,IAAA,CAAAyO,EAAAA,CAAAA,IAAA,EAAA;MAAK3H,SAAS,CACb;MAAArI,QAAA,EAAA,CAAA,eAAAS,cAAA,CAAC2H,EAAAA,CAAAA,GAAI,EAAA;QAAAsJ,IAAA,EAAM,CAAG;QAAArJ,OAAA,EAAS;QACrBrI,QAAC,EAAAS,eAAAA,UAAAA,CAAAA,GAAA,CAAA6H,EAAA,CAAAA,IAAA,EAAA;UAAKkG,EAAG,EAAA,IAAA;UAAKjG,IAAM,EAAA,CAAA;UAAGqW,MAAO,EAAA,UAAA;UAC3B5e;QACH,CAAA;OACF,CAAA,EAAA,eACCS,UAAA,CAAAA,GAAA,CAAA2H,EAAA,CAAAA,GAAA,EAAA;QAAIsJ,IAAK,EAAA,MAAA;QAAOrJ,SAAS,CACxB;QAAArI,QAAA,iBAAAS,UAAA,CAAAA,GAAA,CAAC4S,EAAA,CAAAA,MAAA,EAAA;UACC,YAAY,EAAAgd,gBAAA;UACZ7c,QAAU,EAAA,CAAA;UACVxK,IAAM,EAAAsnB,KAAA,CAAAA,SAAA;UACNhd,IAAK,EAAA,OAAA;UACLzF,OAAS,EAAA8G,OAAA;UACTtM,OAAS,EAAA;QAAA,CAAA;OAEb,CAAA;KACF,CAAA,EACCrI,QAAA;EACH,CAAA,CAAA;AAEJ;ACvDa,MAAAuwB,eAAA,GAAkBhmB,oBAA2C,IAAI,CAAA;ACEvE,SAASimB,WAAoCA,CAAA,EAAA;EAC5C,MAAAC,QAAA,GAAW1kB,iBAAWwkB,eAAe,CAAA;EAE3C,IAAI,CAACE,QAAA,EAAgB,MAAA,IAAIpmB,MAAM,iCAAiC,CAAA;EAEzD,OAAAomB,QAAA;AACT;;;;;;ACXA,IAAA/hB,IAAA;AAGA,MAAM4J,MAAA,GAAOtJ,eAAAA,CAAAA,OAAO,CAAA0hB,GAAA,CAAPhiB,IAAU,KAAAA,IAAA,GAAAO,YAAA,CAAA,CAAA,otBAAA,CAAA,CAAA,CAAA,CAAA;AAyChB,SAAS0hB,QAAQ/vB,KAAuE,EAAA;EACvF,MAAA;IAACgwB,QAAU;IAAAC;EAAiB,CAAA,GAAAjwB,KAAA;EAE5B,MAAAkwB,SAAA,GAAYvI,aAAO,CAAC,CAAA;EAE1B,MAAMzP,eAAkB,GAAA5K,KAAA,CAAAA,WAAA,CACrBiJ,KAA4B,IAAA;IAC3BA,KAAA,CAAM4B,cAAe,CAAA,CAAA;IAErB+X,SAAA,CAAUxV,UAAUnE,KAAM,CAAA8B,KAAA;IAEZ4X,aAAA,EAAA;IAER,MAAA3X,eAAA,GAAmBhX,CAAkB,IAAA;MACzCA,CAAA,CAAE6W,cAAe,CAAA,CAAA;MACR6X,QAAA,CAAA1uB,CAAA,CAAE+W,KAAQ,GAAA6X,SAAA,CAAUxV,OAAO,CAAA;IAAA,CACtC;IAEA,MAAMlC,gBAAgBA,CAAA,KAAM;MACnBC,MAAA,CAAAC,mBAAA,CAAoB,aAAaJ,eAAe,CAAA;MAChDG,MAAA,CAAAC,mBAAA,CAAoB,WAAWF,aAAa,CAAA;IAAA,CACrD;IAEOC,MAAA,CAAAE,gBAAA,CAAiB,aAAaL,eAAe,CAAA;IAC7CG,MAAA,CAAAE,gBAAA,CAAiB,WAAWH,aAAa,CAAA;EAClD,CAAA,EACA,CAACwX,UAAUC,aAAa,CAAA,CAC1B;EAGE,OAAA,eAAAtvB,UAAA,CAAAA,IAAA,CAAC+W,MAAK,EAAA;IAAAkB,WAAA,EAAaV,eAEjB;IAAA9Y,QAAA,EAAA,CAAA,eAAAS,UAAA,CAAAA,GAAA,CAAC,MAAK,EAAA,EAAA,CAAA,EAAA,8BAGL,MAAK,EAAA,EAAA,CAAA;EACR,CAAA,CAAA;AAEJ;;;;;;AClFA,IAAAiO,IAAA;AAUA,MAAM4J,MAAO,GAAAtJ,eAAAA,CAAAA,OAAA,CAAO5G,EAAG,CAAAA,GAAA,CAAA,CAAVsG,IAAW,KAAAA,IAAA,GAAAO,YAAA,CAAA,CAAA,6DAAA,CAAA,CAAA,CAAA,CAAA;AAMjB,SAAS8hB,UACdnwB,KACA,EAAA;EACM,MAAA;IAAC4N,IAAI6N,WAAa;IAAArc,QAAA;IAAU4S;IAAUoH,QAAU;IAAA,GAAGE;EAAa,CAAA,GAAAtZ,KAAA;EACtE,MAAM,CAAC8X,OAAA,EAASsY,UAAU,CAAA,GAAI5wB,eAAgC,IAAI,CAAA;EAClE,MAAM6wB,kBAAkB1I,KAAAA,CAAAA,MAAe,EAAA;EACvC,MAAM,CAAC2I,WAAA,EAAaC,cAAc,CAAA,GAAI/wB,KAAiB,CAAAA,QAAA,CAAA,CAAA;EAEjD,MAAAgxB,iBAAA,GAAoBljB,KAAAA,CAAAA,YAAY,MAAM;IAC1C+iB,eAAA,CAAgB3V,UAAU5C,OAAS,IAAA,IAAA,GAAA,KAAA,CAAA,GAAAA,OAAA,CAAA2Y,WAAA;EAAA,CACrC,EAAG,CAAC3Y,OAAO,CAAC,CAAA;EAEZ,MAAM4Y,YAAe,GAAApjB,KAAA,CAAAA,WAAA,CAClBiL,MAAmB,IAAA;IAClB,MAAMoY,IAAIN,eAAgB,CAAA3V,OAAA;IAE1B,IAAI,CAACiW,CAAA,EAAG;IAEOJ,cAAA,CAAAK,IAAA,CAAKC,IAAID,IAAK,CAAAE,GAAA,CAAIH,IAAIpY,MAAQ,EAAAvG,QAAQ,CAAG,EAAAoH,QAAQ,CAAC,CAAA;EACnE,CAAA,EACA,CAACpH,UAAUoH,QAAQ,CAAA,CACrB;EAEA,MAAMtY,KAAQ,GAAAoF,KAAA,CAAAA,OAAA,CACZ,MAAOoqB,WAAc,GAAA;IAACxf,IAAM,EAAA,MAAA;IAAQrB,OAAO6gB;EAAW,CAAA,GAAI;IAACte,QAAA;IAAUoH;EAAQ,CAAA,EAC7E,CAACpH,QAAU,EAAAoH,QAAA,EAAUkX,WAAW,CAAA,CAClC;EAGE,OAAA,eAAA3vB,eAAA,CAAC+W;IAAK9J,EAAI,EAAA6N,WAAA;IAAc,GAAGnC,SAAW;IAAApO,GAAA,EAAKklB;IAAYtvB,KACpD;IAAA1B,QAAA,EAAA,CAAAA,QAAA,EAAA,eACAS,UAAA,CAAAA,GAAA,CAAAkwB,OAAA,EAAA;MAAQC,QAAU,EAAAU,YAAA;MAAcT,eAAeO;KAAmB,CAAA;EACrE,CAAA,CAAA;AAEJ;AC7CO,SAASO,aAAa7F,OAIZ,EAAA;EACf,MAAM;IAACiB,IAAA;IAAM9rB,UAAY;IAAAI;EAAA,CAAS,GAAAyqB,OAAA;EAClC,MAAM8F,SAAuB,EAAC;EAE9B,IAAIC,CAAI,GAAA5wB,UAAA;EACR,IAAIoiB,CAAa,GAAAhiB,KAAA;EAEjB,KAAA,MAAWqtB,WAAW3B,IAAM,EAAA;IAEtB,IAAA,OAAO2B,YAAY,QAAU,EAAA;MAC/B,IAAI,CAACvlB,MAAAA,CAAAA,QAAA,CAASka,CAAC,CAAA,IAAKA,MAAM,KAAW,CAAA,EAAA;QAC7B,MAAA,IAAIhZ,KAAM,CAAA,2DAAA,CAA4DvG,MAAS,CAAA4qB,OAAA,CAAA,CAAA;MACvF;MAEI,IAAAmD,CAAA,CAAEC,aAAa,QAAU,EAAA;QAC3B,MAAM,IAAIznB,KAAA,CACR,sEAAuE,CAAAvG,MAAA,CAAA4qB,OAAA,CAAA,CACzE;MACF;MAEArL,CAAA,GAAIA,CAAI,IAAA,IAAA,GAAA,KAAA,CAAA,GAAAA,CAAA,CAAAqL,OAAA,CAAA;MAEF,MAAAqD,KAAA,GAAQF,EAAEG,MAAO,CAAArX,IAAA,CAAMsX,CAAM,IAAAA,CAAA,CAAE5jB,SAASqgB,OAAO,CAAA;MAErD,IAAI,CAACqD,KAAO,EAAA;QACJ,MAAA,IAAI1nB,KAAM,CAAA,yBAAA,CAA0BvG,MAAS,CAAA4qB,OAAA,CAAA,CAAA;MACrD;MAEAmD,CAAA,GAAIE,KAAM,CAAAjlB,IAAA;MAEV8kB,MAAA,CAAOxe,KAAKye,CAAC,CAAA;MAEb;IACF;IAGI,IAAA,OAAOnD,YAAY,QAAU,EAAA;MAC/B,IAAI,CAACpL,MAAAA,CAAAA,OAAA,CAAQD,CAAC,CAAA,IAAKA,MAAM,KAAW,CAAA,EAAA;QAClC,MAAM,IAAIhZ,KAAA,CAAM,0DAA2D,CAAAvG,MAAA,CAAA4qB,OAAA,EAAO,GAAG,CAAA,CAAA;MACvF;MAEI,IAAAmD,CAAA,CAAEC,aAAa,OAAS,EAAA;QAC1B,MAAM,IAAIznB,KAAA,CACR,sEAAsEvG,MAAO,CAAA4qB,OAAA,EAAA,GAAA,CAAA,CAC/E;MACF;MAEArL,CAAA,GAAIA,CAAI,IAAA,IAAA,GAAA,KAAA,CAAA,GAAAA,CAAA,CAAAqL,OAAA,CAAA;MAER,MAAMwD,QAAW,GAAAL,CAAA,CAAE5sB,EAAG,CAAA0V,IAAA,CAAMwX,MAAW,IAAA;QACjC,IAAA,OAAO9O,MAAM,QAAU,EAAA;UACzB,OAAO8O,OAAOL,QAAa,KAAA,QAAA;QAC7B;QAEI,IAAA,OAAOzO,MAAM,QAAU,EAAA;UACzB,OAAO8O,OAAOL,QAAa,KAAA,QAAA;QAC7B;QAEI,IAAA,OAAOzO,MAAM,SAAW,EAAA;UAC1B,OAAO8O,OAAOL,QAAa,KAAA,SAAA;QAC7B;QAEI,IAAA3oB,MAAAA,CAAAA,QAAA,CAASka,CAAC,CAAG,EAAA;UACR,OAAA8O,MAAA,CAAO9jB,UAASgV,CAAG,IAAA,IAAA,GAAA,KAAA,CAAA,GAAAA,CAAA,CAAAliB,KAAA,CAAA;QAC5B;QAEO,OAAA,KAAA;MAAA,CACR,CAAA;MAED,IAAI,CAAC+wB,QAAU,EAAA;QACb,MAAM,IAAI7nB,KAAA,CAAM,wBAAyB,CAAAvG,MAAA,CAAA4qB,OAAA,EAAO,GAAG,CAAA,CAAA;MACrD;MAEImD,CAAA,GAAAK,QAAA;MAEJN,MAAA,CAAOxe,KAAKye,CAAC,CAAA;MAEb;IACF;IAGA,IAAI1oB,eAAS,CAAAulB,OAAO,CAAK,IAAAA,OAAA,CAAQ0D,IAAM,EAAA;MACjC,IAAA,CAAC9O,MAAAA,CAAAA,OAAQ,CAAAD,CAAC,CAAG,EAAA;QACf,MAAM,IAAIhZ,KAAA,CACR,mEAAmEvG,MAAO,CAAA4qB,OAAA,EAAA,GAAA,CAAA,CAC5E;MACF;MAEI,IAAAmD,CAAA,CAAEC,aAAa,OAAS,EAAA;QAC1B,MAAM,IAAIznB,KAAA,CACR,qEAAsE,CAAAvG,MAAA,CAAA4qB,OAAA,CAAA,CACxE;MACF;MAEM,MAAA2D,MAAA,GAAShP,gBAAK,EAAC;MAEjBA,CAAA,GAAAgP,MAAA,CAAO1X,IAAK,CAACqF,CAAM,IAAA7W,MAAA,CAAAA,QAAA,CAAS6W,CAAC,CAAK,IAAAA,CAAA,CAAEoS,IAAS,KAAA1D,OAAA,CAAQ0D,IAAI,CAAA;MAEzD,IAAA,CAACjpB,MAAAA,CAAAA,QAAS,CAAAka,CAAC,CAAG,EAAA;QAChB,MAAM,IAAIhZ,KAAA,CAAM,iCAAkC,CAAAvG,MAAA,CAAA4qB,OAAA,CAAQ0D,MAAI,GAAG,CAAA,CAAA;MACnE;MAEA,MAAMD,MAAS,GAAAN,CAAA,CAAE5sB,EAAG,CAAA0V,IAAA,CAAMqF,CAAA,IAAM7W,MAAAA,CAAAA,QAAS,CAAAka,CAAC,CAAK,IAAArD,CAAA,CAAE3R,IAAS,MAAAgV,CAAA,IAAA,IAAA,GAAA,KAAA,CAAA,GAAAA,CAAA,CAAGliB,KAAK,CAAA,CAAA;MAElE,IAAI,CAACgxB,MAAQ,EAAA;QACX,MAAM,IAAI9nB,KAAA,CAAM,8BAA+B,CAAAvG,MAAA,CAAAuf,CAAA,IAAA,IAAA,GAAA,KAAA,CAAA,GAAAA,CAAA,CAAGliB,KAAO,CAAA,CAAA;MAC3D;MAEI0wB,CAAA,GAAAM,MAAA;MAEJP,MAAA,CAAOxe,KAAKye,CAAC,CAAA;MAEb;IACF;IAEA,MAAM,IAAIxnB,KAAM,CAAA,wBAAA,CAAyBvG,MAAK,CAAAigB,IAAA,CAAAE,SAAA,CAAUyK,OAAO,CAAG,CAAA,CAAA;EACpE;EAEO,OAAAkD,MAAA;AACT;ACvHA,MAAMU,WAAmE,GAAA;EACvElxB,KAAO,EAAAmxB,KAAA,CAAAA,gBAAA;EACPC,OAAS,EAAA7gB,KAAA,CAAAA,kBAAA;EACT8gB,IAAM,EAAAniB,KAAA,CAAAA;AACR,CAAA;AAEA,MAAMoiB,WAA8D,GAAA;EAClEtxB,KAAO,EAAA,UAAA;EACPoxB,OAAS,EAAA,SAAA;EACTC,IAAM,EAAA;AACR,CAAA;AAEO,SAASE,oBAAoB/xB,KAA+B,EAAA;EAC3D,MAAA;IAAC+T;EAAW,CAAA,GAAA/T,KAAA;EAClB,MAAM;IAACgyB,OAAS;IAAAC,UAAA;IAAY5xB;IAAY8oB,UAAY;IAAA1oB;EAAA,IAASkkB,eAAgB,EAAA;EAE7E,MAAMuN,UAAa,GAAA5kB,KAAA,CAAAA,WAAA,CAChB6e,IAAe,IAAA;IACd8F,UAAA,CAAW9F,IAAI,CAAA;IACf6F,OAAA,CAAQ7F,IAAI,CAAA;EACd,CAAA,EACA,CAAC6F,SAASC,UAAU,CAAA,CACtB;EAEA,sCACG7iB,OAAK,EAAA;IAAA8B,SAAA,EAAU;IAASmK,MAAO,EAAA,MAAA;IAAOzJ,UAAS,QAC9C;IAAAxS,QAAA,EAAA,CAAA,eAAAS,UAAA,CAAAA,GAAA,CAAC2vB,uBAAA,EAAA;MACC5hB,EAAG,EAAA,QAAA;MACH6hB,gBAAiB,EAAA,kBAAA;MACjB3e,IAAK,EAAA,MAAA;MACLiD,OAAA;MACAlT,KAAM,EAAA;IAAA,CACR,CAAA,EAAA,+BAEC+P,EAAAA,CAAAA,IAAK,EAAA;MAAAE,IAAA,EAAM;MAAGc,QAAS,EAAA,MAAA;MAAOnK,SAAS,CACrC;MAAArI,QAAA,EAAA,CAAA+pB,UAAA,CAAWplB,MAAW,KAAA,CAAA,mBACpBlE,UAAA,CAAAA,GAAA,CAAA2H,EAAA,CAAAA,GAAA,EAAA;QAAIC,OAAS,EAAA,CAAA;QACZrI,QAAC,EAAAS,eAAAA,UAAAA,CAAAA,GAAA,CAAA6H,EAAAA,CAAAA,IAAA,EAAA;UAAKK,KAAK,EAAA,IAAA;UAACJ,IAAM,EAAA,CAAA;UAAGvI;QAErB,CAAA;OACF,CAAA,EAGD+pB,UAAA,CAAWplB,MAAS,GAAA,CAAA,IAClBlE,eAAAA,UAAAA,CAAAA,GAAA,CAAAsR,EAAAA,CAAAA,KAAA,EAAA;QAAMhI,KAAO,EAAA,CAAA;QACX/J,QAAW,EAAA+pB,UAAA,CAAAtnB,GAAA,CAAI,CAACswB,MAAA,EAAQ/S,CACvB,KAAA,eAAAvf,UAAA,CAAAA,GAAA,CAACuyB,cAAA,EAAA;UAECD,MAAA;UACAE,MAAQ,EAAAH,UAAA;UACR7xB,UAAA;UACAI;QAAA,CAAA,EAJK2e,CAMR,CAAA;OACH,CAAA;KAEJ,CAAA;EACF,CAAA,CAAA;AAEJ;AAEA,SAASgT,eAAepyB,KAKrB,EAAA;EACD,MAAM;IAACmyB,MAAA;IAAQE,MAAQ;IAAAhyB,UAAA;IAAYI;GAAS,GAAAT,KAAA;EACtC,MAAAkyB,UAAA,GAAa5kB,iBAAY,CAAA,MAAM+kB,MAAO,CAAAF,MAAA,CAAOhG,IAAI,CAAG,EAAA,CAACgG,MAAQ,EAAAE,MAAM,CAAC,CAAA;EAC1E,MAAM,CAACC,SAAA,EAAWC,YAAY,CAAA,GAAI/yB,eAAiD,IAAI,CAAA;EAGrF,OAAA,eAAAmB,UAAA,CAAAA,IAAA,CAAC2T,EAAc,CAAAA,aAAA,EAAA;IAAAC,OAAA,EAASge,YACrB;IAAAnzB,QAAA,EAAA,CACCkzB,SAAA,IAAA,eAAAzyB,UAAA,CAAAA,GAAA,CAAC+Q,EAAK,CAAAA,IAAA,EAAA;MAAAnJ,OAAA,EAAS,CAAG;MAAAoG,MAAA,EAAQ,CAAG;MAAAhG,IAAA,EAAK,UAChC;MAAAzI,QAAA,EAAA,eAAAuB,eAAA,CAAC+G,EAAAA,CAAAA,IAAK,EAAA;QAAAC,IAAA,EAAM,CAAG;QAAAvI,QAAA,EAAA,CAAA,SAAA,EAAQkzB,UAAU9xB,KAAM,CAAAI,OAAA;MAAA,CAAQ;IACjD,CAAA,CAAA,EAGD,CAAC0xB,SACA,IAAA,eAAAzyB,UAAA,CAAAA,GAAA,CAAC+Q,EAAA,CAAAA,IAAA,EAAA;MACCjD,oBAAoB,EAAA,IAAA;MACpBC,EAAG,EAAA,QAAA;MACHX,OAAS,EAAAilB,UAAA;MACTzqB,OAAS,EAAA,CAAA;MACToG,MAAQ,EAAA,CAAA;MACRhG,IAAA,EAAMiqB,WAAY,CAAAK,MAAA,CAAOK,KAAK,CAAA;MAE9BpzB,QAAC,EAAAuB,eAAAA,UAAAA,CAAAA,IAAA,CAAAyO,EAAAA,CAAAA,IAAA,EAAA;QAAKmC,KAAM,EAAA,YAAA;QAAaY,KAAK,CAC5B;QAAA/S,QAAA,EAAA,CAAA,eAAAS,UAAA,CAAAA,GAAA,CAAC2H,EAAI,CAAAA,GAAA,EAAA;UAAAsJ,IAAA,EAAK,MACR;UAAA1R,QAAA,EAAAS,eAAAA,UAAAA,CAAAA,GAAA,CAAC6H,EAAAA,CAAAA,IAAK,EAAA;YAAAC,IAAA,EAAM,CAAI;YAAAvI,QAAA,EAAAqzB,KAAAA,CAAAA,aAAA,CAAcf,WAAY,CAAAS,MAAA,CAAOK,KAAK,CAAC;UAAE,CAAA;SAC3D,CAAA,EAAA,eAEC7xB,UAAA,CAAAA,IAAA,CAAAwQ,EAAA,CAAAA,KAAA,EAAA;UAAML,IAAM,EAAA,CAAA;UAAG3H,OAAO,CACrB;UAAA/J,QAAA,EAAA,CAAA,eAAAS,UAAA,CAAAA,GAAA,CAAC6yB,2BAAA,EAAA;YACCvG,MAAMgG,MAAO,CAAAhG,IAAA;YACb9rB,UAAA;YACAI;UAAA,CACF,CAAA,EAEAZ,eAAAA,UAAAA,CAAAA,GAAA,CAAC6H;YAAKK,KAAK,EAAA,IAAA;YAACJ,MAAM,CACf;YAAAvI,QAAA,EAAA+yB,MAAA,CAAOhiB,KAAKvP;UACf,CAAA,CAAA;SACF,CAAA;OACF;IAAA,CACF,CAAA;EAEJ,CAAA,CAAA;AAEJ;AAEA,SAAS8xB,4BAA4B1yB,KAIlC,EAAA;EACD,MAAM;IAACmsB,IAAA;IAAM9rB,UAAY;IAAAI;EAAA,CAAS,GAAAT,KAAA;EAElC,MAAM2yB,SAAY,GAAAzsB,KAAA,CAAAA,OAAA,CAChB,MAAM6qB,YAAa,CAAA;IAAC5E,IAAM;IAAA9rB,UAAA;IAAYI;GAAM,CAAA,EAC5C,CAAC0rB,IAAM,EAAA9rB,UAAA,EAAYI,KAAK,CAAA,CAC1B;EAGE,OAAA,eAAAZ,UAAA,CAAAA,GAAA,CAAC6H,EAAK,CAAAA,IAAA,EAAA;IAAAC,IAAA,EAAM,CACT;IAAAvI,QAAA,EAAAuzB,SAAA,CAAU9wB,IAAI,CAACkf,CAAA,EAAG3B,CACjB,KAAA,eAAAze,UAAA,CAAAA,IAAA,CAACb,KACE,CAAAA,QAAA,EAAA;MAAAV,QAAA,EAAA,CAAIggB,CAAA,GAAA,CAAA,IAAMvf,eAAAA,UAAAA,CAAAA,GAAA,CAAA,MAAA,EAAA;QAAKiB,KAAO,EAAA;UAACC,OAAO,4BAA8B;UAAAwuB,OAAA,EAAS;QAAG,CAAA;QAAGnwB,QAAG,EAAA;MAAA,CAAA,CAAA,EAC/ES,eAAAA,UAAAA,CAAAA,GAAA,CAAC,MAAK,EAAA;QAAAiB,KAAA,EAAO;UAAC8xB,UAAA,EAAY;SAAO;QAAAxzB,QAAA,EAAA2hB,CAAA,CAAElgB,KAAS,IAAAkgB,CAAA,CAAEtT;MAAK,CAAA,CAAA;KAFtC,EAAA2R,CAGf,CACD;EACH,CAAA,CAAA;AAEJ;AChIA,SAASyT,YAAY7yB,KAAqE,EAAA;EAClF,MAAA;IAACwC,UAAY;IAAAuJ;EAAgB,CAAA,GAAA/L,KAAA;EACnC,MAAM;IAACmpB,UAAY,EAAA2J;EAAA,CAAqB,GAAApK,MAAAA,CAAAA,mBAAA,CAAoBlmB,YAAYuJ,YAAY,CAAA;EAEpF,MAAMod,UAAmC,GAAAjjB,KAAA,CAAAA,OAAA,CACvC,MACE4sB,iBAAA,CAAkBjxB,GAAI,CAACsO,IAAU,KAAA;IAC/BqiB,OAAOriB,IAAK,CAAAqiB,KAAA;IACZ5xB,OAAA,EAASuP,KAAKA,IAAK,CAAAvP,OAAA;IACnBurB,MAAMhc,IAAK,CAAAgc;EAAA,CACX,CAAA,CAAA,EACJ,CAAC2G,iBAAiB,CAAA,CACpB;EAEM,MAAAC,SAAA,GAAY5J,UAAW,CAAAnlB,IAAA,CAAKgvB,MAAiB,CAAAA,iBAAA,CAAA;EAC7C,MAAAC,WAAA,GAAc9J,UAAW,CAAAnlB,IAAA,CAAKkvB,MAAmB,CAAAA,mBAAA,CAAA;EAEjD,MAAA9qB,IAAA,GAAOlC,KAAAA,CAAAA,QAAQ,MAAM;IACrB,IAAA6sB,SAAA,EAAkB,OAAApB,sBAAA;IAClB,IAAAsB,WAAA,EAAoB,OAAAliB,wBAAA;IACjB,OAAAoiB,yBAAA;EAAA,CACN,EAAA,CAACJ,SAAW,EAAAE,WAAW,CAAC,CAAA;EAErB,MAAAprB,IAAA,GAAO3B,KAAAA,CAAAA,QAAQ,MAAM;IACrB,IAAA6sB,SAAA,EAAkB,OAAA,UAAA;IAClB,IAAAE,WAAA,EAAoB,OAAA,SAAA;IACjB,OAAA,UAAA;EAAA,CACN,EAAA,CAACF,SAAW,EAAAE,WAAW,CAAC,CAAA;EAEpB,OAAA;IACLnY,MAAA,EAAQqO,WAAWplB,MAAW,KAAA,CAAA;IAC9BqE,IAAA;IACAvH,KAAO,EAAA,YAAA;IACPgH,IAAA;IACAiY,YAAc,EAAA;EAAA,CAChB;AACF;AAEO,MAAMsT,mBAAyC,GAAA;EACpD3lB,IAAM,EAAAqhB,yBAAA;EACN1I,SAAW,EAAA2L,mBAAA;EACXc;AACF,CAAA;AC9CO,MAAMQ,eAAuD,GAAA;EAClEpH,MAAQ,EAAA,SAAA;EACR7G,MAAQ,EAAA,SAAA;EACRkO,YAAc,EAAA,iBAAA;EACdxG,OAAS,EAAA,SAAA;EACTyG,SAAW,EAAA,QAAA;EACXC,QAAU,EAAA,aAAA;EACVhL,OAAS,EAAA,WAAA;EACTyB,SAAW,EAAA;AACb,CAAA;AAEO,MAAMwJ,wBAAuE,GAAA;EAClFxH,MAAQ,EAAAyH,KAAA,CAAAA,aAAA;EACRtO,MAAQ,EAAAY,KAAA,CAAAA,SAAA;EACRsN,YAAc,EAAA5D,KAAA,CAAAA,SAAA;EACd5C,OAAS,EAAA4G,KAAA,CAAAA,aAAA;EACTH,SAAW,EAAArrB,KAAA,CAAAA,QAAA;EACXsrB,QAAU,EAAAtrB,KAAA,CAAAA,QAAA;EACVsgB,OAAS,EAAAxgB,KAAA,CAAAA,WAAA;EACTiiB,SAAW,EAAAC,KAAA,CAAAA;AACb,CAAA;AC1BO,SAASyJ,yBAAyBznB,IAAqC,EAAA;EAC5E,OAAOmnB,gBAAgBnnB,IAAI,CAAA;AAC7B;AAEO,SAAS0nB,8BAA8B1nB,IAA4C,EAAA;EACxF,OAAOunB,yBAAyBvnB,IAAI,CAAA;AACtC;ACDO,SAAS2nB,eAAgBA,CAAAC,MAAA,EAA4C;EAAA,IAA5C;IAACC,SAAW;IAAAC;GAAgC,GAAAF,MAAA;EAC1E,sBACGj0B,UAAA,CAAAA,GAAA,CAAAo0B,EAAA,CAAAA,WAAA,EAAA;IAAYF,SACV;IAAA30B,QAAA,EAAA40B,OAAA,CAAQnyB,IAAKqyB,MAAA,IACXr0B,eAAAA,UAAAA,CAAAA,GAAA,CAAAs0B,MAAAA,CAAAA,UAAA,EAAA;MAAwBC,MAAMF,MAAQ;MAAAG,WAAA,EAAW;IAAjC,CAAA,EAAAH,MAAkC,CACpD;EACH,CAAA,CAAA;AAEJ;;;;;;ACjBA,IAAApmB,IAAA,EAAAC,IAAA,EAAAC,IAAA,EAAAC,IAAA,EAAAC,EAAA,EAAA0N,EAAA,EAAA0Y,EAAA;AAOO,MAAMC,cAAcnmB,eAAAA,CAAAA,OAAO,CAAAgB,EAAAA,CAAAA,IAAI,EAAEolB,MAAA,IAA+B;EAAA,IAA9B;IAAC1lB;GAA6B,GAAA0lB,MAAA;EAPvE1mB,IAAAA,GAAAA;EAQQ,MAAA2mB,WAAA,GAAA,CAAc3mB,MAAAgB,KAAM,CAAAE,MAAA,CAAOjO,MAAM4b,IAAK,CAAA+X,QAAA,KAAxB,gBAAA5mB,GAAkC,CAAAvH,IAAA;EAE/C,OAAA6V,MAAA,CAAAA,GAAA,CAAAtO,IAAA,KAAAA,IAAA,GAAGO,2RAYmB,gHAAX,CAAA,CAAA,CAAA,EAAAomB,WAAA,CAAA;AAMpB,CAAC,CAAA;AAEM,MAAM/c,MAAO,GAAAtJ,eAAAA,CAAAA,OAAA,CAAOqE,EAAM,CAAAA,MAAA,CAAA,CAAEkiB,MAAA,IAM7B;EAAA,IAN8B;IAClCC,SAAA;IACAC;EACF,CAGM,GAAAF,MAAA;EACJ,OAAOvY,MAAAA,CAAAA,GAAG,CAAAnO,IAAA,KAAAA,IAAA,GAAAI,YAAA,CAAA,CAAA,2FAAA,EAKmB,iGAMD,EAAA,+CAAA,EASzB,YAKA,MApBe,CAAA,CAAA,CAAA,EAAAkmB,WAAA,EAMDA,WAIb,EAAAK,SAAA,IACFxY,UAAG,CAAArO,IAAA,KAAAA,IAAA,GAAAM,YAAA,CAAA,CAAA,UAAA,EACY,6DAAX,CAAA,CAAA,CAAA,EAAAkmB,WAAA,CAAA,EAKFM,aACFzY,MAAAA,CAAAA,GAAG,CAAApO,IAAA,KAAAA,IAAA,GAAAK,YAAA,CAAA,CAAA,oCAAA,CAAA,CAAA,CAAA,CAAA,CAAA;AAIP,CAAC,CAAA;AAEM,MAAMymB,OAAU,GAAA1mB,eAAAA,CAAAA,OAAA,CAAO5G,EAAG,CAAAA,GAAA,CAAA,CAAV0G,EAAW,KAAAA,EAAA,GAAAG,YAAA,CAAA,CAAA,uGAAA,CAAA,CAAA,CAAA,CAAA;AAO3B,MAAM0mB,UAAa,GAAA3mB,eAAAA,CAAAA,OAAA,CAAO1G,EAAI,CAAAA,IAAA,CAAA,CAAXkU,EAAY,KAAAA,EAAA,GAAAvN,YAAA,CAAA,CAAA,mCAAA,CAAA,CAAA,CAAA,CAAA;AAI/B,MAAM2mB,eAAe5mB,eAAAA,CAAAA,OAAO,CAAA5G,EAAG,CAAAA,GAAA,CAAV,CAAA8sB,EAAA,KAAAA,EAAA,GAAWjmB,uDAEuB,KAA7C,CAAA,CAAA,CAAA,EAAA4mB,MAAA;EAAA,IAAC;IAACnmB;;SAAW,GAAI,CAAA5L,MAAA,CAAA6L,EAAA,CAAAA,GAAA,CAAID,MAAME,MAAO,CAAA7F,KAAA,CAAM,CAAC,CAAC,CAAA,CAAA;AAAA,EAAA;ACvE3D,MAAM+rB,wBAA8E,GAAA;EAClFpI,OAAS,EAAA,SAAA;EACTb,MAAQ,EAAA,SAAA;EACRzD,OAAS,EAAA,UAAA;EACTgL,QAAU,EAAA,SAAA;EACVD,SAAW,EAAA,SAAA;EACXtJ,SAAW,EAAA,UAAA;EACXqJ,YAAc,EAAA,UAAA;EACdlO,MAAQ,EAAA,UAAA;EACR+P,eAAiB,EAAA;AACnB,CAAA;AAaO,SAASC,YAAaA,CAAAC,MAAA,EASP;EAAA,IATO;IAC3BtI,KAAA;IACAuI,OAAA;IACAlb,MAAA;IACAmb,QAAA;IACAC,UAAA;IACAC,QAAA;IACAC,SAAA;IACAxpB;EACF,CAAsB,GAAAmpB,MAAA;EACd,MAAAM,aAAA,GAAgB/B,8BAA8B1nB,IAAI,CAAA;EACxD,MAAM0pB,aAAgB,GAAAtvB,KAAA,CAAMC,IAAK,CAAAwmB,KAAA,CAAM8I,OAAO,CAAA;EAC9C,MAAMC,eAAe5pB,IAAS,KAAA,QAAA;EACxB,MAAA6pB,kBAAA,GAAqB7vB,KAAAA,CAAAA,QAAQ,MAAM;IACjC,MAAA8vB,UAAA,GAAa,IAAIC,IAAA,CAAKP,SAAS,CAAA;IAC/B,MAAAQ,aAAA,GAAgBC,OAAAA,CAAAA,MAAO,CAAAH,UAAA,EAAY,sBAAsB,CAAA;IAExD,OAAAE,aAAA;EAAA,CACT,EAAG,CAACR,SAAS,CAAC,CAAA;EAEd,MAAMpf,WAAc,GAAAhJ,KAAA,CAAAA,WAAA,CACjB8oB,GAA6C,IAAA;IAC5CA,GAAA,CAAIje,cAAe,CAAA,CAAA;IACnBie,GAAA,CAAIC,eAAgB,CAAA,CAAA;IAEpB,IAAIP,YAAc,EAAA;MAChBL,QAAA,CAAS1I,KAAK,CAAA;IAChB;EACF,CAAA,EACA,CAAC0I,QAAU,EAAA1I,KAAA,EAAO+I,YAAY,CAAA,CAChC;EAGE,sBAAAj2B,UAAA,CAAAA,GAAA,CAAC6X,MAAA,EAAA;IACCkd,SAAW,EAAAY,UAAA;IACXX,WAAW,CAACiB,YAAA;IACZ,iBAAe/I,KAAM,CAAA9oB,EAAA;IACrB,YAAA,EAAYqxB,UAAU,IAAO,GAAA,KAAA,CAAA;IAC7B,WAAA,EAAWlb,SAAS,IAAO,GAAA,KAAA,CAAA;IAC3B,SAAQ,EAAA,cAAA;IACR1H,IAAA,EAAM8iB,aAAa,SAAY,GAAA,OAAA;IAC/BvoB,OAAS,EAAAqJ,WAAA;IACT7O,OAAS,EAAA,CAAA;IACToG,MAAQ,EAAA,CAAA;IACRhG,IAAM,EAAA2tB,UAAA,GAAa,SAAY,GAAAN,wBAAA,CAAyBnI,MAAM7gB,IAAI,CAAA;IAElE9M,wCAACoI,MAAI,EAAA;MAAAsK,QAAA,EAAU;MACb1S,QAAC,EAAAuB,eAAAA,UAAAA,CAAAA,IAAA,CAAAyO,EAAAA,CAAAA,IAAA,EAAA;QAAKmC,OAAM,SACV;QAAAnS,QAAA,EAAA,CAAAS,eAAAA,UAAAA,CAAAA,GAAA,CAAC00B;UAAYhjB,KAAM,EAAA,QAAA;UACjBnS,QAAC,iBAAAS,UAAA,CAAAA,GAAA,CAAAi1B,OAAA,EAAA;YAAQrtB,SAAS,CAChB;YAAArI,QAAA,EAAA,eAAAS,cAAA,CAAC6H,EAAAA,CAAAA,IAAK,EAAA;cAAAC,IAAA,EAAM;cAAIvI,QAAiB,EAAAu2B,aAAA,IAAAlD,KAAA,CAAAA,aAAA,CAAckD,aAAa;YAAA,CAAE;UAChE,CAAA;SACF,CAAA,EAAA,eAECh1B,UAAA,CAAAA,IAAA,CAAAwQ,EAAA,CAAAA,KAAA,EAAA;UAAMhI,KAAO,EAAA,CAAA;UAAGkI,QAAQ,CACtB;UAAAjS,QAAA,EAAA,CAAAm2B,QAAA,kCACEnmB,OACC,EAAA;YAAAhQ,QAAA,EAAA,eAAAS,UAAA,CAAAA,GAAA,CAAC+Q,EAAA,CAAAA,IAAA,EAAA;cACCnJ,OAAS,EAAA,CAAA;cACToG,MAAQ,EAAA,CAAA;cACRoD,MAAQ,EAAA,CAAA;cACRpJ,IAAM,EAAA2tB,UAAA,GAAa,SAAY,GAAAN,wBAAA,CAAyBnI,MAAM7gB,IAAI,CAAA;cAElE9M,wCAAC2S,EAAM,CAAAA,KAAA,EAAA;gBAAAhK,KAAA,EAAK,IAAC;gBAAAJ,IAAA,EAAM;gBAAGvI,QAEtB,EAAA;eAAA;YAAA,CAAA;WAEJ,CAAA,EAAA,eAEDS,cAAA,CAAA2H,EAAAA,CAAAA,GAAA,EAAA;YACCpI,QAAC,iBAAAS,UAAA,CAAAA,GAAA,CAAAk1B,UAAA,EAAA;cAAWptB,MAAM,CAAG;cAAAqW,MAAA,EAAO,QACzB;cAAA5e,QAAA,EAAAu0B,wBAAA,CAAyBznB,IAAI,CAAK,IAAArM,eAAAA,UAAAA,CAAAA,GAAA,CAAC,MAAM,EAAA;gBAAAT,QAAA,EAAA8M;cAAA,CAAK;YACjD,CAAA;WACF,CAAA,EAAA,eACArM,UAAA,CAAAA,GAAA,CAACm1B,YAAa,EAAA;YAAAljB,QAAA,EAAU,CACtB;YAAA1S,QAAA,EAAAS,eAAAA,UAAAA,CAAAA,GAAA,CAAC6H,EAAK,CAAAA,IAAA,EAAA;cAAAC,IAAA,EAAM,CAAG;cAAAI,KAAA,EAAK,IACjB;cAAA3I,QAAA,EAAA22B;YACH,CAAA;WACF,CAAA;SACF,CAAA,EAAA,eACCl2B,UAAA,CAAAA,GAAA,CAAAuP,EAAA,CAAAA,IAAA,EAAA;UAAK0B,IAAM,EAAA,CAAA;UAAGsB,SAAQ,UAAW;UAAAb,KAAA,EAAM,QACtC;UAAAnS,QAAA,EAAA,eAAAS,UAAA,CAAAA,GAAA,CAACg0B,eAAgB,EAAA;YAAAE,SAAA,EAAW,CAAG;YAAAC,OAAA,EAAS4B;UAAe,CAAA;SACzD,CAAA;MAAA,CACF;IACF,CAAA;EAAA,CAAA,CACF;AAEJ;;;;;;ACtHA,IAAA9nB,IAAA,EAAAC,EAAA,EAAAC,EAAA,EAAAC,EAAA;AAGO,MAAMqoB,YAAe,GAAAloB,eAAAA,CAAAA,OAAA,CAAO+C,EAAK,CAAAA,KAAA,CAAA,CAAZrD,IAAa,KAAAA,IAAA,GAAAO,YAAA,CAAA,CAAA,yBAAA,CAAA,CAAA,CAAA,CAAA;AAIlC,MAAMkoB,WAAc,GAAAnoB,eAAAA,CAAAA,OAAA,CAAOgB,EAAI,CAAAA,IAAA,CAAA,CAAXrB,EAAY,KAAAA,EAAA,GAAAM,YAAA,CAAA,CAAA,6DAAA,CAAA,CAAA,CAAA,CAAA;AAKhC,MAAMqJ,SAAOtJ,eAAAA,CAAAA,OAAO,CAAA5G,EAAAA,CAAAA,GAAG,EAAEgvB,MAAA,IAAsC;EAAA,IAArC;IAACC;GAAoC,GAAAD,MAAA;EACpE,OAAOpa,MAAAA,CAAAA,GAAG,CAAAnO,EAAA,KAAAA,EAAA,GAAAI,YAAA,CAAA,CAAA,sDAAA,EAQP,MAJC,CAAA,CAAA,CAAA,EAAAooB,QAAA,IACFra,MAAG,CAAAA,GAAA,CAAApO,EAAA,KAAAA,EAAA,GAAAK,YAAA,CAAA,CAAA,wDAAA,CAAA,CAAA,CAAA,CAAA,CAAA;AAKP,CAAC,CAAA;ACPM,MAAMqoB,WAAWC,MAAA,IAQH;EAAA,IARI;IACvB9J,MAAA;IACA+J,wBAAA;IACAC,aAAA;IACAC,SAAA;IACAC,UAAA;IACAtB,QAAA;IACAuB;EACF,CAAqB,GAAAL,MAAA;EACnB,MAAM,CAACM,OAAA,EAASC,UAAU,CAAA,GAAI13B,eAAS,KAAK,CAAA;EAEtC,MAAA23B,cAAA,GAAiBjxB,KAAAA,CAAAA,QAAQ,MAAM;IAC5B,OAAA2mB,MAAA,CAAOjpB,MAAO,CAACwzB,CAAM,IAAA;MAC1B,IAAIR,4BAA4BI,UAAY,EAAA;QACnC,OAAAI,CAAA,CAAExtB,QAAQotB,UAAW,CAAAptB,KAAA;MAC9B;MACO,OAAA,IAAA;IAAA,CACR,CAAA;EACA,CAAA,EAAA,CAACijB,MAAQ,EAAA+J,wBAAA,EAA0BI,UAAU,CAAC,CAAA;EAEjD,MAAMK,aAAgB,GAAAnxB,KAAA,CAAAA,OAAA,CACpB,MAAA,CAAO4wB,SAAW,IAAA,IAAA,GAAA,KAAA,CAAA,GAAAA,SAAA,CAAA7yB,EAAA,IAAKkzB,cAAe,CAAAG,SAAA,CAAWF,CAAA,IAAMA,CAAE,CAAAnzB,EAAA,KAAO6yB,SAAU,CAAA7yB,EAAE,CAAI,GAAA,CAAA,CAAA,EAChF,CAAC6yB,SAAW,IAAA,IAAA,GAAA,KAAA,CAAA,GAAAA,SAAA,CAAA7yB,EAAA,EAAIkzB,cAAc,CAAA,CAChC;EAEA,MAAMI,UAAa,GAAAjqB,KAAA,CAAAA,WAAA,CACjB,CAACyf,KAAA,EAAAyK,MAAA,KAAyB;IAAA,IAAlB;MAACC;KAAiB,GAAAD,MAAA;IACxB,MAAMlC,UAAUmC,WAAgB,KAAA,CAAA;IAChC,MAAMrd,MAAU,GAAA+c,cAAA,IAAkBM,WAAgB,KAAAN,cAAA,CAAepzB,SAAS,CAAM,IAAA,KAAA;IAE9E,OAAA,eAAApD,UAAA,CAAAA,IAAA,CAAC6G,EAAI,CAAAA,GAAA,EAAA;MAAAqK,aAAA,EAAeuI,MAAS,GAAA,CAAA,GAAI,CAAG;MAAA6D,UAAA,EAAYqX,OAAU,GAAA,CAAA,GAAI,CAAG;MAAAxjB,QAAA,EAAU,CACzE;MAAA1S,QAAA,EAAA,CAAA,eAAAS,UAAA,CAAAA,GAAA,CAACu1B,YAAA,EAAA;QACCrI,KAAA;QACAuI,OAAA;QACAlb,MAAA;QACAmb,QAAA,EAAUkC,WAAgB,KAAA,CAAA,IAAK,CAACb,wBAAA;QAChCpB,YAAYiC,WAAgB,KAAAJ,aAAA;QAC5B5B,QAAA;QACAC,WAAW3I,KAAM,CAAA2K,YAAA;QACjBxrB,MAAM6gB,KAAM,CAAA7gB;MAAA,CACd,CAAA,EACCurB,gBAAgBN,cAAe,CAAApzB,MAAA,GAAS,CAAK,IAAA8yB,aAAA,kCAC3CznB,EAAK,CAAAA,IAAA,EAAA;QAAAmC,KAAA,EAAM,QAAS;QAAAa,OAAA,EAAQ;QAAS3K,OAAS,EAAA,CAAA;QAC7CrI,wCAAC6U,EAAQ,CAAAA,OAAA,EAAA;UAAAlM,KAAA,EAAK;QAAC,CAAA;OACjB,CAAA;IAEJ,CAAA,CAAA;EAEJ,CAAA,EACA,CAAC6uB,wBAAA,EAA0BO,cAAgB,EAAAN,aAAA,EAAepB,UAAU4B,aAAa,CAAA,CACnF;EAEA53B,KAAAA,CAAAA,SAAA,CAAU,MAAMy3B,UAAA,CAAW,IAAI,CAAA,EAAG,EAAE,CAAA;EAGlC,sBAAAv2B,UAAA,CAAAA,IAAA,CAAC+W,MAAA,EAAA;IASC+e,QAAA,EAAU,CAACY,aAAiB,IAAAJ,OAAA;IAC5B,SAAQ,EAAA,UAAA;IAEP73B,QAAA,EAAA,CAAA+3B,cAAA,CAAepzB,WAAW,CACzB,IAAApD,eAAAA,UAAAA,CAAAA,IAAA,CAAC21B;MAAa7uB,OAAS,EAAA,CAAA;MAAG0B,OAAO,CAC/B;MAAA/J,QAAA,EAAA,CAAA,eAAAS,cAAA,CAAC6H,EAAAA,CAAAA,IAAK,EAAA;QAAAC,IAAA,EAAM,CAAG;QAAAqW,MAAA,EAAO;QAAW5e,QAEjC,EAAA;OAAA,CAAA,EAAA,8BACCsI,EAAAA,CAAAA,IAAK,EAAA;QAAAK,KAAA,EAAK,IAAC;QAAAJ,IAAA,EAAM;QAAGvI,QAGrB,EAAA;OAAA,CAAA;KACF,CAAA,EAGD+3B,eAAepzB,MAAS,GAAA,CAAA,mBACtBlE,UAAA,CAAAA,GAAA,CAAA02B,WAAA,EAAA;MAAYrlB,WAAU,QACrB;MAAA9R,QAAA,iBAAAS,UAAA,CAAAA,GAAA,CAAC83B,MAAA,CAAAA,WAAA,EAAA;QACCC,kBAAmB,EAAA,cAAA;QACnBC,SAAU,EAAA,oBAAA;QACVC,SAAU,EAAA,MAAA;QACVC,YAAc,EAAAV,aAAA;QACdW,kBAAmB,EAAA,QAAA;QACnBC,UAAY,EAAA,EAAA;QACZC,KAAO,EAAAf,cAAA;QACPgB,YAAc,EAAApB,UAAA;QACdqB,uBAAyB,EAAA,EAAA;QACzBC,QAAU,EAAA,CAAA;QACVd,UAAA;QACAe,UAAY,EAAA;MAAA,CAAA;KAEhB,CAAA;EAAA,CAAA,CAEJ;AAEJ,CAAA;AAEA5B,QAAA,CAASnb,WAAc,GAAA,UAAA;AChHhB,SAASgd,aAAgBA,CAAA,EAAA;EAC9B,sCACGnpB,OAAK,EAAA;IAAAmC,KAAA,EAAM;IAAaY,GAAK,EAAA,CAAA;IAAG1K,SAAS,CACxC;IAAArI,QAAA,EAAA,CAAA,eAAAS,cAAA,CAAC+H,MAAAA,CAAAA,YAAa,EAAA;MAAAC,IAAA,EAAK,UACjB;MAAAzI,QAAA,EAAA,eAAAS,cAAA,CAAC8xB,KAAAA,CAAAA,mBAAiB,CAAA;KACpB,CAAA,EACAhxB,eAAAA,UAAAA,CAAAA,IAAA,CAACwQ,EAAAA,CAAAA,KAAM,EAAA;MAAAhI,KAAA,EAAO,CACZ;MAAA/J,QAAA,EAAA,CAAAS,eAAAA,UAAAA,CAAAA,GAAA,CAAC+H;QAAaD,IAAM,EAAA,CAAA;QAAGE,MAAK,UAAW;QAAAmW,MAAA,EAAO;QAAW5e,QAEzD,EAAA;MAAA,CAAA,CAAA,EAAA,8BACCwI,MAAAA,CAAAA,YAAa,EAAA;QAAAD,IAAA,EAAM,CAAG;QAAAE,IAAA,EAAK;QAAWzI,QAEvC,EAAA;OAAA,CAAA;KACF,CAAA;EACF,CAAA,CAAA;AAEJ;;;;;;ACrBA,IAAA0O,IAAA;AAkBA,MAAM4J,IAAO,GAAAtJ,eAAAA,CAAAA,OAAA,CAAOoqB,EAAO,CAAAA,OAAA,CAAA,CAAd1qB,IAAe,KAAAA,IAAA,GAAAO,YAAA,CAAA,CAAA,4CAAA,CAAA,CAAA,CAAA,CAAA;AAKrB,SAASoqB,YAAaA,CAAAC,MAAA,EAA6C;EAAA,IAA7C;IAAC3L,KAAO;IAAAra,IAAA;IAAMnD;GAA+B,GAAAmpB,MAAA;EAClE,MAAA;IAACC;IAAkBC,eAAiB;IAAAC,aAAA;IAAev5B;IAAOw5B,aAAe;IAAAC;MAC7EpU,eAAgB,EAAA;EAClB,MAAM,CAACqU,IAAA,EAAMC,OAAO,CAAA,GAAIz5B,eAAS,KAAK,CAAA;EACtC,MAAM,CAACwX,MAAA,EAAQkiB,SAAS,CAAA,GAAI15B,eAAmC,IAAI,CAAA;EACnE,MAAM,CAAC4V,OAAA,EAAS+jB,UAAU,CAAA,GAAI35B,eAA6B,IAAI,CAAA;EAC/D,MAAMwQ,QAAQC,EAAAA,CAAAA,QAAS,EAAA;EAEvB,MAAM4c,SAASuM,MAAAA,CAAAA,mBAAoB,CAAAN,aAAA,EAAgBxtB,KAAA,IAAUA,MAAMuhB,MAAM,CAAA;EACzE,MAAM7P,UAAUoc,MAAAA,CAAAA,mBAAoB,CAAAN,aAAA,EAAgBxtB,KAAA,IAAUA,MAAMtE,SAAS,CAAA;EAC7E,MAAM6vB,gBAAgBuC,MAAAA,CAAAA,mBAAoB,CAAAN,aAAA,EAAgBxtB,KAAA,IAAUA,MAAMurB,aAAa,CAAA;EACvF,MAAMwC,eAAeD,MAAAA,CAAAA,mBAAoB,CAAAN,aAAA,EAAgBxtB,KAAA,IAAUA,MAAM+tB,YAAY,CAAA;EACrF,MAAMC,YAAYF,MAAAA,CAAAA,mBAAoB,CAAAN,aAAA,EAAgBxtB,KAAA,IAAUA,MAAMguB,SAAS,CAAA;EAEzE,MAAApH,UAAA,GAAa5kB,KAAAA,CAAAA,YAAY,MAAM;IACnCsrB,eAAA,CAAgBlmB,IAAI,CAAA;IACpBumB,OAAA,CAAQ,IAAI,CAAA;EAAA,CACX,EAAA,CAACvmB,IAAM,EAAAkmB,eAAe,CAAC,CAAA;EAEpB,MAAAW,WAAA,GAAcjsB,KAAAA,CAAAA,YAAY,MAAM;IACpCsrB,eAAA,CAAgB,QAAQ,CAAA;IACxBK,OAAA,CAAQ,KAAK,CAAA;EAAA,CACf,EAAG,CAACL,eAAe,CAAC,CAAA;EAEd,MAAAY,kBAAA,GAAqBlsB,KAAAA,CAAAA,YAAY,MAAM;IAC3C,IAAI0rB,IAAM,EAAA;MACIO,WAAA,EAAA;IACd;EAAA,CACC,EAAA,CAACA,WAAa,EAAAP,IAAI,CAAC,CAAA;EAEtB,MAAMS,mBAAsB,GAAAnsB,KAAA,CAAAA,WAAA,CACzBiJ,KAAyB,IAAA;IACxB,IAAIyiB,SAASziB,KAAM,CAAArB,GAAA,KAAQ,QAAY,IAAAqB,KAAA,CAAMrB,QAAQ,KAAQ,CAAA,EAAA;MAC/CqkB,WAAA,EAAA;MACJviB,MAAA,IAAA,IAAA,GAAA,KAAA,CAAA,GAAAA,MAAA,CAAA0iB,KAAA,CAAA,CAAA;IACV;EACF,CAAA,EACA,CAAC1iB,MAAQ,EAAAuiB,WAAA,EAAaP,IAAI,CAAA,CAC5B;EAEAW,EAAAA,CAAAA,eAAA,CAAgBH,kBAAoB,EAAA,CAACxiB,MAAQ,EAAA5B,OAAO,CAAC,CAAA;EACrDwkB,EAAA,CAAAA,gBAAA,CAAiBH,mBAAmB,CAAA;EAEpC,MAAMI,SAAY,GAAAvsB,KAAA,CAAAA,WAAA,CACfwsB,QAAoB,IAAA;IACf,IAAA;MACF,MAAM,CAACC,OAAS,EAAAC,KAAK,CAAI,GAAAlB,aAAA,CAAcmB,gBAAgBH,QAAQ,CAAA;MAC/DlB,eAAA,CAAgB,QAAQ,CAAA;MACxBD,gBAAA,CAAiBoB,SAASC,KAAK,CAAA;aACxB1O,GAAK,EAAA;MACZtb,KAAA,CAAMwC,IAAK,CAAA;QACT0nB,QAAU,EAAA,IAAA;QACV3V,aAAa+G,GAAI,CAAA1qB,OAAA;QACjBqI,MAAQ,EAAA,OAAA;QACRpI,KAAO,EAAA;MAAA,CACR,CAAA;IACH;EACF,CAAA,EACA,CAAC+3B,eAAA,EAAiBD,gBAAkB,EAAAG,aAAA,EAAe9oB,KAAK,CAAA,CAC1D;EAEA,MAAMmqB,WAAc,GAAA7sB,KAAA,CAAAA,WAAA,CACjB8sB,UAAsB,IAAA;IACjB,IAAA;MACF,MAAM,CAACL,OAAS,EAAAC,KAAK,CAAI,GAAAlB,aAAA,CAAcuB,kBAAkBD,UAAU,CAAA;MACnExB,eAAA,CAAgB,QAAQ,CAAA;MACxBD,gBAAA,CAAiBoB,SAASC,KAAK,CAAA;aACxB1O,GAAK,EAAA;MACZtb,KAAA,CAAMwC,IAAK,CAAA;QACT0nB,QAAU,EAAA,IAAA;QACV3V,aAAa+G,GAAI,CAAA1qB,OAAA;QACjBqI,MAAQ,EAAA,OAAA;QACRpI,KAAO,EAAA;MAAA,CACR,CAAA;IACH;EACF,CAAA,EACA,CAAC+3B,eAAA,EAAiBD,gBAAkB,EAAAG,aAAA,EAAe9oB,KAAK,CAAA,CAC1D;EAEM,MAAAsqB,cAAA,GAAiBhtB,KAAAA,CAAAA,YAAY,MAAM;IACvC,IAAI,CAAC0P,OAAS,EAAA;MACZ8b,aAAA,CAAcyB,QAAS,CAAA,CAAA;IACzB;EAAA,CACC,EAAA,CAACvd,OAAS,EAAA8b,aAAa,CAAC,CAAA;EAE3B,MAAMvxB,OAAU,GAAAsxB,aAAA,GACbh5B,eAAAA,UAAAA,CAAAA,GAAA,CAAA04B,aAAA,EAAA,CAAc,CAAA,mBAGZ53B,UAAA,CAAAA,IAAA,CAAAb,mBAAA,EAAA;IAAAV,QAAA,EAAA,CAAAsT,IAAA,KAAS,KACR,IAAA,eAAA7S,UAAA,CAAAA,GAAA,CAAC62B,QAAA,EAAA;MACC7J,MAAA;MACAmK,UAAY,EAAAqC,YAAA;MACZxC,aAAA;MACAC,SAAW,EAAAuC,YAAA;MACXtC,UAAY,EAAAuD,cAAA;MACZ7E,QAAU,EAAAoE;IAAA,CACZ,CAAA,EAEDnnB,SAAS,OACR,IAAA,eAAA7S,UAAA,CAAAA,GAAA,CAAC62B,QAAA,EAAA;MACC7J,MAAA;MACA+J,wBAAwB,EAAA,IAAA;MACxBI,UAAY,EAAAqC,YAAA;MACZxC,aAAA;MACAC,SAAW,EAAAwC,SAAA;MACXvC,UAAY,EAAAuD,cAAA;MACZ7E,QAAU,EAAA0E;IAAA,CACZ,CAAA;EAEJ,CAAA,CAAA;EAGF,MAAMK,SAAY,GAAAC,qBAAA,CAAA,CAAsB1N,KAAO,IAAA,IAAA,GAAA,KAAA,CAAA,GAAAA,KAAA,CAAA2K,YAAA,KAAgB,EAAE,CAAA;EAE3D,MAAAgD,QAAA,GAAW3N,KACb,GAAA,EAAA,CAAG7pB,MAAW,CAAAy3B,mBAAAA,CAAAA,OAAA,CAAAhH,wBAAA,CAAyB5G,MAAM7gB,IAAI,CAAC,CAAC,EAAA,IAAA,CAAA,CAAKhJ,MACxD,CAAAs3B,SAAA,CAAA,GAAA,gBAAA;EAEE,MAAAI,UAAA,GAAa7N,KAAQ,GAAA,SAAA,CAAU7pB,MAAc,CAAAs3B,SAAA,CAAA,GAAA,wBAAA;EAE7C,MAAAK,WAAA,GAAcnoB,IAAS,KAAA,KAAA,GAAQgoB,QAAW,GAAAE,UAAA;EAG9C,sBAAA/6B,UAAA,CAAAA,GAAA,CAAC6X,IAAA,EAAA;IACCjD,aAAa,EAAA,IAAA;IACblN,SAASyxB,IAAQ,IAAAzxB,OAAA;IACjB,SAAQ,EAAA,aAAA;IACRyxB,IAAA;IACAzpB,SAAA;IACAjI,MAAM,EAAA,IAAA;IACN4D,GAAK,EAAAiuB,UAAA;IAEL/5B,QAAA,iBAAAS,UAAA,CAAAA,GAAA,CAAC4S,EAAA,CAAAA,MAAA,EAAA;MACCkC,UAAU,CAACrV,KAAA;MACXoT,IAAK,EAAA,OAAA;MACLE,QAAU,EAAA,CAAA;MACVnL,OAAS,EAAA,CAAA;MACTsO,SAAW,EAAA+kB,KAAA,CAAAA,UAAA;MACX7tB,OAAA,EAAS+rB,OAAOO,WAAc,GAAArH,UAAA;MAC9BhnB,GAAK,EAAAguB,SAAA;MACLljB,QAAU,EAAAgjB,IAAA;MACVl4B,KAAA,EAAO;QAACsY,QAAA,EAAU;MAAM,CAAA;MACxB9G,IAAA,EAAMhT,QAAQu7B,WAAc,GAAA;IAAA,CAC9B;EAAA,CAAA,CACF;AAEJ;AAEO,SAASJ,sBAAsBv5B,IAAsB,EAAA;EACpD,MAAA65B,SAAA,GAAY70B,KAAAA,CAAAA,QAAQ,MAAM;IAC9B,MAAM8vB,aAAa90B,IAAO,GAAA,IAAI+0B,KAAK/0B,IAAI,CAAA,GAAA,mBAAQ+0B,IAAK,EAAA;IAC9C,MAAAC,aAAA,GAAgBC,OAAAA,CAAAA,MAAO,CAAAH,UAAA,EAAY,sBAAsB,CAAA;IACxD,OAAAE,aAAA;EAAA,CACT,EAAG,CAACh1B,IAAI,CAAC,CAAA;EAEF,OAAA65B,SAAA;AACT;AChLO,SAASC,cAAiBA,CAAA,EAAA;EAC/B,sBACGn7B,UAAA,CAAAA,GAAA,CAAAX,KAAA,EAAA;IAAMG,EAAI,EAAA,GAAA;IACTD,yCAACgQ,EAAK,CAAAA,IAAA,EAAA;MAAAmC,KAAA,EAAM,QAAS;MAAAL,SAAA,EAAU;MAASmK,MAAO,EAAA,MAAA;MAAOjJ,OAAQ,EAAA,QAAA;MAAS6L,YAAY,CACjF;MAAA7e,QAAA,EAAA,CAACS,eAAAA,UAAAA,CAAAA,GAAA,CAAAoU,EAAA,CAAAA,OAAA,EAAA;QAAQlM,OAAK;MAAC,CAAA,CAAA,EAAA,eACdlI,UAAA,CAAAA,GAAA,CAAA2H,EAAA,CAAAA,GAAA,EAAA;QAAI0M,SAAW,EAAA,CAAA;QACd9U,QAAC,EAAAS,eAAAA,UAAAA,CAAAA,GAAA,CAAA6H,EAAAA,CAAAA,IAAA,EAAA;UAAK6J,KAAM,EAAA,QAAA;UAASxJ,KAAK,EAAA,IAAA;UAACJ,IAAM,EAAA,CAAA;UAAGvI;QAEpC,CAAA;OACF,CAAA;IACF,CAAA;EACF,CAAA,CAAA;AAEJ;ACfO,SAAS67B,+BAA+BC,IAAiC,EAAA;EACxE,MAAAC,SAAA,GAAA,mBAAgBC,GAA+B,EAAA;EAC3CC,gBAAA,CAAAH,IAAA,EAAOlmB,KAAU,IAAA;IACrB,IAAAA,KAAA,CAAMlF,WAAW,WAAe,IAAA,EAAE,gBAAgBkF,KAAU,CAAA,IAAA,CAACA,MAAMsmB,UAAY,EAAA;MAC1E,OAAA,IAAA;IACT;IAEA,MAAM;MAACC,MAAA;MAAQ7F;KAAS,GAAI1gB,KAAM,CAAAsmB,UAAA;IAC5B,MAAAE,QAAA,GAAWL,SAAU,CAAA76B,GAAA,CAAIi7B,MAAM,CAAA;IACrC,IAAI,CAACC,QAAA,IAAYA,QAAS,CAAA9F,SAAA,GAAYA,SAAW,EAAA;MACrCyF,SAAA,CAAAM,GAAA,CAAIF,MAAQ,EAAAvmB,KAAA,CAAMsmB,UAAU,CAAA;IACxC;IAEO,OAAA,IAAA;EAAA,CACR,CAAA;EAED,OAAOh1B,KAAM,CAAAC,IAAA,CAAK40B,SAAU,CAAA1J,MAAA,CAAQ,CAAA,CAAE,CAAA7qB,IAAA,CAAK,CAACyY,CAAA,EAAGqc,MAAOrc,CAAE,CAAAqW,SAAA,GAAYgG,CAAE,CAAAhG,SAAA,GAAY,IAAI,CAAG,CAAA,CAAA;AAC3F;;;;;;ACnBA,IAAA5nB,EAAA;AAuBA,MAAM6tB,QAAW,GAAAvtB,eAAAA,CAAAA,OAAA,CAAOwtB,MAAe,CAAAA,eAAA,CAAA,CAAtB9tB,EAAuB,KAAAA,EAAA,GAAAO,UAAA,CAAA,CAAA,2FAAA,CAAA,CAAA,CAAA,CAAA;AAOjC,SAASwtB,iBAAiB77B,KAA6C,EAAA;EACtE,MAAA;IAAC+T;EAAW,CAAA,GAAA/T,KAAA;EAClB,MAAM;IAACwC,UAAY;IAAAnC,UAAA;IAAYw4B;IAAeC,aAAe;IAAAr4B;EAAA,IAASkkB,eAAgB,EAAA;EAChF,MAAAmX,SAAA,GAAYnU,aAA8B,IAAI,CAAA;EAGpD,MAAMuT,OAAO9B,MAAAA,CAAAA,mBAAoB,CAAAN,aAAA,EAAgBxtB,KAAA,IAAUA,MAAM4vB,IAAI,CAAA;EACrE,MAAMa,kBAAkB3C,MAAAA,CAAAA,mBAAoB,CAAAN,aAAA,EAAgBxtB,KAAA,IAAUA,MAAMywB,eAAe,CAAA;EAC3F,MAAMC,iBAAiB5C,MAAAA,CAAAA,mBAAoB,CAAAN,aAAA,EAAgBxtB,KAAA,IAAUA,MAAM0wB,cAAc,CAAA;EACzF,MAAM1C,YAAYF,MAAAA,CAAAA,mBAAoB,CAAAN,aAAA,EAAgBxtB,KAAA,IAAUA,MAAMguB,SAAS,CAAA;EAC/E,MAAMtc,UAAUgf,cAAmB,KAAA,SAAA;EACnC,MAAMC,qBAAqB,CAACF,eAAA;EAE5B,MAAMG,kBAAiDC,cAAAA,CAAAA,OAAM,CAAAj2B,OAAA,CAC3D,OAAO;IACL1D,UAAA;IACAnC,UAAA;IACA+7B,YAAc,EAAAC,MAAA,CAAAA,kBAAA;IACdC,QAAU,EAAApB,IAAA;IACVe,kBAAA;IACAx7B;EAAA,CACF,CAAA,EACA,CAAC+B,UAAA,EAAY04B,IAAM,EAAAe,kBAAA,EAAoB57B,YAAYI,KAAK,CAAA,CAC1D;EAEA,MAAM87B,oBAAoBJ,cAAAA,CAAAA,OAAM,CAAAj2B,OAAA,CAC9B,MAAOg1B,IAAA,GAAOD,8BAA+B,CAAAC,IAAI,IAAI,EAAC,EACtD,CAACA,IAAI,CAAA,CACP;EAGE,OAAA,eAAAv6B,eAAA,CAACyO,EAAAA,CAAAA;IAAK,aAAY,EAAA,qBAAA;IAAsB8B,WAAU,QAAS;IAAAmK,MAAA,EAAO,MAAO;IAAAzJ,QAAA,EAAS,QAChF;IAAAxS,QAAA,EAAA,CAAA,eAAAS,UAAA,CAAAA,GAAA,CAAC2vB,uBAAA,EAAA;MACC5hB,EAAG,EAAA,QAAA;MACH6hB,gBAAiB,EAAA,sBAAA;MACjB3e,IAAK,EAAA,MAAA;MACLiD,OAAA;MACAlT,KAAM,EAAA,gBAAA;MAENzB,QAAA,EAAAuB,eAAAA,UAAAA,CAAAA,IAAA,CAACyO,EAAAA,CAAAA;QAAK+C,GAAK,EAAA,CAAA;QAAG1K,SAAS,CAAG;QAAAwW,UAAA,EAAY,CAAG;QAAApM,aAAA,EAAe,CACtD;QAAAzS,QAAA,EAAA,CAAA,eAACS,UAAA,CAAAA,GAAA,CAAA2H,EAAA,CAAAA,GAAA,EAAA;UAAIsJ,IAAM,EAAA,CAAA;UACT1R,QAAC,EAAAS,eAAAA,UAAAA,CAAAA,GAAA,CAAA44B,YAAA,EAAA;YAAa/lB,IAAK,EAAA,OAAA;YAAQqa,KAAO,EAAAuM,SAAA;YAAW/pB,SAAU,EAAA;UAAe,CAAA;SACxE,CAAA,EAAA,eAEC1P,UAAA,CAAAA,GAAA,CAAA2H,EAAA,CAAAA,GAAA,EAAA;UAAIsJ,IAAK,EAAA,MAAA;UACR1R,wCAACo9B,MAAAA,CAAAA,WAAY,EAAA;YAAAC,WAAA,EAAaF,iBAAmB;YAAAhY,WAAA,EAAY,YAAa;YAAAjd,MAAA,EAAM,IAC1E;YAAAlI,QAAA,EAAAS,eAAAA,UAAAA,CAAAA,GAAA,CAACo0B,EAAAA,CAAAA;cAAYF,SAAW,EAAA,CAAA;cAAG,YAAW,EAAA,YAAA;cACnC30B,QAAkB,EAAAm9B,iBAAA,CAAA16B,GAAA,CAAI66B,MAAA;gBAAA,IAAC;kBAACnB;iBACvB,GAAAmB,MAAA;gBAAA,OAAA78B,eAAAA,UAAAA,CAAAA,GAAA,CAACs0B,MAAAA,CAAAA,UAAwB,EAAA;kBAAAC,IAAA,EAAMmH;gBAAd,CAAA,EAAAA,MAAsB,CACxC;cAAA;YACH,CAAA;UACF,CAAA;SACF,CAAA;OACF;IAAA,CACF,CAAA,EAEA17B,eAAAA,UAAAA,CAAAA,GAAA,CAAC+Q,EAAAA,CAAAA;MAAKE,IAAM,EAAA,CAAA;MACV1R,wCAACgc,EAAwB,CAAAA,uBAAA,EAAA;QAAAtD,OAAA,EAASgkB,UAAUphB,OAC1C;QAAAtb,QAAA,EAAAS,eAAAA,UAAAA,CAAAA,GAAA,CAAC87B;UAAS,SAAQ,EAAA,UAAA;UAAWzwB,KAAK4wB,SAChC;UAAA18B,QAAA,EAAA,eAAAS,UAAA,CAAAA,GAAA,CAAC2H;YAAIsJ,IAAM,EAAA,CAAA;YAAGrJ,SAAS,CACrB;YAAArI,QAAA,EAAA,eAAAS,UAAA,CAAAA,GAAA,CAAC88B,OAAA,EAAA;cACCzB,IAAA;cACAgB,eAAA;cACA17B,KAAO,EAAAq4B,aAAA;cACP7b,OAAA;cACA3c;YAAA,CAAA;WAEJ;QACF,CAAA;MACF,CAAA;KACF,CAAA;EACF,CAAA,CAAA;AAEJ;AAEA,SAASs8B,OAAQA,CAAAC,MAAA,EAYd;EAAA,IAZc;IACfp8B,KAAA;IACA06B,IAAA;IACAgB,eAAA;IACAlf,OAAA;IACA3c;EACF,CAMG,GAAAu8B,MAAA;EACD,IAAIp8B,KAAO,EAAA;IACT,qCAAQq8B,gBAAU,EAAA,CAAA,CAAA,CAAA;EACpB;EAEA,IAAI7f,OAAS,EAAA;IACX,qCAAQge,cAAe,EAAA,CAAA,CAAA,CAAA;EACzB;EAEA,IAAI,CAACE,IAAM,EAAA;IACT,qCAAQ2B,gBAAU,EAAA,CAAA,CAAA,CAAA;EACpB;EAGE,OAAA,eAAAh9B,UAAA,CAAAA,GAAA,CAACi9B,MAAsB,CAAAA,qBAAA,CAAA3hB,QAAA,EAAtB;IAA+B1a,KAAA,EAAOy7B;IACrC98B,QAAC,iBAAAS,UAAA,CAAAA,GAAA,CAAAk9B,MAAA,CAAAA,UAAA,EAAA;MAAW7B,IAAY;MAAA76B;IAAwB,CAAA;EAClD,CAAA,CAAA;AAEJ;ACjIO,MAAM28B,gBAAsC,GAAA;EACjDvvB,IAAM,EAAAohB,sBAAA;EACNgE,aAAaA,CAAA,KAAM;IACX,MAAA;MAACoK;KAAQ,GAAIrN,WAAY,EAAA;IAExB,OAAA;MACL9U,MAAA,EAAQ,CAACmiB,QAAS,CAAAC,aAAA;MAClB90B,IAAM,EAAA2f,KAAA,CAAAA,WAAA;MACNlnB,KAAO,EAAA;IAAA,CACT;EACF,CAAA;EACAulB,SAAW,EAAAyV,gBAAA;EACX9nB,OAAS,EAAAopB,MAAA;IAAA,IAAC;MAACnzB;IAAa,CAAA,GAAAmzB,MAAA;IAAA,OAAA;MAACnzB,MAAQ,EAAA;QAAC,GAAGA,MAAA;QAAQozB,KAAO,EAAA,KAAA;MAAA;KAAU;EAAA,CAAA;EAC9D/K,MAAQ,EAAAgL,MAAA;IAAA,IAAC;MAACrzB;IAAA,CAAa,GAAAqzB,MAAA;IAAA,OAAA;MAACrzB,MAAQ,EAAA;QAAC,GAAGA,MAAA;QAAQozB,KAAO,EAAA;MAAA;KAAiB;EAAA;AACtE,CAAA;ACFA,MAAME,eAAkB,GAAA,CACtBjV,aAAA,EACA0B,eAAA,EACAxD,oBAAA,EACAM,eAAA,EACA9B,YAAA,EACAsC,oBAAA,CACF;AAEA,MAAMkW,cAAA,GAAiB,CAACpT,aAAa,CAAA;AAErC,MAAMqT,UAAA,GAAa,CAACpK,mBAAA,EAAqB4J,gBAAgB,CAAA;AAgD5C,MAAAnN,QAAA,GAAW4N,MAAAA,CAAAA,YAAqC,CAACvS,OAAa,KAAA;EACzEzd,IAAM,EAAA,mBAAA;EACNxN,QAAU,EAAA;IACR4c,OAAA,EAAU6gB,WAAgB,IAAA;MAGjB,OAAAp3B,KAAA,CAAMC,IAAK,EAAA,eAAA,IAAIC,GAAI,CAAA,CAAC,GAAGk3B,WAAa,EAAA,GAAGJ,eAAe,CAAC,CAAC,CAAA;IACjE,CAAA;IACAK,MAAA,EAASC,UAAe,IAAA;MAGf,OAAAt3B,KAAA,CAAMC,IAAK,EAAA,eAAA,IAAIC,GAAI,CAAA,CAAC,GAAGo3B,UAAY,EAAA,GAAGL,cAAc,CAAC,CAAC,CAAA;IAC/D,CAAA;IACAC,UAAA,EAAaK,cAAmB,IAAA;MAGvB,OAAAv3B,KAAA,CAAMC,IAAK,EAAA,eAAA,IAAIC,GAAI,CAAA,CAAC,GAAGq3B,cAAgB,EAAA,GAAGL,UAAU,CAAC,CAAC,CAAA;IAC/D;EACF,CAAA;EACAM,KAAO,EAAA,CACL;IACErwB,IAAA,EAAA,CAAMyd,mCAASzd,IAAQ,KAAA,MAAA;IACvB5M,KAAA,EAAA,CAAOqqB,mCAASrqB,KAAS,KAAA,MAAA;IACzBuH,IAAA,EAAA,CAAM8iB,mCAAS9iB,IAAQ,KAAA21B,KAAA,CAAAA,gBAAA;IACvB3X,SAAW,EAAA4X,KAAA,CAAAA,IAAA,CAAK,MAAMC,OAAO,CAAAC,OAAA,CAAA,CAAA,CAAAC,IAAA,CAAA,YAAA;MAAA,OAAAC,OAAA,CAAA,qBAAuB;;;MAAC,CAAA;IACrDrT,eAAA,EAAiBA,CAACzV,MAAA,EAAQtL,MAAW,KAAA;MAC5B,OAAArD,OAAA,CACJ2O,MAAA,KAAW,MAAU,IAAAtL,MAAA,CAAO/F,EAC1B,IAAAqR,MAAA,KAAW,YAAYtL,MAAO,CAAAkC,IAAA,IAC9BoJ,MAAW,KAAA,QAAA,IAAYtL,MAAO,CAAAiC,QAAA,CACnC;IACF,CAAA;IAAA;IAEAoyB,qBAAuB,EAAA,IAAA;IACvB1T,cAAA;IACAO,OAAA;IACAa;EACF,CAAA;AAEJ,CAAE,CAAA,CAAA;ACtGF,SAASuS,iBAAkBA,CAAAC,MAAA,EAKY;EAAA,IALZ;IACzBC,gBAAA;IACAC,QAAA;IACAjB,UAAA;IACAkB;EACF,CAAuC,GAAAH,MAAA;EACrC,OAAOf,UACJ,CAAA37B,GAAA,CAAI,CAAC88B,SAAA,EAAW/0B,KAAU,KAAA;IArB/B,IAAAkE,EAAA;IAsBY,MAAA8wB,QAAA,GAAWF,mBAAmB90B,KAAK,CAAA;IAErC,IAAA,CAACg1B,YAAYA,QAAS,CAAA9jB,MAAA,EAAe,OAAA,IAAA;IAElC,OAAA;MACLhL,MAAA,EAAQ,EAAG,CAAA5M,MAAA,CAAAyrB,qBAAA,CAAA,CAAwBzrB,MAAU,CAAAy7B,SAAA,CAAAlxB,IAAA,CAAA;MAC7CgS,KAAA,EAAOmf,QAAS,CAAA9e,YAAA,GAAe,KAAY,CAAA,GAAA,YAAA;MAC3C1X,MAAMw2B,QAAS,CAAAx2B,IAAA;MACfy2B,YAAY,CAACJ,QAAA;MACbzoB,QAAA,EAAA,CAAUwoB,gBAAkB,IAAA,IAAA,GAAA,KAAA,CAAA,GAAAA,gBAAA,CAAA/wB,IAAA,MAASkxB,SAAU,CAAAlxB,IAAA;MAC/CmS,QAAU,EAAA,CAAA9R,EAAA,GAAA8wB,QAAA,CAAShpB,OAAT,KAAA,IAAA,GAAA,KAAA,CAAA,GAAA9H,EAAA,CAAkB6C,IAAK,CAAA,GAAA,CAAA;MACjCmP,cAAc8e,QAAS,CAAA9e,YAAA;MACvBjf,OAAO+9B,QAAS,CAAA/9B,KAAA;MAChBgH,MAAM+2B,QAAS,CAAA/2B;IAAA,CACjB;EAAA,CACD,CACA,CAAAjE,MAAA,CAAO+C,OAAO,CAAA;AACnB;AAEA,SAASm4B,cAAAA,CAAAC,MAAA,EAA6D;EAAA,IAA9C;IAACN;GAA6C,GAAAM,MAAA;EAC7D,OAAA;IACLjvB,MAAQ,EAAA,SAAA;IACR2P,KAAO,EAAA,YAAA;IACP5e,KAAO,EAAA,SAAA;IACPuH,IAAM,EAAA42B,KAAA,CAAAA,kBAAA;IACNH,YAAY,CAACJ,QAAA;IACb7e,QAAU,EAAA;EAAA,CACZ;AACF;AAEgB,SAAAqf,wBAAAA,CAAAC,MAAA,EAAgF;EAAA,IAAvD;IAACC;GAAsD,GAAAD,MAAA;EAC9F,IAAI,CAACC,UAAA,EAAmB,OAAA,IAAA;EAEjB,OAAA;IACLrvB,MAAQ,EAAA,oBAAA;IACR2P,KAAO,EAAA,OAAA;IACP5e,KAAO,EAAA,cAAA;IACPuH,IAAM,EAAAg3B,KAAA,CAAAA,iBAAA;IACNxf,QAAU,EAAA;EAAA,CACZ;AACF;AAEO,SAASyf,aAAar1B,MAA4C,EAAA;EACjE,MAAAs1B,cAAA,GAAiBhB,kBAAkBt0B,MAAM,CAAA;EAC/C,MAAMkuB,KAAQ,GAAA;EAAA;EAEZ+G,yBAAyBj1B,MAAM,CAAA,CACjC,CAAEpG,OAAO+C,OAAO,CAAA;EAET,OAAA,CACL,GAAG24B,cAAA;EAAA;EAGHR,eAAe90B,MAAM,CAAA,EAErB,GAAGkuB,KAAA,CACL;AACF;ACxEA,MAAMqH,gBAAmB,GAAC9+B,KACxB,IAAA8H,MAAA,CAAAA,QAAA,CAAS9H,KAAK,CAAA,IAAK,OAAOA,KAAA,CAAMuI,GAAQ,KAAA,QAAA,IAAY,OAAOvI,KAAA,CAAMF,KAAU,KAAA,QAAA;AAEtE,SAASi/B,cAAc/+B,KAAgE,EAAA;EAC5F,MAAM,CAAC0+B,UAAA,EAAYM,aAAa,CAAA,GAAIjgC,KAAAA,CAAAA,SAA6B,KAAS,CAAA,CAAA;EAC1E,MAAM,CAACgB,KAAA,EAAO4T,QAAQ,CAAA,GAAI5U,eAAkB,IAAI,CAAA;EAChD,MAAM;IAACkgC;EAAA,CAAwB,GAAAC,MAAA,CAAAA,SAAA,CAAA,CAAY,CAAA1/B,QAAA;EAErC,MAAA2/B,MAAA,GAASC,wBAAgBp/B,KAAK,CAAA;EAEhC,IAAAD,KAAA,EAAa,MAAAA,KAAA;EAEjBf,KAAAA,CAAAA,SAAA,CAAU,MAAM;IAEXmgC,MAAA,CAAAj+B,IAAA;IAAA;IAECm+B,SAAAA,CAAAA,aAAa,GAAG,CAAA,EAChB99B,SAAA,CAAAA,SAAA,CAAW/B,QAAA,IACTs/B,gBAAiB,CAAAt/B,QAAQ,CAAI,GAAAsG,IAAAA,CAAAA,IAAA,CAAKm5B,oBAAqB,CAAA;MAACz/B;KAAS,CAAC,CAAA,GAAIoE,QAAG,KAAS,CAAA,CACpF,CAAA,EACAO,SAAA,CAAAA,UAAA,CAAYtD,CAAM,IAAA;MACV,MAAAV,OAAA,GAAU2H,MAAAA,CAAAA,SAASjH,CAAC,CAAA,IAAK,OAAOA,CAAE,CAAAV,OAAA,KAAY,QAAW,GAAAU,CAAA,CAAEV,OAAU,GAAA,eAAA;MACrE,MAAA,IAAI6I,KAAM,CAAA,4DAAA,CAA6DvG,MAAS,CAAAtC,OAAA,CAAA,CAAA;IAAA,CACvF,GAEFm/B,SAAU,CAAA;MACTC,IAAM,EAAAP,aAAA;MACNj/B,KAAO,EAAA4T;IAAA,CACR,CAAA;EAAA,CACF,EAAA,CAACsrB,oBAAsB,EAAAE,MAAM,CAAC,CAAA;EAE1B,OAAAT,UAAA;AACT;AC1BgB,SAAAc,2BAAAA,CACdpf,WACAqf,IACiE,EAAA;EAC3D,MAAAn2B,OAAA,GAAUm2B,IAAK,CAAAC,WAAA,IAAe,EAAC;EACrC,MAAMC,wBAAwBF,IAAK,CAAAG,YAAA;EAEnC,IAAIH,IAAK,CAAAI,WAAA,IAAeF,qBAAyB,IAAAA,qBAAA,KAA0BF,KAAKI,WAAa,EAAA;IAEnFjiB,OAAA,CAAAC,IAAA,CACN,oCAAoCpb,MAAK,CAAAg9B,IAAA,CAAAI,WAAA,EAAW,0BAA2B,CAAA,CAAAp9B,MAAA,CAAAk9B,qBAAA,EAAqB,cAAal9B,MAAqB,CAAAk9B,qBAAA,EAAA,IAAA,CAAA,CACxI;EACF;EAEM,MAAAn0B,QAAA,GAAWm0B,yBAAyBF,IAAK,CAAAI,WAAA;EACzC,MAAAC,aAAA,GAAgB1f,UAAUjd,MAAO,CAACmd,KAAMA,CAAE,CAAA1gB,UAAA,KAAe6/B,KAAKn0B,YAAY,CAAA;EAEhF,MAAMqY,cAAiB,GAAA;IACrB,GAAG8b,IAAK,CAAA9b,cAAA;IACR,IAAI,OAAOra,OAAA,KAAY,WAAWA,OAAW,IAAA,KAAK,CAAC,CAAA;EAAA,CACrD;EAEA,IAAIs2B,YAAe,GAAAp0B,QAAA;EAInB,IAAI,CAACA,QAAA,IAAYs0B,aAAc,CAAAx8B,MAAA,KAAW,CAAG,EAAA;IAC5Bs8B,YAAA,GAAAE,aAAA,CAAc,CAAC,CAAE,CAAAt8B,EAAA;EAClC;EAEO,OAAA;IAACo8B;IAA6Bjc;GAAc;AACrD;ACjCA,MAAMoc,iBAAoB,GAAAjd,KAAA,CAAAA,IAAA,CAAK,SAASid,kBAAAA,CAAkBxgC,KAA+B,EAAA;EACvF,MAAM;IAACwC,UAAY;IAAAuJ,YAAA;IAAcnC,KAAO;IAAA62B,WAAA;IAAa5N;EAAe,CAAA,GAAA7yB,KAAA;EAEpE,MAAM6U,IAAO,GAAAvI,MAAA,CAAAA,SAAA,CACXumB,WAAY,CAAA;IACVrwB,UAAA;IACAuJ;EAAA,CACD,CAAA,CACH;EAEAtM,KAAAA,CAAAA,SAAA,CAAU,MAAM;IACdghC,WAAA,CAAY72B,OAAOiL,IAAI,CAAA;EACtB,CAAA,EAAA,CAACjL,KAAO,EAAAiL,IAAA,EAAM4rB,WAAW,CAAC,CAAA;EAE7B,sBAAS5gC,UAAA,CAAAA,GAAA,CAAAC,mBAAA,EAAA,CAAA,CAAA,CAAA;AACX,CAAC,CAAA;AAeM,SAAS4gC,mCAAmC1gC,KAAgD,EAAA;EACjG,MAAM;IAACwC,UAAA;IAAYuJ,YAAc;IAAAyxB,UAAA;IAAYmD;GAAe,GAAA3gC,KAAA;EAE5D,MAAM4gC,MAAMpD,UAAW,CAAAz5B,MAAA;EACjB,MAAA88B,MAAA,GAASlZ,aAAOiZ,GAAG,CAAA;EAEnB,MAAA,CAAC3hB,SAAW,EAAA6hB,YAAY,CAAI,GAAAthC,KAAA,CAAAA,QAAA,CAAsC,MACtE8G,KAAM,CAAAC,IAAA,CAAK,IAAID,KAAA,CAAMs6B,GAAG,CAAC,CAAA,CAC3B;EAEM,MAAAG,YAAA,GAAepZ,aAAO1I,SAAS,CAAA;EAErCxf,KAAAA,CAAAA,SAAA,CAAU,MAAM;IACV,IAAAohC,MAAA,CAAOnmB,YAAYkmB,GAAK,EAAA;MAC1B,MAAMI,kBAAkB16B,KAAM,CAAAC,IAAA,CAAK,IAAID,KAAA,CAAMs6B,GAAG,CAAC,CAAA;MAEjD,KAAA,IAASxhB,CAAI,GAAA,CAAA,EAAGA,CAAI,GAAAwhB,GAAA,EAAKxhB,CAAK,EAAA,EAAA;QAC5B4hB,eAAA,CAAgB5hB,CAAC,CAAA,GAAI2hB,YAAa,CAAArmB,OAAA,CAAQ0E,CAAC,CAAA;MAC7C;MAEAyhB,MAAA,CAAOnmB,OAAU,GAAAkmB,GAAA;MAEjBE,YAAA,CAAa,MAAM;QACjBC,YAAA,CAAarmB,OAAU,GAAAsmB,eAAA;QAChB,OAAAA,eAAA;MAAA,CACR,CAAA;IACH;EAAA,CACF,EAAG,CAACJ,GAAG,CAAC,CAAA;EAER,MAAMH,WAAc,GAAAnzB,KAAAA,CAAAA,WAAA,CAAY,CAAC1D,KAAA,EAAeiL,IAAoC,KAAA;IAClFisB,YAAA,CAAcG,IAAS,IAAA;MACf,MAAAjB,IAAA,GAAO,CAAC,GAAGiB,IAAI,CAAA;MACrBjB,IAAA,CAAKp2B,KAAK,CAAI,GAAAiL,IAAA;MACdksB,YAAA,CAAarmB,OAAU,GAAAslB,IAAA;MAChB,OAAAA,IAAA;IAAA,CACR,CAAA;EACH,CAAA,EAAG,EAAE,CAAA;EAELvgC,KAAAA,CAAAA,SAAA,CAAU,MAAM;IACFkhC,WAAA,CAAA1hB,SAAA,CAAUrb,MAAO,CAAA+C,OAAO,CAAC,CAAA;EAAA,CACpC,EAAA,CAACsY,SAAW,EAAA0hB,WAAW,CAAC,CAAA;EAE3B,OAAA;IAEKvhC,QAAW,EAAAo+B,UAAA,CAAA37B,GAAA,CACV,CAAC88B,SAAA,EAAWuC,cACV,KAAAvC,SAAA,CAAU9L,WACR,IAAA,eAAAhzB,UAAA,CAAAA,GAAA,CAAC2gC,iBAAA,EAAA;MACCh+B,UAAA;MACAuJ,YAAA;MACAnC,KAAO,EAAAs3B,cAAA;MAEPT,WAAA;MACA5N,aAAa8L,SAAU,CAAA9L;IAAA,CAAA,EAFlB8L,SAAU,CAAAlxB,IAGjB,CAGR;EAAA,CAAA,CAAA;AAEJ;AC1Ca,MAAA0zB,oBAAA,GAAuB5d,KAAAA,CAAAA,IAAK,CAACvjB,KAAqC,IAAA;EAC7E,MAAM;IAACZ,QAAA;IAAUwK,KAAO;IAAA8B,IAAA;IAAM01B;GAAW,GAAAphC,KAAA;EACzC,MAAMG,SAASC,MAAAA,CAAAA,SAAU,EAAA;EACzB,MAAMygB,YAAYU,MAAAA,CAAAA,YAAa,EAAA;EACzB,MAAA;IACJ1E,OAAS,EAAAygB,eAAA;IACTK,MAAQ,EAAAJ,cAAA;IACR8D,qBAAuB,EAAAC,oBAAA;IACvBC,uBAAyB,EAAAC,sBAAA;IACzBhE,UAAY,EAAAiE;EAAA,CACd,GAAI9B,MAAAA,CAAAA,UAAY,CAAA,CAAA1/B,QAAA;EAChB,MAAMyhC,gBAAgBC,MAAAA,CAAAA,gBAAiB,EAAA;EACvC,MAAMC,aAAa90B,aAAc,EAAA;EACjC,MAAM+0B,gBAAgBD,UAAW,CAAA92B,SAAA;EAC3B,MAAA;IAACmyB;GAAQ,GAAIrN,WAAY,EAAA;EAC/B,MAAM;IAACpd,IAAA,EAAMsvB;EAAS,CAAA,GAAI7xB,EAAS,CAAAA,QAAA,CAAA,CAAA;EAC7B,MAAA;IACJib,OAAA;IACAhM,cAAiB,GAAA0P,wBAAA;IACjB/tB,KAAQ,GAAA,IAAA;IACRkhC,KAAA,EAAOC,YAAY;EACjB,CAAA,GAAAt2B,IAAA;EACE,MAAAu2B,WAAA,GAAc31B,iBAAU4e,OAAO,CAAA;EACrC,MAAMgX,gBAAgBD,WAAY,CAAAh+B,EAAA;EAC5B,MAAAzB,UAAA,GAAaM,sBAAeo/B,aAAa,CAAA;EAC/C,MAAMn2B,eAAemf,OAAQ,CAAAhf,IAAA;EAC7B,MAAMlC,MAAS,GAAAsC,MAAA,CAAAA,SAAA,CAAUs1B,UAAW,CAAA53B,MAAM,CAAK,IAAAqgB,YAAA;EACzC,MAAA8V,WAAA,GAAc7zB,MAAAA,CAAAA,SAAU,CAAAs1B,UAAA,CAAW73B,OAAO,CAAA;EAC1C,MAAA;IAACs2B,YAAc;IAAAjc;EAAA,CAAkB,GAAAle,KAAA,CAAAA,OAAA,CACrC,MACE+5B,4BAA4Bpf,SAAW,EAAA;IACrC9U,YAAA;IACAs0B,cAAc4B,WAAY,CAAAh2B,QAAA;IAC1BmY,gBAAgB6d,WAAY,CAAAE,kBAAA;IAC5BhC,WAAA;IACAG,aAAat2B,MAAO,CAAAiC;EAAA,CACrB,CAAA,EACH,CAACF,YAAA,EAAck2B,WAAa,EAAAj4B,MAAA,EAAQm2B,aAAatf,SAAS,CAAA,CAC5D;EACA,MAAMuhB,kBAAkBC,MAAAA,CAAAA,eAAgB,CAAA;IACtC7/B,UAAA;IACAuJ,YAAA;IACAs0B,YAAA;IACAjc;EAAA,CACD,CAAA;EACK,MAAAke,YAAA,GAAeh2B,iBAAU81B,eAAe,CAAA;EAC9C,MAAM;IAACG;EAAS,CAAA,GAAAjd,MAAA,CAAAA,oBAAA,CAAqB9iB,YAAYuJ,YAAY,CAAA;EACvD,MAAAgd,SAAA,GAAYC,MAAAA,CAAAA,YAAa,CAAAxmB,UAAA,EAAYuJ,YAAY,CAAA;EACvD,MAAM;IAACod,UAAY,EAAAqZ;EAAA,CAAiB,GAAA9Z,MAAAA,CAAAA,mBAAA,CAAoBlmB,YAAYuJ,YAAY,CAAA;EAC1E,MAAA02B,eAAA,GAAkBC,MAAAA,CAAAA,kBAAmB,CAAAlgC,UAAA,EAAYuJ,YAAY,CAAA;EAC7D,MAAA1L,UAAA,GAAaF,MAAO,CAAAG,GAAA,CAAIyL,YAAY,CAAA;EAC1C,MAAMtL,KAA4B,GAAA,CAAAsoB,SAAA,IAAA,IAAA,GAAA,KAAA,CAAA,GAAAA,SAAA,CAAWpgB,KAAS,MAAAogB,SAAA,IAAA,IAAA,GAAA,KAAA,CAAA,GAAAA,SAAA,CAAWngB,cAAa05B,YAAa,CAAA7hC,KAAA;EAC3F,MAAM,CAAC8kB,UAAA,EAAYL,aAAa,CAAA,GAAI1lB,eAAS,KAAK,CAAA;EAElD,MAAM,CAACk/B,kBAAoB,EAAAiE,qBAAqB,CAAI,GAAAnjC,KAAA,CAAAA,QAAA,CAAsC,EAAE,CAAA;EAG5F,MAAMqd,OAAU,GAAA3W,KAAA,CAAAA,OAAA,CACd,MAAMo3B,eAAgB,CAAA;IAACj9B,UAAY,EAAA0L,YAAA;IAAcvJ;GAAW,CAAA,EAC5D,CAAC86B,eAAiB,EAAA96B,UAAA,EAAYuJ,YAAY,CAAA,CAC5C;EAGA,MAAM4xB,MAAS,GAAAz3B,KAAA,CAAAA,OAAA,CACb,MAAMq3B,cAAe,CAAA;IAACl9B,UAAY,EAAA0L,YAAA;IAAcvJ;GAAW,CAAA,EAC3D,CAAC+6B,cAAgB,EAAA/6B,UAAA,EAAYuJ,YAAY,CAAA,CAC3C;EAGA,MAAM62B,cAAiB,GAAA18B,KAAA,CAAAA,OAAA,CACrB,MAAMs7B,sBAAuB,CAAA;IAACnhC,UAAY,EAAA0L,YAAA;IAAcvJ;GAAW,CAAA,EACnE,CAACA,UAAY,EAAAuJ,YAAA,EAAcy1B,sBAAsB,CAAA,CACnD;EAEM,MAAArY,UAAA,GAAa7c,iBAAUk2B,aAAa,CAAA;EACpC,MAAAT,KAAA,GAAQz1B,iBAAU01B,SAAS,CAAA;EAE3B,MAAA,CAACa,SAAW,EAAAC,YAAY,CAAI,GAAAtjC,KAAA,CAAAA,QAAA,CAAe,MAC/CwK,MAAO,CAAAmiB,IAAA,GAAO4W,SAAAA,CAAAA,WAAe/4B,MAAO,CAAAmiB,IAAI,IAAI,EAAC,CAC/C;EACM,MAAA6W,YAAA,GAAeh5B,OAAOi5B,IAAS,IAAAlB,KAAA,CAAM,CAAC,CAAK,IAAAA,KAAA,CAAM,CAAC,CAAA,CAAE99B,EAAO,IAAA,IAAA;EACjE,MAAM,CAACi/B,YAAA,EAActK,eAAe,CAAA,GAAIp5B,eAAqC,QAAQ,CAAA;EAErF,MAAM,CAACq5B,aAAA,EAAesK,gBAAgB,CAAA,GAAI3jC,eAAuB,IAAI,CAAA;EAMrE,MAAMs5B,gBAAgBsK,MAAAA,CAAAA,gBAAiB,CAAA;IACrC5gC,UAAA;IACAuJ,YAAA;IACAs3B,OAAS,EAAAF,gBAAA;IACTG,KAAKt5B,MAAO,CAAAs5B,GAAA;IACZlG,OAAOpzB,MAAO,CAAAozB;EAAA,CACf,CAAA;EAGD,MAAMrB,kBAAkB3C,MAAAA,CAAAA,mBAAoB,CAAAN,aAAA,EAAgBxtB,KAAA,IAAUA,MAAMywB,eAAe,CAAA;EAC3F,MAAMwH,UAAUnK,MAAAA,CAAAA,mBAAoB,CAAAN,aAAA,EAAgBxtB,KAAA,IAAUA,MAAMi4B,OAAO,CAAA;EAC3E,MAAMC,kBAAkBpK,MAAAA,CAAAA,mBAAoB,CAAAN,aAAA,EAAgBxtB,KAAA,IAAUA,MAAMk4B,eAAe,CAAA;EAC3F,MAAMC,oBAAoBrK,MAAAA,CAAAA,mBAAoB,CAAAN,aAAA,EAAgBxtB,KAAA,IAAUA,MAAMm4B,iBAAiB,CAAA;EAC/F,MAAMC,gBAAgBtK,MAAAA,CAAAA,mBAAoB,CAAAN,aAAA,EAAgBxtB,KAAA,IAAUA,MAAMo4B,aAAa,CAAA;EACvF,MAAMC,aAAavK,MAAAA,CAAAA,mBAAoB,CAAAN,aAAA,EAAgBxtB,KAAA,IAAUA,MAAMq4B,UAAU,CAAA;EAc3E,MAAA5K,SAAA,GAAY7yB,KAAAA,CAAAA,QAAQ,MAAM;IAC9B,IAAI,CAACw9B,aAAe,EAAA;MACX,OAAA,KAAA;IACT;IACO,OAAA/8B,OAAA,CAAQ,EAACoiB,SAAW,IAAA,IAAA,GAAA,KAAA,CAAA,GAAAA,SAAA,CAAApgB,KAAA,CAAA,IAAS,EAACogB,SAAW,IAAA,IAAA,GAAA,KAAA,CAAA,GAAAA,SAAA,CAAAngB,SAAA,CAAS,KAAK,CAAC+6B,UAAA;EAAA,CACjE,EAAG,CAAC5a,SAAW,IAAA,IAAA,GAAA,KAAA,CAAA,GAAAA,SAAA,CAAApgB,KAAA,EAAOogB,uCAAWngB,SAAW,EAAA+6B,UAAA,EAAYD,aAAa,CAAC,CAAA;EAIhE,MAAAvE,UAAA,GAAaK,cAAc/+B,KAAK,CAAA;EAEtC,MAAM,CAAC6H,QAAU,EAAAs7B,WAAW,CAAI,GAAApkC,KAAA,CAAAA,QAAA,CAA6B,EAAE,CAAA;EAC/DC,KAAAA,CAAAA,SAAA,CAAU,MAAM;IACd,MAAMokC,eAAenC,aAAc,CAAAx0B,gBAAA,CAAiB1K,UAAU,CAAE,CAAAu9B,SAAA,CAAW+D,YAAiB,IAAA;MAC1FF,WAAA,CAAYE,YAAY,CAAA;IAAA,CACzB,CAAA;IACD,OAAO,MAAM;MACXD,YAAA,CAAaE,WAAY,CAAA,CAAA;IAAA,CAC3B;EAAA,CACC,EAAA,CAACvhC,UAAY,EAAAk/B,aAAa,CAAC,CAAA;EAE9B,MAAMlE,UAAkC,GAAAt3B,KAAA,CAAAA,OAAA,CACtC,MAAMu7B,kBAAA,CAAmB;IAACj/B,UAAA;IAAYuJ;GAAa,CAAA,EACnD,CAACvJ,UAAY,EAAAuJ,YAAA,EAAc01B,kBAAkB,CAAA,CAC/C;EAEM,MAAA,CAACuC,eAAeC,gBAAgB,CAAA,GAAIzkC,KAAAA,CAAAA,SAAwB,MAAMwK,MAAA,CAAOk6B,WAAW,IAAI,CAAA;EAGxF,MAAAC,eAAA,GAAkBxc,KAAAA,CAAAA,MAA2B,CAAA3d,MAAA,CAAOk6B,OAAO,CAAA;EACjEzkC,KAAAA,CAAAA,SAAA,CAAU,MAAM;IACV,IAAA0kC,eAAA,CAAgBzpB,OAAY,KAAA1Q,MAAA,CAAOk6B,OAAS,EAAA;MAC9CC,eAAA,CAAgBzpB,UAAU1Q,MAAO,CAAAk6B,OAAA;MAChBD,gBAAA,CAAAj6B,MAAA,CAAOk6B,WAAW,IAAI,CAAA;IACzC;EAAA,CACC,EAAA,CAACl6B,MAAO,CAAAk6B,OAAO,CAAC,CAAA;EAEnB,MAAM1F,mBAAmBhB,UAAY,IAAA,IAAA,GAAA,KAAA,CAAA,GAAAA,UAAA,CAAAzjB,IAAA,CAAMqF,CAAA,IAAMA,EAAE3R,IAAS,KAAAu2B,aAAA,CAAA;EAC5D,MAAMI,2BAA2B5G,UAAW,CAAAzjB,IAAA,CAAMqF,CAAM,IAAAA,CAAA,CAAE3R,SAASohB,sBAAsB,CAAA;EAEnF,MAAAhG,WAAA,GAAA,CAAc2V,qDAAkB/wB,IAAS,MAAAohB,sBAAA;EAEzC,MAAA4P,QAAA,GAAW93B,QAAQlG,KAAK,CAAA;EAC9B,MAAMwe,SAAY,GAAA/Y,KAAA,CAAAA,OAAA,CAChB,MACEm5B,YAAa,CAAA;IACXb,gBAAA;IACAvB,QAAA;IACAwB,QAAA;IACAC,kBAAA;IACAlB,UAAA;IACA2B;EAAA,CACD,CAAA,EACH,CAACX,gBAAkB,EAAAvB,QAAA,EAAUwB,QAAU,EAAAC,kBAAA,EAAoBlB,YAAY2B,UAAU,CAAA,CACnF;EACM,MAAAkF,WAAA,GAAcr6B,OAAOk6B,OAAY,KAAA,IAAA;EACvC,MAAMI,YAA+C,GAAAzb,WAAA,GACjD2a,eACA,GAAA,CAAAza,SAAA,IAAA,IAAA,GAAA,KAAA,CAAA,GAAAA,SAAA,CAAWngB,SAAa,KAAA,IAAA;EAE5B,MAAMoW,YAAsC,GAAA9Y,KAAA,CAAAA,OAAA,CAC1C,MAAO7F,aAAaihC,oBAAqB,CAAA;IAAC9+B;IAAYuJ,YAAc;IAAA1L;EAAW,CAAA,CAAA,GAAI,EAAC,EACpF,CAACmC,UAAA,EAAYuJ,YAAc,EAAAu1B,oBAAA,EAAsBjhC,UAAU,CAAA,CAC7D;EAcA,MAAMf,QACJmjC,eAAoB,KAAA,WAAA,IAAe1Z,UAAUzpB,KAAU,KAAAokC,aAAA,IAAiB,CAAC,CAAC7K,aAAA,CAAA;EAE5E,MAAM0L,SAAiD,GAAAr+B,KAAA,CAAAA,OAAA,CACrD,MAAO61B,eAAkB,GAAA0H,iBAAA,IAAqB;IAACz6B,GAAA,EAAKvI,MAAMuI,GAAK;IAAAzI,KAAA,EAAOE,KAAM,CAAAF;EAAA,CAAS,GAAAE,KAAA,EACrF,CAACs7B,eAAiB,EAAA0H,iBAAA,EAAmBhjC,KAAK,CAAA,CAC5C;EAEA,MAAMk4B,gBAAmB,GAAArrB,KAAA,CAAAA,WAAA,CACvB,CAACk3B,UAAkBC,MAA0B,KAAA;IAC7B5C,aAAA,CAAA;MACZ,GAAG73B,MAAA;MACHozB,KAAO,EAAAoH,QAAA;MACPlB,KAAKmB,MAAU,IAAA,KAAA;IAAA,CAChB,CAAA;EACH,CAAA,EACA,CAACz6B,QAAQ63B,aAAa,CAAA,CACxB;EAEA,MAAM6C,WAAc,GAAAp3B,KAAA,CAAAA,WAAA,CACjBq3B,aAAwB,IAAA;IACvB7B,YAAA,CAAa6B,aAAa,CAAA;IAC1BjD,aAAA,CAAckD,WAAY,CAAA,CACxB;MACE14B,IAAM,EAAA,UAAA;MACN1J,UAAA;MACA2pB,IAAM,EAAAwY,aAAA;MACNE,YAAc,EAAA,eAAA,IAAI5O,IAAK,CAAA,CAAA,CAAE6O,WAAY,CAAA;IACvC,CAAA,CACD,CAAA;EACH,CAAA,EACA,CAACtiC,UAAY,EAAAk/B,aAAA,EAAeoB,YAAY,CAAA,CAC1C;EAEA,MAAMiC,UAAa,GAAAz3B,KAAA,CAAAA,WAAA,CAChB03B,WAAsB,IAAA;IACrBlC,YAAA,CAAa,EAAE,CAAA;EAGjB,CAAA,EACA,CAACA,YAAY,CAAA,CACf;EAEM,MAAAmC,QAAA,GAAWtd,KAAAA,CAAAA,OAAoC,MAAM;IACnD,MAAA,IAAIle,MAAM,MAAM,CAAA;EAAA,CACvB,CAAA;EAEQw7B,QAAA,CAAAvqB,OAAA,GAAWnE,KAAsB,IAAA;IACxCgsB,KAAA,CAAM3c,QAAQsf,wBAAkB,CAAA3uB,KAAA,CAAM4uB,OAAO,CAAA,EAAG7C,aAAa7hC,KAAK,CAAA;EAAA,CACpE;EAEM,MAAA2kC,YAAA,GAAe93B,kBAAaiJ,KAAA,IAAsB0uB,SAASvqB,OAAQ,CAAAnE,KAAK,CAAG,EAAA,EAAE,CAAA;EAEnF,MAAM8uB,cAAiB,GAAA/3B,KAAA,CAAAA,WAAA,CACpBg4B,kBAAgC,IAAA;IAlTrC,IAAAx3B,EAAA,EAAAC,EAAA,EAAAC,EAAA,EAAAC,EAAA;IAoTY,MAAA0wB,SAAA,GAAY2G,sBAAsB9H,UAAW,CAAAzjB,IAAA,CAAMqF,CAAM,IAAAA,CAAA,CAAE3R,SAAS63B,kBAAkB,CAAA;IAExF,IAAAA,kBAAA,IAAsB,CAAC3G,SAAW,EAAA;MAC5BtgB,OAAA,CAAAC,IAAA,CAAK,sBAAuB,CAAApb,MAAA,CAAAoiC,kBAAA,EAAkB,GAAG,CAAA,CAAA;MACzD;IACF;IAEA,IAAI,CAAC9G,gBAAkB,EAAA;MACrB;IACF;IAEA,IAAIG,SAAW,EAAA;MACP,MAAA3N,MAAA,GAAA,CAASjjB,qBAAUgG,OAAV,KAAA,IAAA,GAAA,KAAA,CAAA,GAAAjG,EAAA,CAAAkd,IAAA,CAAA2T,SAAA,EAAoB;QAAC30B;MAAM,CAAA,CAAA,KAA3B,IAAiC,GAAA+D,EAAA,GAAA;QAAC/D;OAAM;MAEvDi6B,gBAAA,CAAiB,IAAI,CAAA;MACrBE,eAAA,CAAgBzpB,OAAU,GAAA,KAAA,CAAA;MAE1BmnB,aAAA,CAAc;QAAC,GAAG7Q,MAAA,CAAOhnB,MAAQ;QAAAk6B,OAAA,EAAS;OAAU,CAAA;MAEpD;IACF;IAEA,IAAI1F,gBAAkB,EAAA;MACd,MAAAxN,MAAA,GAAA,CAAS/iB,4BAAiB8F,OAAjB,KAAA,IAAA,GAAA,KAAA,CAAA,GAAA/F,EAAA,CAAAgd,IAAA,CAAAwT,gBAAA,EAA2B;QAACx0B;MAAM,CAAA,CAAA,KAAlC,IAAwC,GAAAiE,EAAA,GAAA;QAACjE;OAAM;MAE9Di6B,gBAAA,CAAiB,IAAI,CAAA;MACrBE,eAAA,CAAgBzpB,OAAU,GAAA,KAAA,CAAA;MAE1BmnB,aAAA,CAAc;QAAC,GAAG7Q,MAAA,CAAOhnB,MAAQ;QAAAk6B,OAAA,EAAS;OAAU,CAAA;IACtD;EACF,CAAA,EACA,CAAC1F,gBAAA,EAAkBhB,UAAY,EAAAxzB,MAAA,EAAQ63B,aAAa,CAAA,CACtD;EAEA,MAAM0D,aAAgB,GAAAj4B,KAAA,CAAAA,WAAA,CACpB,CAACk4B,mBAA2Bra,UAAwC,KAAA;IAvVxE,IAAArd,EAAA,EAAAC,EAAA,EAAAC,EAAA,EAAAC,EAAA;IAwVM,MAAMw3B,gBAAgBjI,UAAW,CAAAzjB,IAAA,CAAMqF,CAAM,IAAAA,CAAA,CAAE3R,SAAS+3B,iBAAiB,CAAA;IAEzE,IAAI,CAACC,aAAe,EAAA;MACVpnB,OAAA,CAAAC,IAAA,CAAK,sBAAuB,CAAApb,MAAA,CAAAsiC,iBAAA,EAAiB,GAAG,CAAA,CAAA;MACxD;IACF;IAGI,IAAA,CAAAhH,gBAAA,IAAA,IAAA,GAAA,KAAA,CAAA,GAAAA,gBAAA,CAAkB/wB,IAAS,MAAAg4B,aAAA,CAAch4B,IAAM,EAAA;MACnCo0B,aAAA,CAAA;QAAC,GAAG73B,MAAQ;QAAA,GAAGmhB;QAAY+Y,OAAS,EAAAuB,aAAA,CAAch4B;OAAK,CAAA;MACrE;IACF;IAEA,IAAIi4B,aAAgB,GAAA17B,MAAA;IAEpB,IAAIw0B,gBAAkB,EAAA;MACd,MAAAmH,WAAA,GAAA,CAAc53B,yBAAcgG,OAAd,KAAA,IAAA,GAAA,KAAA,CAAA,GAAAjG,EAAA,CAAAkd,IAAA,CAAAya,aAAA,EAAwB;QAACz7B,MAAQ,EAAA07B;aAAjC,IAAoD,GAAA33B,EAAA,GAAA;QACtE/D,MAAQ,EAAA07B;MAAA,CACV;MAEAA,aAAA,GAAgBC,WAAY,CAAA37B,MAAA;IAC9B;IAEM,MAAAgnB,MAAA,GAAA,CAAS/iB,EAAc,GAAA,CAAAD,EAAA,GAAAy3B,aAAA,CAAApT,MAAA,KAAd,IAAuB,GAAA,KAAA,CAAA,GAAArkB,EAAA,CAAAgd,IAAA,CAAAya,aAAA,EAAA;MAACz7B,MAAQ,EAAA07B;KAAhC,CAAA,KAAA,IAAA,GAAAz3B,EAAA,GAAmD;MAACjE,MAAA,EAAQ07B;KAAa;IAExFzB,gBAAA,CAAiBwB,cAAch4B,IAAI,CAAA;IACnC02B,eAAA,CAAgBzpB,UAAU+qB,aAAc,CAAAh4B,IAAA;IAE1Bo0B,aAAA,CAAA;MAAC,GAAG7Q,MAAO,CAAAhnB,MAAA;MAAQ,GAAGmhB,UAAY;MAAA+Y,OAAA,EAASuB,aAAc,CAAAh4B;IAAA,CAAK,CAAA;EAC9E,CAAA,EACA,CAAC+wB,gBAAA,EAAkBhB,UAAY,EAAAxzB,MAAA,EAAQ63B,aAAa,CAAA,CACtD;EAEM,MAAA+D,kBAAA,GAAqBt4B,KAAAA,CAAAA,YAAY,MAAM;IAC3C,IAAI82B,wBAA0B,EAAA;MAC5BiB,cAAA,CAAejB,yBAAyB32B,IAAI,CAAA;IAC9C;EAAA,CACC,EAAA,CAAC43B,cAAgB,EAAAjB,wBAAwB,CAAC,CAAA;EAEvC,MAAAyB,iBAAA,GAAoBv4B,KAAAA,CAAAA,YAAY,MAAM;IACtC,IAAA,CAAC2vB,SAASC,aAAe,EAAA;MAC3B;IACF;IAEA,IAAIkH,wBAA0B,EAAA;MAC5BmB,aAAA,CAAcnB,yBAAyB32B,IAAI,CAAA;IAC7C;KACC,CAACwvB,QAAA,CAASC,aAAe,EAAAqI,aAAA,EAAenB,wBAAwB,CAAC,CAAA;EAE9D,MAAA0B,eAAA,GAAkBx4B,KAAAA,CAAAA,YAAY,MAAMs0B,UAAA,CAAWj3B,cAAgB,EAAA,CAACi3B,UAAU,CAAC,CAAA;EAE3E,MAAAmE,eAAA,GAAkBz4B,KAAAA,CAAAA,YAAY,MAAMs0B,UAAA,CAAWh3B,kBAAoB,EAAA,CAACg3B,UAAU,CAAC,CAAA;EAErF,MAAMoE,mBAAsB,GAAA14B,KAAA,CAAAA,WAAA,CAC1B,YAA2B;IAAA,IAA1B24B,MAAS,GAAAC,SAAA,CAAAniC,MAAA,QAAAmiC,SAAA,QAAAC,SAAA,GAAAD,SAAA,MAAA,CAAC7B,WAAgB;IACzB,IAAI4B,MAAQ,EAAA;MACVpE,aAAA,CAAc;QAAC,GAAG73B,MAAQ;QAAAk6B,OAAA,EAAS;MAAK,CAAA,CAAA;IAAA,CACnC,MAAA;MACSrC,aAAA,CAAA7T,aAAA,CAAAzf,OAAA,CAAKvE,MAAQ,EAAA,SAAS,CAAC,CAAA;IACvC;EACF,CAAA,EACA,CAACq6B,WAAa,EAAAr6B,MAAA,EAAQ63B,aAAa,CAAA,CACrC;EAEA,MAAMuE,gBAAmB,GAAA94B,KAAA,CAAAA,WAAA,CACtB6C,IAAuB,IAAA;IAClB,IAAAA,IAAA,CAAKL,MAAW,KAAA,oBAAA,IAAwBqvB,UAAY,EAAA;MACtD1mB,MAAA,CAAOugB,KAAKmG,UAAU,CAAA;MACf,OAAA,IAAA;IACT;IAEI,IAAAhvB,IAAA,CAAKL,WAAW,SAAW,EAAA;MAC7Bk2B,mBAAA,CAAoB,IAAI,CAAA;MACjB,OAAA,IAAA;IACT;IAEI,IAAA71B,IAAA,CAAKL,WAAW,eAAiB,EAAA;MACjB+1B,iBAAA,EAAA;MACX,OAAA,IAAA;IACT;IAEI,IAAA,OAAO11B,KAAKL,MAAW,KAAA,QAAA,IAAYK,KAAKL,MAAO,CAAAu2B,UAAA,CAAW1X,qBAAqB,CAAG,EAAA;MACpF,MAAM6W,iBAAoB,GAAAr1B,IAAA,CAAKL,MAAO,CAAAzE,KAAA,CAAMsjB,sBAAsB5qB,MAAM,CAAA;MACxE,MAAM0hC,gBAAgBjI,UAAW,CAAAzjB,IAAA,CAAMqF,CAAM,IAAAA,CAAA,CAAE3R,SAAS+3B,iBAAiB,CAAA;MAEzE,IAAIC,aAAe,EAAA;QACb,IAAAA,aAAA,CAAch4B,SAASu2B,aAAe,EAAA;UACxCqB,cAAA,CAAeI,cAAch4B,IAAI,CAAA;QAAA,CAC5B,MAAA;UACL83B,aAAA,CAAcE,cAAch4B,IAAI,CAAA;QAClC;QACO,OAAA,IAAA;MACT;IACF;IAEO,OAAA,KAAA;EACT,CAAA,EACA,CACE43B,cAAA,EACAQ,iBAAA,EACA7B,aAAA,EACAxG,UAAA,EACA+H,aAAA,EACApG,UAAA,EACA6G,mBAAA,CACF,CACF;EAEA,MAAMM,WAAc,GAAAh5B,KAAA,CAAAA,WAAA,CACjBiJ,KAA+C,IAAA;IAC9C,KAAA,MAAWpG,QAAQ8O,SAAW,EAAA;MAC5B,IAAI9O,KAAKyP,QAAU,EAAA;QACjB,IAAI2mB,yBAAS,CAAAp2B,IAAA,CAAKyP,QAAU,EAAArJ,KAAK,CAAG,EAAA;UAClCA,KAAA,CAAM4B,cAAe,CAAA,CAAA;UACrB5B,KAAA,CAAM8f,eAAgB,CAAA,CAAA;UACtB+P,gBAAA,CAAiBj2B,IAAI,CAAA;UACrB;QACF;MACF;IACF;EACF,CAAA,EACA,CAACi2B,kBAAkBnnB,SAAS,CAAA,CAC9B;EAEA,MAAMunB,wBAA2B,GAAAl5B,KAAA,CAAAA,WAAA,CAC/B,MAAM04B,oBAAoB,KAAK,CAAA,EAC/B,CAACA,mBAAmB,CAAA,CACtB;EAEA,MAAM,CAACS,QAAU,EAAAC,aAAa,CAAI,GAAAlnC,KAAA,CAAAA,QAAA,CAAe,EAAE,CAAA;EACnD,MAAM,CAACmnC,eAAA,EAAiBC,oBAAoB,CAAA,GAAIpnC,KAA4B,CAAAA,QAAA,CAAA,CAAA;EAC5E,MAAM,CAACqnC,cAAA,EAAgBC,kBAAkB,CAAA,GAAItnC,KAA6B,CAAAA,QAAA,CAAA,CAAA;EAC1E,MAAM,CAACunC,kBAAA,EAAoBC,uBAAuB,CAAA,GAAIxnC,KAA6B,CAAAA,QAAA,CAAA,CAAA;EAEnF,MAAMynC,wBAA2B,GAAA35B,KAAAA,CAAAA,WAAA,CAAY,CAAC6e,IAAA,EAAYzS,SAAuB,KAAA;IAC/EotB,kBAAA,CAAoBI,SAAc,IAAAC,MAAA,CAAAA,SAAA,CAAUD,SAAW,EAAA/a,IAAA,EAAMzS,SAAS,CAAC,CAAA;EACzE,CAAA,EAAG,EAAE,CAAA;EAEL,MAAM0tB,4BAA+B,GAAA95B,KAAAA,CAAAA,WAAA,CAAY,CAAC6e,IAAA,EAAYzS,SAAuB,KAAA;IACnFstB,uBAAA,CAAyBE,SAAc,IAAAC,MAAA,CAAAA,SAAA,CAAUD,SAAW,EAAA/a,IAAA,EAAMzS,SAAS,CAAC,CAAA;EAC9E,CAAA,EAAG,EAAE,CAAA;EAEL,MAAM2tB,yBAA4B,GAAA/5B,KAAA,CAAAA,WAAA,CAChC,CAAC6e,IAAY,EAAAmb,SAAA,KACXV,oBAAqB,CAACM,aAAcC,MAAAA,CAAAA,SAAU,CAAAD,SAAA,EAAW/a,IAAM,EAAAmb,SAAS,CAAC,CAAA,EAC3E,EAAC,CACH;EAEM,MAAAC,kBAAA,GAAqB9mC,KAAM,CAAA+mC,UAAA,GAAa,QAAW,GAAA,QAAA;EACnD,MAAA/gB,QAAA,GAAW9f,OAAQ,CAAAtG,UAAA,IAAA,IAAA,GAAA,KAAA,CAAA,GAAAA,UAAA,CAAYomB,QAAQ,CAAA;EAC7C,MAAMghB,KAAQ,GAAAhnC,KAAA,CAAMuI,GAAM,GAAAvI,KAAA,CAAMuI,GAAM,GAAA,UAAA;EAChC,MAAA0+B,mBAAA,GAAsBxhC,KAAAA,CAAAA,QAAQ,MAAM;IACjC,OAAA;MACL,GAAGzF,KAAA;MACHuI,KAAKyd,QAAW,GAAA3jB,MAAA,CAAAA,cAAA,CAAe2kC,KAAK,CAAA,GAAI7kC,MAAAA,CAAAA,WAAW6kC,KAAK;IAAA,CAC1D;EACC,CAAA,EAAA,CAAChhB,QAAU,EAAAhmB,KAAA,EAAOgnC,KAAK,CAAC,CAAA;EAE3B,MAAM,CAACrlB,WAAA,EAAa0D,oBAAoB,CAAA,GAAI6hB,kCAA4B,CAAA;IACtE1nC,QAAU,EAAAynC,mBAAA;IACV7lB,UAAY,EAAA0lB;EAAA,CACb,CAAA;EAEK,MAAAK,aAAA,GAAgB,EAACnnC,KAAO,IAAA,IAAA,GAAA,KAAA,CAAA,GAAAA,KAAA,CAAAuI,GAAA,CAAA;EAExB,MAAA6+B,QAAA,GAAW3hC,KAAAA,CAAAA,QAAQ,MAAM;IA7fjC,IAAA4H,EAAA;IA8fI,MAAMg6B,eAAkB,GAAA,CAAChiB,oBAAwB,IAAA,EAAC1D,WAAa,IAAA,IAAA,GAAA,KAAA,CAAA,GAAAA,WAAA,CAAAN,OAAA,CAAA;IAC/D,MAAMimB,oBAAuB,GAAA,CAACC,SAAAA,CAAAA,eAAgB,CAAA3nC,UAAA,EAAa,QAAQ,CAAA;IACnE,MAAM4nC,oBAAuB,GAAAL,aAAA,IAAiB,CAACI,SAAA,CAAAA,eAAA,CAAgB3nC,YAAa,QAAQ,CAAA;IACpF,MAAM6nC,eAAezF,eAAoB,KAAA,cAAA;IACnC,MAAA0F,QAAA,GAAA,CAAWr6B,EAAU,GAAAib,SAAA,CAAAe,mBAAA,KAAV,IAA+B,GAAA,KAAA,CAAA,GAAAhc,EAAA,CAAAqO,OAAA;IAG9C,OAAA,CAAC7c,SACDikC,OAAY,KAAA,IAAA,IACZuE,mBACAC,oBACA,IAAAE,oBAAA,IACAC,YACA,IAAAC,QAAA,IACA5iB,UACA,IAAAwT,SAAA;EAAA,CAED,EAAA,CACD0J,eAAA,EACA1Z,SAAU,CAAAe,mBAAA,EACV8d,aAAA,EACA7O,SAAA,EACAxT,UAAA,EACAO,oBAAA,EACA1D,WAAa,IAAA,IAAA,GAAA,KAAA,CAAA,GAAAA,WAAA,CAAAN,OAAA,EACbxiB,KAAA,EACAikC,OAAA,EACAljC,UAAA,CACD,CAAA;EAEK,MAAA+nC,SAAA,GAAYC,oBAAahoC,UAAa,EAAA;IAC1CI,KAAO,EAAA8jC,SAAA;IACPsD,QAAA;IACAS,eAAiB,EAAAhE,YAAA;IACjBzB,SAAA;IACA4D,QAAA;IACAI,cAAA;IACAv+B,QAAA;IACA6gB,UAAA;IACA4d,kBAAA;IACAJ,eAAA;IACA9d;EAAA,CACD,CAAA;EAEK,MAAA0f,YAAA,GAAe5gB,aAAOygB,SAAS,CAAA;EACrCG,YAAA,CAAa7tB,OAAU,GAAA0tB,SAAA;EAEvB,MAAMI,WAAc,GAAAl7B,KAAA,CAAAA,WAAA,CACjB6e,IAAe,IAAA;IACd,MAAMsc,GAAM,GAAAC,MAAA,CAAAA,mBAAA,CAAoBH,YAAa,CAAA7tB,OAAA,EAAUyR,IAAI,CAAA;IACvDsc,GAAA,CAAAE,OAAA,CAAS/gB,EAAO,IAAA;MACd,IAAAA,EAAA,CAAG1b,SAAS,YAAc,EAAA;QAC5B46B,kBAAA,CAAoBI,SAAc,IAAAC,gBAAA,CAAUD,WAAWtf,EAAG,CAAAuE,IAAA,EAAM,KAAK,CAAC,CAAA;MACxE;MACI,IAAAvE,EAAA,CAAG1b,SAAS,gBAAkB,EAAA;QAChC86B,uBAAA,CAAyBE,SAAc,IAAAC,gBAAA,CAAUD,WAAWtf,EAAG,CAAAuE,IAAA,EAAM,KAAK,CAAC,CAAA;MAC7E;MACI,IAAAvE,EAAA,CAAG1b,SAAS,kBAAoB,EAAA;QACb06B,oBAAA,CAACM,aAAcC,MAAAA,CAAAA,SAAU,CAAAD,SAAA,EAAWtf,GAAGuE,IAAM,EAAAvE,EAAA,CAAG0f,SAAS,CAAC,CAAA;MACjF;IAAA,CACD,CAAA;IACDZ,aAAA,CAAcva,IAAI,CAAA;EACpB,CAAA,EACA,CAACoc,YAAY,CAAA,CACf;EAEA,MAAM3jB,YAAyC,GAAA;IAC7C/H,OAAA;IACAmmB,YAAA;IACArF,MAAA;IACA9U,WAAA;IACAwc,cAAA;IACA0B,kBAAA;IACAF,cAAA;IACAvC,YAAA;IACA7B,eAAA;IACA8B,SAAA;IACA/hC,UAAA;IACA0/B,aAAA;IACAn2B,YAAA;IACAgd,SAAA;IACA/J,YAAA;IACA6jB,SAAA;IACAlE,WAAWH,gBAAoB,IAAA,IAAA;IAC/BhB,UAAA;IACAve,SAAA;IACA2pB,MAAQ,EAAA7D,UAAA;IACR8D,QAAU,EAAAzD,YAAA;IACVpT,OAAS,EAAA0S,WAAA;IACTzS,UAAY,EAAAuW,WAAA;IACZM,cAAgB,EAAAlD,kBAAA;IAChB9c,aAAe,EAAA+c,iBAAA;IACfkD,cAAgB,EAAAvC,wBAAA;IAChBwC,OAAS,EAAA1C,WAAA;IACT2C,YAAc,EAAA7C,gBAAA;IACd8C,WAAa,EAAApD,eAAA;IACbqD,WAAa,EAAApD,eAAA;IACbqD,qBAAuB,EAAA/B,yBAAA;IACvBP,kBAAoB,EAAAG,wBAAA;IACpBoC,sBAAwB,EAAAjC,4BAAA;IACxB7B,aAAA;IACA37B,KAAA;IACAy6B,WAAA;IACAlb,UAAA;IACAjK,cAAA,EAAgBA,kBAAkB,EAAC;IACnCkiB,OAAA;IACAjC,UAAA;IACA7/B,KAAA;IACAe,UAAA;IACAylB,oBAAA;IACA1D,WAAA;IACAwW,eAAA;IACAD,gBAAA;IACAzT,aAAA;IACAK,UAAA;IACAwT,SAAA;IACAF,aAAA;IACAqK,YAAA;IACApK,aAAA;IACAj4B,KAAA;IACAJ,KAAA;IACAshC,KAAA;IACAqG,SAAA;IACA7G,uBAAyB,EAAAqB;EAAA,CAC3B;EAEAnjC,KAAAA,CAAAA,SAAA,CAAU,MAAM;IACd,IAAIgjC,oBAAoB,cAAgB,EAAA;MAC5BX,SAAA,CAAA;QACR79B,EAAI,EAAA,0BAAA;QACJgF,MAAQ,EAAA,SAAA;QACRpI,KAAA;UAASzB,QAA8B,EAAA;QAAA,CAAA;MAAA,CACxC,CAAA;IACH;EAAA,CACC,EAAA,CAACqjC,eAAiB,EAAAX,SAAS,CAAC,CAAA;EAG/BriC,KAAAA,CAAAA,SAAA,CAAU,MAAM;IAvoBlB,IAAAqO,EAAA;IAwoBQ,IAAAxO,KAAA,IAAS0K,OAAOmiB,IAAM,EAAA;MACxB,MAAM;QAACA,IAAA;QAAM,GAAGmd;MAAA,CAAc,GAAAt/B,MAAA;MACxB,MAAAu/B,WAAA,GAAcC,4BAAiB17B,EAAa,GAAAy6B,YAAA,CAAA7tB,OAAA,KAAb,mBAAsBja,KAAO,EAAAsiC,SAAAA,CAAAA,UAAA,CAAe5W,IAAI,CAAC,CAAA;MAEtF2W,YAAA,CAAayG,WAAW,CAAA;MACxBf,WAAA,CAAYe,WAAW,CAAA;MAEvB3H,UAAA,CAAW92B,UAAUw+B,UAAU,CAAA;IACjC;EAAA,GACC,CAACt/B,MAAA,EAAQxH,YAAYgmC,WAAa,EAAAlpC,KAAA,EAAOsiC,UAAU,CAAC,CAAA;EAEvD,MAAM,CAAC6H,oBAAsB,EAAAC,uBAAuB,CAAI,GAAAlqC,KAAA,CAAAA,QAAA,CAAoC,EAAE,CAAA;EAE9F,OACGmB,eAAAA,UAAAA,CAAAA,IAAA,CAAA+jB,mBAAA,CAAoBvJ,QAApB,EAAA;IAA6B1a,OAAOmkB,YAClC;IAAAxlB,QAAA,EAAA,CAAAo+B,UAAA,CAAWz5B,SAAS,CACnB,mBAAAlE,UAAA,CAAAA,GAAA,CAAC6gC,kCAAA,EAAA;MACCl+B,UAAA;MACAuJ,YAAA;MACAyxB,UAAA;MACAmD,WAAa,EAAAgC;IAAA,CACf,CAAA,EAID3jB,YAAA,CAAajb,MAAS,GAAA,CAAA,IAAK1D,UAC1B,mBAAAR,UAAA,CAAAA,GAAA,CAAC8pC,MAAA,CAAAA,oBAAA,EAAA;MACC9sB,OAAS,EAAAmC,YAAA;MACTxc,UAAA;MACAuJ,YAAA;MACA69B,SAAW,EAAAF,uBAAA;MACXvd,IAAM,EAAApf,MAAA,CAAAA,WAAA;MACN1M;IAAA,CACF,CAAA,EAAA,8BAGDwpC,MAAqB,CAAAA,oBAAA,EAAA;MAAAhtB,OAAA,EAAS4sB,oBAAsB;MAAAtd,IAAA,EAAMpf,MAAAA,CAAAA;MACxD3N;KACH,CAAA;EACF,CAAA,CAAA;AAEJ,CAAC,CAAA;AAED+hC,oBAAA,CAAqB5lB,WAAc,GAAA,sBAAA;;;;;;;;;;;;AChrB5B,MAAMuuB,uBAAuBrgC,KAAM,CAAA;EAIxCsgC,WACEA,CAAAnpC,OAAA,EACAopC,UACA,EAAApe,WAAA,EACAqe,IACA,EAAA;IACA,KAAA,CAAMrpC,OAAO,CAAA;IATCspC,eAAA,CAAA,IAAA,EAAA,MAAA,CAAA;IACTA,eAAA,CAAA,IAAA,EAAA,QAAA,CAAA;IASL,MAAMpc,OAAU,GAAA,OAAOlC,WAAgB,KAAA,WAAA,GAAc,cAAc,EAAG,CAAA1oB,MAAA,CAAA0oB,WAAA,CAAA;IACjE,IAAA,CAAAO,IAAA,GAAA,CAAQ6d,UAAc,IAAA,EAAI,EAAA9mC,MAAA,CAAO+mC,IAAO,GAAA,EAAA,CAAG/mC,MAAO,CAAA4qB,OAAA,EAAA,IAAA,CAAA,CAAK5qB,MAAI,CAAA+mC,IAAA,EAAA,GAAA,CAAA,GAAMnc,OAAO,CAAA;EAC/E;EAEAqc,YAAYlmC,EAA8B,EAAA;IACxC,IAAA,CAAKmmC,MAAS,GAAAnmC,EAAA;IACP,OAAA,IAAA;EACT;AACF;AAGY,IAAAomC,QAAA,GAAA,gBAAAA,SAAL,IAAA;EACLA,UAAA,aAAc,CAAA,GAAA,4BAAA;EACdA,UAAA,gBAAiB,CAAA,GAAA,0BAAA;EACjBA,UAAA,iBAAkB,CAAA,GAAA,2BAAA;EAClBA,UAAA,mBAAoB,CAAA,GAAA,6BAAA;EACpBA,UAAA,oBAAqB,CAAA,GAAA,mCAAA;EACrBA,UAAA,sBAAuB,CAAA,GAAA,gCAAA;EACvBA,UAAA,wBAAyB,CAAA,GAAA,kCAAA;EACzBA,UAAA,sBAAuB,CAAA,GAAA,gCAAA;EACvBA,UAAA,uBAAwB,CAAA,GAAA,iCAAA;EACxBA,UAAA,0BAA2B,CAAA,GAAA,oCAAA;EAC3BA,UAAA,2BAA4B,CAAA,GAAA,qCAAA;EAC5BA,UAAA,2BAA4B,CAAA,GAAA,qCAAA;EAC5BA,UAAA,8BAA+B,CAAA,GAAA,wCAAA;EAC/BA,UAAA,sCAAuC,CAAA,GAAA,gDAAA;EACvCA,UAAA,wCAAyC,CAAA,GAAA,kDAAA;EAf/BA,OAAAA,SAAAA;AAAA,CAAA,EAAAA,QAAA,IAAA,CAAA,CAAA,CAAA;ACvBZ,MAAMC,kBAAkB,CAAC,KAAA,EAAO,OAAS,EAAA,YAAA,EAAc,cAAc,MAAM,CAAA;AAG3E,SAASC,cAAAA,CAAelqC,YAAwB8rB,IAAwB,EAAA;EACtE,MAAM,CAACqe,IAAA,EAAM,GAAGC,IAAI,CAAI,GAAAte,IAAA;EAEpB,IAAA,EAAE,YAAY9rB,UAAa,CAAA,EAAA;IACtB,OAAA,EAAA;EACT;EAEM,MAAAqqC,WAAA,GAAcrqC,WAAW+wB,MAAO,CAAArX,IAAA,CAAMoX,KAAU,IAAAA,KAAA,CAAM1jB,SAAS+8B,IAAI,CAAA;EACzE,IAAI,CAACE,WAAa,EAAA;IAChB,IAAI,CAACJ,eAAA,CAAgB7c,QAAS,CAAA+c,IAAI,CAAG,EAAA;MAE3BnsB,OAAA,CAAAC,IAAA,CACN,6GAAA,EACAksB,IAAA,EACAnqC,UAAW,CAAAoN,IAAA,EACXpN,WAAW+wB,MAAO,CAAAvvB,GAAA,CAAKsvB,KAAA,IAAUA,MAAM1jB,IAAI,CAAA,CAC7C;IACF;IACO,OAAA,EAAA;EACT;EAEA,IAAI,QAAQi9B,WAAY,CAAAx+B,IAAA,IAAQw+B,WAAY,CAAAx+B,IAAA,CAAKuB,SAAS,WAAa,EAAA;IAC/D,MAAAk9B,QAAA,GAAWD,YAAYx+B,IAAK,CAAA0+B,EAAA;IAClC,OAAO,EAAG,CAAA1nC,MAAA,CAAAsnC,IAAA,EAAI,KAAM,CAAA,CAAAtnC,MAAA,CAAAynC,QAAA,CAAS9oC,IAAKgpC,OAAA,IAAYN,cAAe,CAAAM,OAAA,EAASJ,IAAI,CAAC,CAAE,CAAA95B,IAAA,CAAK,GAAG,CAAC,EAAA,GAAA,CAAA;EACxF;EAEA,MAAMm6B,aAAaL,IAAK,CAAA1mC,MAAA,GAAS,KAAKwmC,cAAe,CAAAG,WAAA,CAAYx+B,MAAMu+B,IAAI,CAAA;EAC3E,MAAMM,WAAc,GAAAD,UAAA,GAAa,GAAI,CAAA5nC,MAAA,CAAA4nC,UAAA,EAAU,GAAM,CAAA,GAAA,EAAA;EACrD,OAAOL,IAAK,CAAA1mC,MAAA,GAAS,CAAI,GAAA,EAAA,CAAGb,aAAOA,MAAgB,CAAA6nC,WAAA,CAAA,GAAAP,IAAA;AACrD;AAEgB,SAAAQ,qBAAAA,CAAsB3qC,YAAwB4qC,OAAqC,EAAA;EACjG,OAAOA,OAAQ,CAAAppC,GAAA,CAAKqpC,QAAA,IAAaX,eAAelqC,UAAY,EAAA6qC,QAAA,CAAS/Z,KAAM,CAAArb,KAAA,CAAM,GAAG,CAAC,CAAC,CAAA,CAAEnF,KAAK,IAAI,CAAA;AACnG;ACpCO,MAAMw6B,mBAAoC,GAAA;EAC/CtqC,KAAO,EAAA,aAAA;EACP4M,IAAM,EAAA,gBAAA;EACN29B,IAAI,CAAC;IAACja,OAAO,YAAc;IAAAjgB,SAAA,EAAW;GAAO;AAC/C,CAAA;AAEO,MAAMm6B,mBAAoC,GAAA;EAC/CxqC,KAAO,EAAA,SAAA;EACP4M,IAAM,EAAA,iBAAA;EACN29B,IAAI,CAAC;IAACja,OAAO,YAAc;IAAAjgB,SAAA,EAAW;GAAO;AAC/C,CAAA;AAEO,MAAMo6B,gCAAmC,GAAAH,mBAAA;AAEzC,MAAMI,wBAA2C,GAAA,CACtDJ,mBAAA;AAAA;AACAE;AAAA;AAAA,CACF;;;;;;;;;;;;;ACTgB,SAAAG,sBAAAA,CACdr7B,IACA,EAAAvG,KAAA,EACAuiB,IACU,EAAA;EACH,OAAAhc,IAAA,YAAgBs7B,kBAAkBt7B,IAAK,CAAAu7B,SAAA,CAAU;IAACvf,IAAM;IAAAviB;GAAM,CAAI,GAAAuG,IAAA;AAC3E;AA+CO,MAAMs7B,eAAkD,CAAA;EAI7D1B,WAAAA,CAIY4B,UACVC,IACA,EAAA;IAFU,IAAA,CAAAD,QAAA,GAAAA,QAAA;IANZ;IAAUzB,eAAA,CAAA,IAAA,EAAA,MAAA,CAAA;IASH,IAAA,CAAA0B,IAAA,GAAOA,IAAO,GAAAA,IAAA,GAAO,CAAA,CAAC;EAC7B;EAAA;AAAA;AAAA;AAAA;AAAA;EAOA97B,OAAOA,MAA6C,EAAA;IAClD,OAAO,IAAK,CAAA+7B,KAAA,CAAM;MAAC/7B;IAAO,CAAA,CAAA;EAC5B;EAAA;AAAA;AAAA;AAAA;EAMAg8B,SAAuCA,CAAA,EAAA;IACrC,OAAO,KAAKF,IAAK,CAAA97B,MAAA;EACnB;EAAA;AAAA;AAAA;AAAA;AAAA;EAOAwF,OAAOA,MAAiC,EAAA;IACtC,OAAO,IAAK,CAAAu2B,KAAA,CAAM;MAACv2B;IAAO,CAAA,CAAA;EAC5B;EAAA;AAAA;AAAA;AAAA;EAMAsL,SAAuCA,CAAA,EAAA;IACrC,OAAO,KAAKgrB,IAAK,CAAAt2B,MAAA;EACnB;EAAA;AAAA;AAAA;AAAA;AAAA;EAOAzU,MAAMA,KAAgC,EAAA;IACpC,OAAO,IAAK,CAAAgrC,KAAA,CAAM;MAAChrC;IAAM,CAAA,CAAA;EAC3B;EAAA;AAAA;AAAA;AAAA;EAMAkrC,QAA+BA,CAAA,EAAA;IAC7B,OAAO,KAAKH,IAAK,CAAA/qC,KAAA;EACnB;EAAA;AAAA;AAAA;AAAA;AAAA;EAOA4e,MAAMA,KAAgC,EAAA;IACpC,OAAO,IAAK,CAAAosB,KAAA,CAAM;MAACpsB;IAAM,CAAA,CAAA;EAC3B;EAAA;AAAA;AAAA;AAAA;EAMAusB,QAAqCA,CAAA,EAAA;IACnC,OAAO,KAAKJ,IAAK,CAAAnsB,KAAA;EACnB;EAAA;AAAA;AAAA;AAAA;AAAA;EAOArX,KAAKA,IAA8D,EAAA;IACjE,OAAO,IAAK,CAAAyjC,KAAA,CAAM;MAACzjC;IAAK,CAAA,CAAA;EAC1B;EAAA;AAAA;AAAA;AAAA;EAMA6jC,OAAmCA,CAAA,EAAA;IACjC,OAAO,KAAKL,IAAK,CAAAxjC,IAAA;EACnB;EAAA;AAAA;AAAA;AAAA;AAAA;EAOA4B,OAAOA,MAA6C,EAAA;IAClD,OAAO,IAAK,CAAA6hC,KAAA,CAAM;MAAC7hC;IAAO,CAAA,CAAA;EAC5B;EAAA;AAAA;AAAA;AAAA;EAMAkiC,SAAuCA,CAAA,EAAA;IACrC,OAAO,KAAKN,IAAK,CAAA5hC,MAAA;EACnB;EAAA;AAAA;AAAA;AAAA;AAAA;EAOA8V,YAAAA,CAAA,EAAmD;IAAA,IAAtCA,mFAAe,IAAuB;IACjD,OAAO,KAAK+rB,KAAM,CAAA;MAAC/rB,cAAcnZ,OAAQ,CAAAmZ,YAAY;KAAE,CAAA;EACzD;EAAA;AAAA;AAAA;AAAA;EAMAqsB,eAAmDA,CAAA,EAAA;IACjD,OAAO,KAAKP,IAAK,CAAA9rB,YAAA;EACnB;EAAA;AAAA;AAAA;AAAA;EAMA4rB,YAA4D;IAAA,IAAlDxgB,OAA4B,GAAAgb,SAAA,CAAAniC,MAAA,QAAAmiC,SAAA,QAAAC,SAAA,GAAAD,SAAA,MAAA;MAAC/Z,IAAM,EAAA;KAAe;IAC1D,MAAM;MAACtrB,KAAA;MAAOiP,MAAQ;MAAAwF;IAAA,IAAU,IAAK,CAAAs2B,IAAA;IACrC,IAAI,CAAC/qC,KAAO,EAAA;MACV,MAAMopC,OAAO,OAAOn6B,MAAA,KAAW,QAAW,GAAA,WAAA,CAAY5M,eAAM,GAAM,CAAA,GAAA,KAAA,CAAA;MAClE,MAAM,IAAI4mC,cAAA,CACR,mCAAA,EACA5e,OAAQ,CAAAiB,IAAA,EACRjB,OAAQ,CAAAthB,KAAA,EACRqgC,IAAA,CACF,CAAEE,WAAY,CAAAE,QAAA,CAAS+B,cAAc,CAAA;IACvC;IAEI,IAAA,CAACt8B,MAAU,IAAA,CAACwF,MAAQ,EAAA;MACtB,MAAM,IAAIw0B,cAAA,CACR,yDAAA,CAA8D5mC,YAAK0oC,IAAK,CAAA/qC,KAAA,CAAA,EACxEqqB,OAAQ,CAAAiB,IAAA,EACRjB,OAAQ,CAAAthB,KAAA,EACR,IAAI1G,MAAK,CAAArC,KAAA,EAAA,GAAA,CAAA,CACX,CAAEspC,WAAY,CAAAE,QAAA,CAASgC,yBAAyB,CAAA;IAClD;IAEA,IAAI/2B,UAAUxF,MAAQ,EAAA;MACpB,MAAM,IAAIg6B,cAAA,CACR,uCAAA,EACA5e,OAAQ,CAAAiB,IAAA,EACRjB,OAAQ,CAAAthB,KAAA,EACR,IAAI1G,MAAK,CAAArC,KAAA,EAAA,GAAA,CAAA,CACX,CAAEspC,WAAY,CAAAE,QAAA,CAASiC,oCAAoC,CAAA;IAC7D;IAEA,OAAO;MAAC,GAAG,IAAK,CAAAV,IAAA;MAAM/qC;IAAK,CAAA;EAC7B;EAAA;AAAA;AAAA;AAAA;EAMAgrC,MAAMU,QAA6C,EAAA;IACjD,MAAMC,OAAU,GAAA,IAAIf,eAAgB,CAAA,IAAA,CAAKE,QAAQ,CAAA;IACzCa,OAAA,CAAAZ,IAAA,GAAO;MAAC,GAAG,IAAA,CAAKA;MAAM,IAAIW,QAAA,IAAY,CAAA,CAAG;KAAA;IAC1C,OAAAC,OAAA;EACT;AACF;AAUgB,SAAAC,mBAAAA,CACdtoC,OACA,EAAA+mC,QAAA,EACAwB,kBACiB,EAAA;EACV,OAAA,IAAIjB,eAAgB,CAAAtnC,OAAO,CAC/B,CAAAsb,KAAA,CAAM,SAAS,CACf,CAAA5e,KAAA,CAAM,UAAW,CAAAqC,MAAA,CAAAgoC,QAAA,CAASrqC,KAAO,CAAA,CAAA,CACjCuH,KAAKukC,cAAQ,CAAA,CACb78B,MAAO,CAAA,cAAc,CACrB,CAAA9F,MAAA,CAAO;IAACohC,EAAI,EAAAF,QAAA,CAASE,EAAI;IAAAsB;EAAmB,CAAA,CAAA;AACjD;AAGgB,SAAAE,iCAAAA,CACdzoC,SACA2c,QACmB,EAAA;EACb,MAAA;IAAC3gB;EAAU,CAAA,GAAAgE,OAAA;EACjB,MAAM+H,OAAO,OAAO4U,QAAA,KAAa,WAAW3gB,MAAO,CAAAG,GAAA,CAAIwgB,QAAQ,CAAI,GAAAA,QAAA;EACnE,IAAI,CAAC5U,IAAA,IAAQ,EAAE,WAAA,IAAeA,IAAO,CAAA,EAAA;IACnC,OAAO,EAAC;EACV;EAEA,OAAA,CACEA,KAAK2gC,SAAY,GAAA3gC,IAAA,CAAK2gC,UAAU3pC,MAAO,CAAAqoC,wBAAwB,IAAIA,wBACnE,EAAA1pC,GAAA,CAAKqpC,YACLuB,mBAAoB,CAAAtoC,OAAA,EAAS+mC,UAAUF,qBAAsB,CAAA9+B,IAAA,EAAMg/B,QAAS,CAAAE,EAAE,CAAC,CAAA,CACjF;AACF;;;;;;;;;;;;ACpRgB,SAAA0B,2BAAAA,CACd38B,IACA,EAAAvG,KAAA,EACAuiB,IACe,EAAA;EACR,OAAAhc,IAAA,YAAgB48B,uBAAuB58B,IAAK,CAAAu7B,SAAA,CAAU;IAACvf,IAAM;IAAAviB;GAAM,CAAI,GAAAuG,IAAA;AAChF;AAkBO,MAAM48B,oBAA4D,CAAA;EAMvEhD,WAAAA,CAIY4B,UACVC,IACA,EAAA;IAFU,IAAA,CAAAD,QAAA,GAAAA,QAAA;IARZ;IAAUzB,eAAA,CAAA,IAAA,EAAA,KAAA,CAAA;IAEV;IAAUA,eAAA,CAAA,IAAA,EAAA,QAAA,CAAA;IASH,IAAA,CAAAlhC,GAAA,GAAM4iC,IAAO,GAAAA,IAAA,CAAK3nC,EAAK,GAAA,EAAA;IACvB,IAAA,CAAA+oC,MAAA,GAASpB,IAAO,GAAAA,IAAA,CAAK/qC,KAAQ,GAAA,EAAA;EACpC;EAAA;AAAA;AAAA;AAAA;AAAA;EAOAoD,GAAGA,EAAkC,EAAA;IAC5B,OAAA,IAAI8oC,qBAAqB,IAAK,CAAApB,QAAA,EAAU;MAAC1nC,EAAI;MAAApD,KAAA,EAAO,IAAK,CAAAmsC;IAAA,CAAO,CAAA;EACzE;EAAA;AAAA;AAAA;AAAA;EAMAC,KAAgBA,CAAA,EAAA;IACd,OAAO,IAAK,CAAAjkC,GAAA;EACd;EAAA;AAAA;AAAA;AAAA;AAAA;EAOAnI,MAAMA,KAAqC,EAAA;IAClC,OAAA,IAAIksC,qBAAqB,IAAK,CAAApB,QAAA,EAAU;MAAC1nC,EAAI,EAAA,IAAA,CAAK+E,GAAK;MAAAnI;IAAA,CAAM,CAAA;EACtE;EAAA;AAAA;AAAA;AAAA;EAMAkrC,QAAmBA,CAAA,EAAA;IACjB,OAAO,IAAK,CAAAiB,MAAA;EACd;EAAA;AAAA;AAAA;AAAA;AAAA;EAOAtB,YAAiE;IAAA,IAAvDxgB,OAA4B,GAAAgb,SAAA,CAAAniC,MAAA,QAAAmiC,SAAA,QAAAC,SAAA,GAAAD,SAAA,MAAA;MAAC/Z,IAAM,EAAA;KAAoB;IACzD,MAAA;MAACnjB,GAAK;MAAAgkC;IAAU,CAAA,GAAA,IAAA;IACtB,IAAI,CAAChkC,GAAK,EAAA;MACR,MAAM,IAAI8gC,cAAA,CACR,wCAAA,EACA5e,OAAQ,CAAAiB,IAAA,EACRjB,OAAQ,CAAAthB,KAAA,EACRojC,MAAA,CACF,CAAE7C,WAAY,CAAAE,QAAA,CAAS6C,WAAW,CAAA;IACpC;IAEA,IAAI,CAACF,MAAQ,EAAA;MACX,MAAM,IAAIlD,cAAA,CACR,2CAAA,EACA5e,OAAQ,CAAAiB,IAAA,EACRnjB,GAAA,CACF,CAAEmhC,WAAY,CAAAE,QAAA,CAAS+B,cAAc,CAAA;IACvC;IAEO,OAAA;MACLnoC,EAAI,EAAA+E,GAAA;MACJnI,KAAO,EAAAmsC;IAAA,CACT;EACF;AACF;AC1GO,MAAMG,iBAAoB,GAAA,mBAAA;AAEjB,SAAAC,UAAAA,CACdnpC,EACA,EAAA+lC,UAAA,EACApe,WACQ,EAAA;EACJ,IAAA,OAAO3nB,OAAO,QAAU,EAAA;IAC1B,MAAM,IAAI6lC,cAAA,CACR,iDAAiD5mC,MAAO,CAAA,OAAAe,EAAA,CAAA,EACxD+lC,UAAA,EACApe,WAAA,CACF;EACF;EAEA,MAAM,CAACyhB,cAAc,CAAA,GAAIppC,GAAGiqB,KAAM,CAAAif,iBAAiB,KAAK,EAAC;EACzD,IAAIE,cAAgB,EAAA;IAClB,MAAM,IAAIvD,cAAA,CACR,+CAA+C5mC,MAAc,CAAAmqC,cAAA,EAAA,GAAA,CAAA,EAC7DrD,UAAA,EACApe,WAAA,CACF;EACF;EAEI,IAAA3nB,EAAA,CAAGoiC,UAAW,CAAA,UAAU,CAAG,EAAA;IAC7B,MAAM,IAAIyD,cAAA,CACR,8CAAA,EACAE,UAAA,EACApe,WAAA,CACF;EACF;EAEO,OAAA3nB,EAAA;AACT;AChCgB,SAAAqpC,kBAAAA,CAAmBzsC,OAAeoD,EAAqB,EAAA;EACrE,IAAIA,EAAI,EAAA;IACC,OAAAA,EAAA;EACT;EAEM,MAAAspC,UAAA,GAAaC,2BAAU3sC,KAAK,CAAA;EAE3B,OAAAssC,iBAAA,CAAkB3gB,KAAK+gB,UAAU,CAAA,GAAIC,2BAAUC,4BAAQ,CAAA5sC,KAAK,CAAC,CAAI,GAAA0sC,UAAA;AAC1E;;;;;;;;;;;;ACwDO,MAAMG,gBAAoD,CAAA;EAI/D3D,YAAY6B,IAAuB,EAAA;IAFnC;IAAU1B,eAAA,CAAA,IAAA,EAAA,MAAA,CAAA;IAGH,IAAA,CAAA0B,IAAA,GAAO;MAAC1gB,OAAS,EAAA,CAAA;MAAI,IAAI0gB,IAAA,GAAOA,IAAO,GAAA,CAAA,CAAG;KAAA;EACjD;EAAA;AAAA;AAAA;AAAA;EAMA3nC,GAAGA,EAA8B,EAAA;IAC/B,OAAO,IAAK,CAAA4nC,KAAA,CAAM;MAAC5nC;IAAG,CAAA,CAAA;EACxB;EAAA;AAAA;AAAA;EAKAgpC,KAAkCA,CAAA,EAAA;IAChC,OAAO,KAAKrB,IAAK,CAAA3nC,EAAA;EACnB;EAAA;AAAA;AAAA;AAAA;EAMApD,MAAMA,KAAiC,EAAA;IAC9B,OAAA,IAAA,CAAKgrC,KAAM,CAAA;MAAChrC,KAAO;MAAAoD,EAAA,EAAIqpC,kBAAmB,CAAAzsC,KAAA,EAAO,IAAK,CAAA+qC,IAAA,CAAK3nC,EAAE;IAAE,CAAA,CAAA;EACxE;EAAA;AAAA;AAAA;EAKA8nC,QAAwCA,CAAA,EAAA;IACtC,OAAO,KAAKH,IAAK,CAAA/qC,KAAA;EACnB;EAAA;AAAA;AAAA;AAAA;EAMAmU,MAAMA,KAAgC,EAAA;IACpC,OAAO,IAAK,CAAA62B,KAAA,CAAM;MAAC72B;IAAM,CAAA,CAAA;EAC3B;EAAA;AAAA;AAAA;EAKA24B,QAAwCA,CAAA,EAAA;IACtC,OAAO,KAAK/B,IAAK,CAAA52B,KAAA;EACnB;EAAA;AAAA;AAAA;AAAA;EAMAoR,UAAUA,SAA4C,EAAA;IACpD,OAAO,IAAK,CAAAylB,KAAA,CAAM;MAACzlB;IAAU,CAAA,CAAA;EAC/B;EAAA;AAAA;AAAA;EAKAwnB,YAAgDA,CAAA,EAAA;IAC9C,OAAO,KAAKhC,IAAK,CAAAxlB,SAAA;EACnB;EAAA;AAAA;AAAA;AAAA;EAMA8E,QAAQA,OAAqD,EAAA;IAC3D,OAAO,IAAK,CAAA2gB,KAAA,CAAM;MAAC3gB;IAAQ,CAAA,CAAA;EAC7B;EAAA;AAAA;AAAA;EAKA2iB,UAAyDA,CAAA,EAAA;IAChD,OAAA,IAAA,CAAKjC,IAAK,CAAA1gB,OAAA,IAAW,EAAC;EAC/B;EAAA;AAAA;AAAA;AAAA;EAMAjM,UAAUA,SAA6D,EAAA;IACrE,OAAO,IAAK,CAAA4sB,KAAA,CAAM;MAAC5sB;IAAU,CAAA,CAAA;EAC/B;EAAA;AAAA;AAAA;EAKAogB,YAAgDA,CAAA,EAAA;IAC9C,OAAO,KAAKuM,IAAK,CAAA3sB,SAAA;EACnB;EAAA;AAAA;AAAA;AAAA;EAMAC,eAAeA,cAA4E,EAAA;IACzF,OAAO,IAAK,CAAA2sB,KAAA,CAAM;MAAC3sB;IAAe,CAAA,CAAA;EACpC;EAAA;AAAA;AAAA;EAKA4uB,iBAA0DA,CAAA,EAAA;IACxD,OAAO,KAAKlC,IAAK,CAAA1sB,cAAA;EACnB;EAAA;AAAA;AAAA;AAAA;AAAA;EAOAwsB,YAA6D;IAAA,IAAnDxgB,OAA4B,GAAAgb,SAAA,CAAAniC,MAAA,QAAAmiC,SAAA,QAAAC,SAAA,GAAAD,SAAA,MAAA;MAAC/Z,IAAM,EAAA;KAAgB;IACrD,MAAA;MAACloB;MAAIpD,KAAO;MAAAmU,KAAA;MAAOkW,SAAS6iB,gBAAkB;MAAA3nB;IAAA,IAAa,IAAK,CAAAwlB,IAAA;IACtE,IAAI,CAAC3nC,EAAI,EAAA;MACP,MAAM,IAAI6lC,cAAA,CACR,iDAAA,EACA5e,OAAQ,CAAAiB,IAAA,EACRjB,OAAQ,CAAAthB,KAAA,CACV,CAAEugC,WAAY,CAAAE,QAAA,CAAS6C,WAAW,CAAA;IACpC;IAEA,IAAI,CAAC9mB,SAAW,EAAA;MACd,MAAM,IAAI0jB,cAAA,CACR,wDAAA,EACA5e,OAAQ,CAAAiB,IAAA,EACRjB,OAAQ,CAAAthB,KAAA,CACV,CAAEugC,WAAY,CAAAE,QAAA,CAAS6C,WAAW,CAAA;IACpC;IAEO,OAAA;MACLjpC,IAAImpC,UAAW,CAAAnpC,EAAA,EAAIinB,OAAQ,CAAAiB,IAAA,EAAMjB,QAAQthB,KAAK,CAAA;MAC9C/I,KAAA;MACAqL,IAAM,EAAA,WAAA;MACN8I,KAAA;MACAoR,SAAA;MACA8E,OAAA,EAAS6iB,oBAAoB,CAAC,CAAA;MAC9B9uB,SAAY,EAAA,CAAA,IAAA,CAAK2sB,IAAK,CAAA3sB,SAAA,IAAa,EAAI,EAAApd,GAAA,CAAI,CAACsO,IAAM,EAAAiP,CAAA,KAChDosB,uBAAuBr7B,IAAM,EAAAiP,CAAA,EAAG8L,QAAQiB,IAAI,CAC9C,CAAA;MACAjN,cAAiB,EAAA,CAAA,IAAA,CAAK0sB,IAAK,CAAA1sB,cAAA,IAAkB,EAAI,EAAArd,GAAA,CAAI,CAACsO,IAAM,EAAAiP,CAAA,KAC1D0tB,4BAA4B38B,IAAM,EAAAiP,CAAA,EAAG8L,QAAQiB,IAAI,CACnD;IAAA,CACF;EACF;EAAA;AAAA;AAAA;AAAA;EAMA0f,MAAMU,QAAiD,EAAA;IAC/C,MAAAC,OAAA,GAAU,IAAIkB,gBAAiB,EAAA;IAC7BlB,OAAA,CAAAZ,IAAA,GAAO;MAAC,GAAG,IAAA,CAAKA;MAAM,IAAIW,QAAA,IAAY,CAAA,CAAG;KAAA;IAC1C,OAAAC,OAAA;EACT;AACF;AC7NsB,eAAAwB,sBAAAA,CACpBC,WACAhqC,EAC6B,EAAA;EAC7B,MAAMb,KAAQ,GAAA,yCAAA;EACR,MAAAZ,UAAA,GAAaM,sBAAemB,EAAE,CAAA;EAC9B,MAAAtB,OAAA,GAAUC,kBAAWqB,EAAE,CAAA;EAE7B,MAAMiqC,KAAQ,GAAA,MAAMD,SAAU,CAAAnoC,MAAAA,CAAAA,6BAA6B,CAAE,CAAAR,KAAA,CAC3DlC,KAAA,EACA;IAACZ;IAAYG;EAAO,CAAA,EACpB;IAACW,KAAK;EAAwB,CAAA,CAChC;EAEA,OAAO4qC,MAAM,CAAC,CAAA;AAChB;;;;;;;;;;;;ACGO,MAAeC,kBAEtB,CAAA;EAFOpE,WAAAA,CAAA,EAAA;IAIL;IAAAG,eAAA,CAAA,IAAA,EAAU,QAAc,CAAA,CAAC,CAAA;EAAA;EAAA;AAAA;AAAA;AAAA;EAMzBjmC,GAAGA,EAA0B,EAAA;IAC3B,OAAO,IAAK,CAAA4nC,KAAA,CAAM;MAAC5nC;IAAG,CAAA,CAAA;EACxB;EAAA;AAAA;AAAA;EAIAgpC,KAAqBA,CAAA,EAAA;IACnB,OAAO,KAAKrB,IAAK,CAAA3nC,EAAA;EACnB;EAAA;AAAA;AAAA;AAAA;EAMApD,MAAMA,KAA6B,EAAA;IAC1B,OAAA,IAAA,CAAKgrC,KAAM,CAAA;MAAChrC,KAAO;MAAAoD,EAAA,EAAI,IAAK,CAAA2nC,IAAA,CAAK3nC,EAAM,IAAAmqC,kBAAAA,CAAAA,OAAA,CAAUvtC,KAAK;IAAE,CAAA,CAAA;EACjE;EAAA;AAAA;AAAA;EAKAkrC,QAA2BA,CAAA,EAAA;IACzB,OAAO,KAAKH,IAAK,CAAA/qC,KAAA;EACnB;EAAA;AAAA;AAAA;AAAA;EAMAuH,KAAKA,IAA2D,EAAA;IAC9D,OAAO,IAAK,CAAAyjC,KAAA,CAAM;MAACzjC;IAAK,CAAA,CAAA;EAC1B;EAAA;AAAA;AAAA;EAKA6jC,OAAyBA,CAAA,EAAA;IACvB,OAAO,KAAKL,IAAK,CAAAxjC,IAAA;EACnB;EAAA;AAAA;AAAA;AAAA;EAMAsjC,YAA4D;IAAA,IAAlDxgB,OAA4B,GAAAgb,SAAA,CAAAniC,MAAA,QAAAmiC,SAAA,QAAAC,SAAA,GAAAD,SAAA,MAAA;MAAC/Z,IAAM,EAAA;KAAe;IAC1D,MAAM;MAACloB,EAAA;MAAIpD,KAAO;MAAAuH;IAAA,IAAQ,IAAK,CAAAwjC,IAAA;IAC/B,IAAI,CAAC3nC,EAAI,EAAA;MACP,MAAM,IAAI6lC,cAAA,CACR,gCAAA,EACA5e,OAAQ,CAAAiB,IAAA,EACRjB,OAAQ,CAAAthB,KAAA,CACV,CAAEugC,WAAY,CAAAE,QAAA,CAAS6C,WAAW,CAAA;IACpC;IAEA,IAAI,CAACrsC,KAAO,EAAA;MACV,MAAM,IAAIipC,cAAA,CACR,mCAAA,EACA5e,OAAQ,CAAAiB,IAAA,EACRjB,OAAQ,CAAAthB,KAAA,CACV,CAAEugC,WAAY,CAAAE,QAAA,CAAS+B,cAAc,CAAA;IACvC;IAEO,OAAA;MACLnoC,IAAImpC,UAAW,CAAAnpC,EAAA,EAAIinB,OAAQ,CAAAiB,IAAA,EAAMjB,QAAQthB,KAAK,CAAA;MAC9C/I,KAAA;MACAuH;IAAA,CACF;EACF;AAOF;AAEA,SAASimC,eAAepL,IAAyE,EAAA;EACxF,OAAA,OAAQA,KAAgCyI,SAAc,KAAA,UAAA;AAC/D;AAGgB,SAAA4C,kBAAAA,CACdn+B,IACA,EAAAvG,KAAA,EACAuiB,IACM,EAAA;EACC,OAAAkiB,cAAA,CAAel+B,IAAI,CAAI,GAAAA,IAAA,CAAKu7B,UAAU;IAACvf,IAAA;IAAMviB;GAAM,CAAI,GAAAuG,IAAA;AAChE;;;;;;;;;;;;ACzGA,MAAMo+B,kBAAmB3C,IAAA,IACvBrjC,gBAASqjC,IAAI,CAAA,IAAKA,KAAK1/B,IAAS,KAAA,WAAA;AAM3B,MAAMsiC,6BAA6BL,kBAGxC,CAAA;EAIApE,YAKE0E,eACA,EAAA;IACM,MAAA7C,IAAA,GAAO2C,eAAgB,CAAAE,eAAe,CAAI,GAAA;MAAC,GAAGA;KAAmB,GAAA;MAACvjB,OAAS,EAAA,CAAA;KAAE;IAE7E,KAAA,EAAA;IAXR;IAAUgf,eAAA,CAAA,IAAA,EAAA,MAAA,CAAA;IAYR,IAAA,CAAK0B,IAAO,GAAAA,IAAA;IAEZ,MAAM8C,gBACJ,OAAOD,eAAA,KAAoB,UAAa,GAAAA,eAAA,GAAkB,KAAK7C,IAAK,CAAAxlB,SAAA;IAEtE,IAAIsoB,aAAe,EAAA;MAEjB,IAAA,CAAK9C,IAAO,GAAA,IAAA,CAAKxlB,SAAU,CAAAsoB,aAAa,CAAE,CAAA9C,IAAA;IAC5C;EACF;EAAA;AAAA;AAAA;AAAA;EAMAxlB,UAAUA,SAAoD,EAAA;IAC5D,OAAO,IAAK,CAAAylB,KAAA,CAAM;MAACzlB;IAAU,CAAA,CAAA;EAC/B;EAAA;AAAA;AAAA;EAKAwnB,YAAoDA,CAAA,EAAA;IAClD,OAAO,KAAKhC,IAAK,CAAAxlB,SAAA;EACnB;EAAA;AAAA;AAAA;AAAA;EAMA8E,QAAQA,OAAqD,EAAA;IAC3D,OAAO,IAAK,CAAA2gB,KAAA,CAAM;MAAC3gB;IAAQ,CAAA,CAAA;EAC7B;EAAA;AAAA;AAAA;EAKA2iB,UAAuCA,CAAA,EAAA;IAC9B,OAAA,IAAA,CAAKjC,IAAK,CAAA1gB,OAAA,IAAW,EAAC;EAC/B;EAAA;AAAA;AAAA;AAAA;AAAA;EAOAwgB,YAAiE;IAAA,IAAvDxgB,OAA4B,GAAAgb,SAAA,CAAAniC,MAAA,QAAAmiC,SAAA,QAAAC,SAAA,GAAAD,SAAA,MAAA;MAAC/Z,IAAM,EAAA;KAAoB;IACzD,MAAAxP,IAAA,GAAO,KAAM,CAAA+uB,SAAA,CAAUxgB,OAAO,CAAA;IAE9B,MAAA9E,SAAA,GAAY,KAAKwlB,IAAK,CAAAxlB,SAAA;IACxB,IAAA,OAAOA,cAAc,UAAY,EAAA;MACnC,MAAM,IAAI0jB,cAAA,CACR,4EAAA,EACA5e,OAAQ,CAAAiB,IAAA,EACRjB,OAAQ,CAAAthB,KAAA,CACV,CAAEugC,WAAY,CAAAE,QAAA,CAASsE,kBAAkB,CAAA;IAC3C;IAEO,OAAA;MACL,GAAGhyB,IAAA;MACHyJ,SAAA;MACA8E,OAAS,EAAA,IAAA,CAAK0gB,IAAK,CAAA1gB,OAAA,IAAW,CAAC,CAAA;MAC/Bhf,IAAM,EAAA;IAAA,CACR;EACF;EAAA;AAAA;AAAA;AAAA;EAMA2/B,MAAMU,QAAyD,EAAA;IACvD,MAAAC,OAAA,GAAU,IAAIgC,oBAAqB,EAAA;IACjChC,OAAA,CAAAZ,IAAA,GAAO;MAAC,GAAG,IAAA,CAAKA;MAAM,IAAIW,QAAA,IAAY,CAAA,CAAG;KAAA;IAC1C,OAAAC,OAAA;EACT;AACF;;;;;;;;;;;;ACtGO,MAAMoC,wBAAwBT,kBAAuD,CAAA;EAI1FpE,YAAY6B,IAA0B,EAAA;IAC9B,KAAA,EAAA;IAHR;IAAU1B,eAAA,CAAA,IAAA,EAAA,MAAA,CAAA;IAIH,IAAA,CAAA0B,IAAA,GAAO;MAAC3nC,EAAA,EAAI,QAAU;MAAApD,KAAA,EAAO;MAAU,IAAI+qC,IAAA,GAAOA,IAAO,GAAA,CAAA,CAAG;KAAA;EACnE;EAAA;AAAA;AAAA;AAAA;AAAA;EAOAF,YAA4D;IAAA,IAAlDxgB,OAA4B,GAAAgb,SAAA,CAAAniC,MAAA,QAAAmiC,SAAA,QAAAC,SAAA,GAAAD,SAAA,MAAA;MAAC/Z,IAAM,EAAA;KAAe;IACnD,OAAA;MACL,GAAG,KAAM,CAAAuf,SAAA,CAAUxgB,OAAO,CAAA;MAC1Bhf,IAAM,EAAA;IAAA,CACR;EACF;EAAA;AAAA;AAAA;AAAA;AAAA;EAOA2/B,MAAMU,QAA+C,EAAA;IAC7C,MAAAC,OAAA,GAAU,IAAIoC,eAAgB,EAAA;IAC5BpC,OAAA,CAAAZ,IAAA,GAAO;MAAC,GAAG,IAAA,CAAKA;MAAM,IAAIW,QAAA,IAAY,CAAA,CAAG;KAAA;IAC1C,OAAAC,OAAA;EACT;AACF;ACrCO,MAAMqC,IAAO,GAACjD,IAA8C,IAAA,IAAIgD,gBAAgBhD,IAAI,CAAA;AAGpF,MAAMxlB,SAAY,GACvBqoB,eACyB,IAAA,IAAID,qBAAqBC,eAAe,CAAA;;;;;;;;;;;;;;;;;;;;;ACFnE,MAAMK,2BAAA,GACJC,MAAA;EAAA,IAAC;IAACC,mBAAqB;IAAAf;EAAA,CACvB,GAAAc,MAAA;EAAA,OAAA,OAAOE,MAAQ,EAAAC,MAAA,KAAmB;IAAA,IAAnB;MAACllC,MAAQ;MAAAmiB;KAAU,GAAA+iB,MAAA;IAChC,IAAIhjC,OAAOlC,MAAO,CAAAkC,IAAA;IAElB,MAAM89B,aAAa7d,IAAK,CAAA9gB,KAAA,CAAM,CAAG,EAAA8gB,IAAA,CAAKpoB,SAAS,CAAC,CAAA;IAChD,MAAMorC,cAAiB,GAAAhjB,IAAA,CAAKA,IAAK,CAAApoB,MAAA,GAAS,CAAC,CAAA;IAE3C,IAAI,CAACmI,IAAM,EAAA;MACFA,IAAA,GAAA,MAAM8hC,sBAAuB,CAAAC,SAAA,EAAWgB,MAAM,CAAA;IACvD;IAEA,IAAI,CAAC/iC,IAAM,EAAA;MACT,MAAM,IAAI49B,cAAA,CACR,iEAAA,EACAE,UAAA,EACAmF,cAAA,CACF;IACF;IAEA,OAAOH,oBAAoB;MAACxsC,UAAA,EAAYysC,MAAQ;MAAA5uC,UAAA,EAAY6L;KAAK,CAAA;EACnE,CAAA;AAAA;AA0CK,MAAMkjC,eAAsD,CAAA;EAIjErF,WAAAA,CAIY4B,UACVC,IACA,EAAA;IAFU,IAAA,CAAAD,QAAA,GAAAA,QAAA;IANZ;IAAUzB,eAAA,CAAA,IAAA,EAAA,MAAA,CAAA;IASH,IAAA,CAAA0B,IAAA,GAAOA,IAAO,GAAAA,IAAA,GAAO,CAAA,CAAC;EAC7B;EAAA;AAAA;AAAA;AAAA;EAMA3nC,GAAGA,EAA6B,EAAA;IAC9B,OAAO,IAAK,CAAA4nC,KAAA,CAAM;MAAC5nC;IAAG,CAAA,CAAA;EACxB;EAAA;AAAA;AAAA;EAKAgpC,KAAmCA,CAAA,EAAA;IACjC,OAAO,KAAKrB,IAAK,CAAA3nC,EAAA;EACnB;EAAA;AAAA;AAAA;AAAA;EAMApD,MAAMA,KAAgC,EAAA;IAC7B,OAAA,IAAA,CAAKgrC,KAAM,CAAA;MAAChrC,KAAO;MAAAoD,EAAA,EAAIqpC,kBAAmB,CAAAzsC,KAAA,EAAO,IAAK,CAAA+qC,IAAA,CAAK3nC,EAAE;IAAE,CAAA,CAAA;EACxE;EAAA;AAAA;AAAA;EAKA8nC,QAAyCA,CAAA,EAAA;IACvC,OAAO,KAAKH,IAAK,CAAA/qC,KAAA;EACnB;EAAA;AAAA;AAAA;AAAA;EAMAmU,MAAMA,KAA+B,EAAA;IACnC,OAAO,IAAK,CAAA62B,KAAA,CAAM;MAAC72B;IAAM,CAAA,CAAA;EAC3B;EAAA;AAAA;AAAA;EAKA24B,QAAyCA,CAAA,EAAA;IACvC,OAAO,KAAK/B,IAAK,CAAA52B,KAAA;EACnB;EAAA;AAAA;AAAA;AAAA;EAMAxS,WAAWA,UAAqC,EAAA;IAExC,MAAA6sC,MAAA,GAAS,IAAK,CAAAzD,IAAA,CAAK3nC,EAAM,IAAAzB,UAAA;IAC/B,OAAO,KAAKqpC,KAAM,CAAA;MAChB5nC,EAAI,EAAAorC,MAAA;MACJnkB,OAAS,EAAA;QACP,IAAI,IAAA,CAAK0gB,IAAK,CAAA1gB,OAAA,IAAW,CAAC,CAAA;QAC1BjnB,EAAI,EAAAzB;MACN;IAAA,CACD,CAAA;EACH;EAAA;AAAA;AAAA;EAKA8sC,aAAgDA,CAAA,EAAA;IAzJlD,IAAAxhC,EAAA;IA0JW,OAAA,CAAAA,EAAA,GAAA,IAAA,CAAK89B,IAAK,CAAA1gB,OAAA,KAAV,IAAmB,GAAA,KAAA,CAAA,GAAApd,EAAA,CAAA7J,EAAA;EAC5B;EAAA;AAAA;AAAA;AAAA;EAMA5D,WAAW0L,YAAoD,EAAA;IAC7D,OAAO,KAAK8/B,KAAM,CAAA;MAChB3gB,OAAS,EAAA;QACP,IAAI,IAAA,CAAK0gB,IAAK,CAAA1gB,OAAA,IAAW,CAAC,CAAA;QAC1Bhf,IAAM,EAAA,OAAOH,YAAiB,KAAA,QAAA,GAAWA,eAAeA,YAAa,CAAA0B;MACvE;IAAA,CACD,CAAA;EACH;EAAA;AAAA;AAAA;EAKA8hC,aAAkDA,CAAA,EAAA;IA7KpD,IAAAzhC,EAAA;IA8KW,OAAA,CAAAA,EAAA,GAAA,IAAA,CAAK89B,IAAK,CAAA1gB,OAAA,KAAV,IAAmB,GAAA,KAAA,CAAA,GAAApd,EAAA,CAAA5B,IAAA;EAC5B;EAAA;AAAA;AAAA;AAAA;AAAA;EAOAsjC,oBAAAA,CAAqBxuB,YAAoBG,UAAuD,EAAA;IAC9F,OAAO,KAAK0qB,KAAM,CAAA;MAChB3gB,OAAS,EAAA;QACP,IAAI,IAAA,CAAK0gB,IAAK,CAAA1gB,OAAA,IAAW,CAAC,CAAA;QAC1Bjf,QAAU,EAAA+U,UAAA;QACVmhB,kBAAoB,EAAAhhB;MACtB;IAAA,CACD,CAAA;EACH;EAAA;AAAA;AAAA;EAKAsuB,uBAAgEA,CAAA,EAAA;IAnMlE,IAAA3hC,EAAA;IAoMW,OAAA,CAAAA,EAAA,GAAA,IAAA,CAAK89B,IAAK,CAAA1gB,OAAA,KAAV,IAAmB,GAAA,KAAA,CAAA,GAAApd,EAAA,CAAA7B,QAAA;EAC5B;EAAA;AAAA;AAAA;EAKAyjC,iCAAoFA,CAAA,EAAA;IA1MtF,IAAA5hC,EAAA;IA2MW,OAAA,CAAAA,EAAA,GAAA,IAAA,CAAK89B,IAAK,CAAA1gB,OAAA,KAAV,IAAmB,GAAA,KAAA,CAAA,GAAApd,EAAA,CAAAq0B,kBAAA;EAC5B;EAAA;AAAA;AAAA;AAAA;EAMAJ,MAAMA,KAAgD,EAAA;IACpD,OAAO,IAAK,CAAA8J,KAAA,CAAM;MAAC9J;IAAM,CAAA,CAAA;EAC3B;EAAA;AAAA;AAAA;EAKA4N,QAAmCA,CAAA,EAAA;IAC1B,OAAA,IAAA,CAAK/D,IAAK,CAAA7J,KAAA,IAAS,EAAC;EAC7B;EAAA;AAAA;AAAA;AAAA;EAMA2J,SAAUA,CAAA,EAAuE;IAAA,IAAvE;MAACvf,IAAO,GAAA,EAAI;MAAAviB,KAAA;MAAOqgC;KAAI,GAAA/D,SAAA,CAAAniC,MAAA,QAAAmiC,SAAA,QAAAC,SAAA,GAAAD,SAAA,MAAsB;MAAC/Z,IAAA,EAAM;KAAmB;IAC/E,MAAMyjB,KAAQ,GAAAzjB,IAAA,CAAKviB,KAAS,IAAAuiB,IAAA,CAAKpoB,SAAS,CAAC,CAAA;IAG3C,MAAME,KAAK,IAAK,CAAA2nC,IAAA,CAAK3nC,EAAO,IAAA2rC,KAAA,IAAS,GAAG1sC,MAAY,CAAA0sC,KAAA,CAAA,IAAA,EAAA;IACpD,MAAM1kB,OAAoC,GAAA;MACxCjnB,EAAA;MACAiI,IAAM,EAAA,KAAA,CAAA;MACND,QAAU,EAAA,KAAA,CAAA;MACVk2B,kBAAoB,EAAA,KAAA,CAAA;MACpB,GAAG,KAAKyJ,IAAK,CAAA1gB;IAAA,CACf;IAEA,IAAI,OAAOjnB,EAAA,KAAO,QAAY,IAAA,CAACA,EAAI,EAAA;MACjC,MAAM,IAAI6lC,cAAA,CACR,qCAAA,EACA3d,IAAA,EACAviB,KAAA,EACAqgC,IAAA,CACF,CAAEE,WAAY,CAAAE,QAAA,CAAS6C,WAAW,CAAA;IACpC;IAEA,IAAI,CAAChiB,OAAA,IAAW,CAACA,OAAA,CAAQjnB,EAAI,EAAA;MAC3B,MAAM,IAAI6lC,cAAA,CACR,mDAAA,EACA3d,IAAA,EACAloB,EAAA,EACAgmC,IAAA,CACF,CAAEE,WAAY,CAAAE,QAAA,CAASwF,oBAAoB,CAAA;IAC7C;IAEA,IAAI,CAAC3kB,OAAA,IAAW,CAACA,OAAA,CAAQhf,IAAM,EAAA;MAC7B,MAAM,IAAI49B,cAAA,CACR,6DAAA,EACA3d,IAAA,EACAloB,EAAA,EACAgmC,IAAA,CACF;IACF;IAEA,MAAMlI,KAAS,GAAA,CAAA,IAAA,CAAK6J,IAAK,CAAA7J,KAAA,IAAS,KAAK6J,IAAK,CAAA7J,KAAA,CAAMh+B,MAAS,GAAA,CAAA,GAAI,KAAK6nC,IAAK,CAAA7J,KAAA,GAAQ,CAAC8M,IAAA,CAAM,CAAA,CAAG,EAAAhtC,GAAA,CACzF,CAACsO,IAAM,EAAAiP,CAAA,KAAMkvB,kBAAmB,CAAAn+B,IAAA,EAAMiP,GAAG+M,IAAI,CAAA,CAC/C;IAEA,MAAM2jB,UAAU/N,KAAM,CAAAlgC,GAAA,CAAKohC,IAAA,IAASA,KAAKh/B,EAAE,CAAA;IAC3C,MAAM8rC,KAAQ,GAAAC,aAAA,CAAAzhC,OAAA,CAAKuhC,OAAQ,CAAAlsC,MAAA,CAAO,CAACqsC,MAAA,EAAQ7wB,CAAM,KAAA0wB,OAAA,CAAQriB,QAAS,CAAAwiB,MAAA,EAAQ7wB,CAAI,GAAA,CAAC,CAAC,CAAC,CAAA;IAC7E,IAAA2wB,KAAA,CAAMhsC,SAAS,CAAG,EAAA;MACpB,MAAM,IAAI+lC,cAAA,CACR,8CAAA,CAA+C5mC,MAAM,CAAA6sC,KAAA,CAAAp/B,IAAA,CAAK,KAAK,CAAA,CAAA,EAC/Dwb,IAAA,EACAloB,EAAA,EACAgmC,IAAA,CACF;IACF;IAEO,OAAA;MACL,GAAG,IAAK,CAAA2B,IAAA;MACR52B,OAAO,IAAK,CAAA42B,IAAA,CAAK52B,KAAS,IAAA85B,2BAAA,CAA4B,KAAKnD,QAAQ,CAAA;MACnE1nC,EAAI,EAAAmpC,UAAA,CAAWnpC,EAAI,EAAAkoB,IAAA,EAAMviB,KAAK,CAAA;MAC9BsC,IAAM,EAAA,UAAA;MACNgf,OAAA,EAASglB,mBAAmBhlB,OAAO,CAAA;MACnC6W;IAAA,CACF;EACF;EAAA;AAAA;AAAA;AAAA;EAMA8J,KAAAA,CAAA,EAA2D;IAAA,IAArDU,QAAgC,GAAArG,SAAA,CAAAniC,MAAA,QAAAmiC,SAAA,QAAAC,SAAA,GAAAD,SAAA,MAAA,EAAqB;IACzD,MAAMsG,OAAU,GAAA,IAAI4C,eAAgB,CAAA,IAAA,CAAKzD,QAAQ,CAAA;IACjD,MAAMzgB,OAAU,GAAA;MAAC,IAAI,IAAA,CAAK0gB,IAAK,CAAA1gB,OAAA,IAAW,CAAC,CAAA;MAAI,IAAIqhB,QAAA,CAASrhB,OAAW,IAAA,CAAA,CAAG;KAAA;IAC1EshB,OAAA,CAAQZ,OAAO;MAAC,GAAG,KAAKA,IAAM;MAAA,GAAGW;MAAUrhB;KAAO;IAC3C,OAAAshB,OAAA;EACT;AACF;AAEA,SAAS0D,mBAAmBtE,IAAiD,EAAA;EAC3E,MAAM1L,IAAwB,GAAA;IAC5Bj8B,EAAA,EAAI2nC,KAAK3nC,EAAM,IAAA,EAAA;IACfiI,IAAA,EAAM0/B,KAAK1/B,IAAQ,IAAA;EAAA,CACrB;EAEA,IAAI0/B,KAAK3/B,QAAU,EAAA;IACjBi0B,IAAA,CAAKj0B,WAAW2/B,IAAK,CAAA3/B,QAAA;EACvB;EAEA,IAAI2/B,KAAKzJ,kBAAoB,EAAA;IAC3BjC,IAAA,CAAKiC,qBAAqByJ,IAAK,CAAAzJ,kBAAA;EACjC;EAEO,OAAAjC,IAAA;AACT;AAGgB,SAAAiQ,kBAAAA,CAAmBhsC,SAA2BynC,IAAoC,EAAA;EAChG,IAAI/nC,OAAM+nC,IAAM,IAAA,IAAA,GAAA,KAAA,CAAA,GAAAA,IAAA,CAAA1/B,IAAA;EAAA;EAEZ/H,QAAQ6qC,mBAAoB,CAAA;IAAC3uC,UAAY,EAAAurC,IAAA,CAAK1/B;GAAK,CAAA;EAAA;EAEnD,IAAIkjC,gBAAgBjrC,OAAO,CAAA;EAE/B,IAAI,CAACynC,IAAA,EAAa,OAAA/nC,GAAA;EAElB,MAAM;IAACI,EAAI;IAAAiI,IAAA;IAAMD,QAAU;IAAAk2B;MAAsByJ,IAAK,CAAA1gB,OAAA;EACtDrnB,GAAA,GAAMA,IAAII,EAAG,CAAA2nC,IAAA,CAAK3nC,EAAE,CAAA,CAAEzB,WAAWyB,EAAE,CAAA;EAEnC,IAAIiI,IAAM,EAAA;IACFrI,GAAA,GAAAA,GAAA,CAAIxD,WAAW6L,IAAI,CAAA;EAC3B;EACA,IAAID,QAAU,EAAA;IACNpI,GAAA,GAAAA,GAAA,CAAI2rC,oBAAqB,CAAAvjC,QAAA,EAAUk2B,kBAAkB,CAAA;EAC7D;EACA,IAAIyJ,KAAK52B,KAAO,EAAA;IACRnR,GAAA,GAAAA,GAAA,CAAImR,KAAM,CAAA42B,IAAA,CAAK52B,KAAK,CAAA;EAC5B;EAEO,OAAAnR,GAAA;AACT;AAGO,SAASusC,2CAEdpvB,YACAG,UACiB,EAAA;EAAA,IAHjB;IAAC6tB,mBAAA;IAAqBnuB;EAAS,CAAA,GAAAwvB,MAAA;EAI/B,MAAMpkC,WAAW4U,SAAU,CAAA9G,IAAA,CAAMgH,CAAM,IAAAA,CAAA,CAAE9c,OAAO+c,UAAU,CAAA;EAE1D,IAAI,CAAC/U,QAAU,EAAA;IACb,MAAM,IAAIxC,KAAA,CAAM,oBAAqB,CAAAvG,MAAA,CAAA8d,UAAA,EAAU,eAAe,CAAA,CAAA;EAChE;EAEA,OAAOguB,oBAAoB;IAAC3uC,UAAA,EAAY4L,QAAS,CAAA5L;EAAA,CAAW,CAAE,CAAAmvC,oBAAA,CAC5DxuB,UAAA,EACAG,UAAA,CACF;AACF;ACzWO,MAAMmvB,gBAAgB,CAAC,SAAA,EAAW,MAAQ,EAAA,OAAA,EAAS,UAAU,OAAO,CAAA;AC+B9D,MAAAC,sBAAA,GAAyBhmB,OAAO,oCAAoC,CAAA;AAyC1E,MAAMimB,uBAAsCA,CAACC,UAAA,EAAYzmC,MAAQ,EAAA0mC,MAAA,KAAoB;EAAA,IAApB;IAAChlC;GAAmB,GAAAglC,MAAA;EAxE5F,IAAA5iC,EAAA,EAAAC,EAAA;EAyEE,MAAM4iC,SAASF,UAAe,KAAA,MAAA;EAC9B,MAAMG,WAAWH,UAAe,KAAA,QAAA;EAChC,MAAMI,SAAY,GAAAnlC,IAAA;EAClB,MAAMolC,UAAa,GAAA,CAAA,CAAAhjC,EAAA,GAAA+iC,SAAA,CAAU3lB,OAAV,KAAA,IAAA,GAAA,KAAA,CAAA,GAAApd,EAAA,CAAmBlK,MAAU,KAAA,EAAA;EAChD,MAAMunB,UAAa,GAAA,CAAA,CAAApd,EAAA,GAAA8iC,SAAA,CAAU3lB,OAAV,KAAA,IAAA,GAAA,KAAA,CAAA,GAAAnd,EAAA,CAAmB/D,WAAU,CAAA,CAAC;EAC3C,MAAA+mC,SAAA,GAAYF,UAAU5lB,cACxB,GAAA,CAAC4lB,UAAU5lB,cAAc,CAAA,GACzB+lB,sBAAuB,CAAAF,UAAA,EAAY3lB,UAAU,CAAA;EAE3C,MAAA8lB,qBAAA,GAAwBJ,SAAU,CAAAI,qBAAA,IAAyB,EAAC;EAE9D,IAAAL,QAAA,IAAY5mC,OAAOiC,QAAU,EAAA;IAC/B,OAAOglC,sBAAsBjtC,IAAK,CAACktC,OAAQA,GAAI,CAAAlwB,UAAA,KAAehX,OAAOiC,QAAQ,CAAA;EAC/E;EAEA,OACG0kC,MAAU,IAAA3mC,MAAA,CAAO/F,EAAM,IAAA8sC,SAAA,CAAUtjB,QAAS,CAAAzjB,MAAA,CAAOkC,IAAI,CAAA,IACrD0kC,QAAY,IAAAG,SAAA,CAAUtjB,QAAS,CAAAzjB,MAAA,CAAOkC,IAAI,CAAA;AAE/C,CAAA;AAEAskC,oBAAA,CAAqBW,QAAW,GAAAZ,sBAAA;;;;;;;;;;;;AChFzB,MAAMa,+BAAkF,CAAA;EAI7FrH,WAAAA,CAIY4B,UACVC,IACA,EAAA;IAFU,IAAA,CAAAD,QAAA,GAAAA,QAAA;IANZ;IAAUzB,eAAA,CAAA,IAAA,EAAA,MAAA,CAAA;IASH,IAAA,CAAA0B,IAAA,GAAOA,IAAO,GAAAA,IAAA,GAAO,CAAA,CAAC;EAC7B;EAAA;AAAA;AAAA;AAAA;EAMA3nC,GAAGA,EAA6C,EAAA;IAC9C,OAAO,IAAK,CAAA4nC,KAAA,CAAM;MAAC5nC;IAAG,CAAA,CAAA;EACxB;EAAA;AAAA;AAAA;EAKAgpC,KAAiDA,CAAA,EAAA;IAC/C,OAAO,KAAKrB,IAAK,CAAA3nC,EAAA;EACnB;EAAA;AAAA;AAAA;AAAA;EAMApD,MAAMA,KAAgD,EAAA;IACpD,OAAO,IAAK,CAAAgrC,KAAA,CAAM;MAAChrC;IAAM,CAAA,CAAA;EAC3B;EAAA;AAAA;AAAA;EAKAkrC,QAAuDA,CAAA,EAAA;IACrD,OAAO,KAAKH,IAAK,CAAA/qC,KAAA;EACnB;EAAA;AAAA;AAAA;AAAA;EAMA0jB,YAAYA,WAAsD,EAAA;IAChE,OAAO,IAAK,CAAAsnB,KAAA,CAAM;MAACtnB;IAAY,CAAA,CAAA;EACjC;EAAA;AAAA;AAAA;EAKA8sB,cAAmEA,CAAA,EAAA;IACjE,OAAO,KAAKzF,IAAK,CAAArnB,WAAA;EACnB;EAAA;AAAA;AAAA;AAAA;EAMAvD,WAAWA,UAAqD,EAAA;IAExD,MAAAquB,MAAA,GAAS,IAAK,CAAAzD,IAAA,CAAK3nC,EAAM,IAAA+c,UAAA;IAC/B,OAAO,KAAK6qB,KAAM,CAAA;MAChB5nC,EAAI,EAAAorC,MAAA;MACJruB;IAAA,CACD,CAAA;EACH;EAAA;AAAA;AAAA;EAKAswB,aAAiEA,CAAA,EAAA;IAC/D,OAAO,KAAK1F,IAAK,CAAA5qB,UAAA;EACnB;EAAA;AAAA;AAAA;AAAA;EAMAG,WAAWA,UAAmE,EAAA;IAC5E,OAAO,IAAK,CAAA0qB,KAAA,CAAM;MAAC1qB;IAAW,CAAA,CAAA;EAChC;EAAA;AAAA;AAAA;EAKAowB,aAAiEA,CAAA,EAAA;IAC/D,OAAO,KAAK3F,IAAK,CAAAzqB,UAAA;EACnB;EAAA;AAAA;AAAA;AAAA;EAMAuqB,SAAUA,CAAA,EAAmF;IAAA,IAAnF;MAACvf,IAAO,GAAA,EAAI;MAAAviB,KAAA;MAAOqgC;KAAI,GAAA/D,SAAA,CAAAniC,MAAA,QAAAmiC,SAAA,QAAAC,SAAA,GAAAD,SAAA,MAAsB;MAAC/Z,IAAA,EAAM;KAA+B;IACrF,MAAA;MAACyf,IAAM;MAAAD;IAAY,CAAA,GAAA,IAAA;IACnB,MAAA;MAAC9qB;IAAa,CAAA,GAAA8qB,QAAA;IAEpB,IAAI,OAAOC,IAAK,CAAA3nC,EAAA,KAAO,QAAY,IAAA,CAAC2nC,KAAK3nC,EAAI,EAAA;MAC3C,MAAM,IAAI6lC,cAAA,CACR,wDAAA,EACA3d,IAAA,EACAviB,KAAA,EACAqgC,IAAA,CACF,CAAEE,WAAY,CAAAE,QAAA,CAAS6C,WAAW,CAAA;IACpC;IAEI,IAAA,CAACtB,KAAK5qB,UAAY,EAAA;MACpB,MAAM,IAAI8oB,cAAA,CACR,8EAAA,EACA3d,IAAA,EACAyf,IAAK,CAAA3nC,EAAA,EACLgmC,IAAA,CACF,CAAEE,WAAY,CAAAE,QAAA,CAAS6C,WAAW,CAAA;IACpC;IAEM,MAAAjhC,QAAA,GAAW4U,UAAU9G,IAAK,CAACgH,KAAMA,CAAE,CAAA9c,EAAA,KAAO2nC,KAAK5qB,UAAU,CAAA;IAE/D,IAAI,CAAC/U,QAAU,EAAA;MACb,MAAM,IAAI69B,cAAA,CACR,8EAAA,EACA3d,IAAA,EACAyf,IAAK,CAAA3nC,EAAA,EACLgmC,IAAA,CACF,CAAEE,WAAY,CAAAE,QAAA,CAAS6C,WAAW,CAAA;IACpC;IAEO,OAAA;MACLjpC,IAAI2nC,IAAK,CAAA3nC,EAAA;MACT+c,YAAY4qB,IAAK,CAAA3nC,EAAA;MACjB5D,YAAY4L,QAAS,CAAA5L,UAAA;MACrB6L,IAAM,EAAA,0BAAA;MACNqY,WAAA,EAAaqnB,IAAK,CAAArnB,WAAA,IAAetY,QAAS,CAAAsY,WAAA;MAC1C1jB,KAAA,EAAO+qC,IAAK,CAAA/qC,KAAA,IAASoL,QAAS,CAAApL,KAAA;MAC9BwP,UAAUu7B,IAAK,CAAAv7B,QAAA;MACfjI,IAAA,EAAMwjC,IAAK,CAAAxjC,IAAA,IAAQ6D,QAAS,CAAA7D,IAAA;MAC5B8Y,mBAAmB0qB,IAAK,CAAA1qB,iBAAA;MACxBC,YAAYyqB,IAAK,CAAAzqB;IAAA,CACnB;EACF;EAAA;AAAA;AAAA;AAAA;EAMA0qB,KAAAA,CAAA,EAAyF;IAAA,IAAnFU,QAA8C,GAAArG,SAAA,CAAAniC,MAAA,QAAAmiC,SAAA,QAAAC,SAAA,GAAAD,SAAA,MAAA,EAAqC;IACvF,MAAMsG,OAAU,GAAA,IAAI4E,+BAAgC,CAAA,IAAA,CAAKzF,QAAQ,CAAA;IACjEa,OAAA,CAAQZ,OAAO;MAAC,GAAG,IAAK,CAAAA,IAAA;MAAM,GAAGW;KAAQ;IAClC,OAAAC,OAAA;EACT;AACF;AAGO,SAASgF,iCACdrtC,OACmC,EAAA;EACnC,MAAM;IAAChE,MAAA;IAAQsxC,mBAAqB;IAAA5wB;EAAA,CAAa,GAAA1c,OAAA;EAG3C,MAAA4sC,SAAA,GAAY5wC,OAAOuxC,YAAa,EAAA;EACtC,MAAMC,OAAU,GAAA9wB,SAAA,CAGbjd,MAAO,CAACstC,GAAK,IAAA;IArLlB,IAAApjC,EAAA;IAqLsB,OAAA,EAAA,CAAAA,EAAA,GAAAojC,GAAA,CAAI/vB,eAAJ,IAAgB,GAAA,KAAA,CAAA,GAAArT,EAAA,CAAA/J,MAAA,CAAA;EAAM,CAAA,CACvC,CAAA6C,IAAA,CAAK,CAACyY,CAAA,EAAGqc,MAAMqV,SAAU,CAAA72B,OAAA,CAAQmF,CAAE,CAAAhf,UAAU,CAAI,GAAA0wC,SAAA,CAAU72B,OAAQ,CAAAwhB,CAAA,CAAEr7B,UAAU,CAAC,CAAA;EAG5E,OAAAsxC,OAAA,CAAQ9vC,IAAKqvC,GAAA,IAAQO,oBAAsB,CAAA,CAAAntB,wBAAA,CAAyB4sB,GAAI,CAAAjtC,EAAE,CAAC,CAAA;AACpF;AAGgB,SAAA2tC,sCAAAA,CACdzhC,IACA,EAAAvG,KAAA,EACAuiB,IAC0B,EAAA;EACnB,OAAAhc,IAAA,YAAgBihC,kCAAkCjhC,IAAK,CAAAu7B,SAAA,CAAU;IAACvf,IAAM;IAAAviB;GAAM,CAAI,GAAAuG,IAAA;AAC3F;AAGgB,SAAA0hC,sCAAAA,CACd1tC,SACAmd,aACY,EAAA;EACN,MAAA;IAACnhB,MAAQ;IAAA0gB;EAAa,CAAA,GAAA1c,OAAA;EACrB,OAAAmd,aAAA,CAAczf,GAAI,CAACsO,IAAS,IAAA;IAC3B,MAAAlE,QAAA,GAAW4U,UAAU9G,IAAK,CAACgH,KAAMA,CAAE,CAAA9c,EAAA,KAAOkM,KAAK6Q,UAAU,CAAA;IAC/D,MAAMngB,KAAQ,GAAAsP,IAAA,CAAKtP,KAAS,KAAAoL,QAAA,IAAA,IAAA,GAAA,KAAA,CAAA,GAAAA,QAAA,CAAUpL,KAAS,CAAA,IAAA,YAAA;IAC/C,MAAMmJ,MAAS,GAAA8nC,eAAA,CAAAvjC,OAAA,CACb;MAACrC,IAAM,EAAAD,QAAA,IAAYA,SAAS5L,UAAY;MAAA4L,QAAA,EAAUkE,KAAK6Q;IAAU,CAAA,EACjEra,OAAA,CACF;IACA,MAAMwd,eAA6BhU,IAAK,CAAAgR,UAAA,GAAa,CAACnX,MAAQ,EAAAmG,IAAA,CAAKgR,UAAU,CAAI,GAAAnX,MAAA;IACjF,MAAM3J,UAAa,GAAA4L,QAAA,IAAY9L,MAAO,CAAAG,GAAA,CAAI2L,SAAS5L,UAAU,CAAA;IAEtD,OAAA,IAAIorC,gBAAgBtnC,OAAO,CAAA,CAC/BtD,MAAMA,KAAK,CAAA,CACXuH,IAAM,CAAA6D,QAAA,IAAYA,QAAS,CAAA7D,IAAA,KAAS/H,yCAAY+H,IAAQ,CAAA,IAAA8Z,KAAW,CAAAA,WAAA,CACnE,CAAA5M,MAAA,CAAO;MAACpJ,IAAA,EAAM;MAAUlC,MAAQ,EAAAma;KAAa,CAAA,CAC7CunB,SAAU,CAAA,CAAA;EAAA,CACd,CAAA;AACH;;;;;;;;;;;;AC7MA,SAASqG,eAAkBA,CAAA,EAAA;EAClB,OAAA,KAAA,CAAA;AACT;AAGO,MAAMC,uBAAsCA,CAACvB,UAAA,EAAYzmC,mBAAmC;EAAA,IAA3B;IAAC0B,IAAA;IAAM9B;GAAoB,GAAAqoC,MAAA;EAC1F,OAAAroC,KAAA,IAAS,KAAK4mC,oBAAqB,CAAAC,UAAA,EAAYzmC,QAAQ;IAAC0B,IAAA;IAAM9B;GAAM,CAAA;AAC7E,CAAA;AAuFO,MAAesoC,kBAEtB,CAAA;EAFOnI,WAAAA,CAAA,EAAA;IAIL;IAAAG,eAAA,CAAA,IAAA,EAAU,gCAAiC,EAAA,KAAA,CAAA;IAE3C;IAAAA,eAAA,CAAA,IAAA,EAAU,QAAc,CAAA,CAAC,CAAA;EAAA;EAAA;AAAA;AAAA;AAAA;EAMzBjmC,GAAGA,EAA0B,EAAA;IAC3B,OAAO,IAAK,CAAA4nC,KAAA,CAAM;MAAC5nC;IAAG,CAAA,CAAA;EACxB;EAAA;AAAA;AAAA;EAKAgpC,KAAqBA,CAAA,EAAA;IACnB,OAAO,KAAKrB,IAAK,CAAA3nC,EAAA;EACnB;EAAA;AAAA;AAAA;AAAA;EAMApD,MAAMA,KAA6B,EAAA;IAC1B,OAAA,IAAA,CAAKgrC,KAAM,CAAA;MAAChrC,KAAO;MAAAoD,EAAA,EAAIqpC,kBAAmB,CAAAzsC,KAAA,EAAO,IAAK,CAAA+qC,IAAA,CAAK3nC,EAAE;IAAE,CAAA,CAAA;EACxE;EAAA;AAAA;AAAA;EAKA8nC,QAA2BA,CAAA,EAAA;IACzB,OAAO,KAAKH,IAAK,CAAA/qC,KAAA;EACnB;EAAA;AAAA;AAAA;AAAA;EAMAsxC,cAAcA,aAA+C,EAAA;IAC3D,OAAO,IAAK,CAAAtG,KAAA,CAAM;MAACsG;IAAc,CAAA,CAAA;EACnC;EAAA;AAAA;AAAA;EAKAC,gBAA2CA,CAAA,EAAA;IACzC,OAAO,KAAKxG,IAAK,CAAAuG,aAAA;EACnB;EAAA;AAAA;AAAA;AAAA;EAMAlzB,UAAUA,SAAqE,EAAA;IAC7E,OAAO,IAAK,CAAA4sB,KAAA,CAAM;MAAC5sB;IAAU,CAAA,CAAA;EAC/B;EAAA;AAAA;AAAA;EAKAogB,YAAmCA,CAAA,EAAA;IACjC,OAAO,KAAKuM,IAAK,CAAA3sB,SAAA;EACnB;EAAA;AAAA;AAAA;AAAA;EAMAC,eAAeA,cAAwE,EAAA;IACrF,OAAO,IAAK,CAAA2sB,KAAA,CAAM;MAAC3sB;IAAe,CAAA,CAAA;EACpC;EAAA;AAAA;AAAA;EAKA4uB,iBAA6CA,CAAA,EAAA;IAC3C,OAAO,KAAKlC,IAAK,CAAA1sB,cAAA;EACnB;EAAA;AAAA;AAAA;AAAA;EAMAlK,MAAMA,KAA4B,EAAA;IAChC,OAAO,IAAK,CAAA62B,KAAA,CAAM;MAAC72B;IAAM,CAAA,CAAA;EAC3B;EAAA;AAAA;AAAA;EAKA24B,QAA2BA,CAAA,EAAA;IACzB,OAAO,KAAK/B,IAAK,CAAA52B,KAAA;EACnB;EAAA;AAAA;AAAA;AAAA;EAMA+V,gBAAgBA,eAA+C,EAAA;IAC7D,OAAO,IAAK,CAAA8gB,KAAA,CAAM;MAAC9gB;IAAgB,CAAA,CAAA;EACrC;EAAA;AAAA;AAAA;EAKAsnB,kBAA+CA,CAAA,EAAA;IAC7C,OAAO,KAAKzG,IAAK,CAAA7gB,eAAA;EACnB;EAAA;AAAA;AAAA;AAAA;EAMAunB,SAAAA,CAAA,EAAwC;IAAA,IAA9Bn2B,8EAAU,IAAoB;IACtC,OAAO,KAAK0vB,KAAM,CAAA;MAChB0G,cAAA,EAAgB;QAAC,IAAI,IAAA,CAAK3G,KAAK2G,cAAkB,IAAA,CAAK,CAAA;QAAAD,SAAA,EAAWn2B;MAAO;IAAA,CACzE,CAAA;EACH;EAAA;AAAA;AAAA;EAKAq2B,YAAoCA,CAAA,EAAA;IAClC,OAAO,KAAK5G,IAAK,CAAA2G,cAAA,GAAiB,IAAK,CAAA3G,IAAA,CAAK2G,eAAeD,SAAY,GAAA,KAAA,CAAA;EACzE;EAAA;AAAA;AAAA;AAAA;EAMArB,sBACEpwB,SAIc,EAAA;IACd,IAAA,CAAK4xB,8BAAiC,GAAA,IAAA;IACtC,OAAO,IAAK,CAAA5G,KAAA,CAAM;MAACoF,qBAAA,EAAuB3qC,KAAM,CAAAoc,OAAA,CAAQ7B,SAAS,CAAA,GAAIA,SAAY,GAAA,CAACA,SAAS;IAAE,CAAA,CAAA;EAC/F;EAAA;AAAA;AAAA;EAKA6xB,wBAA2DA,CAAA,EAAA;IACzD,OAAO,KAAK9G,IAAK,CAAAqF,qBAAA;EACnB;EAAA;AAAA;AAAA;AAAA;EAMAvF,YAA+D;IAAA,IAArDxgB,OAA4B,GAAAgb,SAAA,CAAAniC,MAAA,QAAAmiC,SAAA,QAAAC,SAAA,GAAAD,SAAA,MAAA;MAAC/Z,IAAM,EAAA;KAAkB;IACvD,MAAAloB,EAAA,GAAK,IAAK,CAAA2nC,IAAA,CAAK3nC,EAAM,IAAA,EAAA;IAC3B,MAAMkoB,OAAOjB,OAAQ,CAAAiB,IAAA;IAEf,MAAAgmB,aAAA,GAAgB,KAAKvG,IAAK,CAAAuG,aAAA;IAChC,IAAIA,aAAiB,IAAA,CAAC7B,aAAc,CAAA7iB,QAAA,CAAS0kB,aAAa,CAAG,EAAA;MAC3D,MAAM,IAAIrI,cAAA,CACR,0BAAA,CAA6B5mC,MAAc,CAAAotC,aAAA,CAAAzuC,GAAA,CAAKsO,IAAA,IAAS,IAAIjN,MAAI,CAAAiN,IAAA,EAAA,GAAA,CAAG,CAAE,CAAAQ,IAAA,CAAK,IAAI,CAAA,CAAA,EAC/Ewb,IAAA,EACAloB,MAAMinB,OAAQ,CAAAthB,KAAA,EACd,KAAKgiC,IAAK,CAAA/qC,KAAA,CACZ;IACF;IAEA,MAAMowC,qBAAyB,GAAA,CAAA,IAAA,CAAKrF,IAAK,CAAAqF,qBAAA,IAAyB,EAAI,EAAApvC,GAAA,CAAI,CAACsO,IAAM,EAAAiP,CAAA,KAC/EwyB,sCAAuC,CAAAzhC,IAAA,EAAMiP,GAAG+M,IAAI,CAAA,CACtD;IAEO,OAAA;MACLloB,IAAImpC,UAAW,CAAAnpC,EAAA,EAAIinB,QAAQiB,IAAM,EAAAloB,EAAA,IAAMinB,QAAQthB,KAAK,CAAA;MACpD/I,KAAA,EAAO,KAAK+qC,IAAK,CAAA/qC,KAAA;MACjBqL,IAAM,EAAA,aAAA;MACNimC,aAAA;MACAn9B,KAAA,EAAO,IAAK,CAAA42B,IAAA,CAAK52B,KAAS,IAAA+8B,eAAA;MAC1BhnB,eAAA,EAAiB,IAAK,CAAA6gB,IAAA,CAAK7gB,eAAmB,IAAAinB,oBAAA;MAC9CO,cAAA,EAAgB,KAAK3G,IAAK,CAAA2G,cAAA;MAC1BtB,qBAAA;MACAhyB,SAAY,EAAA,CAAA,IAAA,CAAK2sB,IAAK,CAAA3sB,SAAA,IAAa,EAAI,EAAApd,GAAA,CAAI,CAACsO,IAAM,EAAAiP,CAAA,KAChDosB,sBAAuB,CAAAr7B,IAAA,EAAMiP,GAAG+M,IAAI,CACtC,CAAA;MACAjN,cAAiB,EAAA,CAAA,IAAA,CAAK0sB,IAAK,CAAA1sB,cAAA,IAAkB,EAAI,EAAArd,GAAA,CAAI,CAACsO,IAAM,EAAAiP,CAAA,KAC1D0tB,2BAA4B,CAAA38B,IAAA,EAAMiP,GAAG+M,IAAI,CAC3C;IAAA,CACF;EACF;AAOF;;;;;;;;;;;;AC/RA,MAAMwmB,cAAA,GAAiBA,CAAC/G,IAAA,EAA2B1gB,OAA8B,KAAA;EAjBjF,IAAApd,EAAA;EAkBE,MAAMlK,MAAS,GAAA,CAAA,CAAAkK,EAAA,GAAA89B,IAAA,CAAK1gB,OAAL,KAAA,IAAA,GAAA,KAAA,CAAA,GAAApd,EAAA,CAAclK,OAAOgvC,IAAU,CAAA,CAAA,KAAA,EAAA;EAE1C,IAAA,CAAC,KAAK,GAAG,CAAA,CAAEnlB,SAAS7pB,MAAO,CAAA,CAAC,CAAC,CAAG,EAAA;IAClC,MAAM,IAAIkmC,cAAA,CACR,8BAAA,CAAkC5mC,MAAO,CAAAU,MAAA,CAAA,CAAC,CAAC,EAAA,wDAAA,CAAA,EAC3CsnB,OAAQ,CAAAiB,IAAA,EACRyf,IAAK,CAAA3nC,EAAA,EACL2nC,IAAK,CAAA/qC,KAAA,CACP,CAAEspC,WAAY,CAAAE,QAAA,CAASwI,yBAAyB,CAAA;EAClD;EAEO,OAAAjvC,MAAA;AACT,CAAA;AAEA,MAAMkvC,kCACJ,GAAC3uC,OACD,IAAA,CAAC8qC,QAAgB/jB,OAA8E,KAAA;EAlCjG,IAAApd,EAAA;EAmCI,MAAMilC,aAAa7nB,OAAQ,CAAA8nB,MAAA;EAC3B,MAAM/mC,QAAW,GAAA,CAAA,CAAA6B,EAAA,GAAAod,OAAA,CAAQlhB,MAAR,KAAA,IAAA,GAAA,KAAA,CAAA,GAAA8D,EAAA,CAAgB7B,YAC7B9H,OAAQ,CAAA0c,SAAA,CAAU9G,IAAK,CAACm3B,OAAQA,GAAI,CAAAjtC,EAAA,KAAOinB,OAAQ,CAAAlhB,MAAA,CAAOiC,QAAQ,CAClE,GAAA,KAAA,CAAA;EACE,MAAAC,IAAA,GAAOD,WACTA,QAAS,CAAA5L,UAAA,GACT0yC,WAAW9nB,cAAkB,IAAA+iB,sBAAA,CAAuB7pC,OAAQ,CAAA8pC,SAAA,EAAWgB,MAAM,CAAA;EAE1E,OAAAhR,OAAA,CAAQC,OAAQ,CAAAhyB,IAAI,CAAE,CAAAiyB,IAAA,CAAM99B,cACjCA,UACI,GAAA8D,OAAA,CAAQ6qC,oBAAoB;IAAC3uC,UAAA;IAAYmC,UAAY,EAAAysC;GAAO,CAAA,GAC5D,IAAIG,eAAgB,CAAAjrC,OAAO,EAAEF,EAAG,CAAA,QAAQ,EAAEzB,UAAW,CAAAysC,MAAM,CAAE,CAAA5uC,UAAA,CAAW,EAAE,CAAA,CAChF;AACF,CAAA;AA4DK,MAAM4yC,4BAA4Bf,kBAGvC,CAAA;EAIAnI,WAAAA,CAIY4B,UACVC,IACA,EAAA;IACM,KAAA,EAAA;IAHI,IAAA,CAAAD,QAAA,GAAAA,QAAA;IANZ;IAAUzB,eAAA,CAAA,IAAA,EAAA,MAAA,CAAA;IAUH,IAAA,CAAA0B,IAAA,GAAOA,QAAQ,EAAC;IAChB,IAAA,CAAA6G,8BAAA,GAAiC9rC,OAAQ,CAAAilC,IAAA,IAAA,IAAA,GAAA,KAAA,CAAA,GAAAA,IAAA,CAAMqF,qBAAqB,CAAA;EAC3E;EAAA;AAAA;AAAA;AAAA;EAMAiC,WAAWA,UAAyC,EAAA;IAClD,OAAO,IAAK,CAAArH,KAAA,CAAM;MAAC3gB,OAAA,EAAS;QAAC,IAAI,IAAA,CAAK0gB,IAAK,CAAA1gB,OAAA,IAAW;UAACtnB,MAAQ,EAAA;QAAM,CAAA;QAAAsvC;MAAA;IAAY,CAAA,CAAA;EACnF;EAAA;AAAA;AAAA;EAKAC,aAAoCA,CAAA,EAAA;IA1ItC,IAAArlC,EAAA;IA2IW,OAAA,CAAAA,EAAA,GAAA,IAAA,CAAK89B,IAAK,CAAA1gB,OAAA,KAAV,IAAmB,GAAA,KAAA,CAAA,GAAApd,EAAA,CAAAolC,UAAA;EAC5B;EAAA;AAAA;AAAA;AAAA;EAMAtvC,OAAOA,MAAqC,EAAA;IAC1C,OAAO,IAAK,CAAAioC,KAAA,CAAM;MAAC3gB,OAAA,EAAS;QAAC,IAAI,IAAK,CAAA0gB,IAAA,CAAK1gB,OAAW,IAAA,CAAA,CAAK;QAAAtnB;MAAA;IAAQ,CAAA,CAAA;EACrE;EAAA;AAAA;AAAA;EAKAwvC,SAAgCA,CAAA,EAAA;IAzJlC,IAAAtlC,EAAA;IA0JW,OAAA,CAAAA,EAAA,GAAA,IAAA,CAAK89B,IAAK,CAAA1gB,OAAA,KAAV,IAAmB,GAAA,KAAA,CAAA,GAAApd,EAAA,CAAAlK,MAAA;EAC5B;EAAA;AAAA;AAAA;AAAA;EAMAvD,WAAW6L,IAAgD,EAAA;IACzD,MAAM+e,cAAiB,GAAA,OAAO/e,IAAS,KAAA,QAAA,GAAWA,OAAOA,IAAK,CAAAuB,IAAA;IAC9D,OAAO,IAAK,CAAAo+B,KAAA,CAAM;MAAC5gB;IAAe,CAAA,CAAA;EACpC;EAAA;AAAA;AAAA;EAKAskB,aAAoCA,CAAA,EAAA;IAClC,OAAO,KAAK3D,IAAK,CAAA3gB,cAAA;EACnB;EAAA;AAAA;AAAA;AAAA;EAMAjhB,OAAOA,MAAsD,EAAA;IAC3D,OAAO,KAAK6hC,KAAM,CAAA;MAChB3gB,OAAA,EAAS;QAAC,IAAI,IAAK,CAAA0gB,IAAA,CAAK1gB,WAAW;UAACtnB,MAAA,EAAQ;QAAE,CAAA;QAAIoG;MAAM;IAAA,CACzD,CAAA;EACH;EAAA;AAAA;AAAA;EAKAkiC,SAAiDA,CAAA,EAAA;IA1LnD,IAAAp+B,EAAA;IA2LW,OAAA,CAAAA,EAAA,GAAA,IAAA,CAAK89B,IAAK,CAAA1gB,OAAA,KAAV,IAAmB,GAAA,KAAA,CAAA,GAAApd,EAAA,CAAA9D,MAAA;EAC5B;EAAA;AAAA;AAAA;AAAA;EAMAqpC,gBAAgBnI,QAAmD,EAAA;IACjE,IAAI,CAAC5kC,KAAA,CAAMoc,OAAQ,CAAAwoB,QAAQ,CAAG,EAAA;MACtB,MAAA,IAAIzhC,MAAM,qDAAqD,CAAA;IACvE;IAEA,OAAO,KAAKoiC,KAAM,CAAA;MAChB3gB,OAAA,EAAS;QAAC,IAAI,IAAK,CAAA0gB,IAAA,CAAK1gB,OAAW,IAAA;UAACtnB,MAAQ,EAAA;QAAA,CAAM;QAAAyvC,eAAA,EAAiBnI;MAAQ;IAAA,CAC5E,CAAA;EACH;EAAA;AAAA;AAAA;EAKAoI,kBAAqDA,CAAA,EAAA;IA/MvD,IAAAxlC,EAAA;IAgNW,OAAA,CAAAA,EAAA,GAAA,IAAA,CAAK89B,IAAK,CAAA1gB,OAAA,KAAV,IAAmB,GAAA,KAAA,CAAA,GAAApd,EAAA,CAAAulC,eAAA;EAC5B;EAAA;AAAA;AAAA;AAAA;EAMA3H,YAAgE;IAAA,IAAtDxgB,OAA4B,GAAAgb,SAAA,CAAAniC,MAAA,QAAAmiC,SAAA,QAAAC,SAAA,GAAAD,SAAA,MAAA;MAAC/Z,IAAM,EAAA;KAAmB;IAvNlE,IAAAre,EAAA;IAwNQ,IAAA,OAAO,KAAK89B,IAAK,CAAA3nC,EAAA,KAAO,YAAY,CAAC,IAAA,CAAK2nC,KAAK3nC,EAAI,EAAA;MACrD,MAAM,IAAI6lC,cAAA,CACR,qCAAA,EACA5e,OAAQ,CAAAiB,IAAA,EACRjB,OAAQ,CAAAthB,KAAA,EACR,KAAKgiC,IAAK,CAAA/qC,KAAA,CACZ,CAAEspC,WAAY,CAAAE,QAAA,CAAS6C,WAAW,CAAA;IACpC;IAEI,IAAA,CAAC,KAAKtB,IAAK,CAAA1gB,OAAA,IAAW,CAAC,IAAK,CAAA0gB,IAAA,CAAK1gB,QAAQtnB,MAAQ,EAAA;MACnD,MAAM,IAAIkmC,cAAA,CACR,yCAAA,EACA5e,OAAQ,CAAAiB,IAAA,EACR,KAAKyf,IAAK,CAAA3nC,EAAA,EACV,KAAK2nC,IAAK,CAAA/qC,KAAA,CACZ,CAAEspC,WAAY,CAAAE,QAAA,CAASkJ,eAAe,CAAA;IACxC;IAEA,MAAMC,eAAkB,GAAA,CAAA,CAAA1lC,EAAA,GAAA,IAAA,CAAK89B,IAAK,CAAA1gB,OAAA,KAAV,mBAAmBtnB,MAAW,MAAA,gBAAA;IAClD,IAAA,CAAC4vC,eAAmB,IAAA,IAAA,CAAK5H,IAAK,CAAA1gB,OAAA,CAAQtnB,UAAU,CAAC,IAAA,CAAKgoC,IAAK,CAAA1gB,OAAA,CAAQgoB,UAAY,EAAA;MACzE70B,OAAA,CAAAC,IAAA,CACN,sEAAwE,CAAApb,MAAA,CAAA,IAAA,CAAK0oC,IAAK,CAAA1gB,OAAA,CAAQtnB,MAAM,EAAA,+DAAA,CAAA,EAChG6vC,eAAA,CAAAA,eAAA,CAAgBpJ,SAASqJ,sCAAsC,CAAA,CACjE;IACF;IACO,OAAA;MACL,GAAG,KAAM,CAAAhI,SAAA,CAAUxgB,OAAO,CAAA;MAC1Bhf,IAAM,EAAA,cAAA;MACN+e,cAAA,EAAgB,KAAK2gB,IAAK,CAAA3gB,cAAA;MAC1BjW,OAAO,IAAK,CAAA42B,IAAA,CAAK52B,KAAS,IAAA89B,kCAAA,CAAmC,KAAKnH,QAAQ,CAAA;MAC1EzgB,OAAS,EAAA;QACP,GAAG,KAAK0gB,IAAK,CAAA1gB,OAAA;QAAA;QAEbgoB,UAAY,EAAA,IAAA,CAAKtH,IAAK,CAAA1gB,OAAA,CAAQgoB,cAAcptC,MAA8B,CAAAA,6BAAA,CAAAotC,UAAA;QAC1EtvC,MAAQ,EAAA+uC,cAAA,CAAe,IAAK,CAAA/G,IAAA,EAAM1gB,OAAO;MAC3C;IAAA,CACF;EACF;EAAA;AAAA;AAAA;AAAA;EAMA2gB,MAAMU,QAAqD,EAAA;IACzD,MAAMC,OAAU,GAAA,IAAIyG,mBAAoB,CAAA,IAAA,CAAKtH,QAAQ,CAAA;IAC7Ca,OAAA,CAAAZ,IAAA,GAAO;MAAC,GAAG,IAAA,CAAKA;MAAM,IAAIW,QAAA,IAAY,CAAA,CAAG;KAAA;IAE7C,IAAA,CAAC,KAAKkG,8BAAgC,EAAA;MACxCjG,OAAA,CAAQZ,KAAKqF,qBAAwB,GAAA0C,0BAAA,CAA2B,IAAK,CAAAhI,QAAA,EAAUa,QAAQZ,IAAI,CAAA;IAC7F;IAEI,IAAA,CAACY,OAAQ,CAAAZ,IAAA,CAAK3gB,cAAgB,EAAA;MAChCuhB,OAAA,CAAQZ,IAAK,CAAA3gB,cAAA,GAAiB2oB,aAAc,CAAApH,OAAA,CAAQZ,IAAI,CAAA;IAC1D;IAEO,OAAAY,OAAA;EACT;EAAA;AAAA;AAAA;EAKAqH,OAA+BA,CAAA,EAAA;IAC7B,OAAO,IAAK,CAAAjI,IAAA;EACd;AACF;AAEA,SAAS+H,0BAAAA,CACPxvC,SACAynC,IACwC,EAAA;EAClC,MAAA;IAAC3rC;EAAY,CAAA,GAAAkE,OAAA;EACb,MAAA;IAAC8mB,cAAgB;IAAAC;EAAW,CAAA,GAAA0gB,IAAA;EAC5B,MAAA;IAAChoC,MAAQ;IAAAoG;EAAA,CAAU,GAAAkhB,OAAA,IAAW;IAACtnB,MAAQ,EAAA,EAAA;IAAIoG,MAAQ,EAAA,CAAA;GAAE;EAC3D,MAAM+mC,SAAY,GAAA9lB,cAAA,GACd,CAACA,cAAc,CACf,GAAA3kB,KAAA,CAAMC,IAAK,CAAA,IAAIC,GAAI,CAAAwqC,sBAAA,CAAuBptC,MAAQ,EAAAoG,MAAM,CAAC,CAAC,CAAA;EAE1D,IAAA+mC,SAAA,CAAUhtC,WAAW,CAAG,EAAA;IACnB,OAAA,KAAA,CAAA;EACT;EAEA,OAAOgtC,SACJ,CAAA+C,OAAA,CAASzzC,UACR,IAAAJ,QAAA,CAAS8zC,yBAA0B,CAAA;IACjC7nC,IAAM,EAAA,WAAA;IACN7L;EAAA,CACD,CAAA,CACH,CACCwB,IAAKmyC,MAAA,KAAY;IAAC,GAAGA,MAAA;IAAQ5rC,IAAM,EAAA8Z,KAAAA,CAAAA;EAAa,CAAA,CAAA,CAAA;AACrD;AAEA,SAAS0xB,cAAchI,IAA+C,EAAA;EAC9D,MAAA;IAAC1gB;EAAW,CAAA,GAAA0gB,IAAA;EACZ,MAAA;IAAChoC,MAAQ;IAAAoG;EAAA,CAAU,GAAAkhB,OAAA,IAAW;IAACtnB,MAAQ,EAAA,EAAA;IAAIoG,MAAQ,EAAA,CAAA;GAAE;EACrD,MAAA+mC,SAAA,GAAYC,sBAAuB,CAAAptC,MAAA,EAAQoG,MAAM,CAAA;EACvD,OAAO+mC,SAAU,CAAAhtC,MAAA,KAAW,CAAI,GAAAgtC,SAAA,CAAU,CAAC,CAAI,GAAA,KAAA,CAAA;AACjD;AAGO,SAASC,sBACdA,CAAAptC,MAAA,EAEU;EAAA,IADVoG,MAAkC,GAAAk8B,SAAA,CAAAniC,MAAA,QAAAmiC,SAAA,QAAAC,SAAA,GAAAD,SAAA,MAAA,EACxB;EACN,IAAA6K,SAAA,GAAYkD,8BAA+B,CAAArwC,MAAA,EAAQoG,MAAM,CAAA;EAEzD,IAAA+mC,SAAA,CAAUhtC,WAAW,CAAG,EAAA;IACdgtC,SAAA,GAAAmD,6BAAA,CAA8BtwC,QAAQoG,MAAM,CAAA;EAC1D;EAEO,OAAA+mC,SAAA;AACT;AAGA,SAASkD,8BACPA,CAAArwC,MAAA,EAEU;EAAA,IADVoG,MAAkC,GAAAk8B,SAAA,CAAAniC,MAAA,QAAAmiC,SAAA,QAAAC,SAAA,GAAAD,SAAA,MAAA,EACxB;EACV,MAAMiO,OACJ,GAAA,wFAAA;EACF,MAAMC,UAAoB,EAAC;EACvB,IAAAlmB,KAAA;EACJ,OAAA,CAAQA,KAAQ,GAAAimB,OAAA,CAAQE,IAAK,CAAAzwC,MAAM,OAAO,IAAM,EAAA;IAC9CwwC,OAAA,CAAQ5hC,KAAK0b,KAAM,CAAA,CAAC,CAAK,IAAAA,KAAA,CAAM,CAAC,CAAC,CAAA;EACnC;EAEO,OAAAkmB,OAAA,CACJvyC,GAAI,CAACyyC,SAAc,IAAA;IACZ,MAAAxzB,QAAA,GAAWwzB,SAAU,CAAA,CAAC,CAAM,KAAA,GAAA,GAAMtqC,OAAOsqC,SAAU,CAAAjpC,KAAA,CAAM,CAAC,CAAC,CAAI,GAAAipC,SAAA;IACrE,MAAMC,cAAezzB,QAAuB,IAAA,EAAA,EAAI8xB,MAAO,CAAA4B,OAAA,CAAQ,gBAAgB,EAAE,CAAA;IAC1E,OAAAD,UAAA;EAAA,CACR,CACA,CAAA3wC,MAAA,CAAO+C,OAAO,CAAA;AACnB;AAGA,SAASutC,6BACPA,CAAAtwC,MAAA,EAEU;EAAA,IADVoG,MAAkC,GAAAk8B,SAAA,CAAAniC,MAAA,QAAAmiC,SAAA,QAAAC,SAAA,GAAAD,SAAA,MAAA,EACxB;EACV,MAAMiO,OAAU,GAAA,0BAAA;EACV,MAAAC,OAAA,GAAUxwC,MAAO,CAAAsqB,KAAA,CAAMimB,OAAO,CAAA;EACpC,IAAI,CAACC,OAAS,EAAA;IACZ,OAAO,EAAC;EACV;EAEA,OAAOA,OAAQ,CAAA,CAAC,CACb,CAAAt+B,KAAA,CAAM,MAAM,CACZ,CAAAjU,GAAA,CAAKqsB,KAAA,IAAUA,KAAM,CAAA0kB,IAAA,CAAO,CAAA,CAAA4B,OAAA,CAAQ,kBAAkB,EAAE,CAAC,CACzD,CAAA3yC,GAAA,CAAKsO,IAAA,IAAUA,IAAK,CAAA,CAAC,MAAM,GAAM,GAAAnG,MAAA,CAAOmG,IAAK,CAAA9E,KAAA,CAAM,CAAC,CAAC,CAAA,GAAI8E,IAAK,CAAA,CAC9DvM,OAAO+C,OAAO,CAAA;AACnB;;;;;;;;;;;;AC7VA,MAAM8tC,UAAA,GAAcC,KAAoB,IAAA;EACtC,IAAIA,iBAAiBC,WAAa,EAAA;IACzB,OAAA,aAAA;EACT;EAEI,IAAAC,SAAA,CAAoBF,KAAK,CAAG,EAAA;IACvB,OAAA,SAAA;EACT;EAEA,OAAOpuC,KAAM,CAAAoc,OAAA,CAAQgyB,KAAK,CAAA,GAAI,UAAU,OAAOA,KAAA;AACjD,CAAA;AAEA,MAAMG,UAAA,GAAc1kC,IAA+C,IAAA;EACjE,OAAOA,KAAKjE,IAAS,KAAA,UAAA;AACvB,CAAA;AAEA,MAAM4oC,sBAAwC,GAAAA,CAACrE,UAAoB,EAAAzmC,MAAA,EAAQ7F,OAAY,KAAA;EACrF,MAAMuH,OAAOvH,OAAQ,CAAAuH,IAAA;EACf,MAAAwsB,KAAA,GAAQxsB,IAAK,CAAAwsB,KAAA,IAAS,EAAC;EAE3B,OAAAA,KAAA,CACGt0B,OAAOmxC,kBAAkB,CAAA,CACzB/wC,KAAMmM,IAAA,IAASA,KAAK9P,UAAW,CAAAoN,IAAA,KAASzD,OAAOkC,IAAQ,IAAAiE,IAAA,CAAKnH,QAAQgB,MAAO,CAAA/F,EAAE,KAChF+tC,oBAAqB,CAAAvB,UAAA,EAAYzmC,QAAQ7F,OAAO,CAAA;AAEpD,CAAA;AAEA,MAAM6wC,mBAAA,GAAqCA,CAAC/F,MAAA,EAAgB/jB,OAAkC,KAAA;EAC5F,MAAM6nB,aAAa7nB,OAAQ,CAAA8nB,MAAA;EAC3B,MAAM9a,KAAQ,GAAA6a,UAAA,CAAW7a,KAAM,CAAAt0B,MAAA,CAAOixC,UAAU,CAAA;EAChD,MAAMI,MAAU,GAAA,CAAA/c,KAAA,CAAMne,IAAK,CAAC5J,IAAS,IAAAA,IAAA,CAAKlM,EAAO,KAAAgrC,MAAM,CAAK,IAAA;IAACj6B,KAAO,EAAA,KAAA;EAAA,CAAY,EAAAA,KAAA;EAEhF,IAAI,CAACigC,MAAA,IAAU,OAAOA,MAAA,KAAW,UAAY,EAAA;IACpC,OAAAA,MAAA;EACT;EAEA,OAAO,OAAOA,MAAW,KAAA,UAAA,GAAaA,MAAO,CAAAhG,MAAA,EAAQ/jB,OAAO,CAAI,GAAA+pB,MAAA;AAClE,CAAA;AAEA,SAASC,sBAAAA,CACP/kC,IACA,EAAAvG,KAAA,EACAuiB,IACoB,EAAA;EACpB,IAAIhc,gBAAgBglC,eAAiB,EAAA;IACnC,OAAOhlC,IAAK,CAAAu7B,SAAA,CAAU;MAACvf,IAAA;MAAMviB;IAAM,CAAA,CAAA;EACrC;EAEA,MAAMwrC,QAAW,GAAAjlC,IAAA;EACb,IAAAilC,QAAA,IAAYA,QAAS,CAAAlpC,IAAA,KAAS,SAAW,EAAA;IACpC,OAAAiE,IAAA;EACT;EAEA,IAAI,CAACilC,QAAA,IAAYA,QAAS,CAAAlpC,IAAA,KAAS,UAAY,EAAA;IAC7C,MAAMmpC,OAAW,GAAAD,QAAA,IAAYA,QAAS,CAAAlpC,IAAA,IAASuoC,WAAWW,QAAQ,CAAA;IAC5D,MAAAE,QAAA,GAAWD,OAAY,KAAA,OAAA,GAAU,6CAAgD,GAAA,EAAA;IACvF,MAAM,IAAIvL,cAAA,CACR,8CAAA,CAA+C5mC,gBAAO,GAAI,CAAA,CAAAA,MAAA,CAAAoyC,QAAA,CAAA,EAC1DnpB,IAAA,EACAviB,KAAA,CACF,CAAEugC,WAAY,CAAAE,QAAA,CAASkL,iBAAiB,CAAA;EAC1C;EAEO,OAAAplC,IAAA;AACT;AAEA,SAASykC,UAAaF,KAAyC,EAAA;EAC7D,OAAOnsC,MAAAA,CAAAA,QAAS,CAAAmsC,KAAK,CAAK,IAAA,OAAOA,MAAMvW,IAAS,KAAA,UAAA;AAClD;AAqCO,MAAMwW,oBAAoBzC,kBAA+C,CAAA;EAI9EnI,WAAAA,CAIY4B,UACVC,IACA,EAAA;IACM,KAAA,EAAA;IAHI,IAAA,CAAAD,QAAA,GAAAA,QAAA;IANZ;IAAUzB,eAAA,CAAA,IAAA,EAAA,MAAA,CAAA;IAUH,IAAA,CAAA0B,IAAA,GAAOA,IAAO,GAAAA,IAAA,GAAO,CAAA,CAAC;IAC3B,IAAA,CAAK6G,8BAAiC,GAAA9rC,OAAA,CAAQilC,IAAQ,IAAAA,IAAA,CAAKqF,qBAAqB,CAAA;EAClF;EAAA;AAAA;AAAA;AAAA;AAAA;EAOA/Y,MAAMA,KAA8D,EAAA;IAClE,OAAO,IAAK,CAAA2T,KAAA,CAAM;MAAC3T;IAAM,CAAA,CAAA;EAC3B;EAAA;AAAA;AAAA;EAKAsd,QAAmCA,CAAA,EAAA;IACjC,OAAO,KAAK5J,IAAK,CAAA1T,KAAA;EACnB;EAAA;AAAA;AAAA;AAAA;EAMAwT,YAAwD;IAAA,IAA9CxgB,OAA4B,GAAAgb,SAAA,CAAAniC,MAAA,QAAAmiC,SAAA,QAAAC,SAAA,GAAAD,SAAA,MAAA;MAAC/Z,IAAM,EAAA;KAAW;IAChD,MAAAloB,EAAA,GAAK,KAAK2nC,IAAK,CAAA3nC,EAAA;IACrB,IAAI,OAAOA,EAAA,KAAO,QAAY,IAAA,CAACA,EAAI,EAAA;MACjC,MAAM,IAAI6lC,cAAA,CACR,4BAAA,EACA5e,OAAQ,CAAAiB,IAAA,EACRjB,OAAQ,CAAAthB,KAAA,CACV,CAAEugC,WAAY,CAAAE,QAAA,CAAS6C,WAAW,CAAA;IACpC;IAEM,MAAAhV,KAAA,GAAQ,OAAO,IAAK,CAAA0T,IAAA,CAAK1T,UAAU,WAAc,GAAA,EAAK,GAAA,IAAA,CAAK0T,IAAK,CAAA1T,KAAA;IACtE,IAAI,CAAC5xB,KAAA,CAAMoc,OAAQ,CAAAwV,KAAK,CAAG,EAAA;MACzB,MAAM,IAAI4R,cAAA,CACR,mCAAA,EACA5e,OAAQ,CAAAiB,IAAA,EACRjB,OAAQ,CAAAthB,KAAA,CACV,CAAEugC,WAAY,CAAAE,QAAA,CAASoL,wBAAwB,CAAA;IACjD;IAEA,MAAMtpB,QAAQjB,OAAQ,CAAAiB,IAAA,IAAQ,EAAC,EAAGjpB,OAAOe,EAAE,CAAA;IACrC,MAAAyxC,eAAA,GAAkBxd,KAAM,CAAAr2B,GAAA,CAAI,CAACsO,IAAA,EAAMvG,UAAUsrC,sBAAuB,CAAA/kC,IAAA,EAAMvG,KAAO,EAAAuiB,IAAI,CAAC,CAAA;IAC5F,MAAM4jB,KAAQ,GAAA2F,eAAA,CAAgB9xC,MAAO,CAAA,CAAC+xC,KAAKv2B,CAAM,KAAArF,aAAA,CAAAxL,OAAA,CAAKmnC,eAAiB,EAAA;MAACzxC,IAAI0xC,GAAI,CAAA1xC;IAAK,CAAA,EAAAmb,CAAA,GAAI,CAAC,CAAC,CAAA;IAEvF,IAAA2wB,KAAA,CAAMhsC,SAAS,CAAG,EAAA;MACd,MAAA6xC,OAAA,GAAU7F,KAAM,CAAAluC,GAAA,CAAKsO,IAAA,IAASA,KAAKlM,EAAE,CAAA,CAAEoH,KAAM,CAAA,CAAA,EAAG,CAAC,CAAA;MACvD,MAAMwqC,QAAW,GAAA9F,KAAA,CAAMhsC,MAAS,GAAA,CAAA,GAAI,EAAG,CAAAb,MAAA,CAAA0yC,OAAA,CAAQjlC,IAAK,CAAA,IAAI,CAAC,EAAA,KAAA,CAAA,GAAQilC,OAAQ,CAAAjlC,IAAA,CAAK,IAAI,CAAA;MAClF,MAAM,IAAIm5B,cAAA,CACR,kCAAkC5mC,MAAQ,CAAA2yC,QAAA,EAAA,GAAA,CAAA,EAC1C3qB,OAAQ,CAAAiB,IAAA,EACRjB,OAAQ,CAAAthB,KAAA,CACV,CAAEugC,WAAY,CAAAE,QAAA,CAASyL,4BAA4B,CAAA;IACrD;IAEO,OAAA;MACL,GAAG,KAAM,CAAApK,SAAA,CAAUxgB,OAAO,CAAA;MAC1Bhf,IAAM,EAAA,MAAA;MACN6e,eAAA,EAAiB,IAAK,CAAA6gB,IAAA,CAAK7gB,eAAmB,IAAA+pB,sBAAA;MAC9C9/B,KAAA,EAAO,IAAK,CAAA42B,IAAA,CAAK52B,KAAS,IAAAggC,mBAAA;MAC1B9c,KAAO,EAAAwd;IAAA,CACT;EACF;EAAA;AAAA;AAAA;AAAA;AAAA;EAOA7J,MAAMU,QAAuC,EAAA;IAC3C,MAAMC,OAAU,GAAA,IAAImI,WAAY,CAAA,IAAA,CAAKhJ,QAAQ,CAAA;IACrCa,OAAA,CAAAZ,IAAA,GAAO;MAAC,GAAG,IAAA,CAAKA;MAAM,IAAIW,QAAA,IAAY,CAAA,CAAG;KAAA;IAC1C,OAAAC,OAAA;EACT;AACF;;;;;;;;;;;;ACzFO,MAAM2I,eAAkD,CAAA;EAI7DpL,WAAAA,CAIY4B,UACVC,IACA,EAAA;IAFU,IAAA,CAAAD,QAAA,GAAAA,QAAA;IANZ;IAAUzB,eAAA,CAAA,IAAA,EAAA,MAAA,CAAA;IASH,IAAA,CAAA0B,IAAA,GAAOA,IAAO,GAAAA,IAAA,GAAO,CAAA,CAAC;EAC7B;EAAA;AAAA;AAAA;AAAA;EAMA3nC,GAAGA,EAA6B,EAAA;IAC9B,OAAO,IAAK,CAAA4nC,KAAA,CAAM;MAAC5nC;IAAG,CAAA,CAAA;EACxB;EAAA;AAAA;AAAA;AAAA;EAMAgpC,KAA+BA,CAAA,EAAA;IAC7B,OAAO,KAAKrB,IAAK,CAAA3nC,EAAA;EACnB;EAAA;AAAA;AAAA;AAAA;EAMApD,MAAMA,KAAgC,EAAA;IAC7B,OAAA,IAAA,CAAKgrC,KAAM,CAAA;MAAChrC,KAAO;MAAAoD,EAAA,EAAIqpC,kBAAmB,CAAAzsC,KAAA,EAAO,IAAK,CAAA+qC,IAAA,CAAK3nC,EAAE;IAAE,CAAA,CAAA;EACxE;EAAA;AAAA;AAAA;AAAA;EAMA8nC,QAAqCA,CAAA,EAAA;IACnC,OAAO,KAAKH,IAAK,CAAA/qC,KAAA;EACnB;EAAA;AAAA;AAAA;AAAA;EAMAuH,KAAKA,IAA8D,EAAA;IACjE,OAAO,IAAK,CAAAyjC,KAAA,CAAM;MAACzjC;IAAK,CAAA,CAAA;EAC1B;EAAA;AAAA;AAAA;AAAA;EAMA2tC,QAAAA,CAAA,EAA0C;IAAA,IAAjC55B,8EAAU,IAAuB;IACxC,OAAO,KAAK0vB,KAAM,CAAA;MAChB0G,cAAA,EAAgB;QAAC,IAAI,IAAA,CAAK3G,KAAK2G,cAAkB,IAAA,CAAK,CAAA;QAAAwD,QAAA,EAAU55B;MAAO;IAAA,CACxE,CAAA;EACH;EAAA;AAAA;AAAA;AAAA;EAMA65B,WAAmCA,CAAA,EAAA;IACjC,OAAO,KAAKpK,IAAK,CAAA2G,cAAA,GAAiB,IAAK,CAAA3G,IAAA,CAAK2G,eAAewD,QAAW,GAAA,KAAA,CAAA;EACxE;EAAA;AAAA;AAAA;AAAA;EAMA9J,OAAmCA,CAAA,EAAA;IACjC,OAAO,KAAKL,IAAK,CAAAxjC,IAAA;EACnB;EAAA;AAAA;AAAA;AAAA;AAAA;EAOA4M,MAAMA,KAAmD,EAAA;IACvD,OAAO,IAAK,CAAA62B,KAAA,CAAM;MAAC72B;IAAM,CAAA,CAAA;EAC3B;EAAA;AAAA;AAAA;AAAA;EAMA24B,QAAqCA,CAAA,EAAA;IACnC,OAAO,KAAK/B,IAAK,CAAA52B,KAAA;EACnB;EAAA;AAAA;AAAA;AAAA;AAAA;EAOA3U,WAAWA,UAAkD,EAAA;IAC3D,OAAO,IAAK,CAAAwrC,KAAA,CAAM;MAACxrC;IAAW,CAAA,CAAA;EAChC;EAAA;AAAA;AAAA;AAAA;EAMAkvC,aAA+CA,CAAA,EAAA;IACvC,MAAAlvC,UAAA,GAAa,KAAKurC,IAAK,CAAAvrC,UAAA;IAEzB,IAAA,OAAOA,eAAe,QAAU,EAAA;MAClC,OAAO,IAAK,CAAAsrC,QAAA,CAASxrC,MAAO,CAAAG,GAAA,CAAID,UAAU,CAAA;IAC5C;IAEA,OAAO,KAAKurC,IAAK,CAAAvrC,UAAA;EACnB;EAAA;AAAA;AAAA;AAAA;EAMAqrC,YAAoE;IAAA,IAA1DxgB,OAAoC,GAAAgb,SAAA,CAAAniC,MAAA,QAAAmiC,SAAA,QAAAC,SAAA,GAAAD,SAAA,MAAA;MAAC/Z,IAAM,EAAA;KAAe;IAClE,MAAM;MAACloB,EAAA;MAAIpD,KAAO;MAAAmU;IAAA,IAAS,IAAK,CAAA42B,IAAA;IAChC,IAAI,OAAO3nC,EAAA,KAAO,QAAY,IAAA,CAACA,EAAI,EAAA;MACjC,MAAM,IAAI6lC,cAAA,CACR,iCAAA,EACA5e,OAAQ,CAAAiB,IAAA,EACRjB,OAAQ,CAAAthB,KAAA,CACV,CAAEugC,WAAY,CAAAE,QAAA,CAAS6C,WAAW,CAAA;IACpC;IAEA,IAAI,CAAChiB,OAAQ,CAAA+qB,eAAA,KAAoB,OAAOp1C,KAAU,KAAA,QAAA,IAAY,CAACA,KAAQ,CAAA,EAAA;MACrE,MAAM,IAAIipC,cAAe,CAAA,oCAAA,EAAsC5e,OAAQ,CAAAiB,IAAA,EAAMloB,EAAE,CAAE,CAAAkmC,WAAA,CAC/EE,QAAS,CAAA+B,cAAA,CACX;IACF;IAEI,IAAA/rC,UAAA,GAAa,KAAKurC,IAAK,CAAAvrC,UAAA;IACvB,IAAA,OAAOA,eAAe,QAAU,EAAA;MAClC,MAAM6L,IAAO,GAAA,IAAA,CAAKy/B,QAAS,CAAAxrC,MAAA,CAAOG,IAAID,UAAU,CAAA;MAChD,IAAI,CAAC6L,IAAM,EAAA;QACT,MAAM,IAAI49B,cAAA,CACR,wBAAwB5mC,MAAU,CAAA7C,UAAA,EAAA,aAAA,CAAA,EAClC6qB,OAAQ,CAAAiB,IAAA,EACRloB,EAAA,CACF,CAAEkmC,WAAY,CAAAE,QAAA,CAAS6L,qBAAqB,CAAA;MAC9C;MAEa71C,UAAA,GAAA6L,IAAA;IACf;IAEM,MAAAiqC,gBAAA,GAAmB;MAAChqB,IAAM,EAAAjB,OAAA,CAAQiB,KAAKjpB,MAAO,CAAAe,EAAE,CAAG;MAAAgmC,IAAA,EAAM;KAAO;IACtE,IAAImM,SACF,GAAAphC,KAAA,YAAiB04B,gBACjB,IAAA14B,KAAA,YAAiBi+B,mBACjB,IAAAj+B,KAAA,YAAiBo6B,eACjB,IAAAp6B,KAAA,YAAiB2/B,WACb,GAAA3/B,KAAA,CAAM02B,SAAU,CAAAyK,gBAAgB,CAChC,GAAAnhC,KAAA;IAIF,IAAA,OAAOohC,cAAc,UAAY,EAAA;MACnC,MAAMC,aAAgB,GAAAD,SAAA;MACVA,SAAA,GAAAA,CAACnH,QAAQqH,YAAiB,KAAA;QACpC,OAAOD,cAAcpH,MAAQ,EAAA;UAAC,GAAGqH,YAAA;UAAcH;QAAiB,CAAA,CAAA;MAAA,CAClE;IACF;IAEO,OAAA;MACL,GAAG,IAAK,CAAAvK,IAAA;MACR3nC,IAAImpC,UAAW,CAAAnpC,EAAA,EAAIinB,OAAQ,CAAAiB,IAAA,EAAMjB,QAAQthB,KAAK,CAAA;MAC9CvJ,UAAA;MACA2U,KAAO,EAAAohC,SAAA;MACPv1C,KAAA;MACAqL,IAAM,EAAA;IAAA,CACR;EACF;EAAA;AAAA;AAAA;AAAA;EAMA2/B,MAAMU,QAA6C,EAAA;IACjD,MAAMC,OAAU,GAAA,IAAI2I,eAAgB,CAAA,IAAA,CAAKxJ,QAAQ,CAAA;IACzCa,OAAA,CAAAZ,IAAA,GAAO;MAAC,GAAG,IAAA,CAAKA;MAAM,IAAIW,QAAA,IAAY,CAAA,CAAG;KAAA;IAC1C,OAAAC,OAAA;EACT;AACF;;;;;;;;;;;;ACnRA,MAAM+J,0BACJ,GAAAA,CAACpyC,OAA2B,EAAAynC,IAAA,KAAmCppC,UAAuB,IAAA;EAC9E,MAAAnC,UAAA,GACJurC,IAAK,CAAAvrC,UAAA,KACJ,OAAOurC,IAAA,CAAKvrC,eAAe,QAAW,GAAAurC,IAAA,CAAKvrC,UAAa,GAAAurC,IAAA,CAAKvrC,UAAW,CAAAoN,IAAA,CAAA;EAE3E,OAAOpN,aACH8D,OAAQ,CAAA6qC,mBAAA,CAAoB;IAAC3uC,UAAA;IAAYmC;GAAW,CAAA,GACpD,IAAI4sC,eAAA,CAAgBjrC,OAAO,CAAE,CAAAF,EAAA,CAAG,gBAAgB,CAAA,CAAEzB,WAAWA,UAAU,CAAA;AAC7E,CAAA;AAOK,MAAMg0C,gCAAgCrB,eAAgB,CAAA;EAI3DpL,WAAAA,CAIY4B,UACVC,IACA,EAAA;IACA,KAAA,CAAMD,UAAUC,IAAI,CAAA;IAHV,IAAA,CAAAD,QAAA,GAAAA,QAAA;IANZ;IAAUzB,eAAA,CAAA,IAAA,EAAA,MAAA,CAAA;IAUH,IAAA,CAAA0B,IAAA,GAAOA,IAAO,GAAAA,IAAA,GAAO,CAAA,CAAC;EAC7B;EAAA;AAAA;AAAA;AAAA;AAAA;EAOAF,YAAoE;IAAA,IAA1DxgB,OAA4B,GAAAgb,SAAA,CAAAniC,MAAA,QAAAmiC,SAAA,QAAAC,SAAA,GAAAD,SAAA,MAAA;MAAC/Z,IAAM,EAAA;KAAuB;IAC5D,MAAAyf,IAAA,GAAO,MAAMF,SAAU,CAAA;MAAC,GAAGxgB,OAAS;MAAA+qB,eAAA,EAAiB;KAAK,CAAA;IAE5D,IAAA,CAACrK,KAAKvrC,UAAY,EAAA;MACpB,MAAM,IAAIypC,cAAA,CACR,kDAAA,EACA5e,OAAQ,CAAAiB,IAAA,EACRjB,OAAQ,CAAAthB,KAAA,CACV,CAAEugC,WAAY,CAAAE,QAAA,CAASoM,oBAAoB,CAAA;IAC7C;IAEA,MAAMzhC,QAAQ42B,IAAK,CAAA52B,KAAA,IAASuhC,0BAA2B,CAAA,IAAA,CAAK5K,UAAUC,IAAI,CAAA;IACnE,OAAA;MAAC,GAAGA,IAAM;MAAA52B,KAAA;MAAO3U,YAAYurC,IAAK,CAAAvrC,UAAA;MAAY2I,GAAK,EAAA4iC,IAAA,CAAK3nC;KAAE;EACnE;EAAA;AAAA;AAAA;AAAA;EAMA4nC,MAAMU,QAA6D,EAAA;IACjE,MAAMC,OAAU,GAAA,IAAIgK,uBAAwB,CAAA,IAAA,CAAK7K,QAAQ,CAAA;IACjDa,OAAA,CAAAZ,IAAA,GAAO;MAAC,GAAG,IAAA,CAAKA;MAAM,IAAIW,QAAA,IAAY,CAAA,CAAG;KAAA;IAC1C,OAAAC,OAAA;EACT;AACF;AAGO,SAASuI,mBAAmB5kC,IAAyC,EAAA;EACnE,OAAA5H,MAAA,CAAAA,QAAA,CAAS4H,IAAI,CAAK,IAAA,OAAOA,KAAK9P,UAAe,KAAA,WAAA,IAAe,OAAO8P,IAAA,CAAKnH,GAAQ,KAAA,QAAA;AACzF;;;;;;;;;;;;AChFO,MAAM0tC,gCAAgCzD,mBAAoB,CAAA;EAI/DlJ,WAAAA,CAIY4B,UACVC,IACA,EAAA;IACA,KAAA,CAAMD,QAAQ,CAAA;IAHJ,IAAA,CAAAA,QAAA,GAAAA,QAAA;IANZ;IAAUzB,aAAA,CAAA,IAAA,EAAA,MAAA,CAAA;IAUH,IAAA,CAAA0B,IAAA,GAAOA,IAAO,GAAAA,IAAA,GAAO,CAAA,CAAC;EAC7B;EAAA;AAAA;AAAA;AAAA;AAAA;EAOA52B,MAAMA,KAAuC,EAAA;IAC3C,OAAO,IAAK,CAAA2hC,gCAAA,CAAiC;MAAC3hC;IAAM,CAAA,CAAA;EACtD;EAAA;AAAA;AAAA;AAAA;EAMA62B,MAAMU,QAAyD,EAAA;IACvD,MAAAyG,MAAA,GAAS,KAAM,CAAAnH,KAAA,CAAMU,QAAQ,CAAA;IACnC,MAAMC,OAAU,GAAA,IAAIkK,uBAAwB,CAAA,IAAA,CAAK/K,QAAQ,CAAA;IACzDa,OAAA,CAAQZ,IAAO,GAAA;MAAC,GAAG,IAAA,CAAKA,IAAM;MAAA,GAAGoH,MAAO,CAAAa,OAAA,CAAW,CAAA;MAAA,IAAItH,QAAY,IAAA,CAAG,CAAA;IAAA,CAAA;IAC/D,OAAAC,OAAA;EACT;EAAA;AAAA;AAAA;AAAA;EAMAmK,iCAAiCpK,QAAyD,EAAA;IAClF,MAAAyG,MAAA,GAAS,KAAM,CAAAnH,KAAA,CAAMU,QAAQ,CAAA;IACnC,MAAMC,OAAU,GAAA,IAAIkK,uBAAwB,CAAA,IAAA,CAAK/K,QAAQ,CAAA;IACnD,MAAA5gB,eAAA,GAAkB,KAAK6gB,IAAK,CAAA7gB,eAAA;IAC5B,MAAA6rB,cAAA,GAAiB7rB,eAAmB,IAAAA,eAAA,CAAgBomB,QAAa,KAAAZ,sBAAA;IACvE,MAAMsG,WAAWD,cAAiB,GAAA;MAAC7rB,eAAiB,EAAA,KAAA;QAAa,EAAC;IAClEyhB,OAAA,CAAQZ,IAAO,GAAA;MACb,GAAGoH,OAAOa,OAAQ,CAAA,CAAA;MAClB,GAAG,IAAK,CAAAjI,IAAA;MACR,IAAIW,YAAY,CAAC,CAAA;MACjB,GAAGsK;IAAA,CACL;IACO,OAAArK,OAAA;EACT;AACF;AC9DA,SAASsK,eAAez2C,UAAiC,EAAA;EACvD,MAAM02C,UAAU12C,UAAW,CAAA02C,OAAA;EACpB,OAAApwC,OAAA,CAAQowC,YAAYA,OAAQ,CAAAC,OAAA,IAAYD,QAAQE,MAAU,IAAAF,OAAA,CAAQE,OAAOC,KAAO,CAAA,CAAA;AACzF;AAEA,MAAMC,iBAAA,GAAoB,CAAC,mBAAA,EAAqB,kBAAkB,CAAA;AAElE,SAASC,iBAAiBt2B,QAAkB,EAAA;EACnC,OAAAq2B,iBAAA,CAAkB1pB,SAAS3M,QAAQ,CAAA;AAC5C;AAEA,SAASu2B,eAAeh3C,UAAwB,EAAA;EAxBhD,IAAAyN,EAAA;EAyBS,OAAA,CAAA,CAAAA,EAAA,GAAAzN,UAAA,CAAW6L,IAAX,KAAA,IAAA,GAAA,KAAA,CAAA,GAAA4B,EAAA,CAAiBL,IAAS,MAAA,UAAA;AACnC;AAEA,SAAS6pC,OAAOC,UAA4C,EAAA;EAC1D,OAAOA,WAAWrrC,IAAS,KAAA,MAAA;AAC7B;AAEgB,SAAAsrC,gBAAAA,CAAAC,MAAA,EAAuD;EAAA,IAAtC;IAACt3C;GAAqC,GAAAs3C,MAAA;EACrE,OAAOt3C,MACJ,CAAAuxC,YAAA,CAAA,CACA,CAAA9tC,MAAA,CAAQ8zC,CAAM,IAAA;IACP,MAAAr3C,UAAA,GAAaF,MAAO,CAAAG,GAAA,CAAIo3C,CAAC,CAAA;IACxB,OAAAr3C,UAAA,IAAcg3C,eAAeh3C,UAAU,CAAA;EAAA,CAC/C,EACAuD,MAAO,CAAC8zC,KAAM,CAACN,gBAAA,CAAiBM,CAAC,CAAC,CAAA;AACvC;AAEO,SAASC,yBAAyBxzC,OAA8C,EAAA;EAC/E,MAAA+pC,KAAA,GAAQsJ,iBAAiBrzC,OAAO,CAAA;EACtC,OAAO+pC,MAAMrsC,GAAI,CAACif,YAAa82B,uBAAwB,CAAAzzC,OAAA,EAAS2c,QAAQ,CAAC,CAAA;AAC3E;AAEgB,SAAA82B,uBAAAA,CACdzzC,SACA2c,QACiB,EAAA;EACX,MAAA;IAAC3gB;EAAU,CAAA,GAAAgE,OAAA;EAEX,MAAA+H,IAAA,GAAO/L,MAAO,CAAAG,GAAA,CAAIwgB,QAAQ,CAAA;EAChC,IAAI,CAAC5U,IAAM,EAAA;IACT,MAAM,IAAIzC,KAAA,CAAM,yBAA0B,CAAAvG,MAAA,CAAA4d,QAAA,EAAQ,aAAa,CAAA,CAAA;EACjE;EAEA,MAAMjgB,KAAQ,GAAAqL,IAAA,CAAKrL,KAAS,IAAAg3C,kBAAA,CAAAtpC,OAAA,CAAUuS,QAAQ,CAAA;EAE9C,OAAO,IAAIq0B,eAAgB,CAAAhxC,OAAO,CAC/B,CAAAF,EAAA,CAAG6c,QAAQ,CACX,CAAAjgB,KAAA,CAAMA,KAAK,CAAA,CACXR,WAAW6L,IAAI,CAAA,CACf8I,KAAM,CAAA,CAAC/Q,IAAI6zC,YAAiB,KAAA;IAC3B,MAAM9E,SAAS8E,YAAa,CAAA9E,MAAA;IAC5B,MAAMD,UAAa,GAAAuE,MAAA,CAAOtE,MAAM,CAAA,GAC3BA,MAAO,CAAA9a,KAAA,CAAMne,IAAK,CAAC5J,IAAS,IAAAA,IAAA,CAAKlM,EAAO,KAAAA,EAAE,CAC3C,GAAA,IAAA;IAEA,IAAA8zC,IAAA,GAAOC,mBAAoB,CAAA7zC,OAAA,EAAS2c,QAAQ,CAAA;IAC5C,IAAAiyB,UAAA,IAAcA,WAAWlyC,KAAO,EAAA;MAC3Bk3C,IAAA,GAAAA,IAAA,CAAKl3C,KAAM,CAAAkyC,UAAA,CAAWlyC,KAAK,CAAA;IACpC;IAEO,OAAAk3C,IAAA;EAAA,CACR,CAAA;AACL;AAEgB,SAAAC,mBAAAA,CACd7zC,SACA8zC,cACqB,EAAA;EACf,MAAA;IAAC93C,MAAQ;IAAA6uC;EAAuB,CAAA,GAAA7qC,OAAA;EAEtC,MAAM9D,UAAa,GAAA,OAAO43C,cAAmB,KAAA,QAAA,GAAWA,iBAAiBA,cAAe,CAAA53C,UAAA;EACxF,MAAMygB,QAAW,GAAA,OAAOzgB,UAAe,KAAA,QAAA,GAAWA,aAAaA,UAAW,CAAAoN,IAAA;EAC1E,MAAMm+B,OACJ,OAAOqM,cAAA,KAAmB,QAAW,GAAA;IAAC53C;EAAc,CAAA,GAAA43C,cAAA;EAEhD,MAAA/rC,IAAA,GAAO/L,MAAO,CAAAG,GAAA,CAAIwgB,QAAQ,CAAA;EAChC,IAAI,CAAC5U,IAAM,EAAA;IACT,MAAM,IAAIzC,KAAA,CAAM,yBAA0B,CAAAvG,MAAA,CAAA4d,QAAA,EAAQ,aAAa,CAAA,CAAA;EACjE;EAEA,MAAMjgB,KAAQ,GAAAqL,IAAA,CAAKrL,KAAS,IAAAg3C,kBAAA,CAAAtpC,OAAA,CAAUuS,QAAQ,CAAA;EACxC,MAAAwxB,SAAA,GAAYwE,eAAe5qC,IAAI,CAAA;EAErC,OAAO,IAAIwqC,uBAAA,CAAwBvyC,OAAO,CAAA,CACvCF,GAAG2nC,IAAK,CAAA3nC,EAAA,IAAM6c,QAAQ,CAAA,CACtBjgB,KAAM,CAAA+qC,IAAA,CAAK/qC,KAAS,IAAAA,KAAK,EACzB+C,MAAO,CAAA,gBAAgB,CACvB,CAAAoG,MAAA,CAAO;IAACkC,IAAA,EAAM4U;EAAQ,CAAC,EACvBzgB,UAAW,CAAA6L,IAAI,CACf,CAAAomC,SAAA,CAAUA,SAAS,CAAA,CACnBe,eAAgB,CAAA/H,gCAAA,CAAiCF,EAAE,CACnD,CAAAlsB,cAAA,CACC0sB,KAAK1sB,cAAkB,IAAA,CACrB;IAACjb,EAAA,EAAI,SAAW;IAAApD,KAAA,EAAO;EAAM,CAAA,EAC7B;IAACoD,EAAA,EAAI,QAAU;IAAApD,KAAA,EAAO;EAAQ,CAAA,EAC9B;IAACoD,EAAA,EAAI,SAAW;IAAApD,KAAA,EAAO;EAAS,CAAA,CAClC,CAED,CAAAmU,KAAA,CACC42B,IAAA,CAAK52B,UACDxS,UAAA,IAAuBwsC,oBAAoB;IAAC3uC,UAAA,EAAYygB,QAAU;IAAAte;EAAA,CAAW,CAAA,CAElF,CAAA,CAAAuoB,eAAA,CAAgB6gB,IAAK,CAAA7gB,eAAA,IAAmBylB,oBAAoB,CAC5D,CAAAvxB,SAAA,CACC2sB,KAAK3sB,SAAa,IAAA;EAAA;EAAA;EAIhB,GAAG2tB,iCAAkC,CAAAzoC,OAAA,EAAS+H,IAAI,CAAA;EAAA;EAGlD,IAAIu/B,gBAAgBtnC,OAAO,CAAA,CACxBsb,MAAM,QAAQ,CAAA,CACd5e,MAAM,cAAc,CAAA,CACpBuH,KAAK8vC,KAAgB,CAAAA,gBAAA,CAAA,CACrBpoC,OAAO,WAAW,CAAA,CAClB9F,OAAO;IAAC3B,MAAA,EAAQ;GAAU,CAAA,EAE7B,IAAIojC,gBAAgBtnC,OAAO,CAAA,CACxBsb,MAAM,QAAQ,CAAA,CACd5e,MAAM,eAAe,CAAA,CACrBuH,KAAK+vC,KAAS,CAAAA,SAAA,CAAA,CACdroC,OAAO,WAAW,CAAA,CAClB9F,OAAO;IAAC3B,MAAA,EAAQ;GAAS;EAAA;EAAA,CAG9B,CACF;AACJ;;AC1GA,SAAS+vC,QAAQ/3C,UAA2C,EAAA;EAC1D,IAAI,CAACA,UAAA,IAAc,OAAOA,UAAA,KAAe,QAAU,EAAA;IAC1C,OAAA,KAAA;EACT;EAEO,OAAAsG,OAAA,CAAQtG,WAAW+H,IAAI,CAAA;AAChC;AAEA,SAASiwC,oBAAoBl0C,OAAwC,EAAA;EAC7D,MAAA+zB,KAAA,GAAQyf,yBAAyBxzC,OAAO,CAAA;EACvC,OAAA,IAAIwwC,YAAYxwC,OAAO,CAAA,CAC3BF,GAAG,UAAU,CAAA,CACbpD,KAAM,CAAA,SAAS,CACf,CAAAq3B,KAAA,CAAMA,KAAK,CACX,CAAAoa,SAAA,CAAUpa,KAAM,CAAAl0B,IAAA,CAAMmM,IAAA,IAASioC,QAAQjoC,IAAK,CAAAo/B,aAAA,EAAe,CAAC,CAAC,CAAA;AAClE;AAGO,SAAS+I,sBAAuBA,CAAAC,MAAA,EAGO;EAAA,IAHP;IACrCC,mBAAA;IACAC;EACF,CAA8C,GAAAF,MAAA;EACtC,MAAAG,aAAA,GAAgBC,kCAA2BF,MAAM,CAAA;EACvD,MAAMt0C,OAA4B,GAAA;IAChC,GAAGs0C,MAAA;IACHhH,qBAAqBA,CAAA,KAAMmH,gBAAA;IAC3B5J,mBAAA,EAAsB9jB,OAAY,IAAA;MAC5B,IAAAshB,OAAA,GAAA,CACFgM,mBAAsB,IAAA,IAAA,GAAA,KAAA,CAAA,GAAAA,mBAAA,CAAAI,gBAAA,EAAkB;QAAC,GAAG1tB,OAAS;QAAA,GAAGwtB;MAAa,CAAA,CAAA,KACrE,IAAItJ,eAAA,CAAgBjrC,OAAO,CAAA;MAEzB,IAAA,CAACqoC,OAAQ,CAAAS,KAAA,EAAS,EAAA;QACVT,OAAA,GAAAA,OAAA,CAAQvoC,GAAG,gBAAgB,CAAA;MACvC;MAEA,IAAIinB,QAAQ1oB,UAAY,EAAA;QACtBgqC,OAAA,GAAUA,OAAQ,CAAAhqC,UAAA,CAAWM,MAAe,CAAAA,cAAA,CAAAooB,OAAA,CAAQ1oB,UAAU,CAAC,CAAA;MACjE;MAEO,OAAAgqC,OAAA,CAAQnsC,UAAW,CAAA6qB,OAAA,CAAQ7qB,UAAU,CAAA;IAC9C;EAAA,CACF;EAEA,MAAMu4C,gBAAqC,GAAA;IACzCC,QAAA,EAAUA,CAAA,KAAMR,mBAAA,CAAoBl0C,OAAO,CAAA;IAC3C20C,kBAAkB,SAAAA,CAAA;MAAA,SAAAC,IAAA,GAAA7S,SAAA,CAAAniC,MAAA,EAAIi1C,IAAA,OAAA1yC,KAAA,CAAAyyC,IAAA,GAAAvnB,IAAA,MAAAA,IAAA,GAAAunB,IAAA,EAAAvnB,IAAA;QAAAwnB,IAAA,CAAAxnB,IAAA,IAAA0U,SAAA,CAAA1U,IAAA;MAAA;MAAA,OAASwmB,mBAAoB,CAAA7zC,OAAA,EAAS,GAAG60C,IAAI,CAAA;IAAA;IACnEC,sBAAsB,SAAAA,CAAA;MAAA,SAAAC,KAAA,GAAAhT,SAAA,CAAAniC,MAAA,EAAIi1C,IAAA,OAAA1yC,KAAA,CAAA4yC,KAAA,GAAAC,KAAA,MAAAA,KAAA,GAAAD,KAAA,EAAAC,KAAA;QAAAH,IAAA,CAAAG,KAAA,IAAAjT,SAAA,CAAAiT,KAAA;MAAA;MAAA,OAASvB,uBAAwB,CAAAzzC,OAAA,EAAS,GAAG60C,IAAI,CAAA;IAAA;IAC3EI,uBAAuB,SAAAA,CAAA;MAAA,SAAAC,KAAA,GAAAnT,SAAA,CAAAniC,MAAA,EAAIi1C,IAAA,OAAA1yC,KAAA,CAAA+yC,KAAA,GAAAC,KAAA,MAAAA,KAAA,GAAAD,KAAA,EAAAC,KAAA;QAAAN,IAAA,CAAAM,KAAA,IAAApT,SAAA,CAAAoT,KAAA;MAAA;MAAA,OAAS3B,wBAAyB,CAAAxzC,OAAA,EAAS,GAAG60C,IAAI,CAAA;IAAA;IAC7E/4C,UAAU,SAAAA,CAAA;MAAA,SAAAs5C,KAAA,GAAArT,SAAA,CAAAniC,MAAA,EAAIi1C,IAAA,OAAA1yC,KAAA,CAAAizC,KAAA,GAAAC,KAAA,MAAAA,KAAA,GAAAD,KAAA,EAAAC,KAAA;QAAAR,IAAA,CAAAQ,KAAA,IAAAtT,SAAA,CAAAsT,KAAA;MAAA;MAAA,OAAS,IAAIpK,eAAgB,CAAAjrC,OAAA,EAAS,GAAG60C,IAAI,CAAA;IAAA;IAC3DS,kCAAkC,SAAAA,CAAA;MAAA,SAAAC,KAAA,GAAAxT,SAAA,CAAAniC,MAAA,EAAIi1C,IAAA,OAAA1yC,KAAA,CAAAozC,KAAA,GAAAC,KAAA,MAAAA,KAAA,GAAAD,KAAA,EAAAC,KAAA;QAAAX,IAAA,CAAAW,KAAA,IAAAzT,SAAA,CAAAyT,KAAA;MAAA;MAAA,OACpCvJ,kCAAmC,CAAAjsC,OAAA,EAAS,GAAG60C,IAAI,CAAA;IAAA;IACrDY,iBAAiBz1C,OAAQ,CAAA6qC,mBAAA;IAEzB+I,MAAM,SAAAA,CAAA;MAAA,SAAA8B,KAAA,GAAA3T,SAAA,CAAAniC,MAAA,EAAIi1C,IAAA,OAAA1yC,KAAA,CAAAuzC,KAAA,GAAAC,KAAA,MAAAA,KAAA,GAAAD,KAAA,EAAAC,KAAA;QAAAd,IAAA,CAAAc,KAAA,IAAA5T,SAAA,CAAA4T,KAAA;MAAA;MAAA,OAAS,IAAInF,WAAY,CAAAxwC,OAAA,EAAS,GAAG60C,IAAI,CAAA;IAAA;IACnD5D,UAAU,SAAAA,CAAA;MAAA,SAAA2E,KAAA,GAAA7T,SAAA,CAAAniC,MAAA,EAAIi1C,IAAA,OAAA1yC,KAAA,CAAAyzC,KAAA,GAAAC,KAAA,MAAAA,KAAA,GAAAD,KAAA,EAAAC,KAAA;QAAAhB,IAAA,CAAAgB,KAAA,IAAA9T,SAAA,CAAA8T,KAAA;MAAA;MAAA,OAAS,IAAI7E,eAAgB,CAAAhxC,OAAA,EAAS,GAAG60C,IAAI,CAAA;IAAA;IAE3Dpa,UAAU,SAAAA,CAAA;MAAA,SAAAqb,KAAA,GAAA/T,SAAA,CAAAniC,MAAA,EAAIi1C,IAAA,OAAA1yC,KAAA,CAAA2zC,KAAA,GAAAC,KAAA,MAAAA,KAAA,GAAAD,KAAA,EAAAC,KAAA;QAAAlB,IAAA,CAAAkB,KAAA,IAAAhU,SAAA,CAAAgU,KAAA;MAAA;MAAA,OAAS,IAAIzO,eAAgB,CAAAtnC,OAAA,EAAS,GAAG60C,IAAI,CAAA;IAAA;IAC3DmB,eAAe,SAAAA,CAAA;MAAA,SAAAC,KAAA,GAAAlU,SAAA,CAAAniC,MAAA,EAAIi1C,IAAA,OAAA1yC,KAAA,CAAA8zC,KAAA,GAAAC,KAAA,MAAAA,KAAA,GAAAD,KAAA,EAAAC,KAAA;QAAArB,IAAA,CAAAqB,KAAA,IAAAnU,SAAA,CAAAmU,KAAA;MAAA;MAAA,OAAS,IAAItN,oBAAqB,CAAA5oC,OAAA,EAAS,GAAG60C,IAAI,CAAA;IAAA;IACrEnH,wCAAwC,SAAAA,CAAA;MAAA,SAAAyI,MAAA,GAAApU,SAAA,CAAAniC,MAAA,EAAIi1C,IAAA,OAAA1yC,KAAA,CAAAg0C,MAAA,GAAAC,MAAA,MAAAA,MAAA,GAAAD,MAAA,EAAAC,MAAA;QAAAvB,IAAA,CAAAuB,MAAA,IAAArU,SAAA,CAAAqU,MAAA;MAAA;MAAA,OAC1C1I,sCAAuC,CAAA1tC,OAAA,EAAS,GAAG60C,IAAI,CAAA;IAAA;IAEzDwB,cAAc,SAAAA,CAAA;MAAA,SAAAC,MAAA,GAAAvU,SAAA,CAAAniC,MAAA,EAAIi1C,IAAA,OAAA1yC,KAAA,CAAAm0C,MAAA,GAAAC,MAAA,MAAAA,MAAA,GAAAD,MAAA,EAAAC,MAAA;QAAA1B,IAAA,CAAA0B,MAAA,IAAAxU,SAAA,CAAAwU,MAAA;MAAA;MAAA,OAAS,IAAIzH,mBAAoB,CAAA9uC,OAAA,EAAS,GAAG60C,IAAI,CAAA;IAAA;IACnE2B,kBAAkB,SAAAA,CAAA;MAAA,SAAAC,MAAA,GAAA1U,SAAA,CAAAniC,MAAA,EAAIi1C,IAAA,OAAA1yC,KAAA,CAAAs0C,MAAA,GAAAC,MAAA,MAAAA,MAAA,GAAAD,MAAA,EAAAC,MAAA;QAAA7B,IAAA,CAAA6B,MAAA,IAAA3U,SAAA,CAAA2U,MAAA;MAAA;MAAA,OAAS,IAAIrE,uBAAwB,CAAAryC,OAAA,EAAS,GAAG60C,IAAI,CAAA;IAAA;IAE3E8B,kBAAkB,SAAAA,CAAA;MAAA,SAAAC,MAAA,GAAA7U,SAAA,CAAAniC,MAAA,EAAIi1C,IAAA,OAAA1yC,KAAA,CAAAy0C,MAAA,GAAAC,MAAA,MAAAA,MAAA,GAAAD,MAAA,EAAAC,MAAA;QAAAhC,IAAA,CAAAgC,MAAA,IAAA9U,SAAA,CAAA8U,MAAA;MAAA;MAAA,OAASvO,mBAAoB,CAAAtoC,OAAA,EAAS,GAAG60C,IAAI,CAAA;IAAA;IACnEiC,0BAA0B,SAAAA,CAAA;MAAA,SAAAC,MAAA,GAAAhV,SAAA,CAAAniC,MAAA,EAAIi1C,IAAA,OAAA1yC,KAAA,CAAA40C,MAAA,GAAAC,MAAA,MAAAA,MAAA,GAAAD,MAAA,EAAAC,MAAA;QAAAnC,IAAA,CAAAmC,MAAA,IAAAjV,SAAA,CAAAiV,MAAA;MAAA;MAAA,OAASvO,iCAAkC,CAAAzoC,OAAA,EAAS,GAAG60C,IAAI,CAAA;IAAA;IAEzFoC,QAAQ,SAAAA,CAAA;MAAA,SAAAC,MAAA,GAAAnV,SAAA,CAAAniC,MAAA,EAAIi1C,IAAA,OAAA1yC,KAAA,CAAA+0C,MAAA,GAAAC,MAAA,MAAAA,MAAA,GAAAD,MAAA,EAAAC,MAAA;QAAAtC,IAAA,CAAAsC,MAAA,IAAApV,SAAA,CAAAoV,MAAA;MAAA;MAAA,OAASnL,kBAAmB,CAAAhsC,OAAA,EAAS,GAAG60C,IAAI,CAAA;IAAA;IAExDxH,kCAAkC,SAAAA,CAAA;MAAA,SAAA+J,MAAA,GAAArV,SAAA,CAAAniC,MAAA,EAAIi1C,IAAA,OAAA1yC,KAAA,CAAAi1C,MAAA,GAAAC,MAAA,MAAAA,MAAA,GAAAD,MAAA,EAAAC,MAAA;QAAAxC,IAAA,CAAAwC,MAAA,IAAAtV,SAAA,CAAAsV,MAAA;MAAA;MAAA,OACpChK,gCAAiC,CAAArtC,OAAA,EAAS,GAAG60C,IAAI,CAAA;IAAA;IAEnD10B,0BAA0BA,CACxBtD,UAAA,EACAG,UAEA,KAAA,IAAIiwB,gCAAgCjtC,OAAS,EAAA;MAC3CF,EAAI,EAAA+c,UAAA;MACJG,UAAA;MACAH;IAAA,CACD,CAAA;IAEHoF,SAAA,EAAYwlB,IAA0C,IAAA;MAC7C,OAAA6P,0BAAA,CAAmB7P,IAAI,CAAA,GAC1B,IAAI8B,gBAAA,CAAmB,CAAA,CAAAtnB,SAAA,CAAUwlB,IAAqB,CAAA,GACtD,IAAI8B,gBAAA,CAAiB9B,IAAsB,CAAA;IACjD,CAAA;IAEA7wB,OAAA,EAASA,CAAA,MAAgB;MAAC9W,EAAA,EAAIy3C,iBAAAA,CAAAA,QAAS,aAAa,CAAA;MAAGxvC,MAAM;KAAS,CAAA;IAEtE+2B,IAAM,EAAAlB,KAAA;IACN59B;EAAA,CACF;EAEO,OAAAy0C,gBAAA;AACT;ACtHO,SAAS+C,gBAAiBA,CAAAC,MAAA,EAIa;EAAA,IAJb;IAC/BpD,mBAAA;IACAqD,SAAW,EAAAC,gBAAA;IACX18C;EACF,CAA8C,GAAAw8C,MAAA;EAC5C,MAAM,CAACjiC,eAAA,EAAiBoiC,kBAAkB,CAAA,GAAIv8C,eAAS,KAAK,CAAA;EAC5D,MAAMi5C,SAAS9Y,MAAAA,CAAAA,SAAU,EAAA;EACnB,MAAA+Y,aAAA,GAAgBsD,kCAA2BvD,MAAM,CAAA;EACvD,MAAMxzC,gBAAgBc,MAAAA,CAAAA,gBAAiB,EAAA;EAEjC,MAAAk2C,CAAA,GAAI/1C,KAAAA,CAAAA,QAAQ,MAAM;IACtB,OAAOoyC,sBAAuB,CAAA;MAC5BE,mBAAA;MACAC;IAAA,CACD,CAAA;EAAA,CACA,EAAA,CAACD,mBAAqB,EAAAC,MAAM,CAAC,CAAA;EAE1B,MAAAyD,YAAA,GAAeh2C,KAAAA,CAAAA,QAAQ,MAAM;IAE7B,IAAA41C,gBAAA,EACF,OAAOA,iBAAiBG,CAAG,EAAA;MACzB,GAAGvD,aAAA;MACHzzC;IAAA,CACD,CAAA;IACH,OAAOg3C,EAAEpD,QAAS,EAAA;KACjB,CAACoD,CAAA,EAAGH,gBAAkB,EAAApD,aAAA,EAAezzC,aAAa,CAAC,CAAA;EAEtD,MAAMg4B,QAA6C,GAAA/2B,KAAA,CAAAA,OAAA,CACjD,OAAO;IACL4W,UAAY,EAAAnD,eAAA;IACZwiC,gBAAgB,CAACxiC,eAAA;IACjBujB,eAAe,CAACvjB,eAAA;IAChByiC,YAAY,CAACziC,eAAA;IACb0iC,YAAY,CAAC1iC;EAAA,CACf,CAAA,EACA,CAACA,eAAe,CAAA,CAClB;EAEM,MAAAkW,QAAA,GAAiC3pB,KAAAA,CAAAA,QAAQ,MAAM;IAC5C,OAAA;MACL+2B,QAAA;MACAtjB,eAAA;MACAoiC,kBAAA;MACAG,YAAA;MACAI,kBAAkBL,CAAE,CAAA93C;IAAA,CACtB;EAAA,GACC,CAAC84B,QAAA,EAAUtjB,iBAAiBuiC,YAAc,EAAAD,CAAA,CAAE93C,OAAO,CAAC,CAAA;EAEvD,qCAAQwrB,eAAgB,CAAAxU,QAAA,EAAhB;IAAyB1a,KAAA,EAAOovB;IAAWzwB;EAAS,CAAA,CAAA;AAC9D;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;"}